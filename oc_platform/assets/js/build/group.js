!function(e,t){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(i,n,s){e.Backbone=t(e,s,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");t(e,exports,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,i,n){{var s=e.Backbone,r=[],o=(r.push,r.slice);r.splice}t.VERSION="1.1.2",t.$=n,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,i){if(!c(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,n){if(!c(this,"once",e,[t,n])||!t)return this;var s=this,r=i.once(function(){s.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var s,r,o,a,l,u,d,p;if(!this._events||!c(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(a=e?[e]:i.keys(this._events),l=0,u=a.length;u>l;l++)if(e=a[l],o=this._events[e]){if(this._events[e]=s=[],t||n)for(d=0,p=o.length;p>d;d++)r=o[d],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&s.push(r);s.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&u(i,t),n&&u(n,arguments),this},stopListening:function(e,t,n){var s=this._listeningTo;if(!s)return this;var r=!t&&!n;n||"object"!=typeof t||(n=this),e&&((s={})[e._listenId]=e);for(var o in s)e=s[o],e.off(t,n,this),(r||i.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)e[t].apply(e,[s,i[s]].concat(n));return!1}if(l.test(i)){for(var r=i.split(l),o=0,a=r.length;a>o;o++)e[t].apply(e,[r[o]].concat(n));return!1}return!0},u=function(e,t){var i,n=-1,s=e.length,r=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++n<s;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=e[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=e[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<s;)(i=e[n]).callback.call(i.ctx,r,o,a);return;default:for(;++n<s;)(i=e[n]).callback.apply(i.ctx,t);return}},d={listenTo:"on",listenToOnce:"once"};i.each(d,function(e,t){a[t]=function(t,n,s){var r=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=i.uniqueId("l"));return r[o]=t,s||"object"!=typeof n||(s=this),t[e](n,s,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(t,a);var p=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var s,r,o,a,l,c,u,d;if(null==e)return this;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;o=n.unset,l=n.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(s in r)t=r[s],i.isEqual(d[s],t)||a.push(s),i.isEqual(u[s],t)?delete this.changed[s]:this.changed[s]=t,o?delete d[s]:d[s]=t;if(!l){a.length&&(this._pending=n);for(var p=0,h=a.length;h>p;p++)this.trigger("change:"+a[p],this,d[a[p]],n)}if(c)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,n=!1,s=this._changing?this._previousAttributes:this.attributes;for(var r in e)i.isEqual(s[r],t=e[r])||((n||(n={}))[r]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(n&&n(t,i,e),void t.trigger("sync",t,i,e)):!1},N(this,e),this.sync("read",this,e)},save:function(e,t,n){var s,r,o,a=this.attributes;if(null==e||"object"==typeof e?(s=e,n=t):(s={})[e]=t,n=i.extend({validate:!0},n),s&&!n.wait){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;s&&n.wait&&(this.attributes=i.extend({},a,s)),void 0===n.parse&&(n.parse=!0);var l=this,c=n.success;return n.success=function(e){l.attributes=a;var t=l.parse(e,n);return n.wait&&(t=i.extend(s||{},t)),i.isObject(t)&&!l.set(t,n)?!1:(c&&c(l,e,n),void l.trigger("sync",l,e,n))},N(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=s),o=this.sync(r,this,n),s&&n.wait&&(this.attributes=a),o},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,s=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&s(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;N(this,e);var r=this.sync("delete",this,e);return e.wait||s(),r},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||L();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1):!0}});var h=["keys","values","pairs","invert","pick","omit"];i.each(h,function(e){p.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(f.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,g))},remove:function(e,t){var n=!i.isArray(e);e=n?[e]:i.clone(e),t||(t={});var s,r,o,a;for(s=0,r=e.length;r>s;s++)a=e[s]=this.get(e[s]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,t.silent||(t.index=o,a.trigger("remove",a,this,t)),this._removeReference(a,t));return n?e[0]:e},set:function(e,t){t=i.defaults({},t,m),t.parse&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?e?[e]:[]:i.clone(e);var s,r,o,a,l,c,u,d=t.at,h=this.model,f=this.comparator&&null==d&&t.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=t.add,C=t.merge,E=t.remove,_=!f&&w&&E?[]:!1;for(s=0,r=e.length;r>s;s++){if(l=e[s]||{},o=l instanceof p?a=l:l[h.prototype.idAttribute||"id"],c=this.get(o))E&&(b[c.cid]=!0),C&&(l=l===a?a.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),f&&!u&&c.hasChanged(g)&&(u=!0)),e[s]=c;else if(w){if(a=e[s]=this._prepareModel(l,t),!a)continue;v.push(a),this._addReference(a,t)}a=c||a,!_||!a.isNew()&&b[a.id]||_.push(a),b[a.id]=!0}if(E){for(s=0,r=this.length;r>s;++s)b[(a=this.models[s]).cid]||y.push(a);y.length&&this.remove(y,t)}if(v.length||_&&_.length)if(f&&(u=!0),this.length+=v.length,null!=d)for(s=0,r=v.length;r>s;s++)this.models.splice(d+s,0,v[s]);else{_&&(this.models.length=0);var k=_||v;for(s=0,r=k.length;r>s;s++)this.models.push(k[s])}if(u&&this.sort({silent:!0}),!t.silent){for(s=0,r=v.length;r>s;s++)(a=v[s]).trigger("add",a,this,t);(u||_&&_.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,s=this.models.length;s>n;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var s=e.reset?"reset":"set";n[s](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,s=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),s&&s(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(v,function(e){f.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var y=["groupBy","countBy","sortBy","indexBy"];i.each(y,function(e){f.prototype[e]=function(t,n){var s=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,s,n)}});var b=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,C)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];i.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var s=t.match(w),r=s[1],o=s[2];n=i.bind(n,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,n):this.$el.on(r,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,s){var r=_[e];i.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:r,dataType:"json"};if(s.url||(o.url=i.result(n,"url")||L()),null!=s.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",s.emulateJSON&&(o.data._method=r);var a=s.beforeSend;s.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===o.type||s.emulateJSON||(o.processData=!1),"PATCH"===o.type&&E&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=s.xhr=t.ajax(i.extend(o,s));return n.trigger("request",n,l,s),l};var E=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),_={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},F=/\((.*?)\)/g,x=/(\(\?)?:\w+/g,T=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(k.prototype,a,{initialize:function(){},route:function(e,n,s){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(s=n,n=""),s||(s=this[n]);var r=this;return t.history.route(e,function(i){var o=r._extractParameters(e,i);r.execute(s,o),r.trigger.apply(r,["route:"+n].concat(o)),r.trigger("route",n,o),t.history.trigger("route",r,n,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(D,"\\$&").replace(F,"(?:$1)?").replace(x,function(e,t){return t?e:"([^/?]+)"}).replace(T,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var j=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},P=/^[#\/]|\s+$/g,S=/^\/+|\/+$/g,A=/msie [\w.]+/,z=/\/$/,I=/#.*$/;j.started=!1,i.extend(j.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(z,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(P,"")},start:function(e){if(j.started)throw new Error("Backbone.history has already been started");j.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),s=document.documentMode,r=A.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);if(this.root=("/"+this.root+"/").replace(S,"/"),r&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(P,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),j.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!j.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(I,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new j;var H=function(e,t){var n,s=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,t);var r=function(){this.constructor=n};return r.prototype=s.prototype,n.prototype=new r,e&&i.extend(n.prototype,e),n.__super__=s.prototype,n};p.extend=f.extend=k.extend=b.extend=j.extend=H;var L=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}),!function(e){"function"==typeof define&&define.amd?define("dropzone",["jquery"],e):e(jQuery)}(function(e){function t(e){return e?i(e):void 0}function i(e){for(var i in t.prototype)e[i]=t.prototype[i];return e}var n={exports:{}};return n.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},t.prototype.once=function(e,t){function i(){n.off(e,i),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var n,s=0;s<i.length;s++)if(n=i[s],n===t||n.fn===t){i.splice(s,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks[e];if(i){i=i.slice(0);for(var n=0,s=i.length;s>n;++n)i[n].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length},function(){var i,s,r,o,a,l,c,u,d={}.hasOwnProperty,p=function(e,t){function i(){this.constructor=e}for(var n in t)d.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},h=[].slice;s="undefined"!=typeof t&&null!==t?t:require("emitter"),c=function(){},i=function(e){function t(e,n){var s,r,o;if(this.element=e,this.version=t.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(t.instances.push(this),this.element.dropzone=this,s=null!=(o=t.optionsForElement(this.element))?o:{},this.options=i({},this.defaultOptions,s,null!=n?n:{}),this.options.forceFallback||!t.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(r=this.getExistingFallback())&&r.parentNode&&r.parentNode.removeChild(r),this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?t.getElement(this.options.previewsContainer,"previewsContainer"):this.element),this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:t.getElements(this.options.clickable,"clickable")),this.init()}var i;return p(t,e),t.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],t.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return c},forceFallback:!1,fallback:function(){var e,i,n,s,r,o;for(this.element.className=""+this.element.className+" dz-browser-not-supported",o=this.element.getElementsByTagName("div"),s=0,r=o.length;r>s;s++)e=o[s],/(^| )dz-message($| )/.test(e.className)&&(i=e,e.className="dz-message");return i||(i=t.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(i)),n=i.getElementsByTagName("span")[0],n&&(n.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,i,n;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},i=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=i*t.optHeight:null==t.optHeight&&(t.optHeight=1/i*t.optWidth),n=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):i>n?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*n):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/n),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:c,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:c,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var i,n,s,r,o,a,l,c,u,d,p,h,f;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=t.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),d=e.previewElement.querySelectorAll("[data-dz-name]"),r=0,l=d.length;l>r;r++)i=d[r],i.textContent=e.name;for(p=e.previewElement.querySelectorAll("[data-dz-size]"),o=0,c=p.length;c>o;o++)i=p[o],i.innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=t.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),n=function(i){return function(n){return n.preventDefault(),n.stopPropagation(),e.status===t.UPLOADING?t.confirm(i.options.dictCancelUploadConfirmation,function(){return i.removeFile(e)}):i.options.dictRemoveFileConfirmation?t.confirm(i.options.dictRemoveFileConfirmation,function(){return i.removeFile(e)}):i.removeFile(e)}}(this),h=e.previewElement.querySelectorAll("[data-dz-remove]"),f=[],a=0,u=h.length;u>a;a++)s=h[a],f.push(s.addEventListener("click",n));return f}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var i,n,s,r,o;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),e.previewElement.classList.add("dz-image-preview"),r=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),o=[],n=0,s=r.length;s>n;n++)i=r[n],i.alt=e.name,o.push(i.src=t);return o}},error:function(e,t){var i,n,s,r,o;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),r=e.previewElement.querySelectorAll("[data-dz-errormessage]"),o=[],n=0,s=r.length;s>n;n++)i=r[n],o.push(i.textContent=t);return o}},errormultiple:c,processing:function(e){return e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink)?e._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:c,uploadprogress:function(e,t){var i,n,s,r,o;if(e.previewElement){for(r=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),o=[],n=0,s=r.length;s>n;n++)i=r[n],o.push(i.style.width=""+t+"%");return o}},totaluploadprogress:c,sending:c,sendingmultiple:c,success:function(e){return e.previewElement?e.previewElement.classList.add("dz-success"):void 0},successmultiple:c,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:c,complete:function(e){return e._removeLink?e._removeLink.textContent=this.options.dictRemoveFile:void 0},completemultiple:c,maxfilesexceeded:c,maxfilesreached:c,previewTemplate:'<div class="dz-preview dz-file-preview">\n <div class="dz-details">\n <div class="dz-filename"><span data-dz-name></span></div>\n <div class="dz-size" data-dz-size></div>\n <img data-dz-thumbnail />\n </div>\n <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n <div class="dz-success-mark"><span>✔</span></div>\n <div class="dz-error-mark"><span>✘</span></div>\n <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},i=function(){var e,t,i,n,s,r,o;for(n=arguments[0],i=2<=arguments.length?h.call(arguments,1):[],r=0,o=i.length;o>r;r++){t=i[r];for(e in t)s=t[e],n[e]=s}return n},t.prototype.getAcceptedFiles=function(){var e,t,i,n,s;for(n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted&&s.push(e);return s},t.prototype.getRejectedFiles=function(){var e,t,i,n,s;for(n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted||s.push(e);return s},t.prototype.getFilesWithStatus=function(e){var t,i,n,s,r;for(s=this.files,r=[],i=0,n=s.length;n>i;i++)t=s[i],t.status===e&&r.push(t);return r},t.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(t.QUEUED)},t.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(t.UPLOADING)},t.prototype.getActiveFiles=function(){var e,i,n,s,r;for(s=this.files,r=[],i=0,n=s.length;n>i;i++)e=s[i],(e.status===t.UPLOADING||e.status===t.QUEUED)&&r.push(e);return r},t.prototype.init=function(){var e,i,n,s,r,o,a;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(t.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(n=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null==e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!=e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,i,s,r;if(i=e.hiddenFileInput.files,i.length)for(s=0,r=i.length;r>s;s++)t=i[s],e.addFile(t);return n()})}}(this))(),this.URL=null!=(o=window.URL)?o:window.webkitURL,a=this.events,s=0,r=a.length;r>s;s++)e=a[s],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),i=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(t){return i(t),e.emit("dragenter",t)
}}(this),dragover:function(e){return function(t){var n;try{n=t.dataTransfer.effectAllowed}catch(s){}return t.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",i(t),e.emit("dragover",t)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(t){return i(t),e.drop(t)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(i){return e.listeners.push({element:i,events:{click:function(n){return i!==e.element||n.target===e.element||t.elementInside(n.target,e.element.querySelector(".dz-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},t.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,t.instances.splice(t.instances.indexOf(this),1)},t.prototype.updateTotalUploadProgress=function(){var e,t,i,n,s,r,o,a;if(n=0,i=0,e=this.getActiveFiles(),e.length){for(a=this.getActiveFiles(),r=0,o=a.length;o>r;r++)t=a[r],n+=t.upload.bytesSent,i+=t.upload.total;s=100*n/i}else s=100;return this.emit("totaluploadprogress",s,i,n)},t.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},t.prototype.getFallbackForm=function(){var e,i,n,s;return(e=this.getExistingFallback())?e:(n='<div class="dz-fallback">',this.options.dictFallbackText&&(n+="<p>"+this.options.dictFallbackText+"</p>"),n+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',i=t.createElement(n),"FORM"!==this.element.tagName?(s=t.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),s.appendChild(i)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=s?s:i)},t.prototype.getExistingFallback=function(){var e,t,i,n,s,r;for(t=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)if(t=e[i],/(^| )fallback($| )/.test(t.className))return t},r=["div","form"],n=0,s=r.length;s>n;n++)if(i=r[n],e=t(this.element.getElementsByTagName(i)))return e},t.prototype.setupEventListeners=function(){var e,t,i,n,s,r,o;for(r=this.listeners,o=[],n=0,s=r.length;s>n;n++)e=r[n],o.push(function(){var n,s;n=e.events,s=[];for(t in n)i=n[t],s.push(e.element.addEventListener(t,i,!1));return s}());return o},t.prototype.removeEventListeners=function(){var e,t,i,n,s,r,o;for(r=this.listeners,o=[],n=0,s=r.length;s>n;n++)e=r[n],o.push(function(){var n,s;n=e.events,s=[];for(t in n)i=n[t],s.push(e.element.removeEventListener(t,i,!1));return s}());return o},t.prototype.disable=function(){var e,t,i,n,s;for(this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],s.push(this.cancelUpload(e));return s},t.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},t.prototype.filesize=function(e){var t;return e>=109951162777.6?(e/=109951162777.6,t="TiB"):e>=107374182.4?(e/=107374182.4,t="GiB"):e>=104857.6?(e/=104857.6,t="MiB"):e>=102.4?(e/=102.4,t="KiB"):(e=10*e,t="b"),"<strong>"+Math.round(e)/10+"</strong> "+t},t.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},t.prototype.drop=function(e){var t,i;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(i=e.dataTransfer.items,i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(t)))},t.prototype.paste=function(e){var t,i;return null!=(null!=e&&null!=(i=e.clipboardData)?i.items:void 0)?(this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0):void 0},t.prototype.handleFiles=function(e){var t,i,n,s;for(s=[],i=0,n=e.length;n>i;i++)t=e[i],s.push(this.addFile(t));return s},t.prototype._addFilesFromItems=function(e){var t,i,n,s,r;for(r=[],n=0,s=e.length;s>n;n++)i=e[n],r.push(null!=i.webkitGetAsEntry&&(t=i.webkitGetAsEntry())?t.isFile?this.addFile(i.getAsFile()):t.isDirectory?this._addFilesFromDirectory(t,t.name):void 0:null!=i.getAsFile&&(null==i.kind||"file"===i.kind)?this.addFile(i.getAsFile()):void 0);return r},t.prototype._addFilesFromDirectory=function(e,t){var i,n;return i=e.createReader(),n=function(e){return function(i){var n,s,r;for(s=0,r=i.length;r>s;s++)n=i[s],n.isFile?n.file(function(i){return e.options.ignoreHiddenFiles&&"."===i.name.substring(0,1)?void 0:(i.fullPath=""+t+"/"+i.name,e.addFile(i))}):n.isDirectory&&e._addFilesFromDirectory(n,""+t+"/"+n.name)}}(this),i.readEntries(n,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},t.prototype.accept=function(e,i){return e.size>1024*this.options.maxFilesize*1024?i(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):t.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(i(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,i):i(this.options.dictInvalidFileType)},t.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=t.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(i){return i?(e.accepted=!1,t._errorProcessing([e],i)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}}(this))},t.prototype.enqueueFiles=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)t=e[i],this.enqueueFile(t);return null},t.prototype.enqueueFile=function(e){if(e.status!==t.ADDED||e.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return e.status=t.QUEUED,this.options.autoProcessQueue?setTimeout(function(e){return function(){return e.processQueue()}}(this),0):void 0},t.prototype._thumbnailQueue=[],t.prototype._processingThumbnail=!1,t.prototype._enqueueThumbnail=function(e){return this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},t.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},t.prototype.removeFile=function(e){return e.status===t.UPLOADING&&this.cancelUpload(e),this.files=u(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},t.prototype.removeAllFiles=function(e){var i,n,s,r;for(null==e&&(e=!1),r=this.files.slice(),n=0,s=r.length;s>n;n++)i=r[n],(i.status!==t.UPLOADING||e)&&this.removeFile(i);return null},t.prototype.createThumbnail=function(e,t){var i;return i=new FileReader,i.onload=function(n){return function(){var s;return s=document.createElement("img"),s.onload=function(){var i,r,o,a,c,u,d,p;return e.width=s.width,e.height=s.height,o=n.options.resize.call(n,e),null==o.trgWidth&&(o.trgWidth=o.optWidth),null==o.trgHeight&&(o.trgHeight=o.optHeight),i=document.createElement("canvas"),r=i.getContext("2d"),i.width=o.trgWidth,i.height=o.trgHeight,l(r,s,null!=(c=o.srcX)?c:0,null!=(u=o.srcY)?u:0,o.srcWidth,o.srcHeight,null!=(d=o.trgX)?d:0,null!=(p=o.trgY)?p:0,o.trgWidth,o.trgHeight),a=i.toDataURL("image/png"),n.emit("thumbnail",e,a),null!=t?t():void 0},s.src=i.result}}(this),i.readAsDataURL(e)},t.prototype.processQueue=function(){var e,t,i,n;if(t=this.options.parallelUploads,i=this.getUploadingFiles().length,e=i,!(i>=t)&&(n=this.getQueuedFiles(),n.length>0)){if(this.options.uploadMultiple)return this.processFiles(n.slice(0,t-i));for(;t>e;){if(!n.length)return;this.processFile(n.shift()),e++}}},t.prototype.processFile=function(e){return this.processFiles([e])},t.prototype.processFiles=function(e){var i,n,s;for(n=0,s=e.length;s>n;n++)i=e[n],i.processing=!0,i.status=t.UPLOADING,this.emit("processing",i);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},t.prototype._getFilesWithXhr=function(e){var t,i;return i=function(){var i,n,s,r;for(s=this.files,r=[],i=0,n=s.length;n>i;i++)t=s[i],t.xhr===e&&r.push(t);return r}.call(this)},t.prototype.cancelUpload=function(e){var i,n,s,r,o,a,l;if(e.status===t.UPLOADING){for(n=this._getFilesWithXhr(e.xhr),s=0,o=n.length;o>s;s++)i=n[s],i.status=t.CANCELED;for(e.xhr.abort(),r=0,a=n.length;a>r;r++)i=n[r],this.emit("canceled",i);this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else((l=e.status)===t.ADDED||l===t.QUEUED)&&(e.status=t.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));return this.options.autoProcessQueue?this.processQueue():void 0},t.prototype.uploadFile=function(e){return this.uploadFiles([e])},t.prototype.uploadFiles=function(e){var n,s,r,o,a,l,c,u,d,p,h,f,m,g,v,y,b,w,C,E,_,k,F,x,T,D,j,P,S,A,z,I;for(b=new XMLHttpRequest,w=0,k=e.length;k>w;w++)n=e[w],n.xhr=b;b.open(this.options.method,this.options.url,!0),b.withCredentials=!!this.options.withCredentials,g=null,r=function(t){return function(){var i,s,r;for(r=[],i=0,s=e.length;s>i;i++)n=e[i],r.push(t._errorProcessing(e,g||t.options.dictResponseError.replace("{{statusCode}}",b.status),b));return r}}(this),v=function(t){return function(i){var s,r,o,a,l,c,u,d,p;if(null!=i)for(r=100*i.loaded/i.total,o=0,c=e.length;c>o;o++)n=e[o],n.upload={progress:r,total:i.total,bytesSent:i.loaded};else{for(s=!0,r=100,a=0,u=e.length;u>a;a++)n=e[a],(100!==n.upload.progress||n.upload.bytesSent!==n.upload.total)&&(s=!1),n.upload.progress=r,n.upload.bytesSent=n.upload.total;if(s)return}for(p=[],l=0,d=e.length;d>l;l++)n=e[l],p.push(t.emit("uploadprogress",n,r,n.upload.bytesSent));return p}}(this),b.onload=function(i){return function(n){var s;if(e[0].status!==t.CANCELED&&4===b.readyState){if(g=b.responseText,b.getResponseHeader("content-type")&&~b.getResponseHeader("content-type").indexOf("application/json"))try{g=JSON.parse(g)}catch(o){n=o,g="Invalid JSON response from server."}return v(),200<=(s=b.status)&&300>s?i._finished(e,g,n):r()}}}(this),b.onerror=function(){return function(){return e[0].status!==t.CANCELED?r():void 0}}(this),m=null!=(j=b.upload)?j:b,m.onprogress=v,l={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&i(l,this.options.headers);for(o in l)a=l[o],b.setRequestHeader(o,a);if(s=new FormData,this.options.params){P=this.options.params;for(h in P)y=P[h],s.append(h,y)}for(C=0,F=e.length;F>C;C++)n=e[C],this.emit("sending",n,b,s);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,b,s),"FORM"===this.element.tagName)for(S=this.element.querySelectorAll("input, textarea, select, button"),E=0,x=S.length;x>E;E++)if(u=S[E],d=u.getAttribute("name"),p=u.getAttribute("type"),"SELECT"===u.tagName&&u.hasAttribute("multiple"))for(A=u.options,_=0,T=A.length;T>_;_++)f=A[_],f.selected&&s.append(d,f.value);else(!p||"checkbox"!==(z=p.toLowerCase())&&"radio"!==z||u.checked)&&s.append(d,u.value);for(c=D=0,I=e.length-1;I>=0?I>=D:D>=I;c=I>=0?++D:--D)s.append(this._getParamName(c),e[c],e[c].name);return b.send(s)},t.prototype._finished=function(e,i,n){var s,r,o;for(r=0,o=e.length;o>r;r++)s=e[r],s.status=t.SUCCESS,this.emit("success",s,i,n),this.emit("complete",s);return this.options.uploadMultiple&&(this.emit("successmultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t.prototype._errorProcessing=function(e,i,n){var s,r,o;for(r=0,o=e.length;o>r;r++)s=e[r],s.status=t.ERROR,this.emit("error",s,i,n),this.emit("complete",s);return this.options.uploadMultiple&&(this.emit("errormultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t}(s),i.version="3.10.2",i.options={},i.optionsForElement=function(e){return e.getAttribute("id")?i.options[r(e.getAttribute("id"))]:void 0},i.instances=[],i.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},i.autoDiscover=!0,i.discover=function(){var e,t,n,s,r,o;for(document.querySelectorAll?n=document.querySelectorAll(".dropzone"):(n=[],e=function(e){var t,i,s,r;for(r=[],i=0,s=e.length;s>i;i++)t=e[i],r.push(/(^| )dropzone($| )/.test(t.className)?n.push(t):void 0);return r},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),o=[],s=0,r=n.length;r>s;s++)t=n[s],o.push(i.optionsForElement(t)!==!1?new i(t):void 0);return o},i.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],i.isBrowserSupported=function(){var e,t,n,s,r;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(r=i.blacklistedBrowsers,n=0,s=r.length;s>n;n++)t=r[n],t.test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},u=function(e,t){var i,n,s,r;for(r=[],n=0,s=e.length;s>n;n++)i=e[n],i!==t&&r.push(i);return r},r=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},i.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},i.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},i.getElement=function(e,t){var i;if("string"==typeof e?i=document.querySelector(e):null!=e.nodeType&&(i=e),null==i)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return i},i.getElements=function(e,t){var i,n,s,r,o,a,l,c;if(e instanceof Array){s=[];try{for(r=0,a=e.length;a>r;r++)n=e[r],s.push(this.getElement(n,t))}catch(u){i=u,s=null}}else if("string"==typeof e)for(s=[],c=document.querySelectorAll(e),o=0,l=c.length;l>o;o++)n=c[o],s.push(n);else null!=e.nodeType&&(s=[e]);if(null==s||!s.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return s},i.confirm=function(e,t,i){return window.confirm(e)?t():null!=i?i():void 0},i.isValidFile=function(e,t){var i,n,s,r,o;if(!t)return!0;for(t=t.split(","),n=e.type,i=n.replace(/\/.*$/,""),r=0,o=t.length;o>r;r++)if(s=t[r],s=s.trim(),"."===s.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(s.toLowerCase(),e.name.length-s.length))return!0}else if(/\/\*$/.test(s)){if(i===s.replace(/\/.*$/,""))return!0}else if(n===s)return!0;return!1},"undefined"!=typeof e&&null!==e&&(e.fn.dropzone=function(e){return this.each(function(){return new i(this,e)})}),"undefined"!=typeof n&&null!==n?n.exports=i:window.Dropzone=i,i.ADDED="added",i.QUEUED="queued",i.ACCEPTED=i.QUEUED,i.UPLOADING="uploading",i.PROCESSING=i.UPLOADING,i.CANCELED="canceled",i.ERROR="error",i.SUCCESS="success",a=function(e){var t,i,n,s,r,o,a,l,c,u;for(a=e.naturalWidth,o=e.naturalHeight,i=document.createElement("canvas"),i.width=1,i.height=o,n=i.getContext("2d"),n.drawImage(e,0,0),s=n.getImageData(0,0,1,o).data,u=0,r=o,l=o;l>u;)t=s[4*(l-1)+3],0===t?r=l:u=l,l=r+u>>1;return c=l/o,0===c?1:c},l=function(e,t,i,n,s,r,o,l,c,u){var d;return d=a(t),e.drawImage(t,i,n,s,r,o,l,c,u/d)},o=function(e,t){var i,n,s,r,o,a,l,c,u;if(s=!1,u=!0,n=e.document,c=n.documentElement,i=n.addEventListener?"addEventListener":"attachEvent",l=n.addEventListener?"removeEventListener":"detachEvent",a=n.addEventListener?"":"on",r=function(i){return"readystatechange"!==i.type||"complete"===n.readyState?(("load"===i.type?e:n)[l](a+i.type,r,!1),!s&&(s=!0)?t.call(e,i.type||i):void 0):void 0},o=function(){var e;try{c.doScroll("left")}catch(t){return e=t,void setTimeout(o,50)}return r("poll")},"complete"!==n.readyState){if(n.createEventObject&&c.doScroll){try{u=!e.frameElement}catch(d){}u&&o()}return n[i](a+"DOMContentLoaded",r,!1),n[i](a+"readystatechange",r,!1),e[i](a+"load",r,!1)}},i._autoDiscoverFunction=function(){return i.autoDiscover?i.discover():void 0},o(window,i._autoDiscoverFunction)}.call(this),n.exports}),define("groups",["jquery","underscore","backbone","core","dropzone"],function(e,t,i,n){function s(i){var s=e(i).attr("name"),o=e(i).attr("value"),a=e(i).attr("type");"undefined"!=typeof a&&"checkbox"===e(i).attr("type")&&(i.checked?r[s].splice(t.indexOf(r[s],o),1):r[s].push(o));var l=new n.PostSet(n.groups.postSet.reject(function(e){return t.some(r,function(i,n){return-1!==t.indexOf(i,e.get(n).toLowerCase())})}));n.groups.postCollectionView.render(l)}n.Post=i.Model.extend({id:"",user:"",userThumbnail:"",userURL:"",category:"",body:"",comments:"",hasAttachment:"",attachmentHost:"",attachmentTitle:"",attachmentThumbnail:"",attachmentURL:"",upvotes:"",userInUpvotes:"",downvotes:"",userInDownvotes:"",created_raw:"",created:""}),n.PostSet=i.Collection.extend({model:n.Post,sortByPopularity:function(){this.comparator=this.popularityComparator,this.sort()},sortByNewest:function(){this.comparator=this.newestComparator,this.sort()},newestComparator:function(e){return-e.get("created_raw")},popularityComparator:function(e){return-e.get("upvotes")}}),n.groups.postSet=new n.PostSet,t.each(n.groups.rawPosts,function(e){n.groups.postSet.add(new n.Post(e))}),t.extend(n.groups,{postCollectionView:null,bindPostDeleteButtons:function(t){var i=n.projects.getDiscussionID(t.target);e.get("/interactions/comment/"+i+"/delete/",function(e){"true"==e.status?n.projects.postDeleteHandler(t.target):n.popup("Sorry, your comment could not be deleted.Please try again later.")},"json")},init_mvc:function(){var i=e(".discussion-board-filters input:checkbox");t.each(i,function(t){e(t).change(function(){s(this,n.groups.postCollectionView)})}),e(".filter-sort-option").click(function(t){e(t.target).hasClass("filter-sort-option-newest")?(n.groups.postSet.sortByNewest(),n.groups.postCollectionView.render()):(n.groups.postSet.sortByPopularity(),n.groups.postCollectionView.render())}),e(".discussion-board-filters-search input").keyup(function(){var t=e(this).val(),i=new n.PostSet(n.groups.postSet.filter(function(e){return-1!==e.get("body").toLowerCase().indexOf(t.toLowerCase())}));n.groups.postCollectionView.render(i)})}}),n.PostView=i.View.extend({tagName:"div",className:"discussion-item-wrapper",template:t.template('<div class="discussion-item" id="discussion-<%= id %>"><div style="background-image: url(\'<%= userThumbnail %>\')"class="discussion-user-thumbnail"></div><div class="discussion-item-post"><div class="post-body-wrapper"><div class="delete-button" title="Delete post"></div><div class="post-body"><a href="<%= userURL %>" class="bold user-post-info-name"><%= user %></a> posted in <span class="label coming-soon-label"><%= category %></span><span class="post-datetime"> on <%= created %></span><%= body %><% if (hasAttachment){ %><div class="user-post-attachment"><div class="user-post-attachment-photo" style="background-image: url(\'<%= attachmentThumbnail %>\');"></div><div class="user-post-attachment-description"><a href="<%= attachmentURL %>"><%= attachmentTitle %></a></div></div><% } %><div class="post-actions"><div class="upvote-post <% if (userInUpvotes){ %>user-upvoted<% } %>"><%= upvotes %></div><div class="downvote-post <% if (userInDownvotes){ %>user-upvoted<% } %>"><%= downvotes %></div></div></div></div><div class="post-comments comment-thread"><%= comments %><div class="post-new-comment"><div class="post-comment-user-thumbnail"><div style="background-image: url(\'<%= loggedInUserThumbnail %>\')" class="discussion-response-thumbnail"></div></div><div class="post-comment-body"><form><input type="hidden" name="user" value="<%= loggedInUserID %>" /><input type="hidden" name="parent_type" value="<%= commentsContentType %>" /><input type="hidden" name="parent_id" value="<%= id %>" /><textarea name="body_markdown" placeholder="Say something..."></textarea><div class="post-comment-button-wrapper"><div class="action-button post-comment-button">Post comment</div></div></form></div></div></div></div></div>'),events:{"click .upvote-post":n.comments.upvotePostClickHandler,"click .downvote-post":n.comments.downvotePostClickHandler,"click .post-body-wrapper > .delete-button":n.groups.bindPostDeleteButtons,"focus textarea":n.comments.focusCommentInput,"blur textarea":n.comments.blurCommentInput,"click .post-comment-button":n.comments.postCommentClickHandler,"click .upvote-comment":n.comments.upvoteCommentClickHandler,"click .downvote-comment":n.comments.downvoteCommentClickHandler,"click .reply-to-comment":n.comments.commentReplyButtonClickHandler},initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){this.$el.html(this.template(t.extend(this.model.toJSON(),{loggedInUserID:n.config.user.id,loggedInUserThumbnail:n.config.user.thumbnail,commentsContentType:n.config.contentTypes.comment}))),e(".discussion-board").append(this.$el),pattern=/(?:(?:https?|ftp):\/\/)?(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?/g;var i,s,r,o,a=e(".post-comment-body p",this.$el);for(i=0;i<a.length;i++)if(r=e(a[i]).text(),o=r.match(pattern)){for(s=0;s<o.length;s++)r=r.replace(o[s],'<a href="'+o[s]+'" target="_blank">'+o[s]+"</a>");e(a[i]).html(r)}return this}}),n.PostCollectionView=i.View.extend({render:function(e){this.clearView(),this.prepareView();var i=e||this.collection;this.collection=i,0===i.length?this.showNullView():t.each(i.models,function(e){new n.PostView({model:e}).render()}),this.revealView()},clearView:function(){e(".discussion-board").html("")},prepareView:function(){e(".discussion-board").addClass("spinner-background")},revealView:function(){e(".discussion-board").removeClass("spinner-background"),e(".discussion-board").css("display","none"),e(".discussion-board").fadeIn("fast")},showNullView:function(){e(".discussion-board").html("<p>No post matching your criteria found. Sorry!</p>")}}),n.projects={attachPopup:"",postRedirectTo:"",addMemberHandler:function(i){if("true"===i.status){var s=t.template('<div class="member user"><div class="member-info user-info"><div class="member-photo user-photo" style="background-image:url(\'<%= profile_pic %>\')"></div><div class="member-description user-description"><a href="/user/<%= username %>"><%= name %></a></div></div><div class="member-actions user-actions"><form><input type="hidden" name="user_id" value="<%= id %>" /><input type="hidden" name="project_id" value="'+n.projects.getProjectID()+'" /><button class="btn dull-button admin-toggle make-admin">Make admin</button></form><span class="delete-member delete-button" id="project-<%= project_id %>-user-<%= id %>"></span></div></div>'),r=s(i.user);e("#member-list").prepend(r);var o=e("#member-list .member:first");e("button.admin-toggle",o).click(function(e){n.projects.adminToggleHandler(e)}),e("span.delete-member",o).click(function(e){n.projects.deleteMemberHandler(e)})}else n.popup(i.message,i.title)},addAdminHandler:function(e,t){"true"===e.status?(t.html("Remove admin"),t.removeClass("make-admin"),t.addClass("remove-admin"),t.parents(".member").find(".member-description").append('<span class="admin-label label">ADMINISTRATOR</span>')):n.popup(e.message,e.title)},removeAdminHandler:function(e,t){"true"===e.status?(t.html("Make admin"),t.removeClass("remove-admin"),t.addClass("make-admin"),t.parents(".member").find(".member-description .admin-label").remove()):n.popup(e.message,e.title)},getProjectID:function(){return e("#project-add-member input[name=project_id]").val()},bindAdminClick:function(){e("button.admin-toggle").click(function(e){n.projects.adminToggleHandler(e)})},adminToggleHandler:function(t){var i=e("#revision-comment .form-spinner");i.show();var s=e(t.target),r=s.parent().children("input[name=user_id]").val(),o=s.parent().children("input[name=project_id]").val();return s.hasClass("make-admin")?e.get("/group/"+o+"/add-admin/"+r+"/",function(e){n.projects.addAdminHandler(e,s),i.hide()},"json"):e.get("/group/"+o+"/remove-admin/"+r+"/",function(e){n.projects.removeAdminHandler(e,s),i.hide()},"json"),t.stopPropagation(),t.preventDefault(),!1},bindDeleteButton:function(){e("span.delete-member").click(function(e){n.projects.deleteMemberHandler(e)})},deleteMemberHandler:function(t){target=e(t.target),targetID=target.attr("id");var i=targetID.lastIndexOf("-"),s=targetID.substring(8,i-5),r=targetID.substring(i+1);e.get("/group/"+s+"/remove/"+r+"/",function(e){n.projects.removeMemberHandler(e,target)},"json")},removeMemberHandler:function(t,i){if("true"===t.status){var s=e(i).parents(".member");e(i).tipsy("hide"),s.remove()}else n.popup(t.message,t.title)},initAddMemberAutocomplete:function(){var t="#project-add-member input[name=add-member]";e(t).autocomplete({source:function(t,i){e.get("/user/api/list/"+t.term,function(t){i(e.map(t,function(e){return{label:e.name,value:e.username,id:e.id}}))},"json")},minLength:2,select:function(i,s){var r=e("#revision-comment .form-spinner");r.show();var o=n.projects.getProjectID();e.get("/group/"+o+"/add/"+s.item.id+"/",function(i){n.projects.addMemberHandler(i),e(t).val(""),r.hide()},"json")}})},initDiscussionBoard:function(){n.projects.bindNewPostButton(),n.comments.bindVotingButtons(".discussion-item"),e(".project-info-settings").tipsy({gravity:"s"});var i=""===window.location.search?[]:window.location.search.substring(1).split("&");if(i){var s=t.find(i,function(e){return-1!==e.indexOf("post=")}),r=t.find(i,function(e){return-1!==e.indexOf("category=")}),o=t.find(i,function(e){return-1!==e.indexOf("redirect_to=")});if(s){var a=s.substring(s.indexOf("post=")+5);if("new"===a){if(n.projects.postRedirectTo=o.substring(o.indexOf("redirect_to=")+12),r){var l=r.substring(r.indexOf("category=")+9),c=l.charAt(0).toUpperCase()+l.slice(1),u=e('.new-discussion-post-dialog select[name="category"] option:contains("'+c+'")');u.attr("selected","true")}n.projects.newPostButtonClickHandler(),e(".new-discussion-post-submit").click(n.projects.newPostSubmitButtonClickHandler)}}}},bindNewPostButton:function(){e(".new-discussion-post-button").click(n.projects.newPostButtonClickHandler),e(".new-discussion-post-submit").click(n.projects.newPostSubmitButtonClickHandler)},newPostButtonClickHandler:function(){n.customPopup(".new-discussion-post-dialog");e(".new-discussion-post-body").focus(),n.config.user.id?e("a.new-discussion-post-attach").click(function(t){attachPopup=n.customPopup(".new-discussion-post-attach-dialog"),n.projects.attachPopup=attachPopup;var i=e(".new-discussion-post-attach-resource-project-browser");n.tabs(".new-discussion-post-attach-resource-browser");var s=e('.new-discussion-post-attach-resource-tabs li a[href=".my-files"]');return s.hasClickEventListener()||s.click(function(t){return e.get("/resources/tree/all/user/",function(e){"true"==e.status?(n.renderBrowser(e.tree,i),i.removeClass("loading-browser")):n.popup(e.message,e.title)},"json"),t.stopPropagation(),t.preventDefault(),!1}),e(".new-discussion-post-attach-submit").click(function(t){var s,r=e(".new-discussion-post-attach-dialog .new-discussion-post-attach-resource-tabs li a.selected");if(".my-files"===r.attr("href")&&(selectedResourceCollection=i.find(".selected-destination-collection, .selected-destination-resource"),selectedResourceCollection.length>0&&(s=e(selectedResourceCollection[0]))),s){var o=s.attr("id"),a=-1!=o.indexOf("resource"),l=o.substring(a?9:11);n.projects.insertAttachment(l,s.text(),a)}return t.stopPropagation(),t.preventDefault(),!1}),t.stopPropagation(),t.preventDefault(),!1}):(e(".new-discussion-post-prompt-user-thumbnail").addClass("hide"),e(".new-discussion-post-prompt-suggest-post-as").text("Post"),e(".new-discussion-post-attach").addClass("hide"))},insertAttachment:function(t,i,s){attachWrapper=e(".new-discussion-post-dialog .new-discussion-post-attach-wrapper");var r=e("<span/>",{text:i,"class":"new-discussion-post-attachment"}),o=e("form#new-discussion-post-form");e("input[name=attachment_id]",o).val(t),e("input[name=is_resource]",o).val(s),attachWrapper.html(r),n.projects.attachPopup.close()},newPostSubmitButtonClickHandler:function(t){if(""!==e(".new-discussion-post-body").val()){var i=e("form#new-discussion-post-form");if(n.config.user.id)i.submit();else{var s="To complete this post, please login or create a free account (takes 30 seconds!). Don't worry, we'll keep your posting safe";n.launchSignupDialog(s,function(){if(n.projects.postRedirectTo){var t=e("<input/>",{type:"hidden",name:"redirect_to",value:n.projects.postRedirectTo});i.prepend(t)}i.submit()})}}else e(".new-discussion-post-body").addClass("form-input-error");return t.stopPropagation(),t.preventDefault(),!1},getDiscussionID:function(t){return e(t).closest(".discussion-item").attr("id").substring(11)},postDeleteHandler:function(t){e(t).closest(".discussion-item-wrapper").remove()},bindInviteRequestButton:function(){function t(){var t=e("#project-invite-form button.request-button");t.addClass("loading");var i=e("#project-invite-form input[name=project_id]").val();e.get("/group/"+i+"/request-invite/",function(e){t.removeClass("loading"),"true"==e.status?t.hasClass("join-button")?(t.fadeOut(),window.location.reload()):n.projects.inviteRequestSuccessHandler(t):n.popup(e.message,e.title)},"json")}e(".disabled-action-button").click(function(e){return e.stopPropagation(),e.preventDefault(),!1}),e("#project-info .request-button:not(.disabled-action-button)").click(function(e){if(n.config.user.id)t();else{var i="To become a member, please login or create a free account (takes 30 seconds!).";n.launchSignupDialog(i,t)}return e.stopPropagation(),e.preventDefault(),!1})},inviteRequestSuccessHandler:function(e){e.text("Request sent"),e.disabled=!0,e.addClass("disabled-action-button"),e.unbind(),e.click(function(e){return e.stopPropagation(),e.preventDefault(),!1})},bindInviteAcceptButton:function(){e(".requestor-actions .accept-member").click(function(t){return request_id=e(t.target).parents("form").find("input[name=request_id]").val(),e.get("/group/request/"+request_id+"/accept/",function(e){"true"==e.status?n.projects.inviteAcceptSuccessHandler(t.target):n.popup(e.message,e.title)},"json"),t.stopPropagation(),t.preventDefault(),!1})},inviteAcceptSuccessHandler:function(t){var i=e(t).closest(".requestor"),n=e("<span/>",{"class":"accepted-label label",text:"ACCEPTED"});i.find(".requestor-actions").html(n),i.addClass("user-success")},bindInviteDeclineButton:function(){e(".requestor-actions .decline-member").click(function(t){return request_id=e(t.target).parents("form").find("input[name=request_id]").val(),e.get("/group/request/"+request_id+"/decline/",function(e){"true"==e.status?n.projects.inviteDeclineSuccessHandler(t.target):n.popup(e.message,e.title)
},"json"),t.stopPropagation(),t.preventDefault(),!1})},inviteDeclineSuccessHandler:function(t){var i=e(t).closest(".requestor"),n=e("<span/>",{"class":"declined-label label",text:"DECLINED"});i.find(".requestor-actions").html(n),i.addClass("user-failure")},bindProjectDeleteButton:function(){e(".delete-project-button").click(function(e){return projectDeletePopup=n.customPopup(".confirm-project-delete-dialog"),e.stopPropagation(),e.preventDefault(),!1})},bindNewCategoryButton:function(){e(".add-group-category-button").click(function(t){var i='<li><input type="text" name="new" value="" /><span class="delete-button category-delete-button" title="Delete category"></span></li>';return e(".category-listing").append(i),e(".category-listing li:last .category-delete-button").tipsy({gravity:"s"}),e(".category-listing li:last .category-delete-button").click(n.projects.categoryDeleteButtonClickHandler),e('.category-listing li:last input[type="text"]').focus(),t.stopPropagation(),t.preventDefault(),!1})},bindCategoryDeleteButton:function(){e(".category-listing li .category-delete-button").tipsy({gravity:"s"}),e(".category-listing li .category-delete-button").click(n.projects.categoryDeleteButtonClickHandler)},categoryDeleteButtonClickHandler:function(){categoryDeletePopup=n.customPopup(".confirm-category-delete-dialog");var t=e(this),i=t.parents("li");e(".confirm-category-delete-submit-button",categoryDeletePopup.dialog).click(function(s){categoryDeletePopup.close();var r=e(t.siblings('input[type="text"]')[0]),o=e("form.categories-form input[name=project_id]").val();if("new"!==r.attr("name")){var a=r.attr("name");e.get("/group/"+o+"/category/"+a+"/delete/",function(e){"true"==e.status?(t.tipsy("hide"),i.remove(),n.setMessageBoxMessage("Deleted the category successfully."),n.showMessageBox()):n.popup(e.message,e.title)},"json")}else t.tipsy("hide"),i.remove();return s.stopPropagation(),s.preventDefault(),!1})},launch:{init:function(){this.bindClickScrolls(),this.renderHeaderAnimation(),this.renderPlayProjectCreate(),this.setupProjectsSignupForm(),e(".anchor-image").tipsy({gravity:"n"})},bindClickScrolls:function(){n.scrollBind("#projects-signup-anchor","#projects-footer"),n.scrollBind("#anchor-upload","#create-share"),n.scrollBind("#anchor-organize","#organize-content"),n.scrollBind("#anchor-search","#discover-content"),n.scrollBind("#anchor-social","#social-content")},renderHeaderAnimation:function(){e("#chief-panel-container.projects-launch").addClass("play"),e("#chief-panel-container #project-computer").addClass("play"),e("#chief-panel-container #project-mobile").addClass("play"),e("#chief-panel-container #project-tablet").addClass("play")},renderPlayProjectCreate:function(){function t(){e("#create-steps-panel #upload-create").animate({opacity:1},1e3,function(){e("#create-steps-panel .hidden-arrow:eq(0)").animate({opacity:1},1e3,function(){e("#create-steps-panel #rename-create").animate({opacity:1},1e3,function(){e("#create-steps-panel .hidden-arrow:eq(1)").animate({opacity:1},1e3,function(){e("#create-steps-panel #share-create").animate({opacity:1},1e3,function(){e("#create-steps-panel > div").delay(2e3).animate({opacity:0})})})})})})}setInterval(function(){t()},8e3),t()},setupProjectsSignupForm:function(){if(!Modernizr.input.placeholder){(function(){e("form#projects-signup input, form#projects-signup textarea").val(""),e("form#projects-signup input, form#projects-signup textarea").keyup(function(){""===e(this).val()?e(this).prev("label").removeClass("typing"):e(this).prev("label").addClass("typing")}),e("form#projects-signup input, form#projects-signup textarea").focus(function(){e(this).prev("label").addClass("empty")}),e("form#projects-signup input, form#projects-signup textarea").blur(function(){e(this).prev("label").removeClass("empty")})})()}}}};var r={category:[]}}),define("group",["jquery","groups","dropzone"],function(e,t,i){e(document).ready(function(e){function t(e,t,i){i.append("user",OC.config.user.id)}OC.projects.launch.init(),OC.projects.bindAdminClick(),OC.projects.bindDeleteButton(),e(".delete-button").tipsy(),e(".project-admin-thumbnail").tipsy({gravity:"s"}),OC.comments.addDeleteButtonTooltip(".discussion-item"),OC.projects.bindInviteRequestButton(),OC.projects.initAddMemberAutocomplete(),OC.projects.initDiscussionBoard(),OC.projects.bindInviteAcceptButton(),OC.projects.bindInviteDeclineButton(),OC.projects.bindProjectDeleteButton(),OC.projects.bindNewCategoryButton(),OC.projects.bindCategoryDeleteButton(),e(".new-discussion-post-attach-dialog .upload-drag-drop").dropzone({url:"/api/file-upload/",createImageThumbnails:!1,maxFilesize:5}),i.forElement(".new-discussion-post-attach-dialog .upload-drag-drop").on("sending",t),i.forElement(".new-discussion-post-attach-dialog .upload-drag-drop").on("sending",OC.attachCSRFToken),i.forElement(".new-discussion-post-attach-dialog .upload-drag-drop").on("success",function(t,i){if("false"!==i.status){e(".dz-filename span",t.previewElement).attr("contenteditable",!0);var n,s,r=e(this.element).children().last(),o=e("<div/>",{"class":"attach-insert-button"}),a=e("<button/>",{text:"Attach","class":"btn dull-button"}),l=JSON.parse(i);for(n in l){s=l[n];break}a.click(function(){OC.projects.insertAttachment(s.id,s.title,!0)}),o.append(a),r.append(o)}else OC.popup("The upload process failed due to some errors. Contact us if the problem persists. Error description below:"+i.error,"Upload image failed")}),e(".discussion-board").length>0&&(OC.groups.postCollectionView=new OC.PostCollectionView({collection:OC.groups.postSet}),OC.groups.postCollectionView.render(),OC.groups.init_mvc())})});