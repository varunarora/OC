//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

// tipsy, facebook style tooltips for jquery
// version 1.0.0a
// (c) 2008-2010 jason frame [jason@onehackoranother.com]
// released under the MIT license

/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */

/*!
 * jQuery UI Widget @VERSION
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */

/*!
 * jQuery UI Position @VERSION
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */

/*!
 * jQuery UI Menu @VERSION
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/menu/
 */

/*!
 * jQuery UI Autocomplete @VERSION
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/autocomplete/
 */

/**
     * fastLiveFilter jQuery plugin 1.0.3
     * 
     * Copyright (c) 2011, Anthony Bush
     * License: <http://www.opensource.org/licenses/bsd-license.php>
     * Project Website: http://anthonybush.com/projects/jquery_fast_live_filter/
     **/

// Get resource licenses if unknown.

(function(){var e=this,t=e._,i={},n=Array.prototype,o=Object.prototype,s=Function.prototype,r=n.push,a=n.slice,l=n.concat,u=o.toString,c=o.hasOwnProperty,d=n.forEach,p=n.map,f=n.reduce,m=n.reduceRight,h=n.filter,g=n.every,v=n.some,b=n.indexOf,C=n.lastIndexOf,y=Array.isArray,w=Object.keys,O=s.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.6.0";var _=k.each=k.forEach=function(e,t,n){if(null==e)return e;if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var o=0,s=e.length;s>o;o++)if(t.call(n,e[o],o,e)===i)return}else for(var r=k.keys(e),o=0,s=r.length;s>o;o++)if(t.call(n,e[r[o]],r[o],e)===i)return;return e};k.map=k.collect=function(e,t,i){var n=[];return null==e?n:p&&e.map===p?e.map(t,i):(_(e,function(e,o,s){n.push(t.call(i,e,o,s))}),n)};var x="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,i,n){var o=arguments.length>2;if(null==e&&(e=[]),f&&e.reduce===f)return n&&(t=k.bind(t,n)),o?e.reduce(t,i):e.reduce(t);if(_(e,function(e,s,r){o?i=t.call(n,i,e,s,r):(i=e,o=!0)}),!o)throw new TypeError(x);return i},k.reduceRight=k.foldr=function(e,t,i,n){var o=arguments.length>2;if(null==e&&(e=[]),m&&e.reduceRight===m)return n&&(t=k.bind(t,n)),o?e.reduceRight(t,i):e.reduceRight(t);var s=e.length;if(s!==+s){var r=k.keys(e);s=r.length}if(_(e,function(a,l,u){l=r?r[--s]:--s,o?i=t.call(n,i,e[l],l,u):(i=e[l],o=!0)}),!o)throw new TypeError(x);return i},k.find=k.detect=function(e,t,i){var n;return T(e,function(e,o,s){return t.call(i,e,o,s)?(n=e,!0):void 0}),n},k.filter=k.select=function(e,t,i){var n=[];return null==e?n:h&&e.filter===h?e.filter(t,i):(_(e,function(e,o,s){t.call(i,e,o,s)&&n.push(e)}),n)},k.reject=function(e,t,i){return k.filter(e,function(e,n,o){return!t.call(i,e,n,o)},i)},k.every=k.all=function(e,t,n){t||(t=k.identity);var o=!0;return null==e?o:g&&e.every===g?e.every(t,n):(_(e,function(e,s,r){return(o=o&&t.call(n,e,s,r))?void 0:i}),!!o)};var T=k.some=k.any=function(e,t,n){t||(t=k.identity);var o=!1;return null==e?o:v&&e.some===v?e.some(t,n):(_(e,function(e,s,r){return o||(o=t.call(n,e,s,r))?i:void 0}),!!o)};k.contains=k.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):T(e,function(e){return e===t})},k.invoke=function(e,t){var i=a.call(arguments,2),n=k.isFunction(t);return k.map(e,function(e){return(n?t:e[t]).apply(e,i)})},k.pluck=function(e,t){return k.map(e,k.property(t))},k.where=function(e,t){return k.filter(e,k.matches(t))},k.findWhere=function(e,t){return k.find(e,k.matches(t))},k.max=function(e,t,i){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var n=-1/0,o=-1/0;return _(e,function(e,s,r){var a=t?t.call(i,e,s,r):e;a>o&&(n=e,o=a)}),n},k.min=function(e,t,i){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var n=1/0,o=1/0;return _(e,function(e,s,r){var a=t?t.call(i,e,s,r):e;o>a&&(n=e,o=a)}),n},k.shuffle=function(e){var t,i=0,n=[];return _(e,function(e){t=k.random(i++),n[i-1]=n[t],n[t]=e}),n},k.sample=function(e,t,i){return null==t||i?(e.length!==+e.length&&(e=k.values(e)),e[k.random(e.length-1)]):k.shuffle(e).slice(0,Math.max(0,t))};var E=function(e){return null==e?k.identity:k.isFunction(e)?e:k.property(e)};k.sortBy=function(e,t,i){return t=E(t),k.pluck(k.map(e,function(e,n,o){return{value:e,index:n,criteria:t.call(i,e,n,o)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var P=function(e){return function(t,i,n){var o={};return i=E(i),_(t,function(s,r){var a=i.call(n,s,r,t);e(o,a,s)}),o}};k.groupBy=P(function(e,t,i){k.has(e,t)?e[t].push(i):e[t]=[i]}),k.indexBy=P(function(e,t,i){e[t]=i}),k.countBy=P(function(e,t){k.has(e,t)?e[t]++:e[t]=1}),k.sortedIndex=function(e,t,i,n){i=E(i);for(var o=i.call(n,t),s=0,r=e.length;r>s;){var a=s+r>>>1;i.call(n,e[a])<o?s=a+1:r=a}return s},k.toArray=function(e){return e?k.isArray(e)?a.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:0>t?[]:a.call(e,0,t)},k.initial=function(e,t,i){return a.call(e,0,e.length-(null==t||i?1:t))},k.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,i){return a.call(e,null==t||i?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var F=function(e,t,i){return t&&k.every(e,k.isArray)?l.apply(i,e):(_(e,function(e){k.isArray(e)||k.isArguments(e)?t?r.apply(i,e):F(e,t,i):i.push(e)}),i)};k.flatten=function(e,t){return F(e,t,[])},k.without=function(e){return k.difference(e,a.call(arguments,1))},k.partition=function(e,t){var i=[],n=[];return _(e,function(e){(t(e)?i:n).push(e)}),[i,n]},k.uniq=k.unique=function(e,t,i,n){k.isFunction(t)&&(n=i,i=t,t=!1);var o=i?k.map(e,i,n):e,s=[],r=[];return _(o,function(i,n){(t?n&&r[r.length-1]===i:k.contains(r,i))||(r.push(i),s.push(e[n]))}),s},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(e){var t=a.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.contains(t,e)})})},k.difference=function(e){var t=l.apply(n,a.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=k.max(k.pluck(arguments,"length").concat(0)),t=new Array(e),i=0;e>i;i++)t[i]=k.pluck(arguments,""+i);return t},k.object=function(e,t){if(null==e)return{};for(var i={},n=0,o=e.length;o>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},k.indexOf=function(e,t,i){if(null==e)return-1;var n=0,o=e.length;if(i){if("number"!=typeof i)return n=k.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,o+i):i}if(b&&e.indexOf===b)return e.indexOf(t,i);for(;o>n;n++)if(e[n]===t)return n;return-1},k.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(C&&e.lastIndexOf===C)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var o=n?i:e.length;o--;)if(e[o]===t)return o;return-1},k.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),o=0,s=new Array(n);n>o;)s[o++]=e,e+=i;return s};var D=function(){};k.bind=function(e,t){var i,n;if(O&&e.bind===O)return O.apply(e,a.call(arguments,1));if(!k.isFunction(e))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(a.call(arguments)));D.prototype=e.prototype;var o=new D;D.prototype=null;var s=e.apply(o,i.concat(a.call(arguments)));return Object(s)===s?s:o}},k.partial=function(e){var t=a.call(arguments,1);return function(){for(var i=0,n=t.slice(),o=0,s=n.length;s>o;o++)n[o]===k&&(n[o]=arguments[i++]);for(;i<arguments.length;)n.push(arguments[i++]);return e.apply(this,n)}},k.bindAll=function(e){var t=a.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return _(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var i={};return t||(t=k.identity),function(){var n=t.apply(this,arguments);return k.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},k.delay=function(e,t){var i=a.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(a.call(arguments,1)))},k.throttle=function(e,t,i){var n,o,s,r=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:k.now(),r=null,s=e.apply(n,o),n=o=null};return function(){var u=k.now();a||i.leading!==!1||(a=u);var c=t-(u-a);return n=this,o=arguments,0>=c?(clearTimeout(r),r=null,a=u,s=e.apply(n,o),n=o=null):r||i.trailing===!1||(r=setTimeout(l,c)),s}},k.debounce=function(e,t,i){var n,o,s,r,a,l=function(){var u=k.now()-r;t>u?n=setTimeout(l,t-u):(n=null,i||(a=e.apply(s,o),s=o=null))};return function(){s=this,o=arguments,r=k.now();var u=i&&!n;return n||(n=setTimeout(l,t)),u&&(a=e.apply(s,o),s=o=null),a}},k.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return k.partial(t,e)},k.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},k.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},k.keys=function(e){if(!k.isObject(e))return[];if(w)return w(e);var t=[];for(var i in e)k.has(e,i)&&t.push(i);return t},k.values=function(e){for(var t=k.keys(e),i=t.length,n=new Array(i),o=0;i>o;o++)n[o]=e[t[o]];return n},k.pairs=function(e){for(var t=k.keys(e),i=t.length,n=new Array(i),o=0;i>o;o++)n[o]=[t[o],e[t[o]]];return n},k.invert=function(e){for(var t={},i=k.keys(e),n=0,o=i.length;o>n;n++)t[e[i[n]]]=i[n];return t},k.functions=k.methods=function(e){var t=[];for(var i in e)k.isFunction(e[i])&&t.push(i);return t.sort()},k.extend=function(e){return _(a.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},k.pick=function(e){var t={},i=l.apply(n,a.call(arguments,1));return _(i,function(i){i in e&&(t[i]=e[i])}),t},k.omit=function(e){var t={},i=l.apply(n,a.call(arguments,1));for(var o in e)k.contains(i,o)||(t[o]=e[o]);return t},k.defaults=function(e){return _(a.call(arguments,1),function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var S=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var o=u.call(e);if(o!=u.call(t))return!1;switch(o){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=i.length;s--;)if(i[s]==e)return n[s]==t;var r=e.constructor,a=t.constructor;if(r!==a&&!(k.isFunction(r)&&r instanceof r&&k.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1;i.push(e),n.push(t);var l=0,c=!0;if("[object Array]"==o){if(l=e.length,c=l==t.length)for(;l--&&(c=S(e[l],t[l],i,n)););}else{for(var d in e)if(k.has(e,d)&&(l++,!(c=k.has(t,d)&&S(e[d],t[d],i,n))))break;if(c){for(d in t)if(k.has(t,d)&&!l--)break;c=!l}}return i.pop(),n.pop(),c};k.isEqual=function(e,t){return S(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=y||function(e){return"[object Array]"==u.call(e)},k.isObject=function(e){return e===Object(e)},_(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return c.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.constant=function(e){return function(){return e}},k.property=function(e){return function(t){return t[e]}},k.matches=function(e){return function(t){if(t===e)return!0;for(var i in e)if(e[i]!==t[i])return!1;return!0}},k.times=function(e,t,i){for(var n=Array(Math.max(0,e)),o=0;e>o;o++)n[o]=t.call(i,o);return n},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},k.now=Date.now||function(){return(new Date).getTime()};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=k.invert(I.escape);var A={escape:new RegExp("["+k.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(I.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(A[e],function(t){return I[e][t]})}}),k.result=function(e,t){if(null==e)return void 0;var i=e[t];return k.isFunction(i)?i.call(e):i},k.mixin=function(e){_(k.functions(e),function(t){var i=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),B.call(this,i.apply(k,e))}})};var L=0;k.uniqueId=function(e){var t=++L+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,i){var n;i=k.defaults({},i,k.templateSettings);var o=new RegExp([(i.escape||R).source,(i.interpolate||R).source,(i.evaluate||R).source].join("|")+"|$","g"),s=0,r="__p+='";e.replace(o,function(t,i,n,o,a){return r+=e.slice(s,a).replace(M,function(e){return"\\"+j[e]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(r+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(r+="';\n"+o+"\n__p+='"),s=a+t.length,t}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(i.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(t)return n(t,k);var l=function(e){return n.call(this,e,k)};return l.source="function("+(i.variable||"obj")+"){\n"+r+"}",l},k.chain=function(e){return k(e).chain()};var B=function(e){return this._chain?k(e).chain():e};k.mixin(k),_(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];k.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],B.call(this,i)}}),_(["concat","join","slice"],function(e){var t=n[e];k.prototype[e]=function(){return B.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return k})}).call(this),window.Modernizr=function(e,t,i){function n(e){C.cssText=e}function o(e,t){return n(k.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function a(e,t){for(var n in e){var o=e[n];if(!r(o,"-")&&C[o]!==i)return"pfx"==t?o:!0}return!1}function l(e,t,n){for(var o in e){var r=t[e[o]];if(r!==i)return n===!1?e[o]:s(r,"function")?r.bind(n||t):r}return!1}function u(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),o=(e+" "+x.join(n+" ")+n).split(" ");return s(t,"string")||s(t,"undefined")?a(o,t):(o=(e+" "+T.join(n+" ")+n).split(" "),l(o,t,i))}function c(){m.input=function(i){for(var n=0,o=i.length;o>n;n++)D[i[n]]=i[n]in y;return D.list&&(D.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),D}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),m.inputtypes=function(e){for(var n,o,s,r=0,a=e.length;a>r;r++)y.setAttribute("type",o=e[r]),n="text"!==y.type,n&&(y.value=w,y.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(o)&&y.style.WebkitAppearance!==i?(g.appendChild(y),s=t.defaultView,n=s.getComputedStyle&&"textfield"!==s.getComputedStyle(y,null).WebkitAppearance&&0!==y.offsetHeight,g.removeChild(y)):/^(search|tel)$/.test(o)||(n=/^(url|email)$/.test(o)?y.checkValidity&&y.checkValidity()===!1:y.value!=w)),F[e[r]]=!!n;return F}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d,p,f="2.6.2",m={},h=!0,g=t.documentElement,v="modernizr",b=t.createElement(v),C=b.style,y=t.createElement("input"),w=":)",O={}.toString,k=" -webkit- -moz- -o- -ms- ".split(" "),_="Webkit Moz O ms",x=_.split(" "),T=_.toLowerCase().split(" "),E={svg:"http://www.w3.org/2000/svg"},P={},F={},D={},S=[],I=S.slice,A=function(e,i,n,o){var s,r,a,l,u=t.createElement("div"),c=t.body,d=c||t.createElement("body");if(parseInt(n,10))for(;n--;)a=t.createElement("div"),a.id=o?o[n]:v+(n+1),u.appendChild(a);return s=["&#173;",'<style id="s',v,'">',e,"</style>"].join(""),u.id=v,(c?u:d).innerHTML+=s,d.appendChild(u),c||(d.style.background="",d.style.overflow="hidden",l=g.style.overflow,g.style.overflow="hidden",g.appendChild(d)),r=i(u,e),c?u.parentNode.removeChild(u):(d.parentNode.removeChild(d),g.style.overflow=l),!!r},L=function(){function e(e,o){o=o||t.createElement(n[e]||"div"),e="on"+e;var r=e in o;return r||(o.setAttribute||(o=t.createElement("div")),o.setAttribute&&o.removeAttribute&&(o.setAttribute(e,""),r=s(o[e],"function"),s(o[e],"undefined")||(o[e]=i),o.removeAttribute(e))),o=null,r}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),R={}.hasOwnProperty;p=s(R,"undefined")||s(R.call,"undefined")?function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")}:function(e,t){return R.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=I.call(arguments,1),n=function(){if(this instanceof n){var o=function(){};o.prototype=t.prototype;var s=new o,r=t.apply(s,i.concat(I.call(arguments)));return Object(r)===r?r:s}return t.apply(e,i.concat(I.call(arguments)))};return n}),P.flexbox=function(){return u("flexWrap")},P.flexboxlegacy=function(){return u("boxDirection")},P.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},P.canvastext=function(){return!!m.canvas&&!!s(t.createElement("canvas").getContext("2d").fillText,"function")},P.webgl=function(){return!!e.WebGLRenderingContext},P.touch=function(){var i;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?i=!0:A(["@media (",k.join("touch-enabled),("),v,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){i=9===e.offsetTop}),i},P.geolocation=function(){return"geolocation"in navigator},P.postmessage=function(){return!!e.postMessage},P.websqldatabase=function(){return!!e.openDatabase},P.indexedDB=function(){return!!u("indexedDB",e)},P.hashchange=function(){return L("hashchange",e)&&(t.documentMode===i||t.documentMode>7)},P.history=function(){return!!e.history&&!!history.pushState},P.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},P.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},P.rgba=function(){return n("background-color:rgba(150,255,150,.5)"),r(C.backgroundColor,"rgba")},P.hsla=function(){return n("background-color:hsla(120,40%,100%,.5)"),r(C.backgroundColor,"rgba")||r(C.backgroundColor,"hsla")},P.multiplebgs=function(){return n("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(C.background)},P.backgroundsize=function(){return u("backgroundSize")},P.borderimage=function(){return u("borderImage")},P.borderradius=function(){return u("borderRadius")},P.boxshadow=function(){return u("boxShadow")},P.textshadow=function(){return""===t.createElement("div").style.textShadow},P.opacity=function(){return o("opacity:.55"),/^0.55$/.test(C.opacity)},P.cssanimations=function(){return u("animationName")},P.csscolumns=function(){return u("columnCount")},P.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",i="linear-gradient(left top,#9f9, white);";return n((e+"-webkit- ".split(" ").join(t+e)+k.join(i+e)).slice(0,-e.length)),r(C.backgroundImage,"gradient")},P.cssreflections=function(){return u("boxReflect")},P.csstransforms=function(){return!!u("transform")},P.csstransforms3d=function(){var e=!!u("perspective");return e&&"webkitPerspective"in g.style&&A("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},P.csstransitions=function(){return u("transition")},P.fontface=function(){var e;return A('@font-face {font-family:"font";src:url("https://")}',function(i,n){var o=t.getElementById("smodernizr"),s=o.sheet||o.styleSheet,r=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"";e=/src/i.test(r)&&0===r.indexOf(n.split(" ")[0])}),e},P.generatedcontent=function(){var e;return A(["#",v,"{font:0/0 a}#",v,':after{content:"',w,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},P.video=function(){var e=t.createElement("video"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i},P.audio=function(){var e=t.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),i.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return i},P.localstorage=function(){try{return localStorage.setItem(v,v),localStorage.removeItem(v),!0}catch(e){return!1}},P.sessionstorage=function(){try{return sessionStorage.setItem(v,v),sessionStorage.removeItem(v),!0}catch(e){return!1}},P.webworkers=function(){return!!e.Worker},P.applicationcache=function(){return!!e.applicationCache},P.svg=function(){return!!t.createElementNS&&!!t.createElementNS(E.svg,"svg").createSVGRect},P.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==E.svg},P.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(O.call(t.createElementNS(E.svg,"animate")))},P.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(O.call(t.createElementNS(E.svg,"clipPath")))};for(var j in P)p(P,j)&&(d=j.toLowerCase(),m[d]=P[j](),S.push((m[d]?"":"no-")+d));return m.input||c(),m.addTest=function(e,t){if("object"==typeof e)for(var n in e)p(e,n)&&m.addTest(n,e[n]);else{if(e=e.toLowerCase(),m[e]!==i)return m;t="function"==typeof t?t():t,"undefined"!=typeof h&&h&&(g.className+=" "+(t?"":"no-")+e),m[e]=t}return m},n(""),b=y=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function o(e){var t=g[e[m]];return t||(t={},h++,e[m]=h,g[h]=t),t}function s(e,i,n){if(i||(i=t),c)return i.createElement(e);n||(n=o(i));var s;return s=n.cache[e]?n.cache[e].cloneNode():f.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),s.canHaveChildren&&!p.test(e)?n.frag.appendChild(s):s}function r(e,i){if(e||(e=t),c)return e.createDocumentFragment();i=i||o(e);for(var s=i.frag.cloneNode(),r=0,a=n(),l=a.length;l>r;r++)s.createElement(a[r]);return s}function a(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return v.shivMethods?s(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function l(e){e||(e=t);var n=o(e);return v.shivCSS&&!u&&!n.hasCSS&&(n.hasCSS=!!i(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),c||a(e,n),e}var u,c,d=e.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",h=0,g={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",u="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(i){u=!0,c=!0}}();var v={elements:d.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:d.shivCSS!==!1,supportsUnknownElements:c,shivMethods:d.shivMethods!==!1,type:"default",shivDocument:l,createElement:s,createDocumentFragment:r};e.html5=v,l(t)}(this,t),m._version=f,m._prefixes=k,m._domPrefixes=T,m._cssomPrefixes=x,m.hasEvent=L,m.testProp=function(e){return a([e])},m.testAllProps=u,m.testStyles=A,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(h?" js "+S.join(" "):""),m}(this,this.document),function(e,t,i){function n(e){return"[object Function]"==g.call(e)}function o(e){return"string"==typeof e}function s(){}function r(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function a(){var e=v.shift();b=1,e?e.t?m(function(){("c"==e.t?p.injectCss:p.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),a()):b=0}function l(e,i,n,o,s,l,u){function c(t){if(!f&&r(d.readyState)&&(C.r=f=1,!b&&a(),d.onload=d.onreadystatechange=null,t)){"img"!=e&&m(function(){w.removeChild(d)},50);for(var n in T[i])T[i].hasOwnProperty(n)&&T[i][n].onload()}}var u=u||p.errorTimeout,d=t.createElement(e),f=0,g=0,C={t:n,s:i,e:s,a:l,x:u};1===T[i]&&(g=1,T[i]=[]),"object"==e?d.data=i:(d.src=i,d.type=e),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){c.call(this,g)},v.splice(o,0,C),"img"!=e&&(g||2===T[i]?(w.insertBefore(d,y?null:h),m(c,u)):T[i].push(d))}function u(e,t,i,n,s){return b=0,t=t||"j",o(e)?l("c"==t?k:O,e,t,this.i++,i,n,s):(v.splice(this.i++,0,e),1==v.length&&a()),this}function c(){var e=p;return e.loader={load:u,i:0},e}var d,p,f=t.documentElement,m=e.setTimeout,h=t.getElementsByTagName("script")[0],g={}.toString,v=[],b=0,C="MozAppearance"in f.style,y=C&&!!t.createRange().compareNode,w=y?f:h.parentNode,f=e.opera&&"[object Opera]"==g.call(e.opera),f=!!t.attachEvent&&!f,O=C?"object":f?"script":"img",k=f?"script":O,_=Array.isArray||function(e){return"[object Array]"==g.call(e)},x=[],T={},E={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};p=function(e){function t(e){var t,i,n,e=e.split("!"),o=x.length,s=e.pop(),r=e.length,s={url:s,origUrl:s,prefixes:e};for(i=0;r>i;i++)n=e[i].split("="),(t=E[n.shift()])&&(s=t(s,n));for(i=0;o>i;i++)s=x[i](s);return s}function r(e,o,s,r,a){var l=t(e),u=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(o&&(o=n(o)?o:o[e]||o[r]||o[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,o,s,r,a):(T[l.url]?l.noexec=!0:T[l.url]=1,s.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":i,l.noexec,l.attrs,l.timeout),(n(o)||n(u))&&s.load(function(){c(),o&&o(l.origUrl,a,r),u&&u(l.origUrl,a,r),T[l.url]=2})))}function a(e,t){function i(e,i){if(e){if(o(e))i||(d=function(){var e=[].slice.call(arguments);p.apply(this,e),f()}),r(e,d,t,0,u);else if(Object(e)===e)for(l in a=function(){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i}(),e)e.hasOwnProperty(l)&&(!i&&!--a&&(n(d)?d=function(){var e=[].slice.call(arguments);p.apply(this,e),f()}:d[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),f()}}(p[l])),r(e[l],d,t,l,u))}else!i&&f()}var a,l,u=!!e.test,c=e.load||e.both,d=e.callback||s,p=d,f=e.complete||s;i(u?e.yep:e.nope,!!c),c&&i(c)}var l,u,d=this.yepnope.loader;if(o(e))r(e,0,d,0);else if(_(e))for(l=0;l<e.length;l++)u=e[l],o(u)?r(u,0,d,0):_(u)?p(u):Object(u)===u&&a(u,d);else Object(e)===e&&a(e,d)},p.addPrefix=function(e,t){E[e]=t},p.addFilter=function(e){x.push(e)},p.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",d=function(){t.removeEventListener("DOMContentLoaded",d,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=a,e.yepnope.injectJs=function(e,i,n,o,l,u){var c,d,f=t.createElement("script"),o=o||p.errorTimeout;f.src=e;for(d in n)f.setAttribute(d,n[d]);i=u?a:i||s,f.onreadystatechange=f.onload=function(){!c&&r(f.readyState)&&(c=1,i(),f.onload=f.onreadystatechange=null)},m(function(){c||(c=1,i(1))},o),l?f.onload():h.parentNode.insertBefore(f,h)},e.yepnope.injectCss=function(e,i,n,o,r,l){var u,o=t.createElement("link"),i=l?a:i||s;o.href=e,o.rel="stylesheet",o.type="text/css";for(u in n)o.setAttribute(u,n[u]);r||(h.parentNode.insertBefore(o,h),m(i,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},define("modernizr",function(){}),define("tipsy",["jquery"],function(e){function t(e,t){return"function"==typeof e?e.call(t):e}function i(e){for(;e=e.parentNode;)if(e==document)return!0;return!1}function n(t,i){this.$element=e(t),this.options=i,this.enabled=!0,this.fixTitle()}n.prototype={show:function(){var i=this.getTitle();if(i&&this.enabled){var n=this.tip();n.find(".tipsy-inner")[this.options.html?"html":"text"](i),n[0].className="tipsy",n.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var o,s=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),r=n[0].offsetWidth,a=n[0].offsetHeight,l=t(this.options.gravity,this.$element[0]);switch(l.charAt(0)){case"n":o={top:s.top+s.height+this.options.offset,left:s.left+s.width/2-r/2};break;case"s":o={top:s.top-a-this.options.offset,left:s.left+s.width/2-r/2};break;case"e":o={top:s.top+s.height/2-a/2,left:s.left-r-this.options.offset};break;case"w":o={top:s.top+s.height/2-a/2,left:s.left+s.width+this.options.offset}}2==l.length&&(o.left="w"==l.charAt(1)?s.left+s.width/2-15:s.left+s.width/2-r+15),n.css(o).addClass("tipsy-"+l),n.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+l.charAt(0),this.options.className&&n.addClass(t(this.options.className,this.$element[0])),this.options.fade?n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):n.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){e(this).remove()}):this.tip().remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("original-title"))&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,i=this.options;this.fixTitle();var e,i=this.options;return"string"==typeof i.title?e=t.attr("title"==i.title?"original-title":i.title):"function"==typeof i.title&&(e=i.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||i.fallback},tip:function(){return this.$tip||(this.$tip=e('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},e.fn.tipsy=function(t){function i(i){var o=e.data(i,"tipsy");return o||(o=new n(i,e.fn.tipsy.elementOptions(i,t)),e.data(i,"tipsy",o)),o}function o(){var e=i(this);e.hoverState="in",0==t.delayIn?e.show():(e.fixTitle(),setTimeout(function(){"in"==e.hoverState&&e.show()},t.delayIn))}function s(){var e=i(this);e.hoverState="out",0==t.delayOut?e.hide():setTimeout(function(){"out"==e.hoverState&&e.hide()},t.delayOut)}if(t===!0)return this.data("tipsy");if("string"==typeof t){var r=this.data("tipsy");return r&&r[t](),this}if(t=e.extend({},e.fn.tipsy.defaults,t),t.live||this.each(function(){i(this)
}),"manual"!=t.trigger){var a=t.live?"live":"bind",l="hover"==t.trigger?"mouseenter":"focus",u="hover"==t.trigger?"mouseleave":"blur";this[a](l,o)[a](u,s)}return this},e.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},e.fn.tipsy.revalidate=function(){e(".tipsy").each(function(){var t=e.data(this,"tipsy-pointee");t&&i(t)||e(this).remove()})},e.fn.tipsy.elementOptions=function(t,i){return e.metadata?e.extend({},i,e(t).metadata()):i},e.fn.tipsy.autoNS=function(){return e(this).offset().top>e(document).scrollTop()+e(window).height()/2?"s":"n"},e.fn.tipsy.autoWE=function(){return e(this).offset().left>e(document).scrollLeft()+e(window).width()/2?"e":"w"},e.fn.tipsy.autoBounds=function(t,i){return function(){var n={ns:i[0],ew:i.length>1?i[1]:!1},o=e(document).scrollTop()+t,s=e(document).scrollLeft()+t,r=e(this);return r.offset().top<o&&(n.ns="n"),r.offset().left<s&&(n.ew="w"),e(window).width()+e(document).scrollLeft()-r.offset().left<t&&(n.ew="e"),e(window).height()+e(document).scrollTop()-r.offset().top<t&&(n.ns="s"),n.ns+(n.ew?n.ew:"")}}}),function(e){"function"==typeof define&&define.amd?define("ui_core",["jquery"],e):e(jQuery)}(function(e){function t(t,n){var o,s,r,a=t.nodeName.toLowerCase();return"area"===a?(o=t.parentNode,s=o.name,t.href&&s&&"map"===o.nodeName.toLowerCase()?(r=e("img[usemap='#"+s+"']")[0],!!r&&i(r)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),n="absolute"===i,o=t?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var t=e(this);return n&&"static"===t.css("position")?!1:o.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&s.length?s:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var n=e.attr(i,"tabindex"),o=isNaN(n);return(o||n>=0)&&t(i,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function n(t,i,n,s){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?r["inner"+i].call(this):this.each(function(){e(this).css(s,n(this,t)+"px")})},e.fn["outer"+i]=function(t,o){return"number"!=typeof t?r["outer"+i].call(this,t):this.each(function(){e(this).css(s,n(this,t,!0,o)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,n,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(n=parseInt(o.css("zIndex"),10),!isNaN(n)&&0!==n))return n;o=o.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var o,s=e.ui[t].prototype;for(o in n)s.plugins[o]=s.plugins[o]||[],s.plugins[o].push([i,n[o]])},call:function(e,t,i,n){var o,s=e.plugins[t];if(s&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(o=0;o<s.length;o++)e.options[s[o][0]]&&s[o][1].apply(e.element,i)}}}),function(e){"function"==typeof define&&define.amd?define("widget",["jquery"],e):e(jQuery)}(function(e){var t=0,i=Array.prototype.slice;return e.cleanData=function(t){return function(i){var n,o,s;for(s=0;null!=(o=i[s]);s++)try{n=e._data(o,"events"),n&&n.remove&&e(o).triggerHandler("remove")}catch(r){}t(i)}}(e.cleanData),e.widget=function(t,i,n){var o,s,r,a,l={},u=t.split(".")[0];return t=t.split(".")[1],o=u+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[u]=e[u]||{},s=e[u][t],r=e[u][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new r(e,t)},e.extend(r,s,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),a=new i,a.options=e.widget.extend({},a.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},o=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,s=this._superApply;return this._super=e,this._superApply=o,t=n.apply(this,arguments),this._super=i,this._superApply=s,t}}()):void(l[t]=n)}),r.prototype=e.widget.extend(a,{widgetEventPrefix:s?a.widgetEventPrefix||t:t},l,{constructor:r,namespace:u,widgetName:t,widgetFullName:o}),s?(e.each(s._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete s._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r),r},e.widget.extend=function(t){for(var n,o,s=i.call(arguments,1),r=0,a=s.length;a>r;r++)for(n in s[r])o=s[r][n],s[r].hasOwnProperty(n)&&void 0!==o&&(t[n]=e.isPlainObject(o)?e.isPlainObject(t[n])?e.widget.extend({},t[n],o):e.widget.extend({},o):o);return t},e.widget.bridge=function(t,n){var o=n.prototype.widgetFullName||t;e.fn[t]=function(s){var r="string"==typeof s,a=i.call(arguments,1),l=this;return s=!r&&a.length?e.widget.extend.apply(null,[s].concat(a)):s,this.each(r?function(){var i,n=e.data(this,o);return"instance"===s?(l=n,!1):n?e.isFunction(n[s])&&"_"!==s.charAt(0)?(i=n[s].apply(n,a),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+s+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+s+"'")}:function(){var t=e.data(this,o);t?(t.option(s||{}),t._init&&t._init()):e.data(this,o,new n(s,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,o,s,r=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(r={},n=t.split("."),t=n.shift(),n.length){for(o=r[t]=e.widget.extend({},this.options[t]),s=0;s<n.length-1;s++)o[n[s]]=o[n[s]]||{},o=o[n[s]];if(t=n.pop(),1===arguments.length)return void 0===o[t]?null:o[t];o[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];r[t]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var o,s=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=o=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),e.each(n,function(n,r){function a(){return t||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof r?s[r]:r).apply(s,arguments):void 0}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),u=l[1]+s.eventNamespace,c=l[2];c?o.delegate(c,u,a):i.bind(u,a)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var o,s,r=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(o in s)o in i||(i[o]=s[o]);return this.element.trigger(i,n),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,o,s){"string"==typeof o&&(o={effect:o});var r,a=o?o===!0||"number"==typeof o?i:o.effect||i:t;o=o||{},"number"==typeof o&&(o={duration:o}),r=!e.isEmptyObject(o),o.complete=s,o.delay&&n.delay(o.delay),r&&e.effects&&e.effects.effect[a]?n[t](o):a!==t&&n[a]?n[a](o.duration,o.easing,s):n.queue(function(i){e(this)[t](),s&&s.call(n[0]),i()})}}),e.widget}),function(e){"function"==typeof define&&define.amd?define("position",["jquery"],e):e(jQuery)}(function(e){return function(){function t(e,t,i){return[parseFloat(e[0])*(f.test(e[0])?t/100:1),parseFloat(e[1])*(f.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function n(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,s,r=Math.max,a=Math.abs,l=Math.round,u=/left|center|right/,c=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,p=/^\w+/,f=/%$/,m=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==o)return o;var t,i,n=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=n.children()[0];return e("body").append(n),t=s.offsetWidth,n.css("overflow","scroll"),i=s.offsetWidth,t===i&&(i=n[0].clientWidth),n.remove(),o=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),o="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,s="scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]),o=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:o,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n||o?i.width():i.outerWidth(),height:n||o?i.height():i.outerHeight()}}},e.fn.position=function(o){if(!o||!o.of)return m.apply(this,arguments);o=e.extend({},o);var f,h,g,v,b,C,y=e(o.of),w=e.position.getWithinInfo(o.within),O=e.position.getScrollInfo(w),k=(o.collision||"flip").split(" "),_={};return C=n(y),y[0].preventDefault&&(o.at="left top"),h=C.width,g=C.height,v=C.offset,b=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(o[this]||"").split(" ");1===i.length&&(i=u.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=u.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),_[this]=[e?e[0]:0,t?t[0]:0],o[this]=[p.exec(i[0])[0],p.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===o.at[0]?b.left+=h:"center"===o.at[0]&&(b.left+=h/2),"bottom"===o.at[1]?b.top+=g:"center"===o.at[1]&&(b.top+=g/2),f=t(_.at,h,g),b.left+=f[0],b.top+=f[1],this.each(function(){var n,u,c=e(this),d=c.outerWidth(),p=c.outerHeight(),m=i(this,"marginLeft"),C=i(this,"marginTop"),x=d+m+i(this,"marginRight")+O.width,T=p+C+i(this,"marginBottom")+O.height,E=e.extend({},b),P=t(_.my,c.outerWidth(),c.outerHeight());"right"===o.my[0]?E.left-=d:"center"===o.my[0]&&(E.left-=d/2),"bottom"===o.my[1]?E.top-=p:"center"===o.my[1]&&(E.top-=p/2),E.left+=P[0],E.top+=P[1],s||(E.left=l(E.left),E.top=l(E.top)),n={marginLeft:m,marginTop:C},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](E,{targetWidth:h,targetHeight:g,elemWidth:d,elemHeight:p,collisionPosition:n,collisionWidth:x,collisionHeight:T,offset:[f[0]+P[0],f[1]+P[1]],my:o.my,at:o.at,within:w,elem:c})}),o.using&&(u=function(e){var t=v.left-E.left,i=t+h-d,n=v.top-E.top,s=n+g-p,l={target:{element:y,left:v.left,top:v.top,width:h,height:g},element:{element:c,left:E.left,top:E.top,width:d,height:p},horizontal:0>i?"left":t>0?"right":"center",vertical:0>s?"top":n>0?"bottom":"middle"};d>h&&a(t+i)<h&&(l.horizontal="center"),p>g&&a(n+s)<g&&(l.vertical="middle"),l.important=r(a(t),a(i))>r(a(n),a(s))?"horizontal":"vertical",o.using.call(this,e,l)}),c.offset(e.extend(E,{using:u}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,a=e.left-t.collisionPosition.marginLeft,l=o-a,u=a+t.collisionWidth-s-o;t.collisionWidth>s?l>0&&0>=u?(i=e.left+l+t.collisionWidth-s-o,e.left+=l-i):e.left=u>0&&0>=l?o:l>u?o+s-t.collisionWidth:o:l>0?e.left+=l:u>0?e.left-=u:e.left=r(e.left-a,e.left)},top:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,a=e.top-t.collisionPosition.marginTop,l=o-a,u=a+t.collisionHeight-s-o;t.collisionHeight>s?l>0&&0>=u?(i=e.top+l+t.collisionHeight-s-o,e.top+=l-i):e.top=u>0&&0>=l?o:l>u?o+s-t.collisionHeight:o:l>0?e.top+=l:u>0?e.top-=u:e.top=r(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,o=t.within,s=o.offset.left+o.scrollLeft,r=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,u=e.left-t.collisionPosition.marginLeft,c=u-l,d=u+t.collisionWidth-r-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,f="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,m=-2*t.offset[0];0>c?(i=e.left+p+f+m+t.collisionWidth-r-s,(0>i||i<a(c))&&(e.left+=p+f+m)):d>0&&(n=e.left-t.collisionPosition.marginLeft+p+f+m-l,(n>0||a(n)<d)&&(e.left+=p+f+m))},top:function(e,t){var i,n,o=t.within,s=o.offset.top+o.scrollTop,r=o.height,l=o.isWindow?o.scrollTop:o.offset.top,u=e.top-t.collisionPosition.marginTop,c=u-l,d=u+t.collisionHeight-r-l,p="top"===t.my[1],f=p?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,m="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,h=-2*t.offset[1];0>c?(n=e.top+f+m+h+t.collisionHeight-r-s,e.top+f+m+h>c&&(0>n||n<a(c))&&(e.top+=f+m+h)):d>0&&(i=e.top-t.collisionPosition.marginTop+f+m+h-l,e.top+f+m+h>d&&(i>0||a(i)<d)&&(e.top+=f+m+h))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,o,r,a=document.getElementsByTagName("body")[0],l=document.createElement("div");t=document.createElement(a?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in n)t.style[r]=n[r];t.appendChild(l),i=a||document.documentElement,i.insertBefore(t,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",o=e(l).offset().left,s=o>10&&11>o,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position}),function(e){"function"==typeof define&&define.amd?define("menu",["jquery","ui_core","widget","position"],e):e(jQuery)}(function(e){return e.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,o,s,r,a,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,o=this.previousFilter||"",s=String.fromCharCode(t.keyCode),r=!1,clearTimeout(this.filterTimer),s===o?r=!0:s=o+s,a=new RegExp("^"+i(s),"i"),n=this.activeMenu.find(this.options.items).filter(function(){return a.test(e(this).text())}),n=r&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n,n.length||(s=String.fromCharCode(t.keyCode),a=new RegExp("^"+i(s),"i"),n=this.activeMenu.find(this.options.items).filter(function(){return a.test(e(this).text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,n=this,o=this.options.icons.submenu,s=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),n=e("<span>").addClass("ui-menu-icon ui-icon "+o).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",i.attr("id"))}),t=s.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);n._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,n;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,n,o,s,r,a;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,o=t.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),r=this.activeMenu.height(),a=t.outerHeight(),0>o?this.activeMenu.scrollTop(s+o):o+a>r&&this.activeMenu.scrollTop(s+o-r+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(t),this.activeMenu=n},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[t]()),this.focus(i,n)},nextPage:function(t){var i,n,o;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n-o<0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var i,n,o;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n+o>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}})}),function(e){"function"==typeof define&&define.amd?define("autocomplete",["jquery","ui_core","widget","position","menu"],e):e(jQuery)}(function(e){return e.widget("ui.autocomplete",{version:"@VERSION",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,n,o=this.element[0].nodeName.toLowerCase(),s="textarea"===o,r="input"===o;this.isMultiLine=s?!0:r?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[s||r?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(o){if(this.element.prop("readOnly"))return t=!0,n=!0,void(i=!0);t=!1,n=!1,i=!1;var s=e.ui.keyCode;switch(o.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",o);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",o);break;case s.UP:t=!0,this._keyEvent("previous",o);break;case s.DOWN:t=!0,this._keyEvent("next",o);break;case s.ENTER:this.menu.active&&(t=!0,o.preventDefault(),this.menu.select(o));break;case s.TAB:this.menu.active&&this.menu.select(o);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(o),o.preventDefault());break;default:i=!0,this._searchTimeout(o)}},keypress:function(n){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:this._move("previousPage",n);break;case o.PAGE_DOWN:this._move("nextPage",n);break;case o.UP:this._keyEvent("previous",n);break;case o.DOWN:this._keyEvent("next",n)}}},input:function(e){return n?(n=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(n){n.target===t.element[0]||n.target===i||e.contains(i,n.target)||t.close()})})},menufocus:function(t,i){var n,o;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)})):(o=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:o})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(o.value),n=i.item.attr("aria-label")||o.value,void(n&&e.trim(n).length&&(this.liveRegion.children().hide(),e("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,n=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,n){n(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,o){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){o(e)},error:function(){o([])
}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),n=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!n)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var n=this;e.each(i,function(e,i){n._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return n.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete}),define("tagit",["jquery","autocomplete"],function(e){e.widget("ui.tagit",{options:{allowDuplicates:!1,caseSensitive:!0,fieldName:"tags",placeholderText:null,readOnly:!1,removeConfirmation:!1,tagLimit:null,availableTags:[],autocomplete:{},showAutocompleteOnFocus:!1,allowSpaces:!1,singleField:!1,singleFieldDelimiter:",",singleFieldNode:null,animate:!0,tabIndex:null,beforeTagAdded:null,afterTagAdded:null,beforeTagRemoved:null,afterTagRemoved:null,onTagClicked:null,onTagLimitExceeded:null,onTagAdded:null,onTagRemoved:null,tagSource:null},_create:function(){var t=this;this.element.is("input")?(this.tagList=e("<ul></ul>").insertAfter(this.element),this.options.singleField=!0,this.options.singleFieldNode=this.element,this.element.css("display","none")):this.tagList=this.element.find("ul, ol").andSelf().last(),this.tagInput=e('<input type="text" />').addClass("ui-widget-content"),this.options.readOnly&&this.tagInput.attr("disabled","disabled"),this.options.tabIndex&&this.tagInput.attr("tabindex",this.options.tabIndex),this.options.placeholderText&&this.tagInput.attr("placeholder",this.options.placeholderText),this.options.autocomplete.source||(this.options.autocomplete.source=function(t,i){var n=t.term.toLowerCase(),o=e.grep(this.options.availableTags,function(e){return 0===e.toLowerCase().indexOf(n)});this.options.allowDuplicates||(o=this._subtractArray(o,this.assignedTags())),i(o)}),this.options.showAutocompleteOnFocus&&(this.tagInput.focus(function(){t._showAutocomplete()}),"undefined"==typeof this.options.autocomplete.minLength&&(this.options.autocomplete.minLength=0)),e.isFunction(this.options.autocomplete.source)&&(this.options.autocomplete.source=e.proxy(this.options.autocomplete.source,this)),e.isFunction(this.options.tagSource)&&(this.options.tagSource=e.proxy(this.options.tagSource,this)),this.tagList.addClass("tagit").addClass("ui-widget ui-widget-content ui-corner-all").append(e('<li class="tagit-new"></li>').append(this.tagInput)).click(function(i){var n=e(i.target);n.hasClass("tagit-label")?(n=n.closest(".tagit-choice"),n.hasClass("removed")||t._trigger("onTagClicked",i,{tag:n,tagLabel:t.tagLabel(n)})):t.tagInput.focus()});var i=!1;if(this.options.singleField)if(this.options.singleFieldNode){var n=e(this.options.singleFieldNode),o=n.val().split(this.options.singleFieldDelimiter);n.val(""),e.each(o,function(e,n){t.createTag(n,null,!0),i=!0})}else this.options.singleFieldNode=e('<input type="hidden" style="display:none;" value="" name="'+this.options.fieldName+'" />'),this.tagList.after(this.options.singleFieldNode);i||this.tagList.children("li").each(function(){e(this).hasClass("tagit-new")||(t.createTag(e(this).text(),e(this).attr("class"),!0),e(this).remove())}),this.tagInput.keydown(function(i){if(i.which==e.ui.keyCode.BACKSPACE&&""===t.tagInput.val()){var n=t._lastTag();!t.options.removeConfirmation||n.hasClass("remove")?t.removeTag(n):t.options.removeConfirmation&&n.addClass("remove ui-state-highlight")}else t.options.removeConfirmation&&t._lastTag().removeClass("remove ui-state-highlight");(i.which===e.ui.keyCode.COMMA||i.which===e.ui.keyCode.ENTER||i.which==e.ui.keyCode.TAB&&""!==t.tagInput.val()||i.which==e.ui.keyCode.SPACE&&!0!==t.options.allowSpaces&&('"'!=e.trim(t.tagInput.val()).replace(/^s*/,"").charAt(0)||'"'==e.trim(t.tagInput.val()).charAt(0)&&'"'==e.trim(t.tagInput.val()).charAt(e.trim(t.tagInput.val()).length-1)&&0!==e.trim(t.tagInput.val()).length-1))&&(i.which===e.ui.keyCode.ENTER&&""===t.tagInput.val()||i.preventDefault(),t.tagInput.data("autocomplete-open")||t.createTag(t._cleanedInput()))}).blur(function(){t.tagInput.data("autocomplete-open")||t.createTag(t._cleanedInput())}),(this.options.availableTags||this.options.tagSource||this.options.autocomplete.source)&&(n={select:function(e,i){return t.createTag(i.item.value),!1}},e.extend(n,this.options.autocomplete),n.source=this.options.tagSource||n.source,this.tagInput.autocomplete(n).bind("autocompleteopen",function(){t.tagInput.data("autocomplete-open",!0)}).bind("autocompleteclose",function(){t.tagInput.data("autocomplete-open",!1)}))},_cleanedInput:function(){return e.trim(this.tagInput.val().replace(/^"(.*)"$/,"$1"))},_lastTag:function(){return this.tagList.find(".tagit-choice:last:not(.removed)")},_tags:function(){return this.tagList.find(".tagit-choice:not(.removed)")},assignedTags:function(){var t=this,i=[];return this.options.singleField?(i=e(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter),""===i[0]&&(i=[])):this._tags().each(function(){i.push(t.tagLabel(this))}),i},_updateSingleTagsField:function(t){e(this.options.singleFieldNode).val(t.join(this.options.singleFieldDelimiter)).trigger("change")},_subtractArray:function(t,i){for(var n=[],o=0;o<t.length;o++)-1==e.inArray(t[o],i)&&n.push(t[o]);return n},tagLabel:function(t){return this.options.singleField?e(t).find(".tagit-label:first").text():e(t).find("input:first").val()},_showAutocomplete:function(){this.tagInput.autocomplete("search","")},_findTagByLabel:function(t){var i=this,n=null;return this._tags().each(function(){return i._formatStr(t)==i._formatStr(i.tagLabel(this))?(n=e(this),!1):void 0}),n},_isNew:function(e){return!this._findTagByLabel(e)},_formatStr:function(t){return this.options.caseSensitive?t:e.trim(t.toLowerCase())},_effectExists:function(t){return Boolean(e.effects&&(e.effects[t]||e.effects.effect&&e.effects.effect[t]))},createTag:function(t,i,n){var o=this;if(t=e.trim(t),this.options.preprocessTag&&(t=this.options.preprocessTag(t)),""===t)return!1;if(!this.options.allowDuplicates&&!this._isNew(t))return t=this._findTagByLabel(t),!1!==this._trigger("onTagExists",null,{existingTag:t,duringInitialization:n})&&this._effectExists("highlight")&&t.effect("highlight"),!1;if(this.options.tagLimit&&this._tags().length>=this.options.tagLimit)return this._trigger("onTagLimitExceeded",null,{duringInitialization:n}),!1;var s=e(this.options.onTagClicked?'<a class="tagit-label"></a>':'<span class="tagit-label"></span>').text(t),r=e("<li></li>").addClass("tagit-choice ui-widget-content ui-state-default ui-corner-all").addClass(i).append(s);this.options.readOnly?r.addClass("tagit-choice-read-only"):(r.addClass("tagit-choice-editable"),i=e("<span></span>").addClass("ui-icon ui-icon-close"),i=e('<a><span class="text-icon">×</span></a>').addClass("tagit-close").append(i).click(function(){o.removeTag(r)}),r.append(i)),this.options.singleField||(s=s.html(),r.append('<input type="hidden" style="display:none;" value="'+s+'" name="'+this.options.fieldName+'" />')),!1!==this._trigger("beforeTagAdded",null,{tag:r,tagLabel:this.tagLabel(r),duringInitialization:n})&&(this.options.singleField&&(s=this.assignedTags(),s.push(t),this._updateSingleTagsField(s)),this._trigger("onTagAdded",null,r),this.tagInput.val(""),this.tagInput.parent().before(r),this._trigger("afterTagAdded",null,{tag:r,tagLabel:this.tagLabel(r),duringInitialization:n}),this.options.showAutocompleteOnFocus&&!n&&setTimeout(function(){o._showAutocomplete()},0))},removeTag:function(t,i){if(i="undefined"==typeof i?this.options.animate:i,t=e(t),this._trigger("onTagRemoved",null,t),!1!==this._trigger("beforeTagRemoved",null,{tag:t,tagLabel:this.tagLabel(t)})){if(this.options.singleField){var n=this.assignedTags(),o=this.tagLabel(t),n=e.grep(n,function(e){return e!=o});this._updateSingleTagsField(n)}if(i){t.addClass("removed");var n=this._effectExists("blind")?["blind",{direction:"horizontal"},"fast"]:["fast"],s=this;n.push(function(){t.remove(),s._trigger("afterTagRemoved",null,{tag:t,tagLabel:s.tagLabel(t)})}),t.fadeOut("fast").hide.apply(t,n).dequeue()}else t.remove(),this._trigger("afterTagRemoved",null,{tag:t,tagLabel:this.tagLabel(t)})}},removeTagByLabel:function(e,t){var i=this._findTagByLabel(e);if(!i)throw"No such tag exists with the name '"+e+"'";this.removeTag(i,t)},removeAll:function(){var e=this;this._tags().each(function(t,i){e.removeTag(i,!1)})}})}),!function(e){"function"==typeof define&&define.amd?define("dropzone",["jquery"],e):e(jQuery)}(function(e){function t(e){return e?i(e):void 0}function i(e){for(var i in t.prototype)e[i]=t.prototype[i];return e}var n={exports:{}};return n.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},t.prototype.once=function(e,t){function i(){n.off(e,i),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var n,o=0;o<i.length;o++)if(n=i[o],n===t||n.fn===t){i.splice(o,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks[e];if(i){i=i.slice(0);for(var n=0,o=i.length;o>n;++n)i[n].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length},function(){var i,o,s,r,a,l,u,c,d={}.hasOwnProperty,p=function(e,t){function i(){this.constructor=e}for(var n in t)d.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},f=[].slice;o="undefined"!=typeof t&&null!==t?t:require("emitter"),u=function(){},i=function(e){function t(e,n){var o,s,r;if(this.element=e,this.version=t.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(t.instances.push(this),this.element.dropzone=this,o=null!=(r=t.optionsForElement(this.element))?r:{},this.options=i({},this.defaultOptions,o,null!=n?n:{}),this.options.forceFallback||!t.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(s=this.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?t.getElement(this.options.previewsContainer,"previewsContainer"):this.element),this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:t.getElements(this.options.clickable,"clickable")),this.init()}var i;return p(t,e),t.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],t.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return u},forceFallback:!1,fallback:function(){var e,i,n,o,s,r;for(this.element.className=""+this.element.className+" dz-browser-not-supported",r=this.element.getElementsByTagName("div"),o=0,s=r.length;s>o;o++)e=r[o],/(^| )dz-message($| )/.test(e.className)&&(i=e,e.className="dz-message");return i||(i=t.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(i)),n=i.getElementsByTagName("span")[0],n&&(n.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,i,n;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},i=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=i*t.optHeight:null==t.optHeight&&(t.optHeight=1/i*t.optWidth),n=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):i>n?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*n):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/n),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:u,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:u,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var i,n,o,s,r,a,l,u,c,d,p,f,m;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=t.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),d=e.previewElement.querySelectorAll("[data-dz-name]"),s=0,l=d.length;l>s;s++)i=d[s],i.textContent=e.name;for(p=e.previewElement.querySelectorAll("[data-dz-size]"),r=0,u=p.length;u>r;r++)i=p[r],i.innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=t.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),n=function(i){return function(n){return n.preventDefault(),n.stopPropagation(),e.status===t.UPLOADING?t.confirm(i.options.dictCancelUploadConfirmation,function(){return i.removeFile(e)}):i.options.dictRemoveFileConfirmation?t.confirm(i.options.dictRemoveFileConfirmation,function(){return i.removeFile(e)}):i.removeFile(e)}}(this),f=e.previewElement.querySelectorAll("[data-dz-remove]"),m=[],a=0,c=f.length;c>a;a++)o=f[a],m.push(o.addEventListener("click",n));return m}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var i,n,o,s,r;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),e.previewElement.classList.add("dz-image-preview"),s=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),r=[],n=0,o=s.length;o>n;n++)i=s[n],i.alt=e.name,r.push(i.src=t);return r}},error:function(e,t){var i,n,o,s,r;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),s=e.previewElement.querySelectorAll("[data-dz-errormessage]"),r=[],n=0,o=s.length;o>n;n++)i=s[n],r.push(i.textContent=t);return r}},errormultiple:u,processing:function(e){return e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink)?e._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:u,uploadprogress:function(e,t){var i,n,o,s,r;if(e.previewElement){for(s=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),r=[],n=0,o=s.length;o>n;n++)i=s[n],r.push(i.style.width=""+t+"%");return r}},totaluploadprogress:u,sending:u,sendingmultiple:u,success:function(e){return e.previewElement?e.previewElement.classList.add("dz-success"):void 0},successmultiple:u,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:u,complete:function(e){return e._removeLink?e._removeLink.textContent=this.options.dictRemoveFile:void 0},completemultiple:u,maxfilesexceeded:u,maxfilesreached:u,previewTemplate:'<div class="dz-preview dz-file-preview">\n <div class="dz-details">\n <div class="dz-filename"><span data-dz-name></span></div>\n <div class="dz-size" data-dz-size></div>\n <img data-dz-thumbnail />\n </div>\n <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n <div class="dz-success-mark"><span>✔</span></div>\n <div class="dz-error-mark"><span>✘</span></div>\n <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},i=function(){var e,t,i,n,o,s,r;for(n=arguments[0],i=2<=arguments.length?f.call(arguments,1):[],s=0,r=i.length;r>s;s++){t=i[s];for(e in t)o=t[e],n[e]=o}return n},t.prototype.getAcceptedFiles=function(){var e,t,i,n,o;for(n=this.files,o=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted&&o.push(e);return o},t.prototype.getRejectedFiles=function(){var e,t,i,n,o;for(n=this.files,o=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted||o.push(e);return o},t.prototype.getFilesWithStatus=function(e){var t,i,n,o,s;for(o=this.files,s=[],i=0,n=o.length;n>i;i++)t=o[i],t.status===e&&s.push(t);return s},t.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(t.QUEUED)},t.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(t.UPLOADING)},t.prototype.getActiveFiles=function(){var e,i,n,o,s;for(o=this.files,s=[],i=0,n=o.length;n>i;i++)e=o[i],(e.status===t.UPLOADING||e.status===t.QUEUED)&&s.push(e);return s},t.prototype.init=function(){var e,i,n,o,s,r,a;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(t.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(n=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null==e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!=e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,i,o,s;if(i=e.hiddenFileInput.files,i.length)for(o=0,s=i.length;s>o;o++)t=i[o],e.addFile(t);return n()})}}(this))(),this.URL=null!=(r=window.URL)?r:window.webkitURL,a=this.events,o=0,s=a.length;s>o;o++)e=a[o],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),i=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(t){return i(t),e.emit("dragenter",t)}}(this),dragover:function(e){return function(t){var n;try{n=t.dataTransfer.effectAllowed}catch(o){}return t.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",i(t),e.emit("dragover",t)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(t){return i(t),e.drop(t)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(i){return e.listeners.push({element:i,events:{click:function(n){return i!==e.element||n.target===e.element||t.elementInside(n.target,e.element.querySelector(".dz-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},t.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,t.instances.splice(t.instances.indexOf(this),1)},t.prototype.updateTotalUploadProgress=function(){var e,t,i,n,o,s,r,a;if(n=0,i=0,e=this.getActiveFiles(),e.length){for(a=this.getActiveFiles(),s=0,r=a.length;r>s;s++)t=a[s],n+=t.upload.bytesSent,i+=t.upload.total;o=100*n/i}else o=100;return this.emit("totaluploadprogress",o,i,n)},t.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},t.prototype.getFallbackForm=function(){var e,i,n,o;return(e=this.getExistingFallback())?e:(n='<div class="dz-fallback">',this.options.dictFallbackText&&(n+="<p>"+this.options.dictFallbackText+"</p>"),n+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',i=t.createElement(n),"FORM"!==this.element.tagName?(o=t.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),o.appendChild(i)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=o?o:i)},t.prototype.getExistingFallback=function(){var e,t,i,n,o,s;for(t=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)if(t=e[i],/(^| )fallback($| )/.test(t.className))return t},s=["div","form"],n=0,o=s.length;o>n;n++)if(i=s[n],e=t(this.element.getElementsByTagName(i)))return e},t.prototype.setupEventListeners=function(){var e,t,i,n,o,s,r;for(s=this.listeners,r=[],n=0,o=s.length;o>n;n++)e=s[n],r.push(function(){var n,o;n=e.events,o=[];for(t in n)i=n[t],o.push(e.element.addEventListener(t,i,!1));return o}());return r},t.prototype.removeEventListeners=function(){var e,t,i,n,o,s,r;for(s=this.listeners,r=[],n=0,o=s.length;o>n;n++)e=s[n],r.push(function(){var n,o;n=e.events,o=[];for(t in n)i=n[t],o.push(e.element.removeEventListener(t,i,!1));return o}());return r},t.prototype.disable=function(){var e,t,i,n,o;for(this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),n=this.files,o=[],t=0,i=n.length;i>t;t++)e=n[t],o.push(this.cancelUpload(e));return o},t.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},t.prototype.filesize=function(e){var t;return e>=109951162777.6?(e/=109951162777.6,t="TiB"):e>=107374182.4?(e/=107374182.4,t="GiB"):e>=104857.6?(e/=104857.6,t="MiB"):e>=102.4?(e/=102.4,t="KiB"):(e=10*e,t="b"),"<strong>"+Math.round(e)/10+"</strong> "+t},t.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},t.prototype.drop=function(e){var t,i;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(i=e.dataTransfer.items,i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(t)))},t.prototype.paste=function(e){var t,i;return null!=(null!=e&&null!=(i=e.clipboardData)?i.items:void 0)?(this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0):void 0},t.prototype.handleFiles=function(e){var t,i,n,o;for(o=[],i=0,n=e.length;n>i;i++)t=e[i],o.push(this.addFile(t));return o},t.prototype._addFilesFromItems=function(e){var t,i,n,o,s;for(s=[],n=0,o=e.length;o>n;n++)i=e[n],s.push(null!=i.webkitGetAsEntry&&(t=i.webkitGetAsEntry())?t.isFile?this.addFile(i.getAsFile()):t.isDirectory?this._addFilesFromDirectory(t,t.name):void 0:null!=i.getAsFile&&(null==i.kind||"file"===i.kind)?this.addFile(i.getAsFile()):void 0);return s},t.prototype._addFilesFromDirectory=function(e,t){var i,n;return i=e.createReader(),n=function(e){return function(i){var n,o,s;for(o=0,s=i.length;s>o;o++)n=i[o],n.isFile?n.file(function(i){return e.options.ignoreHiddenFiles&&"."===i.name.substring(0,1)?void 0:(i.fullPath=""+t+"/"+i.name,e.addFile(i))}):n.isDirectory&&e._addFilesFromDirectory(n,""+t+"/"+n.name)}}(this),i.readEntries(n,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},t.prototype.accept=function(e,i){return e.size>1024*this.options.maxFilesize*1024?i(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):t.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(i(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,i):i(this.options.dictInvalidFileType)},t.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=t.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(i){return i?(e.accepted=!1,t._errorProcessing([e],i)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}}(this))},t.prototype.enqueueFiles=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)t=e[i],this.enqueueFile(t);return null},t.prototype.enqueueFile=function(e){if(e.status!==t.ADDED||e.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return e.status=t.QUEUED,this.options.autoProcessQueue?setTimeout(function(e){return function(){return e.processQueue()}}(this),0):void 0},t.prototype._thumbnailQueue=[],t.prototype._processingThumbnail=!1,t.prototype._enqueueThumbnail=function(e){return this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},t.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},t.prototype.removeFile=function(e){return e.status===t.UPLOADING&&this.cancelUpload(e),this.files=c(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},t.prototype.removeAllFiles=function(e){var i,n,o,s;for(null==e&&(e=!1),s=this.files.slice(),n=0,o=s.length;o>n;n++)i=s[n],(i.status!==t.UPLOADING||e)&&this.removeFile(i);return null},t.prototype.createThumbnail=function(e,t){var i;return i=new FileReader,i.onload=function(n){return function(){var o;
return o=document.createElement("img"),o.onload=function(){var i,s,r,a,u,c,d,p;return e.width=o.width,e.height=o.height,r=n.options.resize.call(n,e),null==r.trgWidth&&(r.trgWidth=r.optWidth),null==r.trgHeight&&(r.trgHeight=r.optHeight),i=document.createElement("canvas"),s=i.getContext("2d"),i.width=r.trgWidth,i.height=r.trgHeight,l(s,o,null!=(u=r.srcX)?u:0,null!=(c=r.srcY)?c:0,r.srcWidth,r.srcHeight,null!=(d=r.trgX)?d:0,null!=(p=r.trgY)?p:0,r.trgWidth,r.trgHeight),a=i.toDataURL("image/png"),n.emit("thumbnail",e,a),null!=t?t():void 0},o.src=i.result}}(this),i.readAsDataURL(e)},t.prototype.processQueue=function(){var e,t,i,n;if(t=this.options.parallelUploads,i=this.getUploadingFiles().length,e=i,!(i>=t)&&(n=this.getQueuedFiles(),n.length>0)){if(this.options.uploadMultiple)return this.processFiles(n.slice(0,t-i));for(;t>e;){if(!n.length)return;this.processFile(n.shift()),e++}}},t.prototype.processFile=function(e){return this.processFiles([e])},t.prototype.processFiles=function(e){var i,n,o;for(n=0,o=e.length;o>n;n++)i=e[n],i.processing=!0,i.status=t.UPLOADING,this.emit("processing",i);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},t.prototype._getFilesWithXhr=function(e){var t,i;return i=function(){var i,n,o,s;for(o=this.files,s=[],i=0,n=o.length;n>i;i++)t=o[i],t.xhr===e&&s.push(t);return s}.call(this)},t.prototype.cancelUpload=function(e){var i,n,o,s,r,a,l;if(e.status===t.UPLOADING){for(n=this._getFilesWithXhr(e.xhr),o=0,r=n.length;r>o;o++)i=n[o],i.status=t.CANCELED;for(e.xhr.abort(),s=0,a=n.length;a>s;s++)i=n[s],this.emit("canceled",i);this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else((l=e.status)===t.ADDED||l===t.QUEUED)&&(e.status=t.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));return this.options.autoProcessQueue?this.processQueue():void 0},t.prototype.uploadFile=function(e){return this.uploadFiles([e])},t.prototype.uploadFiles=function(e){var n,o,s,r,a,l,u,c,d,p,f,m,h,g,v,b,C,y,w,O,k,_,x,T,E,P,F,D,S,I,A,L;for(C=new XMLHttpRequest,y=0,_=e.length;_>y;y++)n=e[y],n.xhr=C;C.open(this.options.method,this.options.url,!0),C.withCredentials=!!this.options.withCredentials,g=null,s=function(t){return function(){var i,o,s;for(s=[],i=0,o=e.length;o>i;i++)n=e[i],s.push(t._errorProcessing(e,g||t.options.dictResponseError.replace("{{statusCode}}",C.status),C));return s}}(this),v=function(t){return function(i){var o,s,r,a,l,u,c,d,p;if(null!=i)for(s=100*i.loaded/i.total,r=0,u=e.length;u>r;r++)n=e[r],n.upload={progress:s,total:i.total,bytesSent:i.loaded};else{for(o=!0,s=100,a=0,c=e.length;c>a;a++)n=e[a],(100!==n.upload.progress||n.upload.bytesSent!==n.upload.total)&&(o=!1),n.upload.progress=s,n.upload.bytesSent=n.upload.total;if(o)return}for(p=[],l=0,d=e.length;d>l;l++)n=e[l],p.push(t.emit("uploadprogress",n,s,n.upload.bytesSent));return p}}(this),C.onload=function(i){return function(n){var o;if(e[0].status!==t.CANCELED&&4===C.readyState){if(g=C.responseText,C.getResponseHeader("content-type")&&~C.getResponseHeader("content-type").indexOf("application/json"))try{g=JSON.parse(g)}catch(r){n=r,g="Invalid JSON response from server."}return v(),200<=(o=C.status)&&300>o?i._finished(e,g,n):s()}}}(this),C.onerror=function(){return function(){return e[0].status!==t.CANCELED?s():void 0}}(this),h=null!=(F=C.upload)?F:C,h.onprogress=v,l={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&i(l,this.options.headers);for(r in l)a=l[r],C.setRequestHeader(r,a);if(o=new FormData,this.options.params){D=this.options.params;for(f in D)b=D[f],o.append(f,b)}for(w=0,x=e.length;x>w;w++)n=e[w],this.emit("sending",n,C,o);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,C,o),"FORM"===this.element.tagName)for(S=this.element.querySelectorAll("input, textarea, select, button"),O=0,T=S.length;T>O;O++)if(c=S[O],d=c.getAttribute("name"),p=c.getAttribute("type"),"SELECT"===c.tagName&&c.hasAttribute("multiple"))for(I=c.options,k=0,E=I.length;E>k;k++)m=I[k],m.selected&&o.append(d,m.value);else(!p||"checkbox"!==(A=p.toLowerCase())&&"radio"!==A||c.checked)&&o.append(d,c.value);for(u=P=0,L=e.length-1;L>=0?L>=P:P>=L;u=L>=0?++P:--P)o.append(this._getParamName(u),e[u],e[u].name);return C.send(o)},t.prototype._finished=function(e,i,n){var o,s,r;for(s=0,r=e.length;r>s;s++)o=e[s],o.status=t.SUCCESS,this.emit("success",o,i,n),this.emit("complete",o);return this.options.uploadMultiple&&(this.emit("successmultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t.prototype._errorProcessing=function(e,i,n){var o,s,r;for(s=0,r=e.length;r>s;s++)o=e[s],o.status=t.ERROR,this.emit("error",o,i,n),this.emit("complete",o);return this.options.uploadMultiple&&(this.emit("errormultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t}(o),i.version="3.10.2",i.options={},i.optionsForElement=function(e){return e.getAttribute("id")?i.options[s(e.getAttribute("id"))]:void 0},i.instances=[],i.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},i.autoDiscover=!0,i.discover=function(){var e,t,n,o,s,r;for(document.querySelectorAll?n=document.querySelectorAll(".dropzone"):(n=[],e=function(e){var t,i,o,s;for(s=[],i=0,o=e.length;o>i;i++)t=e[i],s.push(/(^| )dropzone($| )/.test(t.className)?n.push(t):void 0);return s},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),r=[],o=0,s=n.length;s>o;o++)t=n[o],r.push(i.optionsForElement(t)!==!1?new i(t):void 0);return r},i.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],i.isBrowserSupported=function(){var e,t,n,o,s;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(s=i.blacklistedBrowsers,n=0,o=s.length;o>n;n++)t=s[n],t.test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},c=function(e,t){var i,n,o,s;for(s=[],n=0,o=e.length;o>n;n++)i=e[n],i!==t&&s.push(i);return s},s=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},i.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},i.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},i.getElement=function(e,t){var i;if("string"==typeof e?i=document.querySelector(e):null!=e.nodeType&&(i=e),null==i)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return i},i.getElements=function(e,t){var i,n,o,s,r,a,l,u;if(e instanceof Array){o=[];try{for(s=0,a=e.length;a>s;s++)n=e[s],o.push(this.getElement(n,t))}catch(c){i=c,o=null}}else if("string"==typeof e)for(o=[],u=document.querySelectorAll(e),r=0,l=u.length;l>r;r++)n=u[r],o.push(n);else null!=e.nodeType&&(o=[e]);if(null==o||!o.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return o},i.confirm=function(e,t,i){return window.confirm(e)?t():null!=i?i():void 0},i.isValidFile=function(e,t){var i,n,o,s,r;if(!t)return!0;for(t=t.split(","),n=e.type,i=n.replace(/\/.*$/,""),s=0,r=t.length;r>s;s++)if(o=t[s],o=o.trim(),"."===o.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(o.toLowerCase(),e.name.length-o.length))return!0}else if(/\/\*$/.test(o)){if(i===o.replace(/\/.*$/,""))return!0}else if(n===o)return!0;return!1},"undefined"!=typeof e&&null!==e&&(e.fn.dropzone=function(e){return this.each(function(){return new i(this,e)})}),"undefined"!=typeof n&&null!==n?n.exports=i:window.Dropzone=i,i.ADDED="added",i.QUEUED="queued",i.ACCEPTED=i.QUEUED,i.UPLOADING="uploading",i.PROCESSING=i.UPLOADING,i.CANCELED="canceled",i.ERROR="error",i.SUCCESS="success",a=function(e){var t,i,n,o,s,r,a,l,u,c;for(a=e.naturalWidth,r=e.naturalHeight,i=document.createElement("canvas"),i.width=1,i.height=r,n=i.getContext("2d"),n.drawImage(e,0,0),o=n.getImageData(0,0,1,r).data,c=0,s=r,l=r;l>c;)t=o[4*(l-1)+3],0===t?s=l:c=l,l=s+c>>1;return u=l/r,0===u?1:u},l=function(e,t,i,n,o,s,r,l,u,c){var d;return d=a(t),e.drawImage(t,i,n,o,s,r,l,u,c/d)},r=function(e,t){var i,n,o,s,r,a,l,u,c;if(o=!1,c=!0,n=e.document,u=n.documentElement,i=n.addEventListener?"addEventListener":"attachEvent",l=n.addEventListener?"removeEventListener":"detachEvent",a=n.addEventListener?"":"on",s=function(i){return"readystatechange"!==i.type||"complete"===n.readyState?(("load"===i.type?e:n)[l](a+i.type,s,!1),!o&&(o=!0)?t.call(e,i.type||i):void 0):void 0},r=function(){var e;try{u.doScroll("left")}catch(t){return e=t,void setTimeout(r,50)}return s("poll")},"complete"!==n.readyState){if(n.createEventObject&&u.doScroll){try{c=!e.frameElement}catch(d){}c&&r()}return n[i](a+"DOMContentLoaded",s,!1),n[i](a+"readystatechange",s,!1),e[i](a+"load",s,!1)}},i._autoDiscoverFunction=function(){return i.autoDiscover?i.discover():void 0},r(window,i._autoDiscoverFunction)}.call(this),n.exports}),define("upload",["jquery","filepicker","dropzone","underscore"],function(e,t,i,n){OC.config.uploads={filepicker_key:"AGuSaWwXNQFi60wveigBHz",store_error_code:151},filepicker.setKey(OC.config.uploads.filepicker_key),OC.upload={fp_uploaded_files:{},dropzone_uploaded_files:{},manual_to_upload_files:[],isPost:!1,launchFilepickerDialog:function(e,t){return filepicker.pickAndStore({multiple:!0,openTo:t},{location:"S3",path:"/",access:"public"},OC.upload.fpPost,OC.upload.fpError),e.preventDefault(),e.stopPropagation(),!1},uploadCallback:function(t){var i,n,o;i=t,e.extend(OC.upload.fp_uploaded_files,t);for(n in i)"failures"===n?(o=e(document.createElement("div")),o.html("The following files failed to upload: "),o.append(JSON.stringify(i.failures)),e(".uploadfiles").before(o)):(OC.upload.addToUploadList(n,i[n],"","filepicker-item"),OC.upload.newFileUploadListener())},fpPost:function(t){var i,n,o,s,r;for(o=t.length,i={},n=0;o>n;n++)s=t[n].key,r=t[n].filename,i[s]=r;i.user=OC.config.user.id,e("form input[name=project]").length>0&&(i.project=e("form input[name=project]").val()),e("form input[name=collection]").length>0&&(i.collection=e("form input[name=collection]").val()),e.post("/api/filepicker-upload/",i,OC.upload.uploadCallback,"json")},fpError:function(e){151===e&&alert("Sorry, something went wrong")},dzTemplate:n.template('<div class="dz-preview dz-file-preview <%= process %>"><div class="dz-details"><div class="dz-filename"><span data-dz-name contenteditable="true" class="<%= key %>"><%= filename %></span></div><div class="dz-size" data-dz-size><%= filesize %></div><img data-dz-thumbnail /></div><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><div class="dz-success-mark"><span>✔</span></div><div class="dz-error-mark"><span>✘</span></div><div class="dz-error-message"><span data-dz-errormessage></span></div></div>'),singleFileTemplate:n.template('<div class="single-upload <%= process %>"><input type="hidden" name="key" value="<%= key %>" /><input type="text" name="filename" value="<%= filename %>" /><input type="hidden" name="upload_service" value="<%= process %>" /><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><!--<select name="type"><option value="lesson">Lesson</option><option value="project">Project</option><option value="worksheet">Worksheet</option><option value="handout">Handout</option><option value="activity">Activity</option><option value="assessment">Test / assessment</option><option value="lecture">Lecture</option></select>--><div class="alternative-upload"><a>Upload something else instead...</a></div></div>'),newFileUploadListener:function(){var t=e("form.files-upload-rename button[type=submit]"),i=e('form.files-upload-rename button[name="select-file"]');t.hasClass("hidden")&&(e.isEmptyObject(OC.upload.fp_uploaded_files)&&e.isEmptyObject(OC.upload.dropzone_uploaded_files)&&!OC.upload.manual_to_upload_files.length||(t.removeClass("hidden"),OC.upload.isPost&&i.addClass("hidden")))},updateSingleItemKey:function(t){e(".post-new-upload-dialog .upload-drag-drop-replace input[name=key]").val(t)},addToUploadList:function(t,n,o,s){var r={key:t,filename:n,filesize:o,process:s};if(OC.upload.isPost){var a=e(".post-new-upload-dialog .upload-drag-drop,.post-new-upload-dialog .upload-drag-drop-message");a.addClass("hidden");var l=OC.upload.singleFileTemplate(r),u=e(".post-new-upload-dialog .upload-drag-drop-replace");u.html(l),u.removeClass("hidden"),e('input[type="filename"]',u).focus(),e(".alternative-upload a",u).click(function(){u.addClass("hidden"),a.removeClass("hidden");var t=e('input[class="manual-upload"]');e(t[t.length-2]).remove(),OC.upload.manual_to_upload_files=[],OC.upload.dropzone_uploaded_files={},i.forElement(".post-new-upload-dialog .upload-drag-drop").removeAllFiles(),OC.upload.fp_uploaded_files={};var n=e("form.files-upload-rename button[type=submit]"),o=e('form.files-upload-rename button[name="select-file"]');o.removeClass("hidden"),n.addClass("hidden")})}else{var c=OC.upload.dzTemplate(r);e(".post-new-upload-dialog .upload-drag-drop").append(c)}},onFileInputChange:function(){var t,i=e(this)[0].files[0].size;if(t=i>=1048576?(i/1048576).toFixed(2)+" MB":i>=1024?(i/1024).toFixed(2)+" KB":i+" B",i>5242880){var n=OC.customPopup(".upload-filepicker-suggest-dialog");e(".filepicker-suggest",n.dialog).click(function(e){return n.close(),e.preventDefault(),e.stopPropagation(),!1})}else{var o=e(this)[0].files[0].name;OC.upload.addToUploadList(o,o,t,"manual-item"),OC.upload.manual_to_upload_files.push(o),OC.upload.newFileUploadListener();var s=(e("form.files-upload-rename input.manual-upload").length,e("<input/>",{"class":"manual-upload",type:"file"}));s.change(OC.upload.onFileInputChange),e("form.files-upload-rename").append(s)}},preSubmissionHandler:function(){if(OC.upload.isPost){var t=e(".upload-drag-drop-replace"),i=e('input[name="key"]',t).val(),n=e('input[name="filename"]',t).val(),o=e('input[name="upload_service"]',t).val();if("filepicker-item"==o)e("<input/>").attr("type","hidden").attr("name",i).attr("value",n).appendTo(".files-upload-rename");else if("dropzone-item"==o)e("<input/>").attr("type","hidden").attr("name",i).attr("value",n).appendTo(".files-upload-rename");else{var s=e(".files-upload-rename input[class=manual-upload]");e(s[s.length-2]).attr("name",n)}}else{var r,a,l,u,c,d,p,f=e(".post-new-upload-dialog .upload-drag-drop .dz-preview"),m=e(".files-upload-rename input[type=file]");for(l=0;l<f.length;l++)if(c=f[l],d=e(".dz-filename span:first",c).attr("class"),p=e(".dz-filename span:first",c).text().trim(),e(c).hasClass("filepicker-item"))OC.upload.fp_uploaded_files[d]!=p&&(OC.upload.fp_uploaded_files[d]=p);else if(e(c).hasClass("manual-item"))for(u=0;u<m.length;u++)e(m[u]).val()!==d&&e(m[u]).attr("name",p);else OC.upload.dropzone_uploaded_files[d]!=p&&(OC.upload.dropzone_uploaded_files[d]=p);for(r in OC.upload.fp_uploaded_files)e("<input/>").attr("type","hidden").attr("name",r).attr("value",OC.upload.fp_uploaded_files[r]).appendTo(".files-upload-rename");for(a in OC.upload.dropzone_uploaded_files)e("<input/>").attr("type","hidden").attr("name",a).attr("value",OC.upload.dropzone_uploaded_files[a]).appendTo(".files-upload-rename")}}},e(document).ready(function(){OC.upload.isPost="true"==e('form.files-upload-rename input[name="post"]').val(),e("form.files-upload-rename").bind("keypress",function(e){13===e.keyCode&&e.preventDefault()});var t={".uploadfiles":"COMPUTER",".gdrive-upload":"GOOGLE_DRIVE",".skydrive-upload":"SKYDRIVE",".dropbox-upload":"DROPBOX",".gmail-upload":"GMAIL",".box-upload":"BOX",".picasa-upload":"PICASA",".ftp-upload":"FTP",".webdav-upload":"WEBDAV",".facebook-upload":"FACEBOOK"};n.each(t,function(t,i){e(i).click(function(e){OC.upload.launchFilepickerDialog(e,t)})}),e("form.files-upload-rename button[type=submit]").click(function(e){return OC.upload.preSubmissionHandler(e),OC.upload.isPost?!1:!0}),e("button[name=select-file]").click(function(t){return e("input[class=manual-upload]:last").click(),t.preventDefault(),t.stopPropagation(),!1});var o=e(".post-new-upload-dialog .upload-drag-drop");o.length>0&&(e(".post-new-upload-dialog .upload-drag-drop").dropzone({url:"/api/file-upload/",maxFilesize:5,createImageThumbnails:!1}),i.forElement(".post-new-upload-dialog .upload-drag-drop").on("sending",function(t,i,n){function o(e){var t,i,n,o=null;if(document.cookie&&""!==document.cookie)for(t=document.cookie.split(";"),i=0;i<t.length;i++)if(n=jQuery.trim(t[i]),n.substring(0,e.length+1)===e+"="){o=decodeURIComponent(n.substring(e.length+1));break}return o}function s(e){var t=document.location.host,i=document.location.protocol,n="//"+t,o=i+n;return e===o||e.slice(0,o.length+1)===o+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!/^(\/\/|http:|https:).*/.test(e)}var r=e(this)[0].options.url;s(r)&&i.setRequestHeader("X-CSRFToken",o("csrftoken")),n.append("user",OC.config.user.id),e(".post-new-upload-dialog form input[name=project]").length>0&&n.append("project",e("form.files-upload-rename input[name=project]").val()),e(".post-new-upload-dialog form input[name=collection]").length>0&&n.append("collection",e("form.files-upload-rename input[name=collection]").val()),OC.upload.isPost&&OC.upload.addToUploadList(null,t.name,0,"dropzone-item")}),i.forElement(".post-new-upload-dialog .upload-drag-drop").on("uploadprogress",function(t,i){OC.upload.isPost&&e(".single-upload .dz-progress .dz-upload").css("width",i+"%")}),i.forElement(".post-new-upload-dialog .upload-drag-drop").on("success",function(t,i){var n,o=JSON.parse(i);for(n in o)OC.upload.dropzone_uploaded_files[n]=o[n].title;e(".dz-preview .dz-filename > span:contains("+OC.upload.dropzone_uploaded_files[n]+")").addClass(n),e(".dz-filename span",t.previewElement).attr("contenteditable",!0),OC.upload.newFileUploadListener(),OC.upload.isPost&&OC.upload.updateSingleItemKey(n)})),e("input[type=file]").change(OC.upload.onFileInputChange)})}),define("core",["jquery","autocomplete","tagit","tipsy","modernizr","upload"],function(e){e.fn.fastLiveFilter=function(t,i){i=i||{},t=e(t);var n,o=this,s=i.timeout||0,r=i.callback||function(){},a=t.children(),l=a.length,u=l>0?a[0].style.display:"block";return r(l),o.change(function(){for(var e,t=o.val().toLowerCase(),i=0,n=0;l>n;n++)e=a[n],(e.textContent||e.innerText||"").toLowerCase().indexOf(t)>=0?("none"==e.style.display&&(e.style.display=u),i++):"none"!=e.style.display&&(e.style.display="none");return r(i),!1}).keydown(function(){clearTimeout(n),n=setTimeout(function(){o.change()},s)}),this},_.extend(OC.config,{search:{input:"#search-bar input[name=q]",submit:"#search-bar input[type=submit]"},popup:{id:"default-popup",width:360},articlePanel:{list:"ul#article-panel",item:"ul#article-panel li"},article:{redirectSelector:"#chapter-select, .revision-selector",thermometer:".thermometer-difficulty",thermometerWrapper:".thermometer-difficulty-wrapper",image:"#article img"},catalog:{filterInput:"input[name=live-filter]",filterList:".category-article-panel",categoryPanel:{list:"ul.category-article-panel",item:"ul.category-article-panel li"}},about:{jobsCarousel:".jobs-image-rotator"},registration:{fields:{first_name:"input[name=first_name]",last_name:"input[name=last_name]",location:"input[name=location]",email:"input[name=email]",username:"input[name=username]",socialLogin:".social-login-hide",profilePicture:"input[name=profile_pic]",socialFlag:"form#signup-form input[name=social_login]",socialService:"form#signup-form input[name=social_service]",socialID:"form#signup-form input[name=social_id]"},googleAuthURL:"/gauth/",googleAuthResult:".google-signin",orWrapper:".or-wrapper",ToS:"#agree-terms-conditions",signUpButtonID:"signup-button"},invite:{formSelector:"form.signup",formSpinner:".form-spinner",formError:".form-error"},contentTypes:{comment:""}}),OC.api={},OC.api.UserProfile=function(e,t){return this.username=e,this.profile={},this.fetchProfile(t),this},OC.api.UserProfile.prototype.fetchProfile=function(t){profile=this.profile,e.get("/user/api/get-profile/"+this.username+"/",function(e){t("true"==e.status?e.user:null)},"json")},OC.api.User=function(e,t){return this.username=e,new OC.api.UserProfile(this.username,t)},_.extend(OC,{registerationSuccessCallback:"",signupDialog:null,initSearchOptions:function(){e(".search-options-button").click(function(){e(".search-options").toggleClass("show")})},initSearchAutocomplete:function(){e(OC.config.search.input).autocomplete({source:function(t,i){e.get("/resources/api/search/"+t.term+"/",function(t){i(e.map(t,function(e){return{label:e,value:e}}))},"json")},minLength:2,select:function(t,i){var n=e("form#search-form"),o=e("input[name=q]",n);o.val(i.item.label),e("form#search-form").submit()}})},setUpMenuPositioning:function(t,i,n){var o=n||!1,s=e(i).position();s&&(e(t).css("top",s.top+e(i).outerHeight(!0)),o?e(t).css("left",s.left-(e(t).outerWidth()-e(i).outerWidth())/2):e(t).css("left",s.left-(e(t).outerWidth()-e(i).outerWidth(!0))))},popup:function(t,i){var n=e("#"+OC.config.popup.id),o=i||"";0===n.length?n=e("<div/>",{id:OC.config.popup.id,title:o}):n.attr("title",o),n.html(t),n.dialog({modal:!0,open:!1,width:OC.config.popup.width,buttons:{Ok:function(){e(this).dialog("close")}}})},customPopup:function(t,i){function n(t){e(".popup-background").addClass("show-popup-background"),t.addClass("show-popup"),o(t),OC.dismissMessageBox(),e(window).resize(function(){o(t)})}function o(t){var i=e(window).width(),n=e(window).height();e(t).css("left",(i-t.width())/2),e(t).css("top",(n-t.height())/2.5)}function s(t){e(".oc-popup-exit",t.dialog).click(function(){t.close(t)}),e(document).keyup(function(e){t.dialog.hasClass("show-popup")&&27==e.which&&t.close(t)})}function r(t){t.dialog.removeClass("show-popup"),e(".popup-background").removeClass("show-popup-background");var i,n=e(".oc-popup");for(i=0;i<n.length;i++)e(n[i]).hasClass("show-popup")&&e(".popup-background").addClass("show-popup-background");a&&a()}var a=null;i&&(a=i.closeCallback||a);var l=e(t);e(".oc-popup-exit",l).unbind("click"),e(".popup-background").unbind("click"),n(l);var u={dialog:l,close:r};return s(u),e(".popup-background").click(function(){r(u)}),u},tabs:function(t,i){var n=0,o=null,s=!1;i&&(n=i.tab||n,o=i.showOnly||o,s=i.viewOnly||s);var r=e(t);if(r.addClass("oc-tabs"),!s){var a,l=e("nav > ul > li > a",r);for(a=0;a<l.length;a++){var u=e(l[a]).attr("href").replace("#",".");e(u).addClass("tab-content")}var c=e(".tab-content",r);l.click(function(t){if(!e(this).hasClass("selected")){l.removeClass("selected"),e(this).addClass("selected");var i=e(this).attr("href").replace("#",".");e(c).hide(),e(i).show()}return t.preventDefault(),t.stopPropagation(),!1}),e(l[n]).click()}o&&e("> nav",r).addClass("hide-tabs")},progressBar:function(t,i){function n(e){o(this.element,e)}function o(t,i){e(".oc-progressbar-indicator",t).css({width:i+"%"})}var s=0;i&&(s=i.startAt||s);var r=e(t);return o(r,s),{element:r,advanceTo:n}},tip:function(t,i){function n(e){e.removeClass("show"),e.remove()}var o="n",s=null,r=!1,a=null,l=null;i&&(o=i.gravity||o,s=i.title||s,r=i.description||r,a=i.width||a,l=i.dismisser||l);var u=_.template('<div class="oc-tip-body-title"><h4><%= title %></h4></div><div class="oc-tip-body-description"><p><%= description %></p></div><button class="action-button mini-action-button">Done</button>'),c=e("<div/>",{"class":"oc-tip show"}),d=e("<div/>",{"class":"oc-tip-body",html:u({title:s,description:r})}),p=e("<div/>",{"class":"floating-menu-spacer "+o});a&&d.width(a);var f,m,h,g=e("body");switch(o){case"n":c.append(p),c.append(d),g.append(c),f=e("body .oc-tip:last"),h=t.offset().left-(f.width()-t.outerWidth())/2,m=t.offset().top+t.outerHeight(),c.css({top:m+10,left:h}),c.animate({top:m,opacity:1},500);break;case"e":c.append(d),c.append(p),g.append(c),f=e("body .oc-tip:last"),c.css({top:t.offset().top,left:t.offset().left-f.width()});break;case"s":c.append(d),c.append(p),g.append(c),f=e("body .oc-tip:last"),h=t.offset().left-(f.width()-t.outerWidth())/2,m=t.offset().top-f.height(),c.css({top:m-10,left:h}),c.animate({top:m,opacity:1},500);break;case"w":c.append(p),c.append(d),g.append(c),c.css({top:t.offset().top,left:t.offset().left+t.outerWidth()})}if(a){appendedTipWidth=e(".oc-tip-body",f).innerWidth();var v=e(".floating-menu-spacer",f);v.width(appendedTipWidth),v.css("background-position",appendedTipWidth/2-8+"px bottom")}e(".action-button",f).click(function(){l(c,n)})},setupIndex:function(){var t=e("#chief-panel-container.home");if(t.length>0){var i=e(window).height()-100;t.height(i),e(".blog-highlight").css({top:i-e(".blog-highlight").outerHeight(!0)}),e.ajax({type:"GET",dataType:"xml",url:"http://blog.opencurriculum.org/feed/rss/",success:function(t){var i=e(t).find("item:first"),n=e(i).find("title").text(),o=e(i).find("link").text();e(".blog-highlight-title").text(n),e(".blog-highlight-title").attr("href",o),e(".blog-highlight").fadeIn("slow")}}),OC.renderIndexAnimation()}},renderIndexAnimation:function(){function t(){clearInterval(n),setTimeout(function(){n=i()},5e3)}function i(){return forward_motion=!1,setInterval(function(){var i=e(".animated-learning-item");i.text().length>0&&!forward_motion?i.text(i.text().substring(0,i.text().length-1)):i.text().length===o[s].length?(forward_motion=!1,t()):(0===i.text().length&&(s===o.length-1?s=0:s++,forward_motion=!0),i.text(o[s].substring(0,i.text().length+1)))},200)}var n,o=["curriculum","lesson plans","activities","worksheets","handouts"],s=0;setTimeout(function(){n=i()},3e3)},renderSelectRedirector:function(){e(OC.config.article.redirectSelector).change(function(){var t=e("option:selected",this).attr("data-url");void 0!==t&&(window.location.href=t)})},renderThermometer:function(){e(OC.config.article.thermometer).each(function(){e(this).parent(OC.config.article.thermometerWrapper).css("width",100-e(this).attr("data-level")+"%"),e(this).addClass("renderDifficulty")})},initCategoryLiveFilter:function(){e(OC.config.catalog.filterInput).fastLiveFilter(OC.config.catalog.filterList).focus()},renderCategoryArticles:function(){Modernizr.cssanimations?(e(OC.config.catalog.categoryPanel.item).each(function(t){var i=Math.ceil((t+1)/5);e(this).attr("style","-webkit-animation-delay:"+300*i+"ms;                             -moz-animation-delay:"+300*i+"ms;                             -o-animation-delay:"+300*i+"ms;                             animation-delay:"+300*i+"ms;"),i===e("ul.category-article-panel li").size()-1&&e("ul.category-article-panel").addClass("play")}),e(OC.config.catalog.categoryPanel.list).attr("data-liffect","slideUp"),e(OC.config.catalog.categoryPanel.list).addClass("play")):e(OC.config.catalog.categoryPanel.item).show()},renderShowMore:function(){function t(e,t){var i,n=e.split(" "),o="";for(i=0;i<n.length;i++)t>=i?o+=n[i]+" ":(i===t+1&&(o+='<span class="more_text hide">'),o+=n[i]+" ",null===n[i+1]&&(o+='</span><a href="#" class="more_link"> Show more...</a>'));return o}e(".summary-text").add('[class^="showmore"]').each(function(){var i=80;e(this).hasClass("showmore-20")?i=20:e(this).hasClass("showmore-40")?i=40:e(this).hasClass("showmore-60")?i=60:e(this).hasClass("showmore-80")?i=80:e(this).hasClass("showmore-100")&&(i=100),e(this).html(e.browser.msie?t(e(this).html(),i):t(e(this).html(),i+5)),e(this).children("span").hide()}).click(function(){var t=e(this).children("span.more_text"),i=e(this).children("a.more_link");return t.hasClass("hide")?(e(this).hasClass("summary-text")?t.show():t.slideDown("slow"),i.html(" &#171; hide"),t.removeClass("hide")):(e(this).hasClass("summary-text")?t.hide():t.slideUp("slow"),i.html(" Show more..."),t.addClass("hide")),!1})},initImageHoverDescriptions:function(){e(".pillar").mouseover(function(){function t(t){e(t).fadeIn("fast")}e(this).hasClass("pillar-community")?t("#pillars-community-description"):e(this).hasClass("pillar-innovation")?t("#pillars-innovation-description"):e(this).hasClass("pillar-freedom")&&t("#pillars-freedom-description")}),e(".pillar").mouseleave(function(){function t(t){e(t).fadeOut("fast")}e(this).hasClass("pillar-community")?t("#pillars-community-description"):e(this).hasClass("pillar-innovation")?t("#pillars-innovation-description"):e(this).hasClass("pillar-freedom")&&t("#pillars-freedom-description")}),e(".license").mouseover(function(){function t(t){e(t).fadeIn("fast")}e(this).hasClass("license-cc")?t("#license-cc-description"):e(this).hasClass("license-by")?t("#license-by-description"):e(this).hasClass("license-sa")&&t("#license-sa-description")}),e(".license").mouseleave(function(){function t(t){e(t).fadeOut("fast")}e(this).hasClass("license-cc")?t("#license-cc-description"):e(this).hasClass("license-by")?t("#license-by-description"):e(this).hasClass("license-sa")&&t("#license-sa-description")})},renderJobsCarousel:function(){e(OC.config.about.jobsCarousel).animate({left:"-1950px"},2e5)},asynchronousLogin:function(t,i){e.get("/user/api/social-availability/"+t+"/"+i+"/",function(t){"false"==t.status&&(OC.signupDialog?(OC.config.user.id=t.id,e('input[name="user"]').val(t.id),OC.config.user.username=t.username,OC.signupDialog.close(),OC.registerationSuccessCallback(),OC.setMessageBoxMessage("You have successfully logged in."),OC.showMessageBox(),OC.pushMessageBoxForward()):window.location.reload())},"json")},expediteGLogin:function(t){OC.asynchronousLogin("plus",t.id);var i,n=t.name.givenName||"",o=t.name.familyName||"";if(t.placesLived){var s=_.where(t.placesLived,{primary:!0})[0];i=s.value||""}else i="";e(OC.config.registration.fields.first_name).attr("value",n),e(OC.config.registration.fields.last_name).attr("value",o),e(OC.config.registration.fields.location).attr("value",i),e("tr.registration-username-password td:first").attr("colspan","2"),e("tr.registration-username-password td:last").remove();var r=t.image.url,a=r.substring(0,r.indexOf("?sz=")+4)+"300";e(OC.config.registration.fields.profilePicture).attr("value",a),e(OC.config.registration.fields.email).attr("value",t.email);try{e(OC.config.registration.fields.username).attr("value",t.email.substring(0,t.email.indexOf("@")))}catch(l){}e(OC.config.registration.fields.socialFlag).attr("value","true"),e(OC.config.registration.fields.socialService).attr("value","plus"),e(OC.config.registration.fields.socialID).attr("value",t.id)},googleSignInCallback:function(t){function i(){l.removeClass("faded"),OC.expediteGLogin(profile),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".login-dialog #fill-panel").remove(),e(".login-dialog #key-panel").addClass("center")}function n(n,u){a.length>0&&l.removeClass("faded"),e(".google-plus-login input[name=google_id]").val(u.id),e.post("/glogin/",e("form.google-plus-login").serialize(),function(n){if("true"===n.status){var o=e(".google-plus-login input[name=redirect_to]").val();"False"!==o&&void 0!==o?window.location.href=o:OC.signupDialog?i():window.location.href="/"}else if(0===a.length&&t["g-oauth-window"]&&r.length>0)OC.customPopup(".new-account-redirect-dialog"),setTimeout(function(){window.location.href="/signup/?expedite=plus"},3e3);else if(a.length>0)return void i()},"json"),(s.length>0||a.length>0)&&(OC.expediteGLogin(u),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".or-wrapper .or-text").removeClass("hidden"),e(".or-wrapper .or-loading").removeClass("visible"),o.removeClass("visible"),e(OC.config.registration.googleAuthResult).html("<p>You have successfully connected to Google. Just need to confirm a few more details below...</p>"),e(OC.config.registration.orWrapper).hide(),a.length>0&&(e(".login-dialog #fill-panel").remove(),e(".login-dialog #key-panel").addClass("center")))
}var o=e(".registration-cover"),s=e("#signup-form"),r=e("#sign-in-form"),a=e(".login-dialog"),l=e(".oc-popup-body",a);(t["g-oauth-window"]||o.length>0&&"plus"===o.attr("title"))&&(e(".or-wrapper .or-text").addClass("hidden"),e(".or-wrapper .or-loading").addClass("visible"),OC.googleAuthenticationCallback(t,n),a.length>0&&l.addClass("faded"))},googleAuthenticationCallback:function(t,i){if(t.code){t.state=e("#session-state").attr("data-state");var n;gapi.client.load("oauth2","v2",function(){var e=gapi.client.oauth2.userinfo.get();e.execute(function(e){n=e.email})}),gapi.client.load("plus","v1",function(){var o=gapi.client.plus.people.get({userId:"me"});o.execute(function(o){var s={code:t.code,state:t.state,gplus_id:o.id};o.email=n,e.ajax({type:"POST",url:OC.config.registration.googleAuthURL,dataType:"json",contentType:"application/octet-stream; charset=utf-8",success:function(e){i(e,o)},data:s})})})}else t.error},facebookRegistrationCallback:function(t){var i=e(".registration-cover");("connected"===t.status||i.length>0&&"facebook"===i.attr("title"))&&(e(".or-wrapper .or-text").addClass("hidden"),e(".or-wrapper .or-loading").addClass("visible"),FB.api("/me",function(t){OC.expediteFbLogin(t),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".or-wrapper .or-text").removeClass("hidden"),e(".or-wrapper .or-loading").removeClass("visible"),i.removeClass("visible")}),e(OC.config.registration.googleAuthResult).html("<p>You have successfully connected to your Facebook account.  Just need to confirm a few more details below...</p>"),e(OC.config.registration.orWrapper).hide())},expediteFbLogin:function(t){OC.asynchronousLogin("facebook",t.id);var i,n=t.first_name||"",o=t.last_name||"";i=t.location?t.location.name||"":"",e(OC.config.registration.fields.first_name).attr("value",n),e(OC.config.registration.fields.last_name).attr("value",o),e(OC.config.registration.fields.location).attr("value",i),e("tr.registration-username-password td:first").attr("colspan","2"),e("tr.registration-username-password td:last").remove(),FB.api("/me/picture?width=300",function(t){e(OC.config.registration.fields.profilePicture).attr("value",t.data.url)}),e(OC.config.registration.fields.email).attr("value",t.email),e(OC.config.registration.fields.username).attr("value",t.username),e(OC.config.registration.fields.socialFlag).attr("value","true"),e(OC.config.registration.fields.socialService).attr("value","facebook"),e(OC.config.registration.fields.socialID).attr("value",t.id)},facebookSignInCallback:function(){function t(){s.removeClass("faded"),OC.expediteFbLogin(i),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".login-dialog #fill-panel").remove(),e(".login-dialog #key-panel").addClass("center")}var i,n=(e("#signup-form"),e("#sign-in-form")),o=e(".login-dialog"),s=e(".oc-popup-body",o);o.length>0&&s.addClass("faded"),FB.login(function(s){"connected"===s.status&&FB.api("/me",function(s){i=s,e("form.facebook-login input[name=facebook_id]").val(s.id),e.post("/fblogin/",e("form.facebook-login").serialize(),function(i){if("true"===i.status){var s=e(".facebook-login input[name=redirect_to]").val();"False"!==s&&""!==s?window.location.href=s:OC.signupDialog?t():window.location.href="/"}else 0===o.length&&n.length>0?(OC.customPopup(".new-account-redirect-dialog"),setTimeout(function(){window.location.href="/signup/?expedite=facebook"},2e3)):o.length>0&&t()},"json")})},{scope:"public_profile, email"})},initInviteSignup:function(){e(OC.config.invite.formSelector).submit(function(){var t=e(this),i="#"+t.attr("id");return e(OC.config.invite.formSpinner,t).show(),e(i+"-error").slideUp("fast"),e(OC.config.invite.formError,t).removeClass("form-error-show"),e.ajax({data:e(this).serialize(),type:"POST",url:e(this).attr("action"),success:function(n){e(OC.config.invite.formSpinner,t).hide();var o=n.status,s=n.message,r=!1;o===!1||"false"===o?(["name","organization","email"].forEach(function(i){if(s[i]){var n=e("."+i+"-error",t);n.html(s[i][0]),n.addClass("form-error-show"),e("#id_"+i,t).addClass("form-input-error"),r=!0}}),r||(e(i+"-error").html(s),e(i+"-error").slideDown("fast"))):o&&t.fadeOut("fast",function(){var t='<div class="success-check"></div>';e(i+"-success").html(t+s),e(i+"-success").slideDown("fast")})}}),!1})},initRegistrationForm:function(){e("#signup-form input[title]:not(.form-input-error)").tipsy({trigger:"focus",gravity:"n"}),e("#signup-form input[title].form-input-error").tipsy({trigger:"manual",gravity:"n",fade:!0}),e("#signup-form input.form-input-error").each(function(){error_input=e(this),error_input.change(function(){error_input.removeClass("form-input-error"),error_input.tipsy("hide")}),error_input.tipsy("show")}),e(OC.config.registration.ToS).change(function(){e("#"+OC.config.registration.signUpButtonID).toggleClass("disabled");var t=document.getElementById(OC.config.registration.signUpButtonID);t.disabled=!t.disabled}),e("form#signup-form input[name=social_login]").length>0&&"true"===e("form#signup-form input[name=social_login]").attr("value").toLowerCase()&&(e(".social-login-hide").hide(),e("aside.content-block.google-signin").hide(),e("#new-account-signup-info").hide()),e(".synchronous-signup .facebook-button").click(function(){FB.login(function(e){"connected"===e.status&&OC.facebookRegistrationCallback(e)},{scope:"public_profile, email"})}),-1!==window.location.search.indexOf("expedite=facebook")&&setTimeout(function(){FB.login(function(){},{scope:"public_profile, email"})},1e3),e("#sign-in-form .facebook-button, .login-dialog .facebook-button").click(function(e){return OC.facebookSignInCallback(),e.stopPropagation(),e.preventDefault(),!1}),e(".google-plus-button").click(function(e){return e.stopPropagation(),e.preventDefault(),!1}),e("#session-state").length>0&&""!==e("#session-state").attr("data-state")&&OC.initializeGooglePlusButtons(),e("form#signup-form button.large-action-button").click(function(t){var i=e(this),n=OC.highlightAndReturnErroneousInputs(!0);if(0===n.length&&OC.signupDialog){var o=e("form#signup-form").serialize();i.addClass("loading"),e.post("/user/api/register-asynchronously/",o,function(t){i.removeClass("loading"),OC.signupDialog.close(),OC.registerationSuccessCallback(),OC.config.user.id=t.id,e('input[name="user"]').val(t.id),OC.config.user.username=t.username,OC.setMessageBoxMessage(t.name+", your account has successfully been set up."),OC.showMessageBox(),OC.pushMessageBoxForward()},"json")}else 0===n.length&&(e(".page-form-submission-loader").addClass("show"),i.parents("form#signup-form").submit());return t.stopPropagation(),t.preventDefault(),!1}),OC.liveValidateRegistrationForm()},highlightAndReturnErroneousInputs:function(t){var i=['input[name="first_name"]','input[name="last_name"]','input[name="email"]','input[name="username"]','input[name="dob_date"]','input[name="dob_year"]','select[name="dob_month"]'];t&&i.push('input[name="password"]');var n,o,s=[];for(n=0;n<i.length;n++)o=e("form#signup-form "+i[n]),(""===o.val()||"0"===o.val())&&o.addClass("form-input-error"),o.hasClass("form-input-error")&&s.push(o);return s},liveValidateRegistrationForm:function(){OC.validate.text('#signup-form input[name="first_name"], #signup-form input[name="last_name"]',/[A-Za-z-]{1,16}[\s]?/,"The name must contain only letters and not be more than 16 letters."),OC.validate.text('#signup-form input[name="email"]',/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,"The email address is invalid"),e('#signup-form input[name="username"]').blur(function(){var t=e(this);""!==t.val()&&(t.addClass("loading"),e.get("/user/api/username-availability/"+t.val()+"/",function(e){t.removeClass("loading"),"false"==e.status?(t.addClass("unavailable"),t.addClass("form-input-error"),t.attr("title","This username is not available"),t.tipsy({trigger:"manual",gravity:"n",fade:!0}),t.tipsy("show")):(t.hasClass("form-input-error")||t.tipsy("hide"),t.removeClass("unavailable"),t.removeClass("form-input-error"),t.addClass("available"))},"json"))}),OC.validate.text('#signup-form input[name="username"]',/^[a-z][a-z0-9_\.]{3,30}$/,"Username should be all lowercase, cannot begin with a number and must only have letters and digits and/or underscores."),OC.validate.text('#signup-form input[name="password"]',/[\w\.\!\@\#\$\%\^\*\&<>]+/,"Password should contain valid characters"),OC.validate.date('#signup-form select[name="dob_month"]','#signup-form input[name="dob_date"]','#signup-form input[name="dob_year"]',{DOB_OUT_OF_RANGE:"The date of birth is out of range",DOB_AFTER_TODAY:"The date of birth cannot be later than today",DOB_LESS_THAN_THIRTEEN:"You need to be above 13 years of age to sign up",DOB_INCORRECT:"The date of birth is incorrect",DOB_NO_MONTH:"You need to select a month of birth"})},validate:{invalidate:function(e,t){e.addClass("form-input-error"),e.attr("title",t),e.tipsy({trigger:"manual",gravity:"n",fade:!0}),e.tipsy("show")},pass:function(e){e.removeClass("form-input-error"),e.tipsy("hide")},text:function(t,i,n){function o(t){r=e(t.target),r.hasClass("form-input-error")&&r.val().match(i)&&r.val().match(i)[0]===r.val()&&OC.validate.pass(r)}function s(t){r=e(t.target),r.val().match(i)?r.val().match(i)[0]!==r.val()&&OC.validate.invalidate(r,n):OC.validate.invalidate(r,n)}var r,a=e(t);a.keyup(o),a.blur(s),a.change(s)},confirm:function(t,i,n){var o,s=e(t),r=e(i);s.blur(function(t){o=e(t.target),o.val()!==r.val()?OC.validate.invalidate(o,n):OC.validate.pass(o)})},date:function(t,i,n,o){var s,r=e(t),a=e(i),l=e(n);r.blur(function(t){s=e(t.target),0===parseInt(s.val(),10)?OC.validate.invalidate(s,o.DOB_NO_MONTH):s.hasClass("form-input-error")&&OC.validate.pass(s)}),a.blur(function(t){s=e(t.target),a.val().match(/[3][0-1]|[0-2]\d|^[1-9]$/)?s.hasClass("form-input-error")&&OC.validate.pass(s):OC.validate.invalidate(s,o.DOB_INCORRECT)}),l.blur(function(t){if(s=e(t.target),s.val().match(/\d{4}/))if(s.val().match(/\d{4}/)==s.val()){var i=parseInt(s.val(),10),n=new Date;1900>i?OC.validate.invalidate(s,o.DOB_OUT_OF_RANGE):i>n.getFullYear()?OC.validate.invalidate(s,o.DOB_AFTER_TODAY):n.getFullYear()-i<=12?OC.validate.invalidate(s,o.DOB_LESS_THAN_THIRTEEN):s.hasClass("form-input-error")&&OC.validate.pass(s)}else OC.validate.invalidate(s,o.DOB_INCORRECT)})}},emailShare:function(t,i,n,o){e("#email-share-success, #email-share-error").hide();var s=e("#share-via-email .form-spinner");s.show(),e.ajax({type:"POST",url:"/api/emailShare/",dataType:"json",contentType:"application/octet-stream; charset=utf-8",data:{email:t,message:i,from_name:n,from_address:o},success:function(t){s.hide();var i=t.status;"true"===i?(e("#email-share-success").html("You have successfully shared this resource over email"),e("#email-share-success").fadeIn("fast")):(e("#email-share-error").html("Your message could not be sent. Kindly check the above fields again"),e("#email-share-error").fadeIn("fast"))}})},commentSubmissionHandler:function(t,i){if("success"===t.status){var n=e("<div/>",{"class":"resource"}),o=e("<div/>",{"class":"resource-thumbnail",style:"background-image:url("+t.message.profile_pic+")"}),s=e("<div/>",{"class":"description"}),r=e("<span/>",{"class":"bold",text:t.message.name});s.append(r),s.append(" on "+t.message.created),s.append(t.message.body),o.appendTo(n),s.appendTo(n),i.text(""),i.val(""),e("#comments").prepend(n)}else e("#comment-fail").dialog({modal:!0,open:!1,width:360,buttons:{Ok:function(){e(this).dialog("close")}}})},scrollBind:function(t,i){e(t).click(function(){e("html, body").animate({scrollTop:e(i).offset().top},1e3)})},commentHandler:function(){e("#revision-comment button").click(function(t){var i=e("#revision-comment .form-spinner");i.show();var n=e("#revision-comment textarea[name=body_markdown]");return e.post("/interactions/comment/",e("#revision-comment").serialize(),function(e){OC.commentSubmissionHandler(e,n),i.hide()},"json"),t.stopPropagation(),t.preventDefault(),!1})},emailShareHandler:function(){e(".share-on-email").click(function(){return e("#email-share-dialog").dialog({modal:!0,open:!1,width:560,buttons:{Send:function(){OC.emailShare(e("#email-share-address").attr("value"),e("#email-share-message").attr("value"),e("#email-from-name").attr("value"),e("#email-from-address").attr("value"))},Close:function(){e("#email-share-success, #email-share-error").hide(),e(this).dialog("close")}}}),!1})},setupUserMenu:function(){OC.setUpMenuPositioning("nav#user-menu","#user-dropdown"),e(window).resize(function(){OC.setUpMenuPositioning("nav#user-menu","#user-dropdown")}),e("#user-buttons > ul > li.user-firstname-wrapper a, nav#user-menu").mouseenter(function(){e("#user-buttons > ul > li.user-firstname-wrapper a .horizontal-caret").addClass("horizontal-caret-hover"),e("#user-buttons > ul > li.user-firstname-wrapper a").addClass("hover"),e("#user-menu").addClass("showMenu")}).mouseleave(function(){e("#user-buttons > ul > li.user-firstname-wrapper a .horizontal-caret").removeClass("horizontal-caret-hover"),e("#user-buttons > ul > li.user-firstname-wrapper a").removeClass("hover"),e("#user-menu").removeClass("showMenu")}),OC.setUpMenuPositioning("nav#share-menu","li.share-action",!0)},setupShareMenu:function(){var t;e("button.share-button").click(function(e){return t=OC.customPopup(".share-dialog"),e.preventDefault(),e.stopPropagation(),!1}),e(".share-on-email").click(function(){t.close()})},setupAddTo:function(){var t=e('form#resource-form input[name="resource_id"]').val(),i=e("form#resource-form input[name=collection_id]").val();e("li.add-action a").click(function(e){OC.addCopyClickHandler("resource",t,i,e)})},addCopyClickHandler:function(t,i,n,o){OC.tabs(".add-resource-browser");var s=OC.customPopup(".add-resource-dialog"),r=e(".add-resource-profile-browser"),a=e(".add-resource-project-browser");r.addClass("loading-browser"),a.addClass("loading-browser"),e(".add-resource-submit-button").click(function(){var o,l=e(".add-resource-dialog .add-resource-tabs li a.selected");if(o=".my-projects"===l.attr("href")?a.find(".selected-destination-collection"):r.find(".selected-destination-collection"),s.close(),o){var u=OC.customPopup(".add-resource-action-dialog");e(".add-resource-action-submit-button").click(function(s){u.close();var r=e("#add-resource-action-form input[name=add-action]:checked"),a=o.attr("id").substring(11);return"copy"===r.val()?"collection"==t?OC.collection.copy(n,i,a,OC.collection.successfullyCopied):OC.resource.copy(n,i,a,OC.resource.successfullyCopied):("collection"==t&&OC.popup("The feature to link folders does not exist at this point. Sorry for the inconvenience","Cannot link folders"),OC.resource.link(n,i,a,OC.resource.successfullyLinked)),s.preventDefault(),s.stopPropagation(),!1})}}),0===r.children().length&&e.get("/resources/tree/collections/user/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,r),r.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json");var l=e('.add-resource-tabs li a[href=".my-projects"]');return l.hasClickEventListener()||l.click(OC.addToProjectsTabClickHandler),o.preventDefault(),o.stopPropagation(),!1},renderBrowser:function(t,i,n){i.html(t),i.find("a#collection-"+n).addClass("current-collection"),i.click(function(){i.find("a.selected-destination-collection").removeClass("selected-destination-collection"),i.find("a.selected-destination-resource").removeClass("selected-destination-resource")}),i.find("a").click(function(t){var n=i.find("a.selected-destination-collection, a.selected-destination-resource");if(!e(t.target).hasClass("current-collection")&&(n.removeClass("selected-destination-collection"),n.removeClass("selected-destination-resource"),n[0]!==t.target)){var o=e(t.target);o.toggleClass(-1!==o.attr("id").indexOf("collection")?"selected-destination-collection":"selected-destination-resource")}return t.stopPropagation(),t.preventDefault(),!1}),e("ul li.parent-collection > .toggle-collection",i).click(OC.parentCollectionClickHandler),e("ul li.parent-category > .toggle-category",i).click(OC.parentCollectionClickHandler)},addToProjectsTabClickHandler:function(){{var t=e(".add-resource-project-browser");e("form#resource-form input[name=collection_id]").val()}0===t.children().length&&e.get("/resources/tree/collections/projects/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,t),t.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json")},initShowMoreBlock:function(){function t(t){var i=200,n=s(),o=[],r=0;for(r;r<t.length;r++)e(t[r]).height()>i&&(e(t[r]).parent().append(n.clone()),e(t[r]).addClass("compressed"),o.push(e(t[r])));return o}function i(t){var i=0;for(i;i<t.length;i++){var o=e(".show-more",t[i].parent());1==o.length&&e(".show-more-text",o).click({block:e(t[i])},n)}}function n(t){t.data.block.removeClass("compressed");var i=e(".show-more",t.data.block.parent());e(".show-more-text",i).off(),r(e(".show-more-text",i),!1),e(".show-more-text",i).click({block:t.data.block},o)}function o(t){t.data.block.addClass("compressed");var i=e(".show-more",t.data.block.parent());e(".show-more-text",i).off(),r(e(".show-more-text",i),!0),e(".show-more-text",i).click({block:t.data.block},n)}function s(){var t=e("<div/>",{"class":"show-more"}),i=e("<span/>",{"class":"show-more-text",text:"SHOW MORE"});return t.append(i),t}function r(e,t){e.text(t?"SHOW MORE":"SHOW LESS")}var a=[".profile-contributions-list",".home-projects-listing"],l=t(a);i(l)},bindEditHeadlineHandler:function(){e(".profile-headline").keypress(function(t){if(13==t.which){t.preventDefault(),e(".profile-headline").blur();var i=e(".profile-headline").text(),n=e(".profile-headline").attr("title"),o=e(".profile-headline").parent("form").children("input[name=user_id]").val();if(n!=i){var s=e(".profile-headline").parent(".profile-headline-wrapper").children(".headline-edit");s.addClass("changing"),e.post("/user/api/headline/"+o+"/edit/",{new_headline:i},function(){s.removeClass("changing")},"json")}}})},initNotificationHandler:function(){OC.setUpMenuPositioning("nav#notifications-menu",".user-notification-count"),e(window).resize(function(){OC.setUpMenuPositioning("nav#notifications-menu",".user-notification-count")}),OC.setupNotificationsMenu()},setupNotificationsMenu:function(){e("nav#user-buttons > ul > li.user-notification-count").click(function(t){e("#notifications-menu").toggleClass("showMenu"),e("li.user-notification-count").toggleClass("menu-open");var i=e("nav#user-buttons > ul > li.user-notification-count");return i.hasClass("unread-notifications")&&(i.removeClass("unread-notifications"),OC.dismissUnreadNotifications(),e("li.user-notification-count").addClass("empty-notifications")),t.stopPropagation(),t.preventDefault(),!1}),OC.closeMenusHandler()},dismissUnreadNotifications:function(){var t,i=e("nav#notifications-menu > ul > li > a.new-notification"),n=[];for(t=0;t<i.length;t++){notification_id=e(i[t]).attr("id");var o="notification-";n.push(notification_id.substring(o.length))}var s=e("#user-info input[name=user_id]").val();e.get("/user/api/notifications/dismiss/"+s+"/?ids="+n.join(","),function(){},"json")},closeMenusHandler:function(){e("body").on("click",function(){var t,i=e(".showMenu");for(t=0;t<i.length;t++)e(i[t]).removeClass("showMenu");var n,o=e(".menu-open");for(n=0;n<o.length;n++)e(o[n]).removeClass("menu-open")})},initArticleCenter:function(){OC.tabs(".introduction-contributor-faqs"),e(".article-labels span").tipsy(),e(".article-objectives-title").click(function(){e(this).parent().toggleClass("show-objectives")})},initAddResource:function(){OC.setUpMenuPositioning("nav#add-resource-menu",".create-new-resource-button a"),e(window).resize(function(){OC.setUpMenuPositioning("nav#add-resource-menu",".create-new-resource-button a")}),OC.setupResourceMenu()},setupResourceMenu:function(){e(".create-new-resource-button a, nav#add-resource-menu").mouseenter(function(){e(".create-new-resource-button a").addClass("hover"),e("#add-resource-menu").addClass("showMenu")}).mouseleave(function(){e(".create-new-resource-button a").removeClass("hover"),e("#add-resource-menu").removeClass("showMenu")})},initCreateCollection:function(){e("nav#add-resource-menu .add-collection a, nav.profile-resources-collections-actions-menu-add .add-collection a").click(function(t){return e(".new-collection-dialog").dialog({modal:!0,open:!1,width:500,buttons:{Ok:function(){var t=e("form#new-collection-form input[name=new_collection_name]");""===t.val()?t.addClass("form-input-error"):(e(this).dialog("close"),e("form#new-collection-form").submit())},Cancel:function(){e(this).dialog("close")}}}),t.stopPropagation(),t.preventDefault(),!1})},initCreateGroup:function(){e("nav#add-resource-menu .add-group a, .new-group-wrapper, a.new-groups-link").click(function(e){OC.customPopup(".new-group-dialog");return e.stopPropagation(),e.preventDefault(),!1})},initUpload:function(){e("nav#add-resource-menu .add-upload a, .profile-resources-collections-actions-menu-add .add-upload a,a.new-upload-suggestion").click(function(e){OC.customPopup(".post-new-upload-dialog");return e.stopPropagation(),e.preventDefault(),!1})},getLicenses:function(t){OC.config.licenses?t(OC.config.licenses):e.get("/license/api/list/",function(e){"true"===e.status?(OC.config.licenses=e.licenses,t(e.licenses)):OC.popup(e.message,e.title)},"json")},initLink:function(){e("nav#add-resource-menu .add-link a, .profile-resources-collections-actions-menu-add .add-link a").click(function(t){OC.getLicenses(function(t){var i,n,o=e('select[name="license"]');for(i=0;i<t.length;i++)n=e("<option/>",{value:t[i].id,text:t[i].title}),o.append(n)});OC.customPopup(".new-link-dialog");return t.stopPropagation(),t.preventDefault(),!1})},bindDeleteResourceHandler:function(){e(".profile-resource-delete, .project-resource-delete").click(function(t){var i=e(this),n=i.attr("id").substring(9),o=e(".resources-collections-added").attr("id").substring(11);return OC.resource.delete(n,o,callback),t.preventDefault(),t.stopPropagation(),!1})},bindDeleteCollectionHandler:function(){e(".profile-collection-delete, .project-collection-delete").click(function(t){function i(t){e(".resource-collection-item#collection-"+t).fadeOut()}var n=e(this),o=n.attr("id").substring(11);return OC.collection.delete(o,i),t.preventDefault(),t.stopPropagation(),!1})},initCollectionsTree:function(){e("nav.collections-navigation ul li.parent-collection > .toggle-collection").click(OC.parentCollectionClickHandler)},initMessageBox:function(){var t=e(".login-messages-wrapper");""!==OC.getMessageBoxMessage()&&OC.showMessageBox(),e(".close-message-box",t).click(OC.dismissMessageBox)},setMessageBoxMessage:function(t){var i=e(".login-messages");i.text(t)},getMessageBoxMessage:function(){var t=e(".login-messages");return t.text()},showMessageBox:function(){var t=e(".login-messages-wrapper");t.addClass("show-messages"),OC.repositionMessageBox()},pushMessageBoxForward:function(){var t=e(".login-messages-wrapper");t.addClass("push-forward")},dismissMessageBox:function(){var t=e(".login-messages-wrapper");OC.setMessageBoxMessage(""),t.removeClass("show-messages")},repositionMessageBox:function(){var t=e(window).width(),i=e(".login-messages-wrapper"),n=i.width();i.css("left",t/2-n/2)},parentCollectionClickHandler:function(t){var i=e(t.target).closest("li");return i.toggleClass("opened-collection"),e("> ul",i).toggle(),t.preventDefault(),t.stopPropagation(),!1},initForgotAuth:function(){e("#forgot-username-password a").click(function(t){return e(".forgot-username-password-dialog").dialog({modal:!0,open:!1,width:500,buttons:{Submit:function(){e(this).dialog("close"),e("form.forgot-username-password-form").submit()},Cancel:function(){e(this).dialog("close")}}}),t.preventDefault(),t.stopPropagation(),!1})},initChangePassword:function(){e("#change-password").click(function(t){OC.customPopup(".change-password-dialog");return OC.validate.text('.change-password-dialog input[name="new_password"]',/[\w\.\!\@\#\$\%\^\*\&]+/,"Password should contain valid characters"),OC.validate.confirm('.change-password-dialog input[name="confirm_password"]','.change-password-dialog input[name="new_password"]',"Both passwords do not match"),e(".change-password-submit-button").click(function(t){var i=e('.change-password-dialog input[name="confirm_password"]');return i.hasClass("form-input-error")?(t.preventDefault(),t.stopPropagation(),!1):void e("#change-password-form").submit()}),t.preventDefault(),t.stopPropagation(),!1})},initResourceView:function(){if(e(".history-action img").tipsy({gravity:"w"}),e(".toggle-content-title-wrapper").click(OC.togglerClickHandler),e(".oer-meta-support-tag").tipsy({gravity:"s"}),-1!=document.referrer.split("/").indexOf("browse")){setTimeout(function(){e(".need-more-info").animate({top:0},1500)},3e3);var t=e(".need-more-info"),i=e('form#resource-form input[name="resource_id"]').val();if(i){e(".need-more-info-button").click(function(){function n(){e.get("/resources/api/request-for-information/"+i+"/",function(i){"true"===i.status&&t.animate({opacity:0},500,function(){e(this).text("Your request for more information has been sent. You will receive an email once the information is ready for you")}).animate({opacity:1,height:28,"margin-bottom":-40},500,function(){setTimeout(function(){t.animate({top:-56})},6e3)})},"json")}if(OC.config.user.id)n();else{var o="We can send you the info only if you have a free account, so please sign up. It takes only 30 seconds!";OC.launchSignupDialog(o,n)}});var n=e(".resource-comments"),o=e(".request-resource-review");e(window).on("DOMContentLoaded load resize scroll",function(){isElementInViewport(n)&&!n.hasClass("visible")&&(o.animate({top:-56},1500),o.addClass("visible"))});var s=e(".request-resource-review-stars .empty-star");s.hover(function(){s.removeClass("hover");var t,i,n=this;for(t=0;t<s.length&&(i=e(s[t]),i.addClass("hover"),s[t]!==n);t++);e(this).addClass("")}),e(".request-resource-review-stars").mouseleave(function(){s.removeClass("hover")});var r=_.template('<div class="resource-review"><div class="resource-review-user"><div class="resource-review-user-thumbnail" style="background-image: url(\'<%= profile_pic %>\');"></div><div class="resource-review-user-description"><div><a href="<%= user_url %>"><%= name %></a><%= stars %></div><div class="resource-review-user-date"><%= created %></div></div></div><div class="resource-review-body"><%= body %></div></div>');e(".request-resource-review .empty-star").click(function(){var t=OC.customPopup(".review-comment-dialog"),i=this,n=e("form#review-comment-form",t.dialog);e('input[name="stars"]',n).val(s.index(i)+1);var a=e(".review-comment-done-button",t.dialog);a.click(function(){function i(){t.close(),e.post("/interactions/review-resource/",n.serialize(),function(t){if("true"===t.status){o.animate({top:0},500);var i,n=e("<div/>",{"class":"resource-review-user-description-stars"});for(i=0;i<t.review.stars;i++)n.append(e("<span/>",{"class":"full-star"}));t.review.stars=n.get(0).outerHTML;var s=r(t.review),a=e(".resource-review");a.length>0?e(".resource-reviews").append(s):e(".resource-reviews").html(s),OC.setMessageBoxMessage("Successfully posted your review!"),OC.showMessageBox()}else OC.popup(t.message,t.title)},"json")}if(OC.config.user.id)i();else{var s="Please login or create an account (takes 30 seconds!) to complete posting of the review.";OC.launchSignupDialog(s,i)}})})}}},togglerClickHandler:function(){var t=e(this);body=t.parent(".toggle-content").find(".toggle-content-body"),t.hasClass("open")?(t.removeClass("open"),body.slideUp()):(t.addClass("open"),body.slideDown())},initFavoriteResource:function(){function t(e,t){t&&(n.addClass("favorited"),n.text("Favorited"))}var i=e("form#resource-form input[name=resource_id]").val(),n=(e("form.profile-favorite-form input[name=user_id]").val(),e("button.favorite-button"));i?(OC.getFavoriteState("resource",i,t),n.click(function(){var t=e(this);OC.favoriteClickHandler("resource",i,function(){t.addClass("favorited"),t.text("Favorited")},function(){t.removeClass("favorited"),t.text("Favorite")})})):n.click(function(e){return OC.popup("You must be logged in to favorite a resource","Log in to favorite resource"),e.preventDefault(),e.stopPropagation(),!1})},favoriteClickHandler:function(t,i,n,o,s){function r(){e.get("/interactions/favorite/"+t+"/"+i+"/",function(e){"true"==e.status?n(s):"unfavorite success"==e.status&&o(s)},"json")}if(OC.config.user.id)r();else{var a="To favorite this resource to your account, please login or create a free account (takes 30 seconds!).";OC.launchSignupDialog(a,r)}},getFavoriteState:function(t,i,n){e.get("/interactions/favorite/state/"+t+"/"+i+"/",function(e){if("true"==e.status){var t;t="true"==e.favorite.state?!0:!1,n(i,t)}},"json")},getSubscriptionState:function(t,i){var n=t.join();e.get("/user/api/subscribe/state/users/?ids="+n,function(e){"true"==e.status&&i(e.subscription_states)},"json")},initUpvoteDownvoteResource:function(){var t=e("form#resource-form input[name=resource_id]").val(),i=e("form#resource-form input[name=user_id]").val(),n=e("form#resource-form input[name=revision_id]").val(),o=e(".article-community li.thumbs-up-action"),s=e(".article-community li.thumbs-down-action"),r=e(".count",o),a=e(".count",s);if(t){var l;l=n?"/interactions/votes/count/resource/"+t+"/revision/"+n+"/":"/interactions/votes/count/resource/"+t+"/",e.get(l,function(e){"true"==e.status&&(r.text(e.upvote_count),a.text(e.downvote_count),"true"==e.user_upvoted&&s.addClass("user-upvoted"),"true"==e.user_downvoted&&s.addClass("user-downvoted"))},"json")}if(i){var u;e("a",o).click(function(i){return u=n?"/interactions/vote/up/resource/"+t+"/revision/"+n+"/":"/interactions/vote/up/resource/"+t+"/",e.get(u,function(e){"true"==e.status?"unvote"==e.action?(o.removeClass("user-upvoted"),r.text(parseInt(r.text(),10)-1)):(o.addClass("user-upvoted"),r.text(parseInt(r.text(),10)+1)):OC.popup(e.message,e.title)},"json"),i.preventDefault(),i.stopPropagation(),!1}),e("a",s).click(function(i){return u=n?"/interactions/vote/down/resource/"+t+"/revision/"+n+"/":"/interactions/vote/down/resource/"+t+"/",e.get(u,function(e){"true"==e.status?"unvote"==e.action?(s.removeClass("user-downvoted"),a.text(parseInt(a.text(),10)-1)):(s.addClass("user-downvoted"),a.text(parseInt(a.text(),10)+1)):OC.popup(e.message,e.title)},"json"),i.preventDefault(),i.stopPropagation(),!1})}else e("a",o).click(function(e){return OC.popup("You must be logged in to upvote a resource","Log in to upvote resource"),e.preventDefault(),e.stopPropagation(),!1}),e("a",s).click(function(e){return OC.popup("You must be logged in to downvote a resource","Log in to downvote resource"),e.preventDefault(),e.stopPropagation(),!1})},initPrintResource:function(){e(".print-action a").click(function(e){return window.print(),e.preventDefault(),e.stopPropagation(),!1})},initExportResource:function(){e("li.download-as a").click(function(t){return e("#download-menu").addClass("showMenu"),t.preventDefault(),t.stopPropagation(),!1}),e("li.download-as, nav#download-menu").mouseenter(function(){e("#download-menu").addClass("showMenu")}).mouseleave(function(){e("#download-menu").removeClass("showMenu")}),OC.setUpMenuPositioning("nav#download-menu","li.download-as",!1),e(".export-action a").click(function(t){var i=OC.customPopup(".export-document-pdf-dialog"),n=OC.progressBar(".export-document-pdf-progress",{startAt:30}),o=e(".export-document-pdf-status"),s=e("form#resource-form input[name=resource_id]").val();return e.get("/resources/"+s+"/build-export-document/",function(e){if("true"==e.status)if("WebSocket"in window){o.text("Building document..."),n.advanceTo(50);var t=new WebSocket("ws://services.opencurriculum.org:1337/");t.onopen=function(){e.type="pdf",t.send(JSON.stringify(e))},t.onmessage=function(e){if(data=JSON.parse(e.data),data.documentReceived){o.text("Generating PDF..."),n.advanceTo(60);var t=60;setInterval(function(){80>=t&&n.advanceTo(++t)},100)}else data.documentProcessed&&(o.text("Finished! Opening PDF..."),n.advanceTo(100),setTimeout(function(){window.open(data.url,"_blank"),i.close()
},500))}}else o.text("Generating PDF..."),n.advanceTo(50);else OC.popup(e.message,e.title)},"json"),t.preventDefault(),t.stopPropagation(),!1}),e(".word-action a").click(function(t){var i=OC.customPopup(".export-document-word-dialog"),n=OC.progressBar(".export-document-word-progress",{startAt:30}),o=e(".export-document-word-status"),s=e("form#resource-form input[name=resource_id]").val();return e.get("/resources/"+s+"/build-export-document/",function(e){if("true"==e.status)if("WebSocket"in window){o.text("Building document..."),n.advanceTo(50);var t=new WebSocket("ws://services.opencurriculum.org:1337/");t.onopen=function(){e.type="word",t.send(JSON.stringify(e))},t.onmessage=function(e){if(data=JSON.parse(e.data),data.documentReceived){o.text("Generating Word file..."),n.advanceTo(60);var t=60;setInterval(function(){80>=t&&n.advanceTo(++t)},100)}else data.documentProcessed&&(o.text("Finished! Opening Word file..."),n.advanceTo(100),setTimeout(function(){window.open(data.url,"_blank"),i.close()},500))}}else o.text("Generating PDF..."),n.advanceTo(50);else OC.popup(e.message,e.title)},"json"),t.preventDefault(),t.stopPropagation(),!1})},initProfileCreateResource:function(){e(".add-unit").click(function(e){return OC.customPopup(".new-unit-dialog"),e.preventDefault(),e.stopPropagation(),!1})},initProfileSubscribers:function(){function t(t){var o,s;for(i=0;i<n.length;i++)o=e(".subscribe-suggestion-form input[name=user_id][value="+n[i]+"]"),s=o.parents("form.subscribe-suggestion-form").find("button.subscribe-button"),t[parseInt(n[i],10)]&&(s.addClass("subscribed"),s.text("✔ Subscribed"))}var i,n=[];e(".subscribe-suggestion-form").each(function(){e("button.subscribe-button",this).length>0&&n.push(e("input[name=user_id]",this).val())}),n.length>0&&OC.getSubscriptionState(n,t)},initEditResource:function(){e("form.resource-create-edit-form #submission-buttons button[type=submit]").click(function(t){return"save"===action?e("#article-edit-form").submit():e("#log-message").dialog({modal:!0,open:!1,buttons:{Ok:function(){e(this).dialog("close"),e("input[name=log]").attr("value",e("input[name=log_message]").attr("value")),e("#article-edit-form").submit()},Cancel:function(){return e(this).dialog("close"),!1}}}),t.stopPropagation(),t.preventDefault(),!1})},initPictureManipulation:function(){OC.initEditHandlers(),OC.repositionPictures.initRepositionPictures()},initEditHandlers:function(){e(".change-picture").click(function(){e(".picture-upload-dialog").dialog({modal:!0,open:!1,width:OC.config.popup.width,buttons:{Upload:function(){e(".picture-upload-dialog form").submit(),e(this).dialog("close")}}})}),e(".change-picture").tipsy({gravity:"s"})},repositionPictures:{originalRepositionableTop:0,originalRepositionableLeft:0,repositionSetup:!1,userProfile:{selector:".user-picture-cover",positionerSelector:".user-picture-repositioner",container:"user-picture-repositioner-container",wrapperSelector:".user-profile-picture",copy:"user-profile-picture-copy"},projectCover:{selector:"#project-header",positionerSelector:".project-header-repositioner",container:"project-header-repositioner-container",wrapperSelector:".project-header-wrapper",copy:"project-header-picture-copy"},image:null,initRepositionPictures:function(){e(".reposition-picture").tipsy({gravity:"s"}),e("form#profile-picture-reposition-form").length>0&&(OC.repositionPictures.image=OC.repositionPictures.userProfile),e("form#project-cover-reposition-form").length>0&&(OC.repositionPictures.image=OC.repositionPictures.projectCover),OC.repositionPictures.image&&(e(".reposition-picture").click(OC.repositionPictures.repositionClickHandler),backgroundPosition=OC.repositionPictures.getPictureBackgroundPosition(),OC.repositionPictures.originalRepositionableTop=backgroundPosition.top,OC.repositionPictures.originalRepositionableLeft=backgroundPosition.left)},getPictureBackgroundPosition:function(){var t=e(OC.repositionPictures.image.selector),i=e("."+OC.repositionPictures.image.copy);return pictureRawBackgroundPosition=t.css("background-position"),positions=pictureRawBackgroundPosition.split(" "),-1===positions[0].indexOf("%")?(leftPxIndex=positions[0].indexOf("px"),leftPx=parseInt(positions[0].substring(0,leftPxIndex),10),topPxIndex=positions[1].indexOf("px"),topPx=parseInt(positions[1].substring(0,topPxIndex),10),leftPercentage=i.width()===t.width()?0:parseInt(Math.abs(leftPx)/(i.width()-t.width())*100,10),topPercentage=i.height()===t.height()?0:parseInt(Math.abs(topPx)/(i.height()-t.height())*100,10)):(leftPercentageIndex=positions[0].indexOf("%"),leftPercentage=parseInt(positions[0].substring(0,leftPercentageIndex),10),topPercentageIndex=positions[1].indexOf("%"),topPercentage=parseInt(positions[1].substring(0,topPercentageIndex),10)),{left:leftPercentage,top:topPercentage}},repositionClickHandler:function(){OC.repositionPictures.repositionSetup||(OC.repositionPictures.setupReposition(),OC.repositionPictures.repositionSetup=!0),e(".reposition-overlay").addClass("show"),e(".reposition-overlay").animate({opacity:.5},500);var t=e(OC.repositionPictures.image.selector);t.addClass("reposition-mode"),OC.repositionPictures.showRepositioner(),e("."+OC.repositionPictures.image.container).addClass("show"),e(".reposition-floating-actions").addClass("show"),t.tipsy("show")},setupReposition:function(){var t=e(OC.repositionPictures.image.positionerSelector),i=e(OC.repositionPictures.image.selector),n=e(OC.repositionPictures.image.wrapperSelector);pictureBackgroundImage=i.css("background-image");var o=e("<img/>",{src:pictureBackgroundImage.replace(/^url\(["']?/,"").replace(/["']?\)$/,""),"class":OC.repositionPictures.image.copy});n.append(o),t.height(o.height()),t.width(o.width());var s=e("<div/>",{"class":OC.repositionPictures.image.container+" show"});n.append(s),s.height(i.height()+2*(o.height()-i.height())),s.width(i.width()+2*(o.width()-i.width())),s.css("left",i.position().left-(s.width()/2-i.width()/2)),s.css("top",i.position().top-(s.height()/2-i.height()/2)),e(OC.repositionPictures.image.positionerSelector).draggable({containment:"."+OC.repositionPictures.image.container,drag:OC.repositionPictures.movePicture,start:OC.repositionPictures.onDragStart,stop:OC.repositionPictures.onDragComplete}),s.removeClass("show");var r=e("<div/>",{"class":"reposition-overlay"});e("body").append(r);var a=e("<div/>",{"class":"reposition-floating-actions"}),l=e("<button/>",{"class":"action-button mini-action-button",text:"Save"}),u=e("<button/>",{"class":"action-button mini-action-button",text:"Cancel"});OC.repositionPictures.image===OC.repositionPictures.projectCover?a.css("top",i.position().top+i.height()-40):a.css("top",i.position().top+i.height()+10),a.css("left",i.position().left+10),a.append(l),a.append(u),e(OC.repositionPictures.image.wrapperSelector).append(a),i.tipsy({gravity:"s",trigger:"manual",fade:"true"}),u.click(OC.repositionPictures.dismissRepositionMode),l.click(OC.repositionPictures.savePosition)},showRepositioner:function(){e(OC.repositionPictures.image.positionerSelector).addClass("show")},hideRepositioner:function(){e(OC.repositionPictures.image.positionerSelector).removeClass("show")},movePicture:function(t,i){e(OC.repositionPictures.image.selector).css("background-position",i.position.left+"px "+i.position.top+"px")},onDragStart:function(){e(OC.repositionPictures.image.selector).tipsy("hide")},onDragComplete:function(){},dismissRepositionMode:function(){e(".reposition-overlay").animate({opacity:0},500,function(){e(this).removeClass("show");var t=e(OC.repositionPictures.image.selector);t.removeClass("reposition-mode")}),e(".reposition-floating-actions").removeClass("show"),OC.repositionPictures.hideRepositioner(),e("."+OC.repositionPictures.image.container).removeClass("show"),e(OC.repositionPictures.image.selector).tipsy("hide")},savePosition:function(){if(originalBackgroundPosition={left:OC.repositionPictures.originalRepositionableLeft,top:OC.repositionPictures.originalRepositionableTop},newBackgroundPosition=OC.repositionPictures.getPictureBackgroundPosition(),originalBackgroundPosition.left!==newBackgroundPosition.left||originalBackgroundPosition.top!==newBackgroundPosition.top){if(OC.repositionPictures.image===OC.repositionPictures.userProfile){var t=e("#profile-picture-reposition-form input[name=username]").val();e.get("/user/"+t+"/reposition-picture/?left="+newBackgroundPosition.left+"&top="+newBackgroundPosition.top,function(e){"true"==e.status?OC.repositionPictures.dismissRepositionMode():OC.popup(e.message,e.title)},"json")}else if(OC.repositionPictures.image===OC.repositionPictures.projectCover){var i=e("#project-cover-reposition-form input[name=project_id]").val();e.get("/group/"+i+"/reposition-cover/?left="+newBackgroundPosition.left+"&top="+newBackgroundPosition.top,function(e){"true"==e.status?OC.repositionPictures.dismissRepositionMode():OC.popup(e.message,e.title)},"json")}}else OC.repositionPictures.dismissRepositionMode()}},comments:{newCommentTemplate:_.template('<li class="post-comment" id="comment-<%= id %>"><div class="post-comment-user-thumbnail"><div style="background-image: url(\'<%= profile_pic %>\')" class="discussion-response-thumbnail"></div></div><div class="delete-button" title="Delete comment"></div><div class="post-comment-body"><a href="/user/<%= username %>"><%= name %></a><%= body %><form><input type="hidden" name="user" value="<%= user_id %>" /><input type="hidden" name="parent_type" value="<%= content_type %>" /><input type="hidden" name="parent_id" value="<%= id %>" /></form><div class="comment-actions"><div class="reply-to-comment">Reply</div><div class="upvote-comment">0</div><div class="downvote-comment">0</div></div></div></li>'),initRenderComments:function(){e("form#resource-form").length>0?OC.comments.renderResourceComments(OC.comments.resourceCommentsSuccess):e(".discussion-board").length>0&&OC.comments.resourceCommentsSuccess();var t="textarea[name=body_markdown]";OC.comments.bindCommentsInputClickHandler(t)},bindCommentsInputClickHandler:function(t){e(t).on("focus",OC.comments.focusCommentInput),e(t).on("blur",OC.comments.blurCommentInput)},focusCommentInput:function(t){e(t.target).addClass("expanded")},blurCommentInput:function(t){""===e(t.target).val()&&e(t.target).removeClass("expanded")},resourceCommentsSuccess:function(){OC.comments.bindNewCommentButton(),OC.comments.bindCommentReplyButton(),OC.comments.bindVotingButtons(".comment-thread"),OC.comments.bindCommentDeleteButtons()},renderResourceComments:function(t){var i=e('form#resource-form input[name="resource_id"]').val();e.get("/resources/resource-comments/"+i+"/",function(i){"true"==i.status?(e(".resource-comments").prepend(i.comments),t()):OC.popup(i.message,i.title)},"json")},bindNewCommentButton:function(){e(".post-comment-button-wrapper .post-comment-button").click(OC.comments.postCommentClickHandler)},postCommentClickHandler:function(t){function i(){var i=e(t.target).parents(".post-comments").find("textarea[name=body_markdown]");""!==i.val()?e.post("/interactions/comment/",e(t.target).parents("form").serialize(),function(e){"success"==e.status?OC.comments.newCommentSuccessHandler(e,t.target):OC.popup("Sorry, the comment could not be posted. Please try again later.")},"json"):i.focus()}if(OC.config.user.id)i();else{var n="Oops - you aren't logged in! No worries - let us keep your comment safe, while you login or create a free account (takes 30 seconds!)";OC.launchSignupDialog(n,i)}},bindCommentReplyButton:function(){e(".reply-to-comment").click(OC.comments.commentReplyButtonClickHandler)},bindVotingButtons:function(t){e(".upvote-post",t).click(OC.comments.upvotePostClickHandler),e(".downvote-post",t).click(OC.comments.downvotePostClickHandler),e(".upvote-comment",t).click(OC.comments.upvoteCommentClickHandler),e(".downvote-comment",t).click(OC.comments.downvoteCommentClickHandler)},upvotePostClickHandler:function(e){function t(){commentID=OC.projects.getDiscussionID(e.target),OC.comments.newVote(commentID,!0,e.target)}if(OC.config.user.id)t();else{var i="To upvote this post, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},downvotePostClickHandler:function(e){function t(){commentID=OC.comments.getCommentID(e.target),OC.comments.newVote(commentID,!0,e.target)}if(OC.config.user.id)t();else{var i="To downvote this post, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},upvoteCommentClickHandler:function(e){function t(){commentID=OC.comments.getCommentID(e.target),OC.comments.newVote(commentID,!0,e.target)}if(OC.config.user.id)t();else{var i="To upvote this comment, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},downvoteCommentClickHandler:function(e){function t(){commentID=OC.comments.getCommentID(e.target),OC.comments.newVote(commentID,!1,e.target)}if(OC.config.user.id)t();else{var i="To downvote this comment, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},getCommentID:function(t){return e(t).closest(".post-comment").attr("id").substring(8)},bindCommentDeleteButtons:function(){e(".comment-thread .delete-button").click(OC.comments.commentDeleteButtonClickHandler)},commentDeleteButtonClickHandler:function(t){var i=OC.comments.getCommentID(t.target);e.get("/interactions/comment/"+i+"/delete/",function(e){"true"==e.status?OC.comments.commentDeleteHandler(t.target):OC.popup("Sorry, your comment could not be deleted. Please try again later.")},"json")},commentDeleteHandler:function(t){var i=e(t).closest(".post-comment"),n=i.siblings(".post-comment").length;e(t).tipsy("hide"),0===n?i.closest("ul").remove():i.remove()},newVote:function(t,i,n){endpoint=i?"/interactions/comment/"+t+"/upvote/":"/interactions/comment/"+t+"/downvote/",e.get(endpoint,function(e){"true"==e.status?OC.comments.newVoteHandler(n,i):"unvote success"==e.status?OC.comments.newVoteHandler(n,i,!0):OC.popup("Sorry, your vote could not be posted. Please try again later.")},"json")},newVoteHandler:function(t,i,n){n=n||!1;var o=e(t).text();n?(e(t).text(parseInt(o,10)-1),e(t).removeClass("user-upvoted"),e(t).removeClass("user-downvoted")):(e(t).text(parseInt(o,10)+1),e(t).addClass(i?"user-upvoted":"user-downvoted"))},addDeleteButtonTooltip:function(t){e(".delete-button",t).tipsy({gravity:"n"})},commentReplyButtonClickHandler:function(t){var i=e(t.target).closest(".post-comment"),n=i.find(".post-comment-body:first").clone(),o=n.find("a:first").clone();n.find("a:first").remove(),n.find(".comment-actions").remove(),n.find("ul").remove(),strippedTitle='"'+n.text().substring(0,40),strippedTitle+=n.text().length>40?'..."':'"',e(".new-comment-reply-dialog .new-comment-reply-title").text(strippedTitle),e(".new-comment-reply-dialog .new-comment-original-reply-body").html(n.html());var s=i.find(".discussion-response-thumbnail").css("background-image");e(".new-comment-reply-dialog .new-comment-original-commentor-thumbnail").css("background-image",s),e(".new-comment-reply-dialog .new-comment-original-reply-user-name").html(o),e(".new-comment-reply-body").removeClass("form-input-error"),originalCommentID=i.attr("id").substring(8),e(".new-comment-reply-dialog input[name=parent_id]").val(originalCommentID),newCommentReplyPopup=OC.customPopup(".new-comment-reply-dialog"),e(".new-comment-reply-submit").click(function(t){if(""!==e(".new-comment-reply-body").val()){var n=e(t.target).parents(".new-comment-reply-dialog").find("form#new-comment-reply-form");e.post("/interactions/comment/",n.serialize(),function(e){"success"==e.status?(OC.comments.newCommentReplySuccessHandler(e,i),newCommentReplyPopup.close()):OC.popup("Sorry, the comment reply could not be posted.Please try again later.")},"json")}else e(".new-comment-reply-body").addClass("form-input-error");return t.stopPropagation(),t.preventDefault(),!1})},newCommentSuccessHandler:function(t,i){var n=OC.comments.newCommentTemplate,o=n(t.message),s=e(i).parents(".comment-thread"),r=s.children("ul");0===r.length&&(r=e("<ul/>"),s.prepend(r)),r.append(o);var a=r.find(".post-comment:last"),l=e(i).parents(".comment-thread").find("textarea[name=body_markdown]");l.val(""),l.removeClass("expanded"),l.blur(),OC.comments.attachNewCommentActions(a)},newCommentReplySuccessHandler:function(t,i){var n=OC.comments.newCommentTemplate,o=n(t.message),s=e("> ul",i);0===s.length&&(s=e("<ul/>"),i.append(s)),s.append(o);var r=s.find(".post-comment:last");OC.comments.attachNewCommentActions(r),e(".new-comment-reply-body").val("")},attachNewCommentActions:function(t){OC.comments.addDeleteButtonTooltip(t),e(".delete-button",t).click(OC.comments.commentDeleteButtonClickHandler),e(".reply-to-comment",t).click(OC.comments.commentReplyButtonClickHandler),OC.comments.bindVotingButtons(t)}},renderDocumentComments:function(){var t,i,n=e(".oer-document.document-body");if(n.length>=1){var o=e(".document-element",n);for(t=0;t<o.length;t++){i=e(o[t]);var s=e("form.document-element-form",i),r=e("input[name=document_element_id]",s).val();OC.getDocumentElementComments(i,r)}}OC.closePopoutsHandler()},getDocumentElementComments:function(t,i){e.get("/resources/document-element/"+i+"/comments/",function(e){OC.getDocumentElementCommentsResponseHandler(e,t,i)},"json")},getDocumentElementCommentsResponseHandler:function(t,i,n){var o=t.comments;if(i.hasClass("document-table"))for(tableCells=e("td, th",i),j=0;j<tableCells.length;j++){cellCommentButton=e("<div/>",{"class":"document-cell-comment-button"}),cellCommentsWrapper=e("<div/>",{"class":"document-cell-comments"}),cell=e(tableCells[j]),cell.append(cellCommentButton),cell.append(cellCommentsWrapper),newCommentButton=e(".document-cell-comment-button",cell),newCommentsBox=e(".document-cell-comments",cell);var s=cell.attr("id"),r=s.substring(("item-"+n).length+1).split("-"),a=r[0],l=r[1];cellComments=_.pluck(_.where(o,{reference:"row#"+a+",col#"+l}),"comment"),newCommentsBox.html(OC.cellCommentsView(cellComments,cell)),e("button.document-element-comment-post",newCommentsBox).click(OC.documentElementCommentPostHandler),newCommentButton.css("left",cell.width()-newCommentButton.width()+"px");var u=newCommentButton.position().left,c=u+newCommentsBox.outerWidth();c>e(window).width()-10&&(u-=c-(e(window).width()-10)),newCommentsBox.css({left:u+"px",top:newCommentButton.position().top+"px"}),newCommentButton.click(OC.toggleCellComment)}},toggleCellComment:function(t){var i=e(OC.dismissOpenComment()),n=e(t.target).closest("td, th"),o=n.find(".document-cell-comments");return i.get(0)!==o.get(0)&&(o.addClass("show-popout"),e(t.target).addClass("comments-open"),o.click(function(t){return e(t.target).is("button")?void 0:(t.stopPropagation(),t.preventDefault(),!1)})),t.stopPropagation(),t.preventDefault(),!1},closePopoutsHandler:function(){e("body").on("click",function(){OC.dismissOpenComment()})},dismissOpenComment:function(){var t,i=e(".show-popout");for(t=0;t<i.length;t++)e(i[t]).removeClass("show-popout");var n,o=e(".comments-open");for(n=0;n<i.length;n++)e(o[n]).removeClass("comments-open");return i[0]},documentCommentTemplate:_.template('<div class="document-comment"><div class="document-comment-thumbnail" style="background-image: url(\'<%= profile_pic %>\');"></div><div class="document-comment-body"><a href="/user/<%= username %>" class="document-comment-user"><%= name %></a><%= body %></div></div>'),cellCommentsView:function(t,i){var n,o="",s="",r=_.template('<form class="document-element-comments-form"><input type="hidden" name="document-element-item" value="<%= itemID %>" /><input type="hidden" name="user_id" value="<%= userID %>" />'),a="</form>",l=i.attr("id"),u=e('.document-body-form input[name="user_id"]').val(),c=e(".header-user-picture");c.length>=1&&(n=c.css("background-image").replace('"',"'"));var d;for(d=0;d<t.length;d++)s+=OC.documentCommentTemplate(t[d]);if(n){var p=_.template('<div class="document-comment"><div class="document-comment-thumbnail" style="background-image: <%= profile_pic %>;"></div><div class="document-comment-body"><textarea name="comment-body" placeholder="Add a comment..."></textarea></div></div>'),f=p({profile_pic:n}),m=_.template('<div class="document-element-comment-post-wrapper"><button class="document-element-comment-post action-button mini-action-button">Post</button></div>');o+=r({itemID:l,userID:u})+s+f+m()+a}else o+=r({itemID:l,userID:u})+s+a;return o},documentElementCommentPostHandler:function(t){var i=e(t.target).closest("form.document-element-comments-form"),n=e(t.target).closest(".document-element").find("form.document-element-form"),o=e("form.document-body-form"),s=e("textarea[name=comment-body]",i).val().trim();if(""!==s){var r=e(t.target).closest("td, th").attr("id"),a=r.substring(r.indexOf("-",5)+1),l=parseInt(a.substring(0,a.indexOf("-")),10),u=parseInt(a.substring(a.indexOf("-")+1),10),c={body_markdown:s,owner_id:e("input[name=document_element_id]",n).val(),owner_type:e("input[name=document_element_type]",n).val(),user:e("input[name=user_id]",o).val(),reference:"row#"+l+",col#"+u};e.post("/interactions/comment-reference/",c,function(e){"true"==e.status&&OC.documentElementCommentSubmissionHandler(e,i)},"json")}return t.stopPropagation(),t.preventDefault(),!1},documentElementCommentSubmissionHandler:function(t,i){var n=e(".document-comment",i),o=e(n[n.length-2]);o.after(OC.documentCommentTemplate(t));var s=e("textarea[name=comment-body]",i);s.val("")},articleCenter:{registrationInit:function(){e(window).bind("scroll",function(){i()});var t=e(".animating-panda-wrapper > div"),i=function(){var i=e(window).scrollTop();i>400&&1399>i?(t.removeClass(),t.addClass("eating-panda")):i>1400?(t.removeClass(),t.addClass("sleeping-panda")):t.removeClass()}}},initSubscribe:function(){var t,i=e("form.profile-subscribe-form input[name=user_id]").val();e(".profile-subscribe .page-subscribe-button").click(function(n){return t=e(this),OC.subscribeTo(i,t),n.stopPropagation(),n.preventDefault(),!1}),e(".subscribe-suggestion-form .subscribe-button").click(function(t){return i=e(this).parents(".subscribe-suggestion-form").find("input[name=user_id]").val(),OC.subscribeTo(i,e(this)),t.stopPropagation(),t.preventDefault(),!1})},subscribeTo:function(t,i){function n(){e.get("/user/api/subscribe/"+t+"/",function(e){"true"==e.status?i.hasClass("subscribed")?(i.removeClass("subscribed"),i.text("Subscribe")):(i.addClass("subscribed"),i.text("✔ Subscribed")):OC.popup(e.message,e.title)},"json")}if(OC.config.user.id)n();else{var o="To subscribe and get frequent updates, please login or create a free account instantly.";OC.launchSignupDialog(o,n)}},initBrowse:function(){e(".content-panel-body-listing-item-favorites").click(function(){e(this).toggleClass("favorited")}),e(".content-panel-body-header-share").click(function(){if(OC.config.user.id)OC.initNewPostDialog();else{var e="To post something into the community, you must login or create a free account (takes 30 seconds!).";OC.launchSignupDialog(e,function(){OC.initNewPostDialog()})}}),e(".filter-sort-option").click(function(){var t=e(this);t.hasClass("selected")||(e(".filter-sort-option").removeClass("selected"),t.addClass("selected"))}),e(".category-choice").tipsy({gravity:"s"})},initNewPostDialog:function(){function t(t,i,n){e(t,i.dialog).click(function(){i.close();var t=OC.customPopup(".post-tag-dialog");e(".post-tag-submit",t.dialog).click(function(){var o=e("select[name=type]",t.dialog).val(),s=e("<input/>",{name:"type",value:o,type:"hidden"}),r=e("form:first",i.dialog),a=e('input[name="standard"]',t.dialog);r.append(a.clone()),r.append(s),n&&r.submit()})})}{var i=OC.customPopup(".browse-post-new-dialog");e(".post-tag-dialog .standards-input").tagit({fieldName:"standard",autocomplete:{minLength:2,source:function(t,i){e.get("/meta/api/standard/search/"+t.term+"/?limit=15",function(t){i(e.map(t,function(e){return{label:e,value:e}}))},"json")}}})}e(".browse-post-new-option.upload-option",i.dialog).click(function(){i.close();var n=OC.customPopup(".post-new-upload-dialog");e('input[name="post"]',n.dialog).val("true"),OC.upload.isPost=!0,t('form.files-upload-rename button[type="submit"]',n,!0)}),e(".browse-post-new-option.file-folder-option",i.dialog).click(function(){i.close();var n=OC.customPopup(".post-new-file-folder-dialog"),o=e(".post-new-file-folder-profile-browser");e.get("/resources/tree/all/user/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,o),o.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json"),t(".post-new-file-folder-submit",n,!0),e(".post-new-file-folder-submit").click(function(t){var i;if(selectedResourceCollection=o.find(".selected-destination-collection, .selected-destination-resource"),selectedResourceCollection.length>0&&(i=e(selectedResourceCollection[0])),i){var n=i.attr("id"),s=-1!=n.indexOf("resource"),r=n.substring(s?9:11);e("#post-new-file-folder-profile-form input[name=is_resource]").val(s),e("#post-new-file-folder-profile-form input[name=resource_collection_ID]").val(r)}return t.stopPropagation(),t.preventDefault(),!1})}),e(".browse-post-new-option.url-option",i.dialog).click(function(){i.close();var e=OC.customPopup(".post-new-url-dialog");t(".post-new-url-submit",e,!0)})},launchSignupDialog:function(t,i){var n=OC.customPopup(".login-dialog"),o=e(".easy-signup-form, #sign-in-form"),s=(e(".easy-signup-form #session-state"),e(".login-dialog-message",n.dialog));OC.signupDialog=n,s.html(t),e.get("/user/api/registeration-context/",function(t){if("true"==t.status){var n;for(n=0;n<o.length;n++)e("#session-state",e(o[n])).attr("data-state",t.state),e("span.g-signin",e(o[n])).attr("data-clientid",t.client_id);OC.initializeGooglePlusButtons(),OC.registerationSuccessCallback=i}},"json")},initializeGooglePlusButtons:function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src="https://plus.google.com/js/client:plusone.js?onload=renderPlus",t.parentNode.insertBefore(e,t)},signupTour:function(){function t(){var t='<p>Wohoo! You are almost set. We sent you an email to confirm your account. When you get a chance, please check your email and confirm the same.</p><p>For now, please enjoy this little tour we put together for you.</p><div class="user-welcome-submit-wrapper oc-popup-submit-wrapper"><button class="action-button user-welcome-submit-button oc-popup-submit-button">Take the mini-tour &#187;</button></div>',i=e("<div/>",{"class":"user-welcome-dialog oc-popup"}),o=e("<div/>",{"class":"oc-popup-title-bar"}),s=e("<div/>",{"class":"oc-popup-title"}),r=e("<h3/>",{text:"Welcome, "+OC.config.user.name}),a=e("<div/>",{"class":"delete-button oc-popup-exit"}),l=e("<div/>",{"class":"oc-popup-body",html:t});s.append(r),o.append(s),o.append(a),i.append(o),i.append(l),e("body").append(i);var p=OC.customPopup(".user-welcome-dialog"),f=e(".user-welcome-submit-button",p.dialog);f.click(function(t){p.close(),e.get("/user/api/onboard/welcome/0.1/",function(){},"json"),u=e("<div/>",{"class":"signup-floaters"}),e("body").append(u),c=e(".signup-floaters"),c.css({height:e(window).height(),width:e(window).width()}),d.addClass("show-popup-background");var i=e("<div/>",{"class":"signup-steps-wrapper"}),o=e("<nav/>",{"class":"signup-steps"}),s=e("<div/>",{"class":"signup-step signup-step-one selected",text:"1"}),r=e("<div/>",{"class":"signup-step signup-step-two",text:"2"}),a=e("<div/>",{"class":"signup-step signup-step-three",text:"3"}),l=e("<div/>",{"class":"signup-steps-flow"});return o.append(s),o.append(r),o.append(a),i.append(o),i.append(l),c.append(i),i.css({top:e(window).height()-i.height()-20}),n(),t.stopPropagation(),t.preventDefault(),!1})}function i(t){steps=["one","two","three","four","five"];var i=e(".signup-steps-step");i.removeClass("selected");var n=e(".signup-step-"+steps[t-1]);n.addClass("selected");var o=e(".signup-step-"+steps[t-2]);0!==o.length&&o.addClass("completed")}function n(){var t=e(".create-new-resource-button a"),i=e("#add-resource-menu");t.css({top:t.position().top,left:t.position().left}),t.addClass("popout"),i.addClass("popout"),i.mouseover(),l=e("<div/>",{"class":"step-one-message step-message"}),messageTitle=e("<div/>",{"class":"step-message-title",text:p.one.title}),messageBody=e("<div/>",{"class":"step-message-body",html:p.one.body}),l.append(messageTitle),l.append(messageBody),c.append(l);var n=e(".step-one-message");n.css({top:t.position().top,left:t.position().left-n.width()-80}),e(".signup-tour-primary-button",n).click(function(){l.addClass("hide"),t.removeClass("popout"),i.removeClass("popout"),o()}),e(".signup-tour-secondary-button",n).click(function(){a()})}function o(){i(2);var t=e("#search-bar");t.css({top:t.position().top,left:t.position().left}),t.addClass("popout"),l=e("<div/>",{"class":"step-two-message step-message"}),messageTitle=e("<div/>",{"class":"step-message-title",text:p.two.title}),messageBody=e("<div/>",{"class":"step-message-body",html:p.two.body}),l.append(messageTitle),l.append(messageBody),c.append(l);var n=e(".step-two-message");n.css({top:t.position().top+20,left:t.position().left+20}),e(".signup-tour-primary-button",n).click(function(e){return l.addClass("hide"),t.removeClass("popout"),s(),e.stopPropagation(),e.preventDefault(),!1}),e(".signup-tour-secondary-button",n).click(function(){a()})}function s(){i(3);var t=e(".user-profile-picture"),n=e(".user-profile-info-body"),o=e(".edit-profile-picture .change-picture");t.css({top:t.position().top,left:t.position().left}),n.css({top:n.position().top,left:n.position().left}),t.addClass("popout"),n.addClass("popout"),o.mouseover(),l=e("<div/>",{"class":"step-three-message step-message"}),messageTitle=e("<div/>",{"class":"step-message-title",text:p.three.title}),messageBody=e("<div/>",{"class":"step-message-body",html:p.three.body}),l.append(messageTitle),l.append(messageBody),c.append(l);var s=e(".step-three-message");s.css({top:t.position().top-20,left:t.position().left+t.width()+20}),e(".signup-tour-primary-button",s).click(function(){l.addClass("hide"),t.removeClass("popout"),n.removeClass("popout"),r()})}function r(){a()}function a(){d.removeClass("show-popup-background"),e(".signup-steps-wrapper").addClass("hide"),e(".signup-floaters").addClass("hide");var t=e("#logo");setTimeout(function(){OC.tip(t,{title:"Confused about where to begin?",gravity:"n",width:220,description:"Begin by exploring our vast library of content by clicking on the site logo, before you decide to come back to your profile to make something.",dismisser:function(e,t){t(e)}})},2500)}var l,u,c,d=e(".popup-background"),p={one:{title:"Create lessons, units and folders of joy",body:'Begin by creating a template-based lesson, or create a standards-aligned unit. Import existing content from Dropbox, Google Drive and other places to build folders for sharing.<div class="signup-tour-buttons"><div class="action-button mini-action-button signup-tour-primary-button">Next &#187;</div><div class="action-button mini-action-button signup-tour-secondary-button">Cancel</div></div>'},two:{title:"Search from what others are creating",body:'Hundreds of teachers and content publishers are creating and sharing lessons, worksheets, videos, student handouts, and activities for you to use. Here is where your quest begins.<div class="signup-tour-buttons"><div class="action-button mini-action-button signup-tour-primary-button">Next &#187;</div><div class="action-button mini-action-button signup-tour-secondary-button">Cancel</div></div>'},three:{title:"Does that look like you?",body:'Begin your journey in OpenCurriculum with a new dashing photo of yours and a headline update. Let all others in the community know you have arrived and are here to stay :)<div class="signup-tour-buttons"><div class="action-button mini-action-button signup-tour-primary-button">Done</div></div>'}},f=""===window.location.search?[]:window.location.search.substring(1).split("&");if(f){var m=_.find(f,function(e){return-1!==e.indexOf("new_user=")});m&&OC.config.user.id&&t()}},validateNewURL:function(){OC.validate.text('.resource-create-edit-form input[name="url"]',/^(?:(?:https?|ftp):\/\/)?(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i,"You seem to have a little error in your URL"),e("form.url-edit-form .action-button").click(function(t){var i,n,o=e(this),s=['input[name="url"]'],r=[];
for(i=0;i<s.length;i++)n=e("form.resource-create-edit-form "+s[i]),n.hasClass("form-input-error")&&r.push(n);return 0!==r.length?(t.stopPropagation(),t.preventDefault(),!1):void o.parents("form.resource-create-edit-form").submit()})},collaborators:{currentResourceCollectionVisibility:null,template:_.template('<li class="collaborator-item user" id="user-<%= id %>"><div class="collaborator-info user-info"><div class="collaborator-photo user-photo" style="background-image: url(\'<%= profile_pic %>\')"></div><div class="collaborator-description user-description"><a href="/user/<%= username %>"><%= name %></a></div></div><div class="collaborator-actions user-actions"><span class="delete-member delete-button" title="Remove collaborator"></span></div></li>'),init:function(t,i,n,o,s){var r=OC.customPopup(".resource-collection-visibility-dialog",{closeCallback:o}),a=e("#add-collection-collaborator-form",r.dialog),l=e("input[name=add-collaborator]",a);l.focus(),l.val("");var u=e("ul.collaborators",a);u.children().remove(),e(".resource-collection-visibility-form-tabs li a").unbind("click");var c=e('.resource-collection-visibility-form-tabs li a[href="#profile-access"]'),d=e('.resource-collection-visibility-form-tabs li a[href="#project-access"]'),p=e('.resource-collection-visibility-form-tabs li a[href="#private-access"]');"collection"==t.type?(e("input[name=collection_id]",a).val(t.id),OC.collaborators.add(!0),u.addClass("waiting"),e.get("/resources/collection/"+t.id+"/list-collaborators/",function(e){"true"===e.status?OC.collaborators.listHandler(e):OC.popup(e.message,e.title),u.removeClass("waiting")},"json"),c.click(function(){OC.collaborators.currentResourceCollectionVisibility="public",e.get("/resources/collection/"+t.id+"/visibility/public/")}),d.click(function(){OC.collaborators.currentResourceCollectionVisibility="project",e.get("/resources/collection/"+t.id+"/visibility/project/")}),p.click(function(){OC.collaborators.currentResourceCollectionVisibility="private",e.get("/resources/collection/"+t.id+"/visibility/private/")}),n(t.id,!1)):(e("input[name=resource_id]",a).val(t.id),OC.collaborators.add(!1),u.addClass("waiting"),e.get("/resources/resource/"+t.id+"/list-collaborators/",function(e){"true"===e.status?OC.collaborators.listHandler(e):OC.popup(e.message,e.title),u.removeClass("waiting")},"json"),c.click(function(){OC.collaborators.currentResourceCollectionVisibility="public",e.get("/resources/resource/"+t.id+"/visibility/public/")}),d.click(function(){OC.collaborators.currentResourceCollectionVisibility="project",e.get("/resources/resource/"+t.id+"/visibility/project/")}),p.click(function(){OC.collaborators.currentResourceCollectionVisibility="private",e.get("/resources/resource/"+t.id+"/visibility/private/")}),i(t.id,!1)),OC.tabs(".resource-collection-visibility-form",{tab:"private"==OC.collaborators.currentResourceCollectionVisibility?1:0,showOnly:s?null:1})},add:function(t){var i=e("#add-collection-collaborator-form"),n=e("input[name=add-collaborator]",i),o=e("input[name=collection_id]",i).val(),s=e("input[name=resource_id]",i).val();n.autocomplete({source:function(t,i){e.get("/user/api/list/"+t.term,function(t){i(e.map(t,function(e){return{label:e.name,value:e.username,id:e.id}}))},"json")},minLength:2,select:function(i,r){n.addClass("waiting"),t?e.get("/resources/collection/"+o+"/add/"+r.item.id+"/",function(t){var i=e("#add-collection-collaborator-form ul.collaborators");OC.collaborators.addHandler(t.user,i),n.val(""),n.removeClass("waiting")},"json"):e.get("/resources/resource/"+s+"/add/"+r.item.id+"/",function(i){var o=e("#add-collection-collaborator-form ul.collaborators");OC.collaborators.addHandler(i.user,o,t),n.val(""),n.removeClass("waiting")},"json")}})},listHandler:function(t){var i,n=e("#add-collection-collaborator-form ul.collaborators");for(i=0;i<t.users.length;i++)OC.collaborators.addHandler(t.users[i],n)},addHandler:function(e,t,i){collaborator=OC.collaborators.template(e),t.append(collaborator);var n=t.find("li.collaborator-item:last .delete-button");n.click(function(e){OC.collaborators.removeHandler(e,i)}),n.tipsy({gravity:"n"})},removeHandler:function(t,i){var n=e("#add-collection-collaborator-form"),o=e("input[name=collection_id]",n).val(),s=e("input[name=resource_id]",n).val(),r=e(t.target),a=r.closest("li.collaborator-item").attr("id").substring(5);i?e.get("/resources/collection/"+o+"/remove/"+a+"/",function(e){"true"===e.status?OC.collaborators.remove(r):OC.popup(e.message,e.title)},"json"):e.get("/resources/resource/"+s+"/remove/"+a+"/",function(e){"true"===e.status?OC.remove.remove(r):OC.popup(e.message,e.title)},"json")},remove:function(t){var i=e(t).parents("li.collaborator-item");e(t).tipsy("hide"),i.remove()}},resources:{},resource:{copy:function(t,i,n,o){e.get("/resources/resource/"+i+"/copy/from/"+t+"/to/"+n+"/",function(e){"true"==e.status?o(e.resource,i):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")},link:function(t,i,n,o){e.get("/resources/resource/"+i+"/link/from/"+t+"/to/"+n+"/",function(e){"true"==e.status?o(e.resource,i):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")},successfullyCopied:function(){OC.setMessageBoxMessage("Resource has been copied to your folder successfully."),OC.showMessageBox()},successfullyLinked:function(){OC.setMessageBoxMessage("Resource has been linked in your folder successfully."),OC.showMessageBox()},"delete":function(t,i,n){var o=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",o.dialog).click(function(s){return o.close(),e.post("/resources/delete-resource/"+t+"/from/"+i+"/",function(e){"true"==e.status?n([e.resourceID]):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),s.stopPropagation(),s.preventDefault(),!1})},deleteMultiple:function(t,i,n){var o=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",o.dialog).click(function(s){o.close();var r=t.join();return e.post("/resources/delete-resources/from/"+i+"/?ids="+r,function(e){"true"==e.status?n(e.resourceIDs):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),s.stopPropagation(),s.preventDefault(),!1})},rename:function(t,i,n){e.post("/resources/rename/resource/"+t+"/"+encodeURIComponent(i)+"/",function(e){"true"==e.status?n(e.resourceID,e.title):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")}},collection:{copy:function(t,i,n,o){e.get("/resources/collection/"+i+"/copy/to/"+n+"/",function(e){"true"==e.status?o(e.collection,i):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")},successfullyCopied:function(){OC.setMessageBoxMessage("Folder has been copied into your folder successfully."),OC.showMessageBox()},"delete":function(t,i){var n=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",n.dialog).click(function(o){return n.close(),e.post("/resources/delete-collection/"+t+"/",function(e){"true"==e.status?i([e.collectionID]):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),o.stopPropagation(),o.preventDefault(),!1})},deleteMultiple:function(t,i){var n=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",n.dialog).click(function(o){n.close();var s=t.join();return e.post("/resources/delete-collections/?ids="+s,function(e){"true"==e.status?i(e.collectionIDs):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),o.stopPropagation(),o.preventDefault(),!1})},rename:function(t,i,n){e.post("/resources/rename/collection/"+t+"/"+encodeURIComponent(i)+"/",function(e){"true"==e.status?n(e.collectionID,e.title):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")}},setPageHeight:function(){e(".resource-browse, .profile-page").height(e(window).height()-e("header").height()),e(".profile-content").height(e(window).height()-e("header").height()-e(".profile-tabs").outerHeight(!0)-parseInt(e(".profile-content").css("padding-top"),10))},favorites:{},attachCSRFToken:function(t,i){function n(t){var i,n,o,s=null;if(document.cookie&&""!==document.cookie)for(i=document.cookie.split(";"),n=0;n<i.length;n++)if(o=e.trim(i[n]),o.substring(0,t.length+1)===t+"="){s=decodeURIComponent(o.substring(t.length+1));break}return s}function o(e){var t=document.location.host,i=document.location.protocol,n="//"+t,o=i+n;return e===o||e.slice(0,o.length+1)===o+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!/^(\/\/|http:|https:).*/.test(e)}var s=e(this)[0].options.url;o(s)&&i.setRequestHeader("X-CSRFToken",n("csrftoken"))}}),e(document).ready(function(e){OC.setupUserMenu(),e(".chief-panel-container-cover").addClass("play"),OC.setPageHeight(),e(window).resize(OC.setPageHeight),OC.initSearchOptions(),OC.initSearchAutocomplete(),OC.initShowMoreBlock(),OC.bindEditHeadlineHandler(),OC.initNotificationHandler(),OC.initMessageBox(),OC.setupIndex(),OC.initBrowse(),OC.initPictureManipulation(),OC.initSubscribe(),OC.initInviteSignup(),OC.renderSelectRedirector(),OC.renderThermometer(),OC.setupShareMenu(),OC.setupAddTo(),e("#submission-info").animate({top:"0px"},1e3),e(".edit-dropdown").click(function(){e(this).toggleClass("edit-dropdown-opened"),e(this).parent().children(".edit-dropped").toggleClass("show-dropped")}),OC.emailShareHandler(),OC.commentHandler(),OC.initCategoryLiveFilter(),OC.renderCategoryArticles(),OC.initImageHoverDescriptions(),OC.renderJobsCarousel(),e("#philosophy-button").click(function(){e("html, body").animate({scrollTop:e("#our-philosophy").offset().top},1e3)}),OC.initAddResource(),OC.initCreateCollection(),OC.initCreateGroup(),OC.initUpload(),OC.initLink(),OC.bindDeleteResourceHandler(),OC.bindDeleteCollectionHandler(),OC.initCollectionsTree(),OC.initFavoriteResource(),OC.comments.initRenderComments(),OC.initUpvoteDownvoteResource(),OC.initResourceView(),OC.initPrintResource(),OC.initExportResource(),OC.initProfileCreateResource(),OC.initProfileSubscribers(),OC.validateNewURL(),OC.initForgotAuth(),OC.initChangePassword(),OC.renderShowMore(),OC.initArticleCenter(),e(".new-resource-tags").tagit({allowSpaces:!0});try{window.fbAsyncInit=function(){FB.init({appId:t,status:!0,cookie:!0,xfbml:!0}),FB.Event.subscribe("auth.authResponseChange",function(){var t=e(".registration-cover");t.length>0&&"facebook"===t.attr("title")&&OC.facebookRegistrationCallback({status:"false"})})}}catch(i){}!function(e){var t,i="facebook-jssdk",n=e.getElementsByTagName("script")[0];e.getElementById(i)||(t=e.createElement("script"),t.id=i,t.async=!0,t.src="//connect.facebook.net/en_US/all.js",n.parentNode.insertBefore(t,n))}(document),OC.initRegistrationForm(),OC.signupTour()});var t;return e(document).ajaxSend(function(t,i,n){function o(t){var i,n,o,s=null;if(document.cookie&&""!==document.cookie)for(i=document.cookie.split(";"),n=0;n<i.length;n++)if(o=e.trim(i[n]),o.substring(0,t.length+1)===t+"="){s=decodeURIComponent(o.substring(t.length+1));break}return s}function s(e){var t=document.location.host,i=document.location.protocol,n="//"+t,o=i+n;return e===o||e.slice(0,o.length+1)===o+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!/^(\/\/|http:|https:).*/.test(e)}function r(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}!r(n.type)&&s(n.url)&&i.setRequestHeader("X-CSRFToken",o("csrftoken"))}),function(e,t,i,n,o,s,r){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,s=t.createElement(i),r=t.getElementsByTagName(i)[0],s.async=1,s.src=n,r.parentNode.insertBefore(s,r)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-23974225-2","opencurriculum.org"),OC.config.user.id&&(ga("set","&uid",parseInt(OC.config.user.id,10)),ga("set","dimension2",OC.config.user.dob)),ga("send","pageview"),e.fn.shuffleElements=function(){var t,i,n,o=e(this);for(n=o.length;n;t=parseInt(Math.random()*n,10),i=o[--n],o[n]=o[t],o[t]=i);return o},e.fn.selectRange=function(e,t){return this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(e,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select()}})},e.fn.hasClickEventListener=function(t){elementClickEvents=e._data(this[0],"events").click;var i=0;for(i;i<elementClickEvents.length;i++)if(elementClickEvents[i].handler==t)return!0;return!1},getScrollbarWidth=function(){var t=e('<div style="width: 100%; height:200px;"></div>'),i=e('<div style="width:200px;height:150px; position: absolute;top: 0; left: 0; visibility: hidden; overflow:hidden;"></div>').append(t),n=t[0],o=i[0];e("body").append(o);var s=n.offsetWidth;i.css("overflow","scroll");var r=o.clientWidth;return i.remove(),s-r},isElementInViewport=function(t){t instanceof e&&(t=t[0]);var i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)},UserVoice=window.UserVoice||[],function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//widget.uservoice.com/ZAGIW6Tl7C98iiNDKsLe5g.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),UserVoice.push(["set",{accent_color:"#6aba2e",trigger_color:"white",trigger_background_color:"rgba(46, 49, 51, 0.6)"}]),UserVoice.push(["addTrigger",{mode:"contact",trigger_position:"bottom-right"}]),e.fn.animateAuto=function(t,i,n){var o;return this.each(function(s,r){r=e(r),o=r.clone().css({height:"auto",width:"auto"}).appendTo("body");var a=o.css("height"),l=o.css("width");o.remove(),"height"===t?r.animate({height:a},i,n):"width"===t?r.animate({width:l},i,n):"both"===t&&r.animate({width:l,height:a},i,n)})},OC}),define("header",["jquery","underscore","modernizr","tipsy","tagit","core"],function(){});