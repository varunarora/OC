var requirejs,require,define;!function(ba){function G(e){return"[object Function]"===K.call(e)}function H(e){return"[object Array]"===K.call(e)}function v(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function T(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function t(e,t){return fa.call(e,t)}function m(e,i){return t(e,i)&&e[i]}function B(e,i){for(var n in e)if(t(e,n)&&i(e[n],n))break}function U(e,i,n,o){return i&&B(i,function(i,s){(n||!t(e,s))&&(!o||"object"!=typeof i||!i||H(i)||G(i)||i instanceof RegExp?e[s]=i:(e[s]||(e[s]={}),U(e[s],i,n,o)))}),e}function u(e,t){return function(){return t.apply(e,arguments)}}function ca(e){throw e}function da(e){if(!e)return e;var t=ba;return v(e.split("."),function(e){t=t[e]}),t}function C(e,t,i,n){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=n,i&&(t.originalError=i),t}function ga(e){function i(e,t,i){var n,o,s,r,a,l,u,c,t=t&&t.split("/"),d=P.map,p=d&&d["*"];if(e){for(e=e.split("/"),o=e.length-1,P.nodeIdCompat&&Q.test(e[o])&&(e[o]=e[o].replace(Q,"")),"."===e[0].charAt(0)&&t&&(o=t.slice(0,t.length-1),e=o.concat(e)),o=e,s=0;s<o.length;s++)r=o[s],"."===r?(o.splice(s,1),s-=1):".."===r&&0!==s&&(1!=s||".."!==o[2])&&".."!==o[s-1]&&s>0&&(o.splice(s-1,2),s-=2);e=e.join("/")}if(i&&d&&(t||p)){o=e.split("/"),s=o.length;e:for(;s>0;s-=1){if(a=o.slice(0,s).join("/"),t)for(r=t.length;r>0;r-=1)if((i=m(d,t.slice(0,r).join("/")))&&(i=m(i,a))){n=i,l=s;break e}!u&&p&&m(p,a)&&(u=m(p,a),c=s)}!n&&u&&(n=u,l=c),n&&(o.splice(0,l,n),e=o.join("/"))}return(n=m(P.pkgs,e))?n:e}function n(e){z&&v(document.getElementsByTagName("script"),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===O.contextName?(t.parentNode.removeChild(t),!0):void 0})}function o(e){var t=m(P.paths,e);return t&&H(t)&&1<t.length?(t.shift(),O.require.undef(e),O.makeRequire(null,{skipMap:!0})([e]),!0):void 0}function s(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function r(e,t,n,o){var r,a,l=null,u=t?t.name:null,c=e,d=!0,p="";return e||(d=!1,e="_@r"+(W+=1)),e=s(e),l=e[0],e=e[1],l&&(l=i(l,u,o),a=m(A,l)),e&&(l?p=a&&a.normalize?a.normalize(e,function(e){return i(e,u,o)}):-1===e.indexOf("!")?i(e,u,o):e:(p=i(e,u,o),e=s(p),l=e[0],p=e[1],n=!0,r=O.nameToUrl(p))),n=!l||a||n?"":"_unnormalized"+(q+=1),{prefix:l,name:p,parentMap:t,unnormalized:!!n,url:r,originalName:c,isDefine:d,id:(l?l+"!"+p:p)+n}}function a(e){var t=e.id,i=m(D,t);return i||(i=D[t]=new O.Module(e)),i}function l(e,i,n){var o=e.id,s=m(D,o);!t(A,o)||s&&!s.defineEmitComplete?(s=a(e),s.error&&"error"===i?n(s.error):s.on(i,n)):"defined"===i&&n(A[o])}function c(e,t){var i=e.requireModules,n=!1;t?t(e):(v(i,function(t){(t=m(D,t))&&(t.error=e,t.events.error&&(n=!0,t.emit("error",e)))}),n||g.onError(e))}function d(){R.length&&(ha.apply(F,[F.length,0].concat(R)),R=[])}function p(e){delete D[e],delete S[e]}function h(e,t,i){var n=e.map.id;e.error?e.emit("error",e.error):(t[n]=!0,v(e.depMaps,function(n,o){var s=n.id,r=m(D,s);r&&!e.depMatched[o]&&!i[s]&&(m(t,s)?(e.defineDep(o,A[s]),e.check()):h(r,t,i))}),i[n]=!0)}function f(){var e,t,i=(e=1e3*P.waitSeconds)&&O.startTime+e<(new Date).getTime(),s=[],r=[],a=!1,l=!0;if(!_){if(_=!0,B(S,function(e){var u=e.map,c=u.id;if(e.enabled&&(u.isDefine||r.push(e),!e.error))if(!e.inited&&i)o(c)?a=t=!0:(s.push(c),n(c));else if(!e.inited&&e.fetched&&u.isDefine&&(a=!0,!u.prefix))return l=!1}),i&&s.length)return e=C("timeout","Load timeout for modules: "+s,null,s),e.contextName=O.contextName,c(e);l&&v(r,function(e){h(e,{},{})}),i&&!t||!a||!z&&!ea||E||(E=setTimeout(function(){E=0,f()},50)),_=!1}}function b(e){t(A,e[0])||a(r(e[0],null,!0)).init(e[1],e[2])}function y(e){var e=e.currentTarget||e.srcElement,t=O.onScriptLoad;return e.detachEvent&&!Y?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=O.onScriptError,(!e.detachEvent||Y)&&e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function w(){var e;for(d();F.length;){if(e=F.shift(),null===e[0])return c(C("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));b(e)}}var _,x,O,k,E,P={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},D={},S={},I={},F=[],A={},L={},j={},W=1,q=1;return k={require:function(e){return e.require?e.require:e.require=O.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?A[e.map.id]=e.exports:e.exports=A[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return m(P.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},x=function(e){this.events=m(I,e.id)||{},this.map=e,this.shim=m(P.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},x.prototype={init:function(e,t,i,n){n=n||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=u(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,O.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();O.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;L[e]||(L[e]=!0,O.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id;t=this.depExports;var n=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(G(o)){if(this.events.error&&this.map.isDefine||g.onError!==ca)try{n=O.execCb(i,o,t,n)}catch(s){e=s}else n=O.execCb(i,o,t,n);if(this.map.isDefine&&void 0===n&&((t=this.module)?n=t.exports:this.usingExports&&(n=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e)}else n=o;this.exports=n,this.map.isDefine&&!this.ignore&&(A[i]=n,g.onResourceLoad)&&g.onResourceLoad(O,this.map,this.depMaps),p(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,n=e.id,o=r(e.prefix);this.depMaps.push(o),l(o,"defined",u(this,function(o){var s,d;d=m(j,this.map.id);var h=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,v=O.makeRequire(e.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(o.normalize&&(h=o.normalize(h,function(e){return i(e,f,!0)})||""),o=r(e.prefix+"!"+h,this.map.parentMap),l(o,"defined",u(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),(d=m(D,o.id))&&(this.depMaps.push(o),this.events.error&&d.on("error",u(this,function(e){this.emit("error",e)})),d.enable())):d?(this.map.url=O.nameToUrl(d),this.load()):(s=u(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),s.error=u(this,function(e){this.inited=!0,this.error=e,e.requireModules=[n],B(D,function(e){0===e.map.id.indexOf(n+"_unnormalized")&&p(e.map.id)}),c(e)}),s.fromText=u(this,function(i,o){var l=e.name,u=r(l),d=M;o&&(i=o),d&&(M=!1),a(u),t(P.config,n)&&(P.config[l]=P.config[n]);try{g.exec(i)}catch(p){return c(C("fromtexteval","fromText eval for "+n+" failed: "+p,p,[n]))}d&&(M=!0),this.depMaps.push(u),O.completeLoad(l),v([l],s)}),o.load(e.name,v,s,P))})),O.enable(o,this),this.pluginMaps[o.id]=o},enable:function(){S[this.map.id]=this,this.enabling=this.enabled=!0,v(this.depMaps,u(this,function(e,i){var n,o;if("string"==typeof e){if(e=r(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[i]=e,n=m(k,e.id))return void(this.depExports[i]=n(this));this.depCount+=1,l(e,"defined",u(this,function(e){this.defineDep(i,e),this.check()})),this.errback&&l(e,"error",u(this,this.errback))}n=e.id,o=D[n],!t(k,n)&&o&&!o.enabled&&O.enable(e,this)})),B(this.pluginMaps,u(this,function(e){var t=m(D,e.id);t&&!t.enabled&&O.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){v(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},O={config:P,contextName:e,registry:D,defined:A,urlFetched:L,defQueue:F,Module:x,makeModuleMap:r,nextTick:g.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=P.shim,i={paths:!0,bundles:!0,config:!0,map:!0};B(e,function(e,t){i[t]?(P[t]||(P[t]={}),U(P[t],e,!0,!0)):P[t]=e}),e.bundles&&B(e.bundles,function(e,t){v(e,function(e){e!==t&&(j[e]=t)})}),e.shim&&(B(e.shim,function(e,i){H(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=O.makeShimExports(e)),t[i]=e}),P.shim=t),e.packages&&v(e.packages,function(e){var t,e="string"==typeof e?{name:e}:e;t=e.name,e.location&&(P.paths[t]=e.location),P.pkgs[t]=e.name+"/"+(e.main||"main").replace(ia,"").replace(Q,"")}),B(D,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=r(t))}),(e.deps||e.callback)&&O.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(ba,arguments)),t||e.exports&&da(e.exports)}},makeRequire:function(o,s){function l(i,n,u){var d,p;return s.enableBuildCallback&&n&&G(n)&&(n.__requireJsBuild=!0),"string"==typeof i?G(n)?c(C("requireargs","Invalid require call"),u):o&&t(k,i)?k[i](D[o.id]):g.get?g.get(O,i,o,l):(d=r(i,o,!1,!0),d=d.id,t(A,d)?A[d]:c(C("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+e+(o?"":". Use require([])")))):(w(),O.nextTick(function(){w(),p=a(r(null,o)),p.skipMap=s.skipMap,p.init(i,n,u,{enabled:!0}),f()}),l)}return s=s||{},U(l,{isBrowser:z,toUrl:function(e){var t,n=e.lastIndexOf("."),s=e.split("/")[0];return-1!==n&&("."!==s&&".."!==s||n>1)&&(t=e.substring(n,e.length),e=e.substring(0,n)),O.nameToUrl(i(e,o&&o.id,!0),t,!0)},defined:function(e){return t(A,r(e,o,!1,!0).id)},specified:function(e){return e=r(e,o,!1,!0).id,t(A,e)||t(D,e)}}),o||(l.undef=function(e){d();var t=r(e,o,!0),i=m(D,e);n(e),delete A[e],delete L[t.url],delete I[e],T(F,function(t,i){t[0]===e&&F.splice(i,1)}),i&&(i.events.defined&&(I[e]=i.events),p(e))}),l},enable:function(e){m(D,e.id)&&a(e).enable()},completeLoad:function(e){var i,n,s=m(P.shim,e)||{},r=s.exports;for(d();F.length;){if(n=F.shift(),null===n[0]){if(n[0]=e,i)break;i=!0}else n[0]===e&&(i=!0);b(n)}if(n=m(D,e),!i&&!t(A,e)&&n&&!n.inited){if(P.enforceDefine&&(!r||!da(r)))return o(e)?void 0:c(C("nodefine","No define call for "+e,null,[e]));b([e,s.deps||[],s.exportsFn])}f()},nameToUrl:function(e,t,i){var n,o,s;if((n=m(P.pkgs,e))&&(e=n),n=m(j,e))return O.nameToUrl(n,t,i);if(g.jsExtRegExp.test(e))n=e+(t||"");else{for(n=P.paths,e=e.split("/"),o=e.length;o>0;o-=1)if(s=e.slice(0,o).join("/"),s=m(n,s)){H(s)&&(s=s[0]),e.splice(0,o,s);break}n=e.join("/"),n+=t||(/^data\:|\?/.test(n)||i?"":".js"),n=("/"===n.charAt(0)||n.match(/^[\w\+\.\-]+:/)?"":P.baseUrl)+n}return P.urlArgs?n+((-1===n.indexOf("?")?"?":"&")+P.urlArgs):n},load:function(e,t){g.load(O,e,t)},execCb:function(e,t,i,n){return t.apply(n,i)},onScriptLoad:function(e){("load"===e.type||ja.test((e.currentTarget||e.srcElement).readyState))&&(N=null,e=y(e),O.completeLoad(e.id))},onScriptError:function(e){var t=y(e);return o(t.id)?void 0:c(C("scripterror","Script error for: "+t.id,e,[t.id]))}},O.require=O.makeRequire(),O}var g,x,y,D,I,E,N,J,s,O,ka=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,la=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,Q=/\.js$/,ia=/^\.\//;x=Object.prototype;var K=x.toString,fa=x.hasOwnProperty,ha=Array.prototype.splice,z=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),ea=!z&&"undefined"!=typeof importScripts,ja=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,Y="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),F={},q={},R=[],M=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(G(requirejs))return;q=requirejs,requirejs=void 0}"undefined"!=typeof require&&!G(require)&&(q=require,require=void 0),g=requirejs=function(e,t,i,n){var o,s="_";return!H(e)&&"string"!=typeof e&&(o=e,H(t)?(e=t,t=i,i=n):e=[]),o&&o.context&&(s=o.context),(n=m(F,s))||(n=F[s]=g.s.newContext(s)),o&&n.configure(o),n.require(e,t,i)},g.config=function(e){return g(e)},g.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=g),g.version="2.1.14",g.jsExtRegExp=/^\/|:|\?|\.js$/,g.isBrowser=z,x=g.s={contexts:F,newContext:ga},g({}),v(["toUrl","undef","defined","specified"],function(e){g[e]=function(){var t=F._;return t.require[e].apply(t,arguments)}}),z&&(y=x.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0])&&(y=x.head=D.parentNode),g.onError=ca,g.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},g.load=function(e,t,i){var n=e&&e.config||{};if(z)return n=g.createNode(n,t,i),n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&0>n.attachEvent.toString().indexOf("[native code")||Y?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(M=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=i,J=n,D?y.insertBefore(n,D):y.appendChild(n),J=null,n;if(ea)try{importScripts(i),e.completeLoad(t)}catch(o){e.onError(C("importscripts","importScripts failed for "+t+" at "+i,o,[t]))}},z&&!q.skipDataMain&&T(document.getElementsByTagName("script"),function(e){return y||(y=e.parentNode),(I=e.getAttribute("data-main"))?(s=I,q.baseUrl||(E=s.split("/"),s=E.pop(),O=E.length?E.join("/")+"/":"./",q.baseUrl=O),s=s.replace(Q,""),g.jsExtRegExp.test(s)&&(s=I),q.deps=q.deps?q.deps.concat(s):[s],!0):void 0}),define=function(e,t,i){var n,o;"string"!=typeof e&&(i=t,t=e,e=null),H(t)||(i=t,t=null),!t&&G(i)&&(t=[],i.length&&(i.toString().replace(ka,"").replace(la,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),M&&((n=J)||(N&&"interactive"===N.readyState||T(document.getElementsByTagName("script"),function(e){return"interactive"===e.readyState?N=e:void 0}),n=N),n&&(e||(e=n.getAttribute("data-requiremodule")),o=F[n.getAttribute("data-requirecontext")])),(o?o.defQueue:R).push([e,t,i])},define.amd={jQuery:!0},g.exec=function(b){return eval(b)},g(q)}}(this),define("requireLib",function(){}),function(){var e=this,t=e._,i={},n=Array.prototype,o=Object.prototype,s=Function.prototype,r=n.push,a=n.slice,l=n.concat,u=o.toString,c=o.hasOwnProperty,d=n.forEach,p=n.map,h=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,v=n.some,b=n.indexOf,y=n.lastIndexOf,C=Array.isArray,w=Object.keys,_=s.bind,x=function(e){return e instanceof x?e:this instanceof x?void(this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var O=x.each=x.forEach=function(e,t,n){if(null==e)return e;if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var o=0,s=e.length;s>o;o++)if(t.call(n,e[o],o,e)===i)return}else for(var r=x.keys(e),o=0,s=r.length;s>o;o++)if(t.call(n,e[r[o]],r[o],e)===i)return;return e};x.map=x.collect=function(e,t,i){var n=[];return null==e?n:p&&e.map===p?e.map(t,i):(O(e,function(e,o,s){n.push(t.call(i,e,o,s))}),n)};var k="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,i,n){var o=arguments.length>2;if(null==e&&(e=[]),h&&e.reduce===h)return n&&(t=x.bind(t,n)),o?e.reduce(t,i):e.reduce(t);if(O(e,function(e,s,r){o?i=t.call(n,i,e,s,r):(i=e,o=!0)}),!o)throw new TypeError(k);return i},x.reduceRight=x.foldr=function(e,t,i,n){var o=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=x.bind(t,n)),o?e.reduceRight(t,i):e.reduceRight(t);var s=e.length;if(s!==+s){var r=x.keys(e);s=r.length}if(O(e,function(a,l,u){l=r?r[--s]:--s,o?i=t.call(n,i,e[l],l,u):(i=e[l],o=!0)}),!o)throw new TypeError(k);return i},x.find=x.detect=function(e,t,i){var n;return E(e,function(e,o,s){return t.call(i,e,o,s)?(n=e,!0):void 0}),n},x.filter=x.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(O(e,function(e,o,s){t.call(i,e,o,s)&&n.push(e)}),n)},x.reject=function(e,t,i){return x.filter(e,function(e,n,o){return!t.call(i,e,n,o)},i)},x.every=x.all=function(e,t,n){t||(t=x.identity);var o=!0;return null==e?o:g&&e.every===g?e.every(t,n):(O(e,function(e,s,r){return(o=o&&t.call(n,e,s,r))?void 0:i}),!!o)};var E=x.some=x.any=function(e,t,n){t||(t=x.identity);var o=!1;return null==e?o:v&&e.some===v?e.some(t,n):(O(e,function(e,s,r){return o||(o=t.call(n,e,s,r))?i:void 0}),!!o)};x.contains=x.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):E(e,function(e){return e===t})},x.invoke=function(e,t){var i=a.call(arguments,2),n=x.isFunction(t);return x.map(e,function(e){return(n?t:e[t]).apply(e,i)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var n=-1/0,o=-1/0;return O(e,function(e,s,r){var a=t?t.call(i,e,s,r):e;a>o&&(n=e,o=a)}),n},x.min=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var n=1/0,o=1/0;return O(e,function(e,s,r){var a=t?t.call(i,e,s,r):e;o>a&&(n=e,o=a)}),n},x.shuffle=function(e){var t,i=0,n=[];return O(e,function(e){t=x.random(i++),n[i-1]=n[t],n[t]=e}),n},x.sample=function(e,t,i){return null==t||i?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var T=function(e){return null==e?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,i){return t=T(t),x.pluck(x.map(e,function(e,n,o){return{value:e,index:n,criteria:t.call(i,e,n,o)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var P=function(e){return function(t,i,n){var o={};return i=T(i),O(t,function(s,r){var a=i.call(n,s,r,t);e(o,a,s)}),o}};x.groupBy=P(function(e,t,i){x.has(e,t)?e[t].push(i):e[t]=[i]}),x.indexBy=P(function(e,t,i){e[t]=i}),x.countBy=P(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,i,n){i=T(i);for(var o=i.call(n,t),s=0,r=e.length;r>s;){var a=s+r>>>1;i.call(n,e[a])<o?s=a+1:r=a}return s},x.toArray=function(e){return e?x.isArray(e)?a.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:0>t?[]:a.call(e,0,t)},x.initial=function(e,t,i){return a.call(e,0,e.length-(null==t||i?1:t))},x.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,i){return a.call(e,null==t||i?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var z=function(e,t,i){return t&&x.every(e,x.isArray)?l.apply(i,e):(O(e,function(e){x.isArray(e)||x.isArguments(e)?t?r.apply(i,e):z(e,t,i):i.push(e)}),i)};x.flatten=function(e,t){return z(e,t,[])},x.without=function(e){return x.difference(e,a.call(arguments,1))},x.partition=function(e,t){var i=[],n=[];return O(e,function(e){(t(e)?i:n).push(e)}),[i,n]},x.uniq=x.unique=function(e,t,i,n){x.isFunction(t)&&(n=i,i=t,t=!1);var o=i?x.map(e,i,n):e,s=[],r=[];return O(o,function(i,n){(t?n&&r[r.length-1]===i:x.contains(r,i))||(r.push(i),s.push(e[n]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=a.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=l.apply(n,a.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e),i=0;e>i;i++)t[i]=x.pluck(arguments,""+i);return t},x.object=function(e,t){if(null==e)return{};for(var i={},n=0,o=e.length;o>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},x.indexOf=function(e,t,i){if(null==e)return-1;var n=0,o=e.length;if(i){if("number"!=typeof i)return n=x.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,o+i):i}if(b&&e.indexOf===b)return e.indexOf(t,i);for(;o>n;n++)if(e[n]===t)return n;return-1},x.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(y&&e.lastIndexOf===y)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var o=n?i:e.length;o--;)if(e[o]===t)return o;return-1},x.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),o=0,s=new Array(n);n>o;)s[o++]=e,e+=i;return s};var D=function(){};x.bind=function(e,t){var i,n;if(_&&e.bind===_)return _.apply(e,a.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(a.call(arguments)));D.prototype=e.prototype;var o=new D;D.prototype=null;var s=e.apply(o,i.concat(a.call(arguments)));return Object(s)===s?s:o}},x.partial=function(e){var t=a.call(arguments,1);return function(){for(var i=0,n=t.slice(),o=0,s=n.length;s>o;o++)n[o]===x&&(n[o]=arguments[i++]);for(;i<arguments.length;)n.push(arguments[i++]);return e.apply(this,n)}},x.bindAll=function(e){var t=a.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return O(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var i={};return t||(t=x.identity),function(){var n=t.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},x.delay=function(e,t){var i=a.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(a.call(arguments,1)))},x.throttle=function(e,t,i){var n,o,s,r=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:x.now(),r=null,s=e.apply(n,o),n=o=null};return function(){var u=x.now();a||i.leading!==!1||(a=u);var c=t-(u-a);return n=this,o=arguments,0>=c?(clearTimeout(r),r=null,a=u,s=e.apply(n,o),n=o=null):r||i.trailing===!1||(r=setTimeout(l,c)),s}},x.debounce=function(e,t,i){var n,o,s,r,a,l=function(){var u=x.now()-r;t>u?n=setTimeout(l,t-u):(n=null,i||(a=e.apply(s,o),s=o=null))};return function(){s=this,o=arguments,r=x.now();var u=i&&!n;return n||(n=setTimeout(l,t)),u&&(a=e.apply(s,o),s=o=null),a}},x.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=function(e){if(!x.isObject(e))return[];if(w)return w(e);var t=[];for(var i in e)x.has(e,i)&&t.push(i);return t},x.values=function(e){for(var t=x.keys(e),i=t.length,n=new Array(i),o=0;i>o;o++)n[o]=e[t[o]];return n},x.pairs=function(e){for(var t=x.keys(e),i=t.length,n=new Array(i),o=0;i>o;o++)n[o]=[t[o],e[t[o]]];return n},x.invert=function(e){for(var t={},i=x.keys(e),n=0,o=i.length;o>n;n++)t[e[i[n]]]=i[n];return t},x.functions=x.methods=function(e){var t=[];for(var i in e)x.isFunction(e[i])&&t.push(i);return t.sort()},x.extend=function(e){return O(a.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},x.pick=function(e){var t={},i=l.apply(n,a.call(arguments,1));return O(i,function(i){i in e&&(t[i]=e[i])}),t},x.omit=function(e){var t={},i=l.apply(n,a.call(arguments,1));for(var o in e)x.contains(i,o)||(t[o]=e[o]);return t},x.defaults=function(e){return O(a.call(arguments,1),function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var S=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var o=u.call(e);if(o!=u.call(t))return!1;switch(o){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=i.length;s--;)if(i[s]==e)return n[s]==t;var r=e.constructor,a=t.constructor;if(r!==a&&!(x.isFunction(r)&&r instanceof r&&x.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1;i.push(e),n.push(t);var l=0,c=!0;if("[object Array]"==o){if(l=e.length,c=l==t.length)for(;l--&&(c=S(e[l],t[l],i,n)););}else{for(var d in e)if(x.has(e,d)&&(l++,!(c=x.has(t,d)&&S(e[d],t[d],i,n))))break;if(c){for(d in t)if(x.has(t,d)&&!l--)break;c=!l}}return i.pop(),n.pop(),c};x.isEqual=function(e,t){return S(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=C||function(e){return"[object Array]"==u.call(e)},x.isObject=function(e){return e===Object(e)},O(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return c.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var i in e)if(e[i]!==t[i])return!1;return!0}},x.times=function(e,t,i){for(var n=Array(Math.max(0,e)),o=0;e>o;o++)n[o]=t.call(i,o);return n},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=x.invert(I.escape);var F={escape:new RegExp("["+x.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(I.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(F[e],function(t){return I[e][t]})}}),x.result=function(e,t){if(null==e)return void 0;var i=e[t];return x.isFunction(i)?i.call(e):i},x.mixin=function(e){O(x.functions(e),function(t){var i=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),A.call(this,i.apply(x,e))}})};var R=0;x.uniqueId=function(e){var t=++R+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,i){var n;i=x.defaults({},i,x.templateSettings);var o=new RegExp([(i.escape||N).source,(i.interpolate||N).source,(i.evaluate||N).source].join("|")+"|$","g"),s=0,r="__p+='";e.replace(o,function(t,i,n,o,a){return r+=e.slice(s,a).replace(H,function(e){return"\\"+M[e]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(r+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(r+="';\n"+o+"\n__p+='"),s=a+t.length,t}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(i.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(t)return n(t,x);var l=function(e){return n.call(this,e,x)};return l.source="function("+(i.variable||"obj")+"){\n"+r+"}",l},x.chain=function(e){return x(e).chain()};var A=function(e){return this._chain?x(e).chain():e};x.mixin(x),O(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];x.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],A.call(this,i)}}),O(["concat","join","slice"],function(e){var t=n[e];x.prototype[e]=function(){return A.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),window.Modernizr=function(e,t,i){function n(e){y.cssText=e}function o(e,t){return n(x.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function a(e,t){for(var n in e){var o=e[n];if(!r(o,"-")&&y[o]!==i)return"pfx"==t?o:!0}return!1}function l(e,t,n){for(var o in e){var r=t[e[o]];if(r!==i)return n===!1?e[o]:s(r,"function")?r.bind(n||t):r}return!1}function u(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),o=(e+" "+k.join(n+" ")+n).split(" ");return s(t,"string")||s(t,"undefined")?a(o,t):(o=(e+" "+E.join(n+" ")+n).split(" "),l(o,t,i))}function c(){f.input=function(i){for(var n=0,o=i.length;o>n;n++)D[i[n]]=i[n]in C;return D.list&&(D.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),D}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),f.inputtypes=function(e){for(var n,o,s,r=0,a=e.length;a>r;r++)C.setAttribute("type",o=e[r]),n="text"!==C.type,n&&(C.value=w,C.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(o)&&C.style.WebkitAppearance!==i?(g.appendChild(C),s=t.defaultView,n=s.getComputedStyle&&"textfield"!==s.getComputedStyle(C,null).WebkitAppearance&&0!==C.offsetHeight,g.removeChild(C)):/^(search|tel)$/.test(o)||(n=/^(url|email)$/.test(o)?C.checkValidity&&C.checkValidity()===!1:C.value!=w)),z[e[r]]=!!n;return z}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d,p,h="2.6.2",f={},m=!0,g=t.documentElement,v="modernizr",b=t.createElement(v),y=b.style,C=t.createElement("input"),w=":)",_={}.toString,x=" -webkit- -moz- -o- -ms- ".split(" "),O="Webkit Moz O ms",k=O.split(" "),E=O.toLowerCase().split(" "),T={svg:"http://www.w3.org/2000/svg"},P={},z={},D={},S=[],I=S.slice,F=function(e,i,n,o){var s,r,a,l,u=t.createElement("div"),c=t.body,d=c||t.createElement("body");if(parseInt(n,10))for(;n--;)a=t.createElement("div"),a.id=o?o[n]:v+(n+1),u.appendChild(a);return s=["&#173;",'<style id="s',v,'">',e,"</style>"].join(""),u.id=v,(c?u:d).innerHTML+=s,d.appendChild(u),c||(d.style.background="",d.style.overflow="hidden",l=g.style.overflow,g.style.overflow="hidden",g.appendChild(d)),r=i(u,e),c?u.parentNode.removeChild(u):(d.parentNode.removeChild(d),g.style.overflow=l),!!r},R=function(){function e(e,o){o=o||t.createElement(n[e]||"div"),e="on"+e;var r=e in o;return r||(o.setAttribute||(o=t.createElement("div")),o.setAttribute&&o.removeAttribute&&(o.setAttribute(e,""),r=s(o[e],"function"),s(o[e],"undefined")||(o[e]=i),o.removeAttribute(e))),o=null,r}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};
return e}(),N={}.hasOwnProperty;p=s(N,"undefined")||s(N.call,"undefined")?function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")}:function(e,t){return N.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=I.call(arguments,1),n=function(){if(this instanceof n){var o=function(){};o.prototype=t.prototype;var s=new o,r=t.apply(s,i.concat(I.call(arguments)));return Object(r)===r?r:s}return t.apply(e,i.concat(I.call(arguments)))};return n}),P.flexbox=function(){return u("flexWrap")},P.flexboxlegacy=function(){return u("boxDirection")},P.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},P.canvastext=function(){return!!f.canvas&&!!s(t.createElement("canvas").getContext("2d").fillText,"function")},P.webgl=function(){return!!e.WebGLRenderingContext},P.touch=function(){var i;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?i=!0:F(["@media (",x.join("touch-enabled),("),v,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){i=9===e.offsetTop}),i},P.geolocation=function(){return"geolocation"in navigator},P.postmessage=function(){return!!e.postMessage},P.websqldatabase=function(){return!!e.openDatabase},P.indexedDB=function(){return!!u("indexedDB",e)},P.hashchange=function(){return R("hashchange",e)&&(t.documentMode===i||t.documentMode>7)},P.history=function(){return!!e.history&&!!history.pushState},P.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},P.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},P.rgba=function(){return n("background-color:rgba(150,255,150,.5)"),r(y.backgroundColor,"rgba")},P.hsla=function(){return n("background-color:hsla(120,40%,100%,.5)"),r(y.backgroundColor,"rgba")||r(y.backgroundColor,"hsla")},P.multiplebgs=function(){return n("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(y.background)},P.backgroundsize=function(){return u("backgroundSize")},P.borderimage=function(){return u("borderImage")},P.borderradius=function(){return u("borderRadius")},P.boxshadow=function(){return u("boxShadow")},P.textshadow=function(){return""===t.createElement("div").style.textShadow},P.opacity=function(){return o("opacity:.55"),/^0.55$/.test(y.opacity)},P.cssanimations=function(){return u("animationName")},P.csscolumns=function(){return u("columnCount")},P.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",i="linear-gradient(left top,#9f9, white);";return n((e+"-webkit- ".split(" ").join(t+e)+x.join(i+e)).slice(0,-e.length)),r(y.backgroundImage,"gradient")},P.cssreflections=function(){return u("boxReflect")},P.csstransforms=function(){return!!u("transform")},P.csstransforms3d=function(){var e=!!u("perspective");return e&&"webkitPerspective"in g.style&&F("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},P.csstransitions=function(){return u("transition")},P.fontface=function(){var e;return F('@font-face {font-family:"font";src:url("https://")}',function(i,n){var o=t.getElementById("smodernizr"),s=o.sheet||o.styleSheet,r=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"";e=/src/i.test(r)&&0===r.indexOf(n.split(" ")[0])}),e},P.generatedcontent=function(){var e;return F(["#",v,"{font:0/0 a}#",v,':after{content:"',w,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},P.video=function(){var e=t.createElement("video"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(n){}return i},P.audio=function(){var e=t.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&(i=new Boolean(i),i.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),i.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return i},P.localstorage=function(){try{return localStorage.setItem(v,v),localStorage.removeItem(v),!0}catch(e){return!1}},P.sessionstorage=function(){try{return sessionStorage.setItem(v,v),sessionStorage.removeItem(v),!0}catch(e){return!1}},P.webworkers=function(){return!!e.Worker},P.applicationcache=function(){return!!e.applicationCache},P.svg=function(){return!!t.createElementNS&&!!t.createElementNS(T.svg,"svg").createSVGRect},P.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==T.svg},P.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(_.call(t.createElementNS(T.svg,"animate")))},P.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(_.call(t.createElementNS(T.svg,"clipPath")))};for(var M in P)p(P,M)&&(d=M.toLowerCase(),f[d]=P[M](),S.push((f[d]?"":"no-")+d));return f.input||c(),f.addTest=function(e,t){if("object"==typeof e)for(var n in e)p(e,n)&&f.addTest(n,e[n]);else{if(e=e.toLowerCase(),f[e]!==i)return f;t="function"==typeof t?t():t,"undefined"!=typeof m&&m&&(g.className+=" "+(t?"":"no-")+e),f[e]=t}return f},n(""),b=C=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function o(e){var t=g[e[f]];return t||(t={},m++,e[f]=m,g[m]=t),t}function s(e,i,n){if(i||(i=t),c)return i.createElement(e);n||(n=o(i));var s;return s=n.cache[e]?n.cache[e].cloneNode():h.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e),s.canHaveChildren&&!p.test(e)?n.frag.appendChild(s):s}function r(e,i){if(e||(e=t),c)return e.createDocumentFragment();i=i||o(e);for(var s=i.frag.cloneNode(),r=0,a=n(),l=a.length;l>r;r++)s.createElement(a[r]);return s}function a(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return v.shivMethods?s(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function l(e){e||(e=t);var n=o(e);return v.shivCSS&&!u&&!n.hasCSS&&(n.hasCSS=!!i(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),c||a(e,n),e}var u,c,d=e.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,h=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",m=0,g={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",u="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(i){u=!0,c=!0}}();var v={elements:d.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:d.shivCSS!==!1,supportsUnknownElements:c,shivMethods:d.shivMethods!==!1,type:"default",shivDocument:l,createElement:s,createDocumentFragment:r};e.html5=v,l(t)}(this,t),f._version=h,f._prefixes=x,f._domPrefixes=E,f._cssomPrefixes=k,f.hasEvent=R,f.testProp=function(e){return a([e])},f.testAllProps=u,f.testStyles=F,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(m?" js "+S.join(" "):""),f}(this,this.document),function(e,t,i){function n(e){return"[object Function]"==g.call(e)}function o(e){return"string"==typeof e}function s(){}function r(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function a(){var e=v.shift();b=1,e?e.t?f(function(){("c"==e.t?p.injectCss:p.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),a()):b=0}function l(e,i,n,o,s,l,u){function c(t){if(!h&&r(d.readyState)&&(y.r=h=1,!b&&a(),d.onload=d.onreadystatechange=null,t)){"img"!=e&&f(function(){w.removeChild(d)},50);for(var n in E[i])E[i].hasOwnProperty(n)&&E[i][n].onload()}}var u=u||p.errorTimeout,d=t.createElement(e),h=0,g=0,y={t:n,s:i,e:s,a:l,x:u};1===E[i]&&(g=1,E[i]=[]),"object"==e?d.data=i:(d.src=i,d.type=e),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){c.call(this,g)},v.splice(o,0,y),"img"!=e&&(g||2===E[i]?(w.insertBefore(d,C?null:m),f(c,u)):E[i].push(d))}function u(e,t,i,n,s){return b=0,t=t||"j",o(e)?l("c"==t?x:_,e,t,this.i++,i,n,s):(v.splice(this.i++,0,e),1==v.length&&a()),this}function c(){var e=p;return e.loader={load:u,i:0},e}var d,p,h=t.documentElement,f=e.setTimeout,m=t.getElementsByTagName("script")[0],g={}.toString,v=[],b=0,y="MozAppearance"in h.style,C=y&&!!t.createRange().compareNode,w=C?h:m.parentNode,h=e.opera&&"[object Opera]"==g.call(e.opera),h=!!t.attachEvent&&!h,_=y?"object":h?"script":"img",x=h?"script":_,O=Array.isArray||function(e){return"[object Array]"==g.call(e)},k=[],E={},T={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};p=function(e){function t(e){var t,i,n,e=e.split("!"),o=k.length,s=e.pop(),r=e.length,s={url:s,origUrl:s,prefixes:e};for(i=0;r>i;i++)n=e[i].split("="),(t=T[n.shift()])&&(s=t(s,n));for(i=0;o>i;i++)s=k[i](s);return s}function r(e,o,s,r,a){var l=t(e),u=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(o&&(o=n(o)?o:o[e]||o[r]||o[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,o,s,r,a):(E[l.url]?l.noexec=!0:E[l.url]=1,s.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":i,l.noexec,l.attrs,l.timeout),(n(o)||n(u))&&s.load(function(){c(),o&&o(l.origUrl,a,r),u&&u(l.origUrl,a,r),E[l.url]=2})))}function a(e,t){function i(e,i){if(e){if(o(e))i||(d=function(){var e=[].slice.call(arguments);p.apply(this,e),h()}),r(e,d,t,0,u);else if(Object(e)===e)for(l in a=function(){var t,i=0;for(t in e)e.hasOwnProperty(t)&&i++;return i}(),e)e.hasOwnProperty(l)&&(!i&&!--a&&(n(d)?d=function(){var e=[].slice.call(arguments);p.apply(this,e),h()}:d[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),h()}}(p[l])),r(e[l],d,t,l,u))}else!i&&h()}var a,l,u=!!e.test,c=e.load||e.both,d=e.callback||s,p=d,h=e.complete||s;i(u?e.yep:e.nope,!!c),c&&i(c)}var l,u,d=this.yepnope.loader;if(o(e))r(e,0,d,0);else if(O(e))for(l=0;l<e.length;l++)u=e[l],o(u)?r(u,0,d,0):O(u)?p(u):Object(u)===u&&a(u,d);else Object(e)===e&&a(e,d)},p.addPrefix=function(e,t){T[e]=t},p.addFilter=function(e){k.push(e)},p.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",d=function(){t.removeEventListener("DOMContentLoaded",d,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=a,e.yepnope.injectJs=function(e,i,n,o,l,u){var c,d,h=t.createElement("script"),o=o||p.errorTimeout;h.src=e;for(d in n)h.setAttribute(d,n[d]);i=u?a:i||s,h.onreadystatechange=h.onload=function(){!c&&r(h.readyState)&&(c=1,i(),h.onload=h.onreadystatechange=null)},f(function(){c||(c=1,i(1))},o),l?h.onload():m.parentNode.insertBefore(h,m)},e.yepnope.injectCss=function(e,i,n,o,r,l){var u,o=t.createElement("link"),i=l?a:i||s;o.href=e,o.rel="stylesheet",o.type="text/css";for(u in n)o.setAttribute(u,n[u]);r||(m.parentNode.insertBefore(o,m),f(i,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},define("modernizr",function(){}),define("tipsy",["jquery"],function(e){function t(e,t){return"function"==typeof e?e.call(t):e}function i(e){for(;e=e.parentNode;)if(e==document)return!0;return!1}function n(t,i){this.$element=e(t),this.options=i,this.enabled=!0,this.fixTitle()}n.prototype={show:function(){var i=this.getTitle();if(i&&this.enabled){var n=this.tip();n.find(".tipsy-inner")[this.options.html?"html":"text"](i),n[0].className="tipsy",n.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var o,s=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),r=n[0].offsetWidth,a=n[0].offsetHeight,l=t(this.options.gravity,this.$element[0]);switch(l.charAt(0)){case"n":o={top:s.top+s.height+this.options.offset,left:s.left+s.width/2-r/2};break;case"s":o={top:s.top-a-this.options.offset,left:s.left+s.width/2-r/2};break;case"e":o={top:s.top+s.height/2-a/2,left:s.left-r-this.options.offset};break;case"w":o={top:s.top+s.height/2-a/2,left:s.left+s.width+this.options.offset}}2==l.length&&(o.left="w"==l.charAt(1)?s.left+s.width/2-15:s.left+s.width/2-r+15),n.css(o).addClass("tipsy-"+l),n.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+l.charAt(0),this.options.className&&n.addClass(t(this.options.className,this.$element[0])),this.options.fade?n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):n.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){e(this).remove()}):this.tip().remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("original-title"))&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,i=this.options;this.fixTitle();var e,i=this.options;return"string"==typeof i.title?e=t.attr("title"==i.title?"original-title":i.title):"function"==typeof i.title&&(e=i.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||i.fallback},tip:function(){return this.$tip||(this.$tip=e('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},e.fn.tipsy=function(t){function i(i){var o=e.data(i,"tipsy");return o||(o=new n(i,e.fn.tipsy.elementOptions(i,t)),e.data(i,"tipsy",o)),o}function o(){var e=i(this);e.hoverState="in",0==t.delayIn?e.show():(e.fixTitle(),setTimeout(function(){"in"==e.hoverState&&e.show()},t.delayIn))}function s(){var e=i(this);e.hoverState="out",0==t.delayOut?e.hide():setTimeout(function(){"out"==e.hoverState&&e.hide()},t.delayOut)}if(t===!0)return this.data("tipsy");if("string"==typeof t){var r=this.data("tipsy");return r&&r[t](),this}if(t=e.extend({},e.fn.tipsy.defaults,t),t.live||this.each(function(){i(this)}),"manual"!=t.trigger){var a=t.live?"live":"bind",l="hover"==t.trigger?"mouseenter":"focus",u="hover"==t.trigger?"mouseleave":"blur";this[a](l,o)[a](u,s)}return this},e.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},e.fn.tipsy.revalidate=function(){e(".tipsy").each(function(){var t=e.data(this,"tipsy-pointee");t&&i(t)||e(this).remove()})},e.fn.tipsy.elementOptions=function(t,i){return e.metadata?e.extend({},i,e(t).metadata()):i},e.fn.tipsy.autoNS=function(){return e(this).offset().top>e(document).scrollTop()+e(window).height()/2?"s":"n"},e.fn.tipsy.autoWE=function(){return e(this).offset().left>e(document).scrollLeft()+e(window).width()/2?"e":"w"},e.fn.tipsy.autoBounds=function(t,i){return function(){var n={ns:i[0],ew:i.length>1?i[1]:!1},o=e(document).scrollTop()+t,s=e(document).scrollLeft()+t,r=e(this);return r.offset().top<o&&(n.ns="n"),r.offset().left<s&&(n.ew="w"),e(window).width()+e(document).scrollLeft()-r.offset().left<t&&(n.ew="e"),e(window).height()+e(document).scrollTop()-r.offset().top<t&&(n.ns="s"),n.ns+(n.ew?n.ew:"")}}}),function(e){"function"==typeof define&&define.amd?define("ui_core",["jquery"],e):e(jQuery)}(function(e){function t(t,n){var o,s,r,a=t.nodeName.toLowerCase();return"area"===a?(o=t.parentNode,s=o.name,t.href&&s&&"map"===o.nodeName.toLowerCase()?(r=e("img[usemap='#"+s+"']")[0],!!r&&i(r)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),n="absolute"===i,o=t?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var t=e(this);return n&&"static"===t.css("position")?!1:o.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&s.length?s:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var n=e.attr(i,"tabindex"),o=isNaN(n);return(o||n>=0)&&t(i,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function n(t,i,n,s){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?r["inner"+i].call(this):this.each(function(){e(this).css(s,n(this,t)+"px")})},e.fn["outer"+i]=function(t,o){return"number"!=typeof t?r["outer"+i].call(this,t):this.each(function(){e(this).css(s,n(this,t,!0,o)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,n,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(n=parseInt(o.css("zIndex"),10),!isNaN(n)&&0!==n))return n;o=o.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var o,s=e.ui[t].prototype;for(o in n)s.plugins[o]=s.plugins[o]||[],s.plugins[o].push([i,n[o]])},call:function(e,t,i,n){var o,s=e.plugins[t];if(s&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(o=0;o<s.length;o++)e.options[s[o][0]]&&s[o][1].apply(e.element,i)}}}),function(e){"function"==typeof define&&define.amd?define("widget",["jquery"],e):e(jQuery)}(function(e){var t=0,i=Array.prototype.slice;return e.cleanData=function(t){return function(i){var n,o,s;for(s=0;null!=(o=i[s]);s++)try{n=e._data(o,"events"),n&&n.remove&&e(o).triggerHandler("remove")}catch(r){}t(i)}}(e.cleanData),e.widget=function(t,i,n){var o,s,r,a,l={},u=t.split(".")[0];return t=t.split(".")[1],o=u+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[u]=e[u]||{},s=e[u][t],r=e[u][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new r(e,t)},e.extend(r,s,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),a=new i,a.options=e.widget.extend({},a.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},o=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,s=this._superApply;return this._super=e,this._superApply=o,t=n.apply(this,arguments),this._super=i,this._superApply=s,t}}()):void(l[t]=n)}),r.prototype=e.widget.extend(a,{widgetEventPrefix:s?a.widgetEventPrefix||t:t},l,{constructor:r,namespace:u,widgetName:t,widgetFullName:o}),s?(e.each(s._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete s._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r),r},e.widget.extend=function(t){for(var n,o,s=i.call(arguments,1),r=0,a=s.length;a>r;r++)for(n in s[r])o=s[r][n],s[r].hasOwnProperty(n)&&void 0!==o&&(t[n]=e.isPlainObject(o)?e.isPlainObject(t[n])?e.widget.extend({},t[n],o):e.widget.extend({},o):o);return t},e.widget.bridge=function(t,n){var o=n.prototype.widgetFullName||t;e.fn[t]=function(s){var r="string"==typeof s,a=i.call(arguments,1),l=this;return s=!r&&a.length?e.widget.extend.apply(null,[s].concat(a)):s,this.each(r?function(){var i,n=e.data(this,o);return"instance"===s?(l=n,!1):n?e.isFunction(n[s])&&"_"!==s.charAt(0)?(i=n[s].apply(n,a),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+s+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+s+"'")}:function(){var t=e.data(this,o);t?(t.option(s||{}),t._init&&t._init()):e.data(this,o,new n(s,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,o,s,r=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(r={},n=t.split("."),t=n.shift(),n.length){for(o=r[t]=e.widget.extend({},this.options[t]),s=0;s<n.length-1;s++)o[n[s]]=o[n[s]]||{},o=o[n[s]];if(t=n.pop(),1===arguments.length)return void 0===o[t]?null:o[t];o[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];r[t]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var o,s=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=o=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),e.each(n,function(n,r){function a(){return t||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof r?s[r]:r).apply(s,arguments):void 0}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),u=l[1]+s.eventNamespace,c=l[2];c?o.delegate(c,u,a):i.bind(u,a)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var o,s,r=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(o in s)o in i||(i[o]=s[o]);return this.element.trigger(i,n),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,o,s){"string"==typeof o&&(o={effect:o});var r,a=o?o===!0||"number"==typeof o?i:o.effect||i:t;o=o||{},"number"==typeof o&&(o={duration:o}),r=!e.isEmptyObject(o),o.complete=s,o.delay&&n.delay(o.delay),r&&e.effects&&e.effects.effect[a]?n[t](o):a!==t&&n[a]?n[a](o.duration,o.easing,s):n.queue(function(i){e(this)[t](),s&&s.call(n[0]),i()})}}),e.widget}),function(e){"function"==typeof define&&define.amd?define("position",["jquery"],e):e(jQuery)}(function(e){return function(){function t(e,t,i){return[parseFloat(e[0])*(h.test(e[0])?t/100:1),parseFloat(e[1])*(h.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function n(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,s,r=Math.max,a=Math.abs,l=Math.round,u=/left|center|right/,c=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,p=/^\w+/,h=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==o)return o;var t,i,n=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=n.children()[0];return e("body").append(n),t=s.offsetWidth,n.css("overflow","scroll"),i=s.offsetWidth,t===i&&(i=n[0].clientWidth),n.remove(),o=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),o="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,s="scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]),o=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:o,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n||o?i.width():i.outerWidth(),height:n||o?i.height():i.outerHeight()}}},e.fn.position=function(o){if(!o||!o.of)return f.apply(this,arguments);o=e.extend({},o);var h,m,g,v,b,y,C=e(o.of),w=e.position.getWithinInfo(o.within),_=e.position.getScrollInfo(w),x=(o.collision||"flip").split(" "),O={};return y=n(C),C[0].preventDefault&&(o.at="left top"),m=y.width,g=y.height,v=y.offset,b=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(o[this]||"").split(" ");1===i.length&&(i=u.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=u.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),O[this]=[e?e[0]:0,t?t[0]:0],o[this]=[p.exec(i[0])[0],p.exec(i[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===o.at[0]?b.left+=m:"center"===o.at[0]&&(b.left+=m/2),"bottom"===o.at[1]?b.top+=g:"center"===o.at[1]&&(b.top+=g/2),h=t(O.at,m,g),b.left+=h[0],b.top+=h[1],this.each(function(){var n,u,c=e(this),d=c.outerWidth(),p=c.outerHeight(),f=i(this,"marginLeft"),y=i(this,"marginTop"),k=d+f+i(this,"marginRight")+_.width,E=p+y+i(this,"marginBottom")+_.height,T=e.extend({},b),P=t(O.my,c.outerWidth(),c.outerHeight());"right"===o.my[0]?T.left-=d:"center"===o.my[0]&&(T.left-=d/2),"bottom"===o.my[1]?T.top-=p:"center"===o.my[1]&&(T.top-=p/2),T.left+=P[0],T.top+=P[1],s||(T.left=l(T.left),T.top=l(T.top)),n={marginLeft:f,marginTop:y},e.each(["left","top"],function(t,i){e.ui.position[x[t]]&&e.ui.position[x[t]][i](T,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:p,collisionPosition:n,collisionWidth:k,collisionHeight:E,offset:[h[0]+P[0],h[1]+P[1]],my:o.my,at:o.at,within:w,elem:c})}),o.using&&(u=function(e){var t=v.left-T.left,i=t+m-d,n=v.top-T.top,s=n+g-p,l={target:{element:C,left:v.left,top:v.top,width:m,height:g},element:{element:c,left:T.left,top:T.top,width:d,height:p},horizontal:0>i?"left":t>0?"right":"center",vertical:0>s?"top":n>0?"bottom":"middle"};d>m&&a(t+i)<m&&(l.horizontal="center"),p>g&&a(n+s)<g&&(l.vertical="middle"),l.important=r(a(t),a(i))>r(a(n),a(s))?"horizontal":"vertical",o.using.call(this,e,l)}),c.offset(e.extend(T,{using:u}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,a=e.left-t.collisionPosition.marginLeft,l=o-a,u=a+t.collisionWidth-s-o;t.collisionWidth>s?l>0&&0>=u?(i=e.left+l+t.collisionWidth-s-o,e.left+=l-i):e.left=u>0&&0>=l?o:l>u?o+s-t.collisionWidth:o:l>0?e.left+=l:u>0?e.left-=u:e.left=r(e.left-a,e.left)},top:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,a=e.top-t.collisionPosition.marginTop,l=o-a,u=a+t.collisionHeight-s-o;t.collisionHeight>s?l>0&&0>=u?(i=e.top+l+t.collisionHeight-s-o,e.top+=l-i):e.top=u>0&&0>=l?o:l>u?o+s-t.collisionHeight:o:l>0?e.top+=l:u>0?e.top-=u:e.top=r(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,o=t.within,s=o.offset.left+o.scrollLeft,r=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,u=e.left-t.collisionPosition.marginLeft,c=u-l,d=u+t.collisionWidth-r-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,h="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>c?(i=e.left+p+h+f+t.collisionWidth-r-s,(0>i||i<a(c))&&(e.left+=p+h+f)):d>0&&(n=e.left-t.collisionPosition.marginLeft+p+h+f-l,(n>0||a(n)<d)&&(e.left+=p+h+f))},top:function(e,t){var i,n,o=t.within,s=o.offset.top+o.scrollTop,r=o.height,l=o.isWindow?o.scrollTop:o.offset.top,u=e.top-t.collisionPosition.marginTop,c=u-l,d=u+t.collisionHeight-r-l,p="top"===t.my[1],h=p?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>c?(n=e.top+h+f+m+t.collisionHeight-r-s,e.top+h+f+m>c&&(0>n||n<a(c))&&(e.top+=h+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+h+f+m-l,e.top+h+f+m>d&&(i>0||a(i)<d)&&(e.top+=h+f+m))
}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,o,r,a=document.getElementsByTagName("body")[0],l=document.createElement("div");t=document.createElement(a?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in n)t.style[r]=n[r];t.appendChild(l),i=a||document.documentElement,i.insertBefore(t,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",o=e(l).offset().left,s=o>10&&11>o,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position}),function(e){"function"==typeof define&&define.amd?define("menu",["jquery","ui_core","widget","position"],e):e(jQuery)}(function(e){return e.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,o,s,r,a,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,o=this.previousFilter||"",s=String.fromCharCode(t.keyCode),r=!1,clearTimeout(this.filterTimer),s===o?r=!0:s=o+s,a=new RegExp("^"+i(s),"i"),n=this.activeMenu.find(this.options.items).filter(function(){return a.test(e(this).text())}),n=r&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n,n.length||(s=String.fromCharCode(t.keyCode),a=new RegExp("^"+i(s),"i"),n=this.activeMenu.find(this.options.items).filter(function(){return a.test(e(this).text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,n=this,o=this.options.icons.submenu,s=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),n=e("<span>").addClass("ui-menu-icon ui-icon "+o).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",i.attr("id"))}),t=s.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);n._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,n;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,n,o,s,r,a;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,o=t.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),r=this.activeMenu.height(),a=t.outerHeight(),0>o?this.activeMenu.scrollTop(s+o):o+a>r&&this.activeMenu.scrollTop(s+o-r+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(t),this.activeMenu=n},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[t]()),this.focus(i,n)},nextPage:function(t){var i,n,o;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n-o<0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var i,n,o;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-n+o>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)}})}),function(e){"function"==typeof define&&define.amd?define("autocomplete",["jquery","ui_core","widget","position","menu"],e):e(jQuery)}(function(e){return e.widget("ui.autocomplete",{version:"@VERSION",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,n,o=this.element[0].nodeName.toLowerCase(),s="textarea"===o,r="input"===o;this.isMultiLine=s?!0:r?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[s||r?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(o){if(this.element.prop("readOnly"))return t=!0,n=!0,void(i=!0);t=!1,n=!1,i=!1;var s=e.ui.keyCode;switch(o.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",o);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",o);break;case s.UP:t=!0,this._keyEvent("previous",o);break;case s.DOWN:t=!0,this._keyEvent("next",o);break;case s.ENTER:this.menu.active&&(t=!0,o.preventDefault(),this.menu.select(o));break;case s.TAB:this.menu.active&&this.menu.select(o);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(o),o.preventDefault());break;default:i=!0,this._searchTimeout(o)}},keypress:function(n){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:this._move("previousPage",n);break;case o.PAGE_DOWN:this._move("nextPage",n);break;case o.UP:this._keyEvent("previous",n);break;case o.DOWN:this._keyEvent("next",n)}}},input:function(e){return n?(n=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(n){n.target===t.element[0]||n.target===i||e.contains(i,n.target)||t.close()})})},menufocus:function(t,i){var n,o;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)})):(o=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:o})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(o.value),n=i.item.attr("aria-label")||o.value,void(n&&e.trim(n).length&&(this.liveRegion.children().hide(),e("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,n=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,n){n(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,o){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){o(e)},error:function(){o([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),n=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!n)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var n=this;e.each(i,function(e,i){n._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return n.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete}),define("tagit",["jquery","autocomplete"],function(e){e.widget("ui.tagit",{options:{allowDuplicates:!1,caseSensitive:!0,fieldName:"tags",placeholderText:null,readOnly:!1,removeConfirmation:!1,tagLimit:null,availableTags:[],autocomplete:{},showAutocompleteOnFocus:!1,allowSpaces:!1,singleField:!1,singleFieldDelimiter:",",singleFieldNode:null,animate:!0,tabIndex:null,beforeTagAdded:null,afterTagAdded:null,beforeTagRemoved:null,afterTagRemoved:null,onTagClicked:null,onTagLimitExceeded:null,onTagAdded:null,onTagRemoved:null,tagSource:null},_create:function(){var t=this;this.element.is("input")?(this.tagList=e("<ul></ul>").insertAfter(this.element),this.options.singleField=!0,this.options.singleFieldNode=this.element,this.element.css("display","none")):this.tagList=this.element.find("ul, ol").andSelf().last(),this.tagInput=e('<input type="text" />').addClass("ui-widget-content"),this.options.readOnly&&this.tagInput.attr("disabled","disabled"),this.options.tabIndex&&this.tagInput.attr("tabindex",this.options.tabIndex),this.options.placeholderText&&this.tagInput.attr("placeholder",this.options.placeholderText),this.options.autocomplete.source||(this.options.autocomplete.source=function(t,i){var n=t.term.toLowerCase(),o=e.grep(this.options.availableTags,function(e){return 0===e.toLowerCase().indexOf(n)});this.options.allowDuplicates||(o=this._subtractArray(o,this.assignedTags())),i(o)}),this.options.showAutocompleteOnFocus&&(this.tagInput.focus(function(){t._showAutocomplete()}),"undefined"==typeof this.options.autocomplete.minLength&&(this.options.autocomplete.minLength=0)),e.isFunction(this.options.autocomplete.source)&&(this.options.autocomplete.source=e.proxy(this.options.autocomplete.source,this)),e.isFunction(this.options.tagSource)&&(this.options.tagSource=e.proxy(this.options.tagSource,this)),this.tagList.addClass("tagit").addClass("ui-widget ui-widget-content ui-corner-all").append(e('<li class="tagit-new"></li>').append(this.tagInput)).click(function(i){var n=e(i.target);n.hasClass("tagit-label")?(n=n.closest(".tagit-choice"),n.hasClass("removed")||t._trigger("onTagClicked",i,{tag:n,tagLabel:t.tagLabel(n)})):t.tagInput.focus()});var i=!1;if(this.options.singleField)if(this.options.singleFieldNode){var n=e(this.options.singleFieldNode),o=n.val().split(this.options.singleFieldDelimiter);n.val(""),e.each(o,function(e,n){t.createTag(n,null,!0),i=!0})}else this.options.singleFieldNode=e('<input type="hidden" style="display:none;" value="" name="'+this.options.fieldName+'" />'),this.tagList.after(this.options.singleFieldNode);i||this.tagList.children("li").each(function(){e(this).hasClass("tagit-new")||(t.createTag(e(this).text(),e(this).attr("class"),!0),e(this).remove())}),this.tagInput.keydown(function(i){if(i.which==e.ui.keyCode.BACKSPACE&&""===t.tagInput.val()){var n=t._lastTag();!t.options.removeConfirmation||n.hasClass("remove")?t.removeTag(n):t.options.removeConfirmation&&n.addClass("remove ui-state-highlight")}else t.options.removeConfirmation&&t._lastTag().removeClass("remove ui-state-highlight");(i.which===e.ui.keyCode.COMMA||i.which===e.ui.keyCode.ENTER||i.which==e.ui.keyCode.TAB&&""!==t.tagInput.val()||i.which==e.ui.keyCode.SPACE&&!0!==t.options.allowSpaces&&('"'!=e.trim(t.tagInput.val()).replace(/^s*/,"").charAt(0)||'"'==e.trim(t.tagInput.val()).charAt(0)&&'"'==e.trim(t.tagInput.val()).charAt(e.trim(t.tagInput.val()).length-1)&&0!==e.trim(t.tagInput.val()).length-1))&&(i.which===e.ui.keyCode.ENTER&&""===t.tagInput.val()||i.preventDefault(),t.tagInput.data("autocomplete-open")||t.createTag(t._cleanedInput()))}).blur(function(){t.tagInput.data("autocomplete-open")||t.createTag(t._cleanedInput())}),(this.options.availableTags||this.options.tagSource||this.options.autocomplete.source)&&(n={select:function(e,i){return t.createTag(i.item.value),!1}},e.extend(n,this.options.autocomplete),n.source=this.options.tagSource||n.source,this.tagInput.autocomplete(n).bind("autocompleteopen",function(){t.tagInput.data("autocomplete-open",!0)}).bind("autocompleteclose",function(){t.tagInput.data("autocomplete-open",!1)}))},_cleanedInput:function(){return e.trim(this.tagInput.val().replace(/^"(.*)"$/,"$1"))},_lastTag:function(){return this.tagList.find(".tagit-choice:last:not(.removed)")},_tags:function(){return this.tagList.find(".tagit-choice:not(.removed)")},assignedTags:function(){var t=this,i=[];return this.options.singleField?(i=e(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter),""===i[0]&&(i=[])):this._tags().each(function(){i.push(t.tagLabel(this))}),i},_updateSingleTagsField:function(t){e(this.options.singleFieldNode).val(t.join(this.options.singleFieldDelimiter)).trigger("change")},_subtractArray:function(t,i){for(var n=[],o=0;o<t.length;o++)-1==e.inArray(t[o],i)&&n.push(t[o]);return n},tagLabel:function(t){return this.options.singleField?e(t).find(".tagit-label:first").text():e(t).find("input:first").val()},_showAutocomplete:function(){this.tagInput.autocomplete("search","")},_findTagByLabel:function(t){var i=this,n=null;return this._tags().each(function(){return i._formatStr(t)==i._formatStr(i.tagLabel(this))?(n=e(this),!1):void 0}),n},_isNew:function(e){return!this._findTagByLabel(e)},_formatStr:function(t){return this.options.caseSensitive?t:e.trim(t.toLowerCase())},_effectExists:function(t){return Boolean(e.effects&&(e.effects[t]||e.effects.effect&&e.effects.effect[t]))},createTag:function(t,i,n){var o=this;if(t=e.trim(t),this.options.preprocessTag&&(t=this.options.preprocessTag(t)),""===t)return!1;if(!this.options.allowDuplicates&&!this._isNew(t))return t=this._findTagByLabel(t),!1!==this._trigger("onTagExists",null,{existingTag:t,duringInitialization:n})&&this._effectExists("highlight")&&t.effect("highlight"),!1;if(this.options.tagLimit&&this._tags().length>=this.options.tagLimit)return this._trigger("onTagLimitExceeded",null,{duringInitialization:n}),!1;var s=e(this.options.onTagClicked?'<a class="tagit-label"></a>':'<span class="tagit-label"></span>').text(t),r=e("<li></li>").addClass("tagit-choice ui-widget-content ui-state-default ui-corner-all").addClass(i).append(s);this.options.readOnly?r.addClass("tagit-choice-read-only"):(r.addClass("tagit-choice-editable"),i=e("<span></span>").addClass("ui-icon ui-icon-close"),i=e('<a><span class="text-icon"></span></a>').addClass("tagit-close").append(i).click(function(){o.removeTag(r)}),r.append(i)),this.options.singleField||(s=s.html(),r.append('<input type="hidden" style="display:none;" value="'+s+'" name="'+this.options.fieldName+'" />')),!1!==this._trigger("beforeTagAdded",null,{tag:r,tagLabel:this.tagLabel(r),duringInitialization:n})&&(this.options.singleField&&(s=this.assignedTags(),s.push(t),this._updateSingleTagsField(s)),this._trigger("onTagAdded",null,r),this.tagInput.val(""),this.tagInput.parent().before(r),this._trigger("afterTagAdded",null,{tag:r,tagLabel:this.tagLabel(r),duringInitialization:n}),this.options.showAutocompleteOnFocus&&!n&&setTimeout(function(){o._showAutocomplete()},0))},removeTag:function(t,i){if(i="undefined"==typeof i?this.options.animate:i,t=e(t),this._trigger("onTagRemoved",null,t),!1!==this._trigger("beforeTagRemoved",null,{tag:t,tagLabel:this.tagLabel(t)})){if(this.options.singleField){var n=this.assignedTags(),o=this.tagLabel(t),n=e.grep(n,function(e){return e!=o});this._updateSingleTagsField(n)}if(i){t.addClass("removed");var n=this._effectExists("blind")?["blind",{direction:"horizontal"},"fast"]:["fast"],s=this;n.push(function(){t.remove(),s._trigger("afterTagRemoved",null,{tag:t,tagLabel:s.tagLabel(t)})}),t.fadeOut("fast").hide.apply(t,n).dequeue()}else t.remove(),this._trigger("afterTagRemoved",null,{tag:t,tagLabel:this.tagLabel(t)})}},removeTagByLabel:function(e,t){var i=this._findTagByLabel(e);if(!i)throw"No such tag exists with the name '"+e+"'";this.removeTag(i,t)},removeAll:function(){var e=this;this._tags().each(function(t,i){e.removeTag(i,!1)})}})}),!function(e){"function"==typeof define&&define.amd?define("dropzone",["jquery"],e):e(jQuery)}(function(e){function t(e){return e?i(e):void 0}function i(e){for(var i in t.prototype)e[i]=t.prototype[i];return e}var n={exports:{}};return n.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},t.prototype.once=function(e,t){function i(){n.off(e,i),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},i.fn=t,this.on(e,i),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks[e];if(!i)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var n,o=0;o<i.length;o++)if(n=i[o],n===t||n.fn===t){i.splice(o,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks[e];if(i){i=i.slice(0);for(var n=0,o=i.length;o>n;++n)i[n].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length},function(){var i,o,s,r,a,l,u,c,d={}.hasOwnProperty,p=function(e,t){function i(){this.constructor=e}for(var n in t)d.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},h=[].slice;o="undefined"!=typeof t&&null!==t?t:require("emitter"),u=function(){},i=function(e){function t(e,n){var o,s,r;if(this.element=e,this.version=t.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(t.instances.push(this),this.element.dropzone=this,o=null!=(r=t.optionsForElement(this.element))?r:{},this.options=i({},this.defaultOptions,o,null!=n?n:{}),this.options.forceFallback||!t.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(s=this.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?t.getElement(this.options.previewsContainer,"previewsContainer"):this.element),this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:t.getElements(this.options.clickable,"clickable")),this.init()}var i;return p(t,e),t.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],t.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return u},forceFallback:!1,fallback:function(){var e,i,n,o,s,r;for(this.element.className=""+this.element.className+" dz-browser-not-supported",r=this.element.getElementsByTagName("div"),o=0,s=r.length;s>o;o++)e=r[o],/(^| )dz-message($| )/.test(e.className)&&(i=e,e.className="dz-message");return i||(i=t.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(i)),n=i.getElementsByTagName("span")[0],n&&(n.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,i,n;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},i=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=i*t.optHeight:null==t.optHeight&&(t.optHeight=1/i*t.optWidth),n=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):i>n?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*n):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/n),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t
},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:u,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:u,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var i,n,o,s,r,a,l,u,c,d,p,h,f;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=t.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),d=e.previewElement.querySelectorAll("[data-dz-name]"),s=0,l=d.length;l>s;s++)i=d[s],i.textContent=e.name;for(p=e.previewElement.querySelectorAll("[data-dz-size]"),r=0,u=p.length;u>r;r++)i=p[r],i.innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=t.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),n=function(i){return function(n){return n.preventDefault(),n.stopPropagation(),e.status===t.UPLOADING?t.confirm(i.options.dictCancelUploadConfirmation,function(){return i.removeFile(e)}):i.options.dictRemoveFileConfirmation?t.confirm(i.options.dictRemoveFileConfirmation,function(){return i.removeFile(e)}):i.removeFile(e)}}(this),h=e.previewElement.querySelectorAll("[data-dz-remove]"),f=[],a=0,c=h.length;c>a;a++)o=h[a],f.push(o.addEventListener("click",n));return f}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var i,n,o,s,r;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),e.previewElement.classList.add("dz-image-preview"),s=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),r=[],n=0,o=s.length;o>n;n++)i=s[n],i.alt=e.name,r.push(i.src=t);return r}},error:function(e,t){var i,n,o,s,r;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),s=e.previewElement.querySelectorAll("[data-dz-errormessage]"),r=[],n=0,o=s.length;o>n;n++)i=s[n],r.push(i.textContent=t);return r}},errormultiple:u,processing:function(e){return e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink)?e._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:u,uploadprogress:function(e,t){var i,n,o,s,r;if(e.previewElement){for(s=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),r=[],n=0,o=s.length;o>n;n++)i=s[n],r.push(i.style.width=""+t+"%");return r}},totaluploadprogress:u,sending:u,sendingmultiple:u,success:function(e){return e.previewElement?e.previewElement.classList.add("dz-success"):void 0},successmultiple:u,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:u,complete:function(e){return e._removeLink?e._removeLink.textContent=this.options.dictRemoveFile:void 0},completemultiple:u,maxfilesexceeded:u,maxfilesreached:u,previewTemplate:'<div class="dz-preview dz-file-preview">\n <div class="dz-details">\n <div class="dz-filename"><span data-dz-name></span></div>\n <div class="dz-size" data-dz-size></div>\n <img data-dz-thumbnail />\n </div>\n <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n <div class="dz-success-mark"><span></span></div>\n <div class="dz-error-mark"><span></span></div>\n <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},i=function(){var e,t,i,n,o,s,r;for(n=arguments[0],i=2<=arguments.length?h.call(arguments,1):[],s=0,r=i.length;r>s;s++){t=i[s];for(e in t)o=t[e],n[e]=o}return n},t.prototype.getAcceptedFiles=function(){var e,t,i,n,o;for(n=this.files,o=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted&&o.push(e);return o},t.prototype.getRejectedFiles=function(){var e,t,i,n,o;for(n=this.files,o=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted||o.push(e);return o},t.prototype.getFilesWithStatus=function(e){var t,i,n,o,s;for(o=this.files,s=[],i=0,n=o.length;n>i;i++)t=o[i],t.status===e&&s.push(t);return s},t.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(t.QUEUED)},t.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(t.UPLOADING)},t.prototype.getActiveFiles=function(){var e,i,n,o,s;for(o=this.files,s=[],i=0,n=o.length;n>i;i++)e=o[i],(e.status===t.UPLOADING||e.status===t.QUEUED)&&s.push(e);return s},t.prototype.init=function(){var e,i,n,o,s,r,a;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(t.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(n=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null==e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!=e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,i,o,s;if(i=e.hiddenFileInput.files,i.length)for(o=0,s=i.length;s>o;o++)t=i[o],e.addFile(t);return n()})}}(this))(),this.URL=null!=(r=window.URL)?r:window.webkitURL,a=this.events,o=0,s=a.length;s>o;o++)e=a[o],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),i=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(t){return i(t),e.emit("dragenter",t)}}(this),dragover:function(e){return function(t){var n;try{n=t.dataTransfer.effectAllowed}catch(o){}return t.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",i(t),e.emit("dragover",t)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(t){return i(t),e.drop(t)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(i){return e.listeners.push({element:i,events:{click:function(n){return i!==e.element||n.target===e.element||t.elementInside(n.target,e.element.querySelector(".dz-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},t.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,t.instances.splice(t.instances.indexOf(this),1)},t.prototype.updateTotalUploadProgress=function(){var e,t,i,n,o,s,r,a;if(n=0,i=0,e=this.getActiveFiles(),e.length){for(a=this.getActiveFiles(),s=0,r=a.length;r>s;s++)t=a[s],n+=t.upload.bytesSent,i+=t.upload.total;o=100*n/i}else o=100;return this.emit("totaluploadprogress",o,i,n)},t.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},t.prototype.getFallbackForm=function(){var e,i,n,o;return(e=this.getExistingFallback())?e:(n='<div class="dz-fallback">',this.options.dictFallbackText&&(n+="<p>"+this.options.dictFallbackText+"</p>"),n+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',i=t.createElement(n),"FORM"!==this.element.tagName?(o=t.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),o.appendChild(i)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=o?o:i)},t.prototype.getExistingFallback=function(){var e,t,i,n,o,s;for(t=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)if(t=e[i],/(^| )fallback($| )/.test(t.className))return t},s=["div","form"],n=0,o=s.length;o>n;n++)if(i=s[n],e=t(this.element.getElementsByTagName(i)))return e},t.prototype.setupEventListeners=function(){var e,t,i,n,o,s,r;for(s=this.listeners,r=[],n=0,o=s.length;o>n;n++)e=s[n],r.push(function(){var n,o;n=e.events,o=[];for(t in n)i=n[t],o.push(e.element.addEventListener(t,i,!1));return o}());return r},t.prototype.removeEventListeners=function(){var e,t,i,n,o,s,r;for(s=this.listeners,r=[],n=0,o=s.length;o>n;n++)e=s[n],r.push(function(){var n,o;n=e.events,o=[];for(t in n)i=n[t],o.push(e.element.removeEventListener(t,i,!1));return o}());return r},t.prototype.disable=function(){var e,t,i,n,o;for(this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),n=this.files,o=[],t=0,i=n.length;i>t;t++)e=n[t],o.push(this.cancelUpload(e));return o},t.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},t.prototype.filesize=function(e){var t;return e>=109951162777.6?(e/=109951162777.6,t="TiB"):e>=107374182.4?(e/=107374182.4,t="GiB"):e>=104857.6?(e/=104857.6,t="MiB"):e>=102.4?(e/=102.4,t="KiB"):(e=10*e,t="b"),"<strong>"+Math.round(e)/10+"</strong> "+t},t.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},t.prototype.drop=function(e){var t,i;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(i=e.dataTransfer.items,i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(t)))},t.prototype.paste=function(e){var t,i;return null!=(null!=e&&null!=(i=e.clipboardData)?i.items:void 0)?(this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0):void 0},t.prototype.handleFiles=function(e){var t,i,n,o;for(o=[],i=0,n=e.length;n>i;i++)t=e[i],o.push(this.addFile(t));return o},t.prototype._addFilesFromItems=function(e){var t,i,n,o,s;for(s=[],n=0,o=e.length;o>n;n++)i=e[n],s.push(null!=i.webkitGetAsEntry&&(t=i.webkitGetAsEntry())?t.isFile?this.addFile(i.getAsFile()):t.isDirectory?this._addFilesFromDirectory(t,t.name):void 0:null!=i.getAsFile&&(null==i.kind||"file"===i.kind)?this.addFile(i.getAsFile()):void 0);return s},t.prototype._addFilesFromDirectory=function(e,t){var i,n;return i=e.createReader(),n=function(e){return function(i){var n,o,s;for(o=0,s=i.length;s>o;o++)n=i[o],n.isFile?n.file(function(i){return e.options.ignoreHiddenFiles&&"."===i.name.substring(0,1)?void 0:(i.fullPath=""+t+"/"+i.name,e.addFile(i))}):n.isDirectory&&e._addFilesFromDirectory(n,""+t+"/"+n.name)}}(this),i.readEntries(n,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},t.prototype.accept=function(e,i){return e.size>1024*this.options.maxFilesize*1024?i(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):t.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(i(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,i):i(this.options.dictInvalidFileType)},t.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=t.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(i){return i?(e.accepted=!1,t._errorProcessing([e],i)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}}(this))},t.prototype.enqueueFiles=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)t=e[i],this.enqueueFile(t);return null},t.prototype.enqueueFile=function(e){if(e.status!==t.ADDED||e.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return e.status=t.QUEUED,this.options.autoProcessQueue?setTimeout(function(e){return function(){return e.processQueue()}}(this),0):void 0},t.prototype._thumbnailQueue=[],t.prototype._processingThumbnail=!1,t.prototype._enqueueThumbnail=function(e){return this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},t.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},t.prototype.removeFile=function(e){return e.status===t.UPLOADING&&this.cancelUpload(e),this.files=c(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},t.prototype.removeAllFiles=function(e){var i,n,o,s;for(null==e&&(e=!1),s=this.files.slice(),n=0,o=s.length;o>n;n++)i=s[n],(i.status!==t.UPLOADING||e)&&this.removeFile(i);return null},t.prototype.createThumbnail=function(e,t){var i;return i=new FileReader,i.onload=function(n){return function(){var o;return o=document.createElement("img"),o.onload=function(){var i,s,r,a,u,c,d,p;return e.width=o.width,e.height=o.height,r=n.options.resize.call(n,e),null==r.trgWidth&&(r.trgWidth=r.optWidth),null==r.trgHeight&&(r.trgHeight=r.optHeight),i=document.createElement("canvas"),s=i.getContext("2d"),i.width=r.trgWidth,i.height=r.trgHeight,l(s,o,null!=(u=r.srcX)?u:0,null!=(c=r.srcY)?c:0,r.srcWidth,r.srcHeight,null!=(d=r.trgX)?d:0,null!=(p=r.trgY)?p:0,r.trgWidth,r.trgHeight),a=i.toDataURL("image/png"),n.emit("thumbnail",e,a),null!=t?t():void 0},o.src=i.result}}(this),i.readAsDataURL(e)},t.prototype.processQueue=function(){var e,t,i,n;if(t=this.options.parallelUploads,i=this.getUploadingFiles().length,e=i,!(i>=t)&&(n=this.getQueuedFiles(),n.length>0)){if(this.options.uploadMultiple)return this.processFiles(n.slice(0,t-i));for(;t>e;){if(!n.length)return;this.processFile(n.shift()),e++}}},t.prototype.processFile=function(e){return this.processFiles([e])},t.prototype.processFiles=function(e){var i,n,o;for(n=0,o=e.length;o>n;n++)i=e[n],i.processing=!0,i.status=t.UPLOADING,this.emit("processing",i);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},t.prototype._getFilesWithXhr=function(e){var t,i;return i=function(){var i,n,o,s;for(o=this.files,s=[],i=0,n=o.length;n>i;i++)t=o[i],t.xhr===e&&s.push(t);return s}.call(this)},t.prototype.cancelUpload=function(e){var i,n,o,s,r,a,l;if(e.status===t.UPLOADING){for(n=this._getFilesWithXhr(e.xhr),o=0,r=n.length;r>o;o++)i=n[o],i.status=t.CANCELED;for(e.xhr.abort(),s=0,a=n.length;a>s;s++)i=n[s],this.emit("canceled",i);this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else((l=e.status)===t.ADDED||l===t.QUEUED)&&(e.status=t.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));return this.options.autoProcessQueue?this.processQueue():void 0},t.prototype.uploadFile=function(e){return this.uploadFiles([e])},t.prototype.uploadFiles=function(e){var n,o,s,r,a,l,u,c,d,p,h,f,m,g,v,b,y,C,w,_,x,O,k,E,T,P,z,D,S,I,F,R;for(y=new XMLHttpRequest,C=0,O=e.length;O>C;C++)n=e[C],n.xhr=y;y.open(this.options.method,this.options.url,!0),y.withCredentials=!!this.options.withCredentials,g=null,s=function(t){return function(){var i,o,s;for(s=[],i=0,o=e.length;o>i;i++)n=e[i],s.push(t._errorProcessing(e,g||t.options.dictResponseError.replace("{{statusCode}}",y.status),y));return s}}(this),v=function(t){return function(i){var o,s,r,a,l,u,c,d,p;if(null!=i)for(s=100*i.loaded/i.total,r=0,u=e.length;u>r;r++)n=e[r],n.upload={progress:s,total:i.total,bytesSent:i.loaded};else{for(o=!0,s=100,a=0,c=e.length;c>a;a++)n=e[a],(100!==n.upload.progress||n.upload.bytesSent!==n.upload.total)&&(o=!1),n.upload.progress=s,n.upload.bytesSent=n.upload.total;if(o)return}for(p=[],l=0,d=e.length;d>l;l++)n=e[l],p.push(t.emit("uploadprogress",n,s,n.upload.bytesSent));return p}}(this),y.onload=function(i){return function(n){var o;if(e[0].status!==t.CANCELED&&4===y.readyState){if(g=y.responseText,y.getResponseHeader("content-type")&&~y.getResponseHeader("content-type").indexOf("application/json"))try{g=JSON.parse(g)}catch(r){n=r,g="Invalid JSON response from server."}return v(),200<=(o=y.status)&&300>o?i._finished(e,g,n):s()}}}(this),y.onerror=function(){return function(){return e[0].status!==t.CANCELED?s():void 0}}(this),m=null!=(z=y.upload)?z:y,m.onprogress=v,l={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&i(l,this.options.headers);for(r in l)a=l[r],y.setRequestHeader(r,a);if(o=new FormData,this.options.params){D=this.options.params;for(h in D)b=D[h],o.append(h,b)}for(w=0,k=e.length;k>w;w++)n=e[w],this.emit("sending",n,y,o);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,y,o),"FORM"===this.element.tagName)for(S=this.element.querySelectorAll("input, textarea, select, button"),_=0,E=S.length;E>_;_++)if(c=S[_],d=c.getAttribute("name"),p=c.getAttribute("type"),"SELECT"===c.tagName&&c.hasAttribute("multiple"))for(I=c.options,x=0,T=I.length;T>x;x++)f=I[x],f.selected&&o.append(d,f.value);else(!p||"checkbox"!==(F=p.toLowerCase())&&"radio"!==F||c.checked)&&o.append(d,c.value);for(u=P=0,R=e.length-1;R>=0?R>=P:P>=R;u=R>=0?++P:--P)o.append(this._getParamName(u),e[u],e[u].name);return y.send(o)},t.prototype._finished=function(e,i,n){var o,s,r;for(s=0,r=e.length;r>s;s++)o=e[s],o.status=t.SUCCESS,this.emit("success",o,i,n),this.emit("complete",o);return this.options.uploadMultiple&&(this.emit("successmultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t.prototype._errorProcessing=function(e,i,n){var o,s,r;for(s=0,r=e.length;r>s;s++)o=e[s],o.status=t.ERROR,this.emit("error",o,i,n),this.emit("complete",o);return this.options.uploadMultiple&&(this.emit("errormultiple",e,i,n),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t}(o),i.version="3.10.2",i.options={},i.optionsForElement=function(e){return e.getAttribute("id")?i.options[s(e.getAttribute("id"))]:void 0},i.instances=[],i.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},i.autoDiscover=!0,i.discover=function(){var e,t,n,o,s,r;for(document.querySelectorAll?n=document.querySelectorAll(".dropzone"):(n=[],e=function(e){var t,i,o,s;for(s=[],i=0,o=e.length;o>i;i++)t=e[i],s.push(/(^| )dropzone($| )/.test(t.className)?n.push(t):void 0);return s},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),r=[],o=0,s=n.length;s>o;o++)t=n[o],r.push(i.optionsForElement(t)!==!1?new i(t):void 0);return r},i.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],i.isBrowserSupported=function(){var e,t,n,o,s;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(s=i.blacklistedBrowsers,n=0,o=s.length;o>n;n++)t=s[n],t.test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},c=function(e,t){var i,n,o,s;for(s=[],n=0,o=e.length;o>n;n++)i=e[n],i!==t&&s.push(i);return s},s=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},i.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},i.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},i.getElement=function(e,t){var i;if("string"==typeof e?i=document.querySelector(e):null!=e.nodeType&&(i=e),null==i)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return i},i.getElements=function(e,t){var i,n,o,s,r,a,l,u;if(e instanceof Array){o=[];try{for(s=0,a=e.length;a>s;s++)n=e[s],o.push(this.getElement(n,t))}catch(c){i=c,o=null}}else if("string"==typeof e)for(o=[],u=document.querySelectorAll(e),r=0,l=u.length;l>r;r++)n=u[r],o.push(n);else null!=e.nodeType&&(o=[e]);if(null==o||!o.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return o},i.confirm=function(e,t,i){return window.confirm(e)?t():null!=i?i():void 0},i.isValidFile=function(e,t){var i,n,o,s,r;if(!t)return!0;for(t=t.split(","),n=e.type,i=n.replace(/\/.*$/,""),s=0,r=t.length;r>s;s++)if(o=t[s],o=o.trim(),"."===o.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(o.toLowerCase(),e.name.length-o.length))return!0}else if(/\/\*$/.test(o)){if(i===o.replace(/\/.*$/,""))return!0}else if(n===o)return!0;return!1},"undefined"!=typeof e&&null!==e&&(e.fn.dropzone=function(e){return this.each(function(){return new i(this,e)})}),"undefined"!=typeof n&&null!==n?n.exports=i:window.Dropzone=i,i.ADDED="added",i.QUEUED="queued",i.ACCEPTED=i.QUEUED,i.UPLOADING="uploading",i.PROCESSING=i.UPLOADING,i.CANCELED="canceled",i.ERROR="error",i.SUCCESS="success",a=function(e){var t,i,n,o,s,r,a,l,u,c;for(a=e.naturalWidth,r=e.naturalHeight,i=document.createElement("canvas"),i.width=1,i.height=r,n=i.getContext("2d"),n.drawImage(e,0,0),o=n.getImageData(0,0,1,r).data,c=0,s=r,l=r;l>c;)t=o[4*(l-1)+3],0===t?s=l:c=l,l=s+c>>1;return u=l/r,0===u?1:u},l=function(e,t,i,n,o,s,r,l,u,c){var d;return d=a(t),e.drawImage(t,i,n,o,s,r,l,u,c/d)},r=function(e,t){var i,n,o,s,r,a,l,u,c;if(o=!1,c=!0,n=e.document,u=n.documentElement,i=n.addEventListener?"addEventListener":"attachEvent",l=n.addEventListener?"removeEventListener":"detachEvent",a=n.addEventListener?"":"on",s=function(i){return"readystatechange"!==i.type||"complete"===n.readyState?(("load"===i.type?e:n)[l](a+i.type,s,!1),!o&&(o=!0)?t.call(e,i.type||i):void 0):void 0},r=function(){var e;try{u.doScroll("left")}catch(t){return e=t,void setTimeout(r,50)}return s("poll")},"complete"!==n.readyState){if(n.createEventObject&&u.doScroll){try{c=!e.frameElement}catch(d){}c&&r()}return n[i](a+"DOMContentLoaded",s,!1),n[i](a+"readystatechange",s,!1),e[i](a+"load",s,!1)}},i._autoDiscoverFunction=function(){return i.autoDiscover?i.discover():void 0},r(window,i._autoDiscoverFunction)}.call(this),n.exports}),define("upload",["jquery","filepicker","dropzone","underscore"],function(e,t,i,n){OC.config.uploads={filepicker_key:"AGuSaWwXNQFi60wveigBHz",store_error_code:151},filepicker.setKey(OC.config.uploads.filepicker_key),OC.upload={fp_uploaded_files:{},dropzone_uploaded_files:{},manual_to_upload_files:[],isPost:!1,launchFilepickerDialog:function(e,t){return filepicker.pickAndStore({multiple:!0,openTo:t},{location:"S3",path:"/",access:"public"},OC.upload.fpPost,OC.upload.fpError),e.preventDefault(),e.stopPropagation(),!1},uploadCallback:function(t){var i,n,o;i=t,e.extend(OC.upload.fp_uploaded_files,t);for(n in i)"failures"===n?(o=e(document.createElement("div")),o.html("The following files failed to upload: "),o.append(JSON.stringify(i.failures)),e(".uploadfiles").before(o)):(OC.upload.addToUploadList(n,i[n],"","filepicker-item"),OC.upload.newFileUploadListener())},fpPost:function(t){var i,n,o,s,r;for(o=t.length,i={},n=0;o>n;n++)s=t[n].key,r=t[n].filename,i[s]=r;i.user=OC.config.user.id,e("form input[name=project]").length>0&&(i.project=e("form input[name=project]").val()),e("form input[name=collection]").length>0&&(i.collection=e("form input[name=collection]").val()),e.post("/api/filepicker-upload/",i,OC.upload.uploadCallback,"json")},fpError:function(e){151===e&&alert("Sorry, something went wrong")},dzTemplate:n.template('<div class="dz-preview dz-file-preview <%= process %>"><div class="dz-details"><div class="dz-filename"><span data-dz-name contenteditable="true" class="<%= key %>"><%= filename %></span></div><div class="dz-size" data-dz-size><%= filesize %></div><img data-dz-thumbnail /></div><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><div class="dz-success-mark"><span></span></div><div class="dz-error-mark"><span></span></div><div class="dz-error-message"><span data-dz-errormessage></span></div></div>'),singleFileTemplate:n.template('<div class="single-upload <%= process %>"><input type="hidden" name="key" value="<%= key %>" /><input type="text" name="filename" value="<%= filename %>" /><input type="hidden" name="upload_service" value="<%= process %>" /><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><!--<select name="type"><option value="lesson">Lesson</option><option value="project">Project</option><option value="worksheet">Worksheet</option><option value="handout">Handout</option><option value="activity">Activity</option><option value="assessment">Test / assessment</option><option value="lecture">Lecture</option></select>--><div class="alternative-upload"><a>Upload something else instead...</a></div></div>'),newFileUploadListener:function(){var t=e("form.files-upload-rename button[type=submit]"),i=e('form.files-upload-rename button[name="select-file"]');t.hasClass("hidden")&&(e.isEmptyObject(OC.upload.fp_uploaded_files)&&e.isEmptyObject(OC.upload.dropzone_uploaded_files)&&!OC.upload.manual_to_upload_files.length||(t.removeClass("hidden"),OC.upload.isPost&&i.addClass("hidden")))},updateSingleItemKey:function(t){e(".post-new-upload-dialog .upload-drag-drop-replace input[name=key]").val(t)},addToUploadList:function(t,n,o,s){var r={key:t,filename:n,filesize:o,process:s};if(OC.upload.isPost){var a=e(".post-new-upload-dialog .upload-drag-drop,.post-new-upload-dialog .upload-drag-drop-message");a.addClass("hidden");var l=OC.upload.singleFileTemplate(r),u=e(".post-new-upload-dialog .upload-drag-drop-replace");u.html(l),u.removeClass("hidden"),e('input[type="filename"]',u).focus(),e(".alternative-upload a",u).click(function(){u.addClass("hidden"),a.removeClass("hidden");var t=e('input[class="manual-upload"]');e(t[t.length-2]).remove(),OC.upload.manual_to_upload_files=[],OC.upload.dropzone_uploaded_files={},i.forElement(".post-new-upload-dialog .upload-drag-drop").removeAllFiles(),OC.upload.fp_uploaded_files={};var n=e("form.files-upload-rename button[type=submit]"),o=e('form.files-upload-rename button[name="select-file"]');o.removeClass("hidden"),n.addClass("hidden")})}else{var c=OC.upload.dzTemplate(r);e(".post-new-upload-dialog .upload-drag-drop").append(c)}},onFileInputChange:function(){var t,i=e(this)[0].files[0].size;if(t=i>=1048576?(i/1048576).toFixed(2)+" MB":i>=1024?(i/1024).toFixed(2)+" KB":i+" B",i>5242880){var n=OC.customPopup(".upload-filepicker-suggest-dialog");e(".filepicker-suggest",n.dialog).click(function(e){return n.close(),e.preventDefault(),e.stopPropagation(),!1})}else{var o=e(this)[0].files[0].name;OC.upload.addToUploadList(o,o,t,"manual-item"),OC.upload.manual_to_upload_files.push(o),OC.upload.newFileUploadListener();var s=(e("form.files-upload-rename input.manual-upload").length,e("<input/>",{"class":"manual-upload",type:"file"}));s.change(OC.upload.onFileInputChange),e("form.files-upload-rename").append(s)}},preSubmissionHandler:function(){if(OC.upload.isPost){var t=e(".upload-drag-drop-replace"),i=e('input[name="key"]',t).val(),n=e('input[name="filename"]',t).val(),o=e('input[name="upload_service"]',t).val();if("filepicker-item"==o)e("<input/>").attr("type","hidden").attr("name",i).attr("value",n).appendTo(".files-upload-rename");else if("dropzone-item"==o)e("<input/>").attr("type","hidden").attr("name",i).attr("value",n).appendTo(".files-upload-rename");else{var s=e(".files-upload-rename input[class=manual-upload]");e(s[s.length-2]).attr("name",n)}}else{var r,a,l,u,c,d,p,h=e(".post-new-upload-dialog .upload-drag-drop .dz-preview"),f=e(".files-upload-rename input[type=file]");for(l=0;l<h.length;l++)if(c=h[l],d=e(".dz-filename span:first",c).attr("class"),p=e(".dz-filename span:first",c).text().trim(),e(c).hasClass("filepicker-item"))OC.upload.fp_uploaded_files[d]!=p&&(OC.upload.fp_uploaded_files[d]=p);else if(e(c).hasClass("manual-item"))for(u=0;u<f.length;u++)e(f[u]).val()!==d&&e(f[u]).attr("name",p);else OC.upload.dropzone_uploaded_files[d]!=p&&(OC.upload.dropzone_uploaded_files[d]=p);for(r in OC.upload.fp_uploaded_files)e("<input/>").attr("type","hidden").attr("name",r).attr("value",OC.upload.fp_uploaded_files[r]).appendTo(".files-upload-rename");for(a in OC.upload.dropzone_uploaded_files)e("<input/>").attr("type","hidden").attr("name",a).attr("value",OC.upload.dropzone_uploaded_files[a]).appendTo(".files-upload-rename")}}},e(document).ready(function(){OC.upload.isPost="true"==e('form.files-upload-rename input[name="post"]').val(),e("form.files-upload-rename").bind("keypress",function(e){13===e.keyCode&&e.preventDefault()});var t={".uploadfiles":"COMPUTER",".gdrive-upload":"GOOGLE_DRIVE",".skydrive-upload":"SKYDRIVE",".dropbox-upload":"DROPBOX",".gmail-upload":"GMAIL",".box-upload":"BOX",".picasa-upload":"PICASA",".ftp-upload":"FTP",".webdav-upload":"WEBDAV",".facebook-upload":"FACEBOOK"};n.each(t,function(t,i){e(i).click(function(e){OC.upload.launchFilepickerDialog(e,t)})}),e("form.files-upload-rename button[type=submit]").click(function(e){return OC.upload.preSubmissionHandler(e),OC.upload.isPost?!1:!0}),e("button[name=select-file]").click(function(t){return e("input[class=manual-upload]:last").click(),t.preventDefault(),t.stopPropagation(),!1});var o=e(".post-new-upload-dialog .upload-drag-drop");o.length>0&&(e(".post-new-upload-dialog .upload-drag-drop").dropzone({url:"/api/file-upload/",maxFilesize:5,createImageThumbnails:!1}),i.forElement(".post-new-upload-dialog .upload-drag-drop").on("sending",function(t,i,n){function o(e){var t,i,n,o=null;if(document.cookie&&""!==document.cookie)for(t=document.cookie.split(";"),i=0;i<t.length;i++)if(n=jQuery.trim(t[i]),n.substring(0,e.length+1)===e+"="){o=decodeURIComponent(n.substring(e.length+1));break}return o}function s(e){var t=document.location.host,i=document.location.protocol,n="//"+t,o=i+n;return e===o||e.slice(0,o.length+1)===o+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!/^(\/\/|http:|https:).*/.test(e)}var r=e(this)[0].options.url;s(r)&&i.setRequestHeader("X-CSRFToken",o("csrftoken")),n.append("user",OC.config.user.id),e(".post-new-upload-dialog form input[name=project]").length>0&&n.append("project",e("form.files-upload-rename input[name=project]").val()),e(".post-new-upload-dialog form input[name=collection]").length>0&&n.append("collection",e("form.files-upload-rename input[name=collection]").val()),OC.upload.isPost&&OC.upload.addToUploadList(null,t.name,0,"dropzone-item")
}),i.forElement(".post-new-upload-dialog .upload-drag-drop").on("uploadprogress",function(t,i){OC.upload.isPost&&e(".single-upload .dz-progress .dz-upload").css("width",i+"%")}),i.forElement(".post-new-upload-dialog .upload-drag-drop").on("success",function(t,i){var n,o=JSON.parse(i);for(n in o)OC.upload.dropzone_uploaded_files[n]=o[n].title;e(".dz-preview .dz-filename > span:contains("+OC.upload.dropzone_uploaded_files[n]+")").addClass(n),e(".dz-filename span",t.previewElement).attr("contenteditable",!0),OC.upload.newFileUploadListener(),OC.upload.isPost&&OC.upload.updateSingleItemKey(n)})),e("input[type=file]").change(OC.upload.onFileInputChange)})}),function(e){"function"==typeof define&&define.amd?define("button",["jquery","./core","./widget"],e):e(jQuery)}(function(e){var t,i="ui-button ui-widget ui-state-default ui-corner-all",n="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",o=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},s=function(t){var i=t.name,n=t.form,o=e([]);return i&&(i=i.replace(/'/g,"\\'"),o=n?e(n).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),o};return e.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,o),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var n=this,r=this.options,a="checkbox"===this.type||"radio"===this.type,l=a?"":"ui-state-active";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(i).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===t&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||e(this).removeClass(l)}).bind("click"+this.eventNamespace,function(e){r.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),a&&this.element.bind("change"+this.eventNamespace,function(){n.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return r.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(r.disabled)return!1;e(this).addClass("ui-state-active"),n.buttonElement.attr("aria-pressed","true");var t=n.element[0];s(t).not(t).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return r.disabled?!1:(e(this).addClass("ui-state-active"),t=this,void n.document.one("mouseup",function(){t=null}))}).bind("mouseup"+this.eventNamespace,function(){return r.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return r.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",r.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(i+" ui-state-active "+n).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),void(t&&this.buttonElement.removeClass("checkbox"===this.type||"radio"===this.type?"ui-state-focus":"ui-state-focus ui-state-active"))):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?s(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(n),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),o=this.options.icons,s=o.primary&&o.secondary,r=[];o.primary||o.secondary?(this.options.text&&r.push("ui-button-text-icon"+(s?"s":o.primary?"-primary":"-secondary")),o.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+o.primary+"'></span>"),o.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+o.secondary+"'></span>"),this.options.text||(r.push(s?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):r.push("ui-button-text-only"),t.addClass(r.join(" "))}}),e.widget("ui.buttonset",{version:"@VERSION",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),n=i.filter(":ui-button");i.not(":ui-button").button(),n.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button}),function(e){"function"==typeof define&&define.amd?define("mouse",["jquery","widget"],e):e(jQuery)}(function(e){var t=!1;return e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"@VERSION",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,o=1===i.which,s="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return o&&!s&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(i){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&e.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),t=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(e){"function"==typeof define&&define.amd?define("draggable",["jquery","ui_core","mouse","widget"],e):e(jQuery)}(function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(n){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",t,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper),o=n?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return o.parents("body").length||o.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n&&o[0]===this.element[0]&&this._setPositionRelative(),o[0]===this.element[0]||/(fixed|absolute)/.test(o.css("position"))||o.css("position","absolute"),o},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,o=this.options,s=this.document[0];return this.relativeContainer=null,o.containment?"window"===o.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,e(s).width()-this.helperProportions.width-this.margins.left,(e(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),i=e(o.containment),n=i[0],void(n&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,o,s,r=this.options,a=this._isRootNode(this.scrollParent[0]),l=e.pageX,u=e.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(u=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(u=i[3]+this.offset.click.top)),r.grid&&(o=r.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY,u=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-r.grid[1]:o+r.grid[1]:o,s=r.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-r.grid[0]:s+r.grid[0]:s),"y"===r.axis&&(l=this.originalPageX),"x"===r.axis&&(u=this.originalPageY)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,n){var o=n.options,s=e.extend({},i,{item:n.element});n.sortables=[],e(o.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,s))})},stop:function(t,i,n){var o=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,o))})},drag:function(t,i,n){var o=this;e.each(n.sortables,function(){var s=!1,r=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==r&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(r.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(o).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,n){var o=e("body"),s=n.options;o.css("cursor")&&(s._cursor=o.css("cursor")),o.css("cursor",s.cursor)},stop:function(t,i,n){var o=n.options;o._cursor&&e("body").css("cursor",o._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,n){var o=e(i.helper),s=n.options;o.css("opacity")&&(s._opacity=o.css("opacity")),o.css("opacity",s.opacity)},stop:function(t,i,n){var o=n.options;o._opacity&&e(i.helper).css("opacity",o._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,n){var o=n.options,s=!1,r=n.scrollParentNotHidden[0],a=n.document[0];r!==a&&"HTML"!==r.tagName?(o.axis&&"x"===o.axis||(n.overflowOffset.top+r.offsetHeight-t.pageY<o.scrollSensitivity?r.scrollTop=s=r.scrollTop+o.scrollSpeed:t.pageY-n.overflowOffset.top<o.scrollSensitivity&&(r.scrollTop=s=r.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(n.overflowOffset.left+r.offsetWidth-t.pageX<o.scrollSensitivity?r.scrollLeft=s=r.scrollLeft+o.scrollSpeed:t.pageX-n.overflowOffset.left<o.scrollSensitivity&&(r.scrollLeft=s=r.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(t.pageY-e(a).scrollTop()<o.scrollSensitivity?s=e(a).scrollTop(e(a).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(a).scrollTop())<o.scrollSensitivity&&(s=e(a).scrollTop(e(a).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(t.pageX-e(a).scrollLeft()<o.scrollSensitivity?s=e(a).scrollLeft(e(a).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(a).scrollLeft())<o.scrollSensitivity&&(s=e(a).scrollLeft(e(a).scrollLeft()+o.scrollSpeed)))),s!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,n){var o=n.options;n.snapElements=[],e(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var t=e(this),i=t.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,n){var o,s,r,a,l,u,c,d,p,h,f=n.options,m=f.snapTolerance,g=i.offset.left,v=g+n.helperProportions.width,b=i.offset.top,y=b+n.helperProportions.height;for(p=n.snapElements.length-1;p>=0;p--)l=n.snapElements[p].left-n.margins.left,u=l+n.snapElements[p].width,c=n.snapElements[p].top-n.margins.top,d=c+n.snapElements[p].height,l-m>v||g>u+m||c-m>y||b>d+m||!e.contains(n.snapElements[p].item.ownerDocument,n.snapElements[p].item)?(n.snapElements[p].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[p].item})),n.snapElements[p].snapping=!1):("inner"!==f.snapMode&&(o=Math.abs(c-y)<=m,s=Math.abs(d-b)<=m,r=Math.abs(l-v)<=m,a=Math.abs(u-g)<=m,o&&(i.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:d,left:0}).top),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:u}).left)),h=o||s||r||a,"outer"!==f.snapMode&&(o=Math.abs(c-b)<=m,s=Math.abs(d-y)<=m,r=Math.abs(l-g)<=m,a=Math.abs(u-v)<=m,o&&(i.position.top=n._convertPositionTo("relative",{top:c,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:d-n.helperProportions.height,left:0}).top),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:u-n.helperProportions.width}).left)),!n.snapElements[p].snapping&&(o||s||r||a||h)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[p].item})),n.snapElements[p].snapping=o||s||r||a||h)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,n){var o,s=n.options,r=e.makeArray(e(s.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});r.length&&(o=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each(function(t){e(this).css("zIndex",o+t)}),this.css("zIndex",o+r.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,n){var o=e(i.helper),s=n.options;o.css("zIndex")&&(s._zIndex=o.css("zIndex")),o.css("zIndex",s.zIndex)},stop:function(t,i,n){var o=n.options;o._zIndex&&e(i.helper).css("zIndex",o._zIndex)}}),e.ui.draggable}),function(e){"function"==typeof define&&define.amd?define("resizable",["jquery","./core","./mouse","./widget"],e):e(jQuery)}(function(e){return e.widget("ui.resizable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",o=!1;return t[n]>0?!0:(t[n]=1,o=t[n]>0,t[n]=0,o)},_create:function(){var t,i,n,o,s,r=this,a=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;i<t.length;i++)n=e.trim(t[i]),s="ui-resizable-"+n,o=e("<div class='ui-resizable-handle "+s+"'></div>"),o.css({zIndex:a.zIndex}),"se"===n&&o.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(o);
this._renderAxis=function(t){var i,n,o,s;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=e(this.handles[i],this.element),s=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),o=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(o,s),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){r.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),r.axis=o&&o[1]?o[1]:"se")}),a.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(e(this).removeClass("ui-resizable-autohide"),r._handles.show())}).mouseleave(function(){a.disabled||r.resizing||(e(this).addClass("ui-resizable-autohide"),r._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,n,o=!1;for(i in this.handles)n=e(this.handles[i])[0],(n===t.target||e.contains(n,t.target))&&(o=!0);return!this.options.disabled&&o},_mouseStart:function(t){var i,n,o,s=this.options,r=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),s.containment&&(i+=e(s.containment).scrollLeft()||0,n+=e(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalPosition={left:i,top:n},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===o?this.axis+"-resize":o),r.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,n,o=this.originalMousePosition,s=this.axis,r=t.pageX-o.left||0,a=t.pageY-o.top||0,l=this._change[s];return this._updatePrevProperties(),l?(i=l.apply(this,[t,r,a]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,n,o,s,r,a,l,u=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),o=n&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,s=n?0:c.sizeDiff.width,r={width:c.helper.width()-s,height:c.helper.height()-o},a=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,l=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,u.animate||this.element.css(e.extend(r,{top:l,left:a})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!u.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,n,o,s,r=this.options;s={minWidth:this._isNumber(r.minWidth)?r.minWidth:0,maxWidth:this._isNumber(r.maxWidth)?r.maxWidth:1/0,minHeight:this._isNumber(r.minHeight)?r.minHeight:0,maxHeight:this._isNumber(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||e)&&(t=s.minHeight*this.aspectRatio,n=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,o=s.maxWidth/this.aspectRatio,t>s.minWidth&&(s.minWidth=t),n>s.minHeight&&(s.minHeight=n),i<s.maxWidth&&(s.maxWidth=i),o<s.maxHeight&&(s.maxHeight=o)),this._vBoundaries=s},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,s=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,r=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,u=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return s&&(e.width=t.minWidth),r&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),o&&(e.height=t.maxHeight),s&&u&&(e.left=a-t.minWidth),n&&u&&(e.left=a-t.maxWidth),r&&c&&(e.top=l-t.minHeight),o&&c&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],o=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(n[t],10)||0,i[t]+=parseInt(o[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,o=this.originalPosition;return{top:o.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},sw:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,n]))},ne:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},nw:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,n]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),n=i.options,o=i._proportionallyResizeElements,s=o.length&&/textarea/i.test(o[0].nodeName),r=s&&i._hasScroll(o[0],"left")?0:i.sizeDiff.height,a=s?0:i.sizeDiff.width,l={width:i.size.width-a,height:i.size.height-r},u=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(l,c&&u?{top:c,left:u}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};o&&o.length&&e(o[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,n,o,s,r,a,l=e(this).resizable("instance"),u=l.options,c=l.element,d=u.containment,p=d instanceof e?d.get(0):/parent/.test(d)?c.parent().get(0):d;p&&(l.containerElement=e(p),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,n){i[e]=l._num(t.css("padding"+n))}),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},n=l.containerOffset,o=l.containerSize.height,s=l.containerSize.width,r=l._hasScroll(p,"left")?p.scrollWidth:s,a=l._hasScroll(p)?p.scrollHeight:o,l.parentData={element:p,left:n.left,top:n.top,width:r,height:a}))},resize:function(t){var i,n,o,s,r=e(this).resizable("instance"),a=r.options,l=r.containerOffset,u=r.position,c=r._aspectRatio||t.shiftKey,d={top:0,left:0},p=r.containerElement,h=!0;p[0]!==document&&/static/.test(p.css("position"))&&(d=l),u.left<(r._helper?l.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-l.left:r.position.left-d.left),c&&(r.size.height=r.size.width/r.aspectRatio,h=!1),r.position.left=a.helper?l.left:0),u.top<(r._helper?l.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-l.top:r.position.top),c&&(r.size.width=r.size.height*r.aspectRatio,h=!1),r.position.top=r._helper?l.top:0),o=r.containerElement.get(0)===r.element.parent().get(0),s=/relative|absolute/.test(r.containerElement.css("position")),o&&s?(r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top):(r.offset.left=r.element.offset().left,r.offset.top=r.element.offset().top),i=Math.abs(r.sizeDiff.width+(r._helper?r.offset.left-d.left:r.offset.left-l.left)),n=Math.abs(r.sizeDiff.height+(r._helper?r.offset.top-d.top:r.offset.top-l.top)),i+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-i,c&&(r.size.height=r.size.width/r.aspectRatio,h=!1)),n+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-n,c&&(r.size.width=r.size.height*r.aspectRatio,h=!1)),h||(r.position.left=r.prevPosition.left,r.position.top=r.prevPosition.top,r.size.width=r.prevSize.width,r.size.height=r.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,n=t.containerOffset,o=t.containerPosition,s=t.containerElement,r=e(t.helper),a=r.offset(),l=r.outerWidth()-t.sizeDiff.width,u=r.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(s.css("position"))&&e(this).css({left:a.left-o.left-n.left,width:l,height:u}),t._helper&&!i.animate&&/static/.test(s.css("position"))&&e(this).css({left:a.left-o.left-n.left,width:l,height:u})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options,n=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):e.each(i.alsoResize,function(e){n(e)})},resize:function(t,i){var n=e(this).resizable("instance"),o=n.options,s=n.originalSize,r=n.originalPosition,a={height:n.size.height-s.height||0,width:n.size.width-s.width||0,top:n.position.top-r.top||0,left:n.position.left-r.left||0},l=function(t,n){e(t).each(function(){var t=e(this),o=e(this).data("ui-resizable-alsoresize"),s={},r=n&&n.length?n:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(r,function(e,t){var i=(o[t]||0)+(a[t]||0);i&&i>=0&&(s[t]=i||null)}),t.css(s)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?l(o.alsoResize):e.each(o.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,n=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),n=i.options,o=i.size,s=i.originalSize,r=i.originalPosition,a=i.axis,l="number"==typeof n.grid?[n.grid,n.grid]:n.grid,u=l[0]||1,c=l[1]||1,d=Math.round((o.width-s.width)/u)*u,p=Math.round((o.height-s.height)/c)*c,h=s.width+d,f=s.height+p,m=n.maxWidth&&n.maxWidth<h,g=n.maxHeight&&n.maxHeight<f,v=n.minWidth&&n.minWidth>h,b=n.minHeight&&n.minHeight>f;n.grid=l,v&&(h+=u),b&&(f+=c),m&&(h-=u),g&&(f-=c),/^(se|s|e)$/.test(a)?(i.size.width=h,i.size.height=f):/^(ne)$/.test(a)?(i.size.width=h,i.size.height=f,i.position.top=r.top-p):/^(sw)$/.test(a)?(i.size.width=h,i.size.height=f,i.position.left=r.left-d):((0>=f-c||0>=h-u)&&(t=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=r.top-p):(f=c-t.height,i.size.height=f,i.position.top=r.top+s.height-f),h-u>0?(i.size.width=h,i.position.left=r.left-d):(h=c-t.height,i.size.width=h,i.position.left=r.left+s.width-h))}}),e.ui.resizable}),function(e){"function"==typeof define&&define.amd?define("dialog",["jquery","ui_core","widget","button","draggable","mouse","position","resizable"],e):e(jQuery)}(function(e){return e.widget("ui.dialog",{version:"@VERSION",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,n=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(o){}this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var n=!1,o=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),s=Math.max.apply(null,o);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),n=!0),n&&!i&&this._trigger("focus",t),n},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),o=i.filter(":last");t.target!==o[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==n[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){o.focus()}),t.preventDefault()):(this._delay(function(){n.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(e.each(i,function(i,n){var o,s;n=e.isFunction(n)?{click:n,text:i}:n,n=e.extend({type:"button"},n),o=n.click,n.click=function(){o.apply(t.element[0],arguments)},s={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,e("<button></button>",n).button(s).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,o){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,t(o))},drag:function(e,n){i._trigger("drag",e,t(n))},stop:function(o,s){var r=s.offset.left-i.document.scrollLeft(),a=s.offset.top-i.document.scrollTop();n.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" top"+(a>=0?"+":"")+a,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",o,t(s))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,n=this.options,o=n.resizable,s=this.uiDialog.css("position"),r="string"==typeof o?o:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:r,start:function(n,o){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,t(o))},resize:function(e,n){i._trigger("resize",e,t(n))},stop:function(o,s){var r=i.uiDialog.offset(),a=r.left-i.document.scrollLeft(),l=r.top-i.document.scrollTop();n.height=i.uiDialog.height(),n.width=i.uiDialog.width(),n.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(l>=0?"+":"")+l,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",o,t(s))}}).css("position",s)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,n=!1,o={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(n=!0),e in i.resizableRelatedOptions&&(o[e]=t)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var i,n,o=this.uiDialog;"dialogClass"===e&&o.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=o.is(":data(ui-draggable)"),i&&!t&&o.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(n=o.is(":data(ui-resizable)"),n&&!t&&o.resizable("destroy"),n&&"string"==typeof t&&o.resizable("option","handles",t),n||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}})}),define("core",["jquery","autocomplete","tagit","tipsy","modernizr","upload","dialog"],function(e){e.fn.fastLiveFilter=function(t,i){i=i||{},t=e(t);var n,o=this,s=i.timeout||0,r=i.callback||function(){},a=t.children(),l=a.length,u=l>0?a[0].style.display:"block";return r(l),o.change(function(){for(var e,t=o.val().toLowerCase(),i=0,n=0;l>n;n++)e=a[n],(e.textContent||e.innerText||"").toLowerCase().indexOf(t)>=0?("none"==e.style.display&&(e.style.display=u),i++):"none"!=e.style.display&&(e.style.display="none");return r(i),!1}).keydown(function(){clearTimeout(n),n=setTimeout(function(){o.change()},s)}),this},_.extend(OC.config,{search:{input:"#search-bar input[name=q]",submit:"#search-bar input[type=submit]"},popup:{id:"default-popup",width:360},articlePanel:{list:"ul#article-panel",item:"ul#article-panel li"},article:{redirectSelector:"#chapter-select, .revision-selector",thermometer:".thermometer-difficulty",thermometerWrapper:".thermometer-difficulty-wrapper",image:"#article img"},catalog:{filterInput:"input[name=live-filter]",filterList:".category-article-panel",categoryPanel:{list:"ul.category-article-panel",item:"ul.category-article-panel li"}},about:{jobsCarousel:".jobs-image-rotator"},registration:{fields:{first_name:"input[name=first_name]",last_name:"input[name=last_name]",location:"input[name=location]",email:"input[name=email]",username:"input[name=username]",socialLogin:".social-login-hide",profilePicture:"input[name=profile_pic]",socialFlag:"form#signup-form input[name=social_login]",socialService:"form#signup-form input[name=social_service]",socialID:"form#signup-form input[name=social_id]"},googleAuthURL:"/gauth/",googleAuthResult:".google-signin",orWrapper:".or-wrapper",ToS:"#agree-terms-conditions",signUpButtonID:"signup-button"},invite:{formSelector:"form.signup",formSpinner:".form-spinner",formError:".form-error"}}),OC.api={},OC.api.UserProfile=function(e,t){return this.username=e,this.profile={},this.fetchProfile(t),this},OC.api.UserProfile.prototype.fetchProfile=function(t){profile=this.profile,e.get("/user/api/get-profile/"+this.username+"/",function(e){t("true"==e.status?e.user:null)},"json")},OC.api.User=function(e,t){return this.username=e,new OC.api.UserProfile(this.username,t)},_.extend(OC,{registerationSuccessCallback:"",signupDialog:null,initSearchOptions:function(){e(".search-options-button").click(function(){e(".search-options").toggleClass("show")})},initSearchAutocomplete:function(){e(OC.config.search.input).autocomplete({source:function(t,i){e.get("/resources/api/search/"+t.term+"/",function(t){i(e.map(t,function(e){return{label:e,value:e}}))},"json")},minLength:2,select:function(t,i){var n=e("form#search-form"),o=e("input[name=q]",n);o.val(i.item.label),e("form#search-form").submit()}})},setUpMenuPositioning:function(t,i,n){var o=n||!1,s=e(i).position();s&&(e(t).css("top",s.top+e(i).outerHeight(!0)),o?e(t).css("left",s.left-(e(t).outerWidth()-e(i).outerWidth())/2):e(t).css("left",s.left-(e(t).outerWidth()-e(i).outerWidth(!0))))},popup:function(t,i){var n=e("#"+OC.config.popup.id),o=i||"";0===n.length?n=e("<div/>",{id:OC.config.popup.id,title:o}):n.attr("title",o),n.html(t),n.dialog({modal:!0,open:!1,width:OC.config.popup.width,buttons:{Ok:function(){e(this).dialog("close")}}})},customPopup:function(t,i){function n(t){e(".popup-background").addClass("show-popup-background"),t.addClass("show-popup"),o(t),OC.dismissMessageBox(),e(window).resize(function(){o(t)})}function o(t){var i=e(window).width(),n=e(window).height();e(t).css("left",(i-t.width())/2),e(t).css("top",(n-t.height())/2.5)}function s(t){e(".oc-popup-exit",t.dialog).click(function(){t.close(t)}),e(document).keyup(function(e){t.dialog.hasClass("show-popup")&&27==e.which&&t.close(t)})}function r(t){t.dialog.removeClass("show-popup"),e(".popup-background").removeClass("show-popup-background");var i,n=e(".oc-popup");for(i=0;i<n.length;i++)e(n[i]).hasClass("show-popup")&&e(".popup-background").addClass("show-popup-background");a&&a()}var a=null;i&&(a=i.closeCallback||a);var l=e(t);e(".oc-popup-exit",l).unbind("click"),e(".popup-background").unbind("click"),n(l);var u={dialog:l,close:r};return s(u),e(".popup-background").click(function(){r(u)}),u},tabs:function(t,i){var n=0,o=null,s=!1;i&&(n=i.tab||n,o=i.showOnly||o,s=i.viewOnly||s);var r=e(t);if(r.addClass("oc-tabs"),!s){var a,l=e("nav > ul > li > a",r);for(a=0;a<l.length;a++){var u=e(l[a]).attr("href").replace("#",".");e(u).addClass("tab-content")}var c=e(".tab-content",r);l.click(function(t){if(!e(this).hasClass("selected")){l.removeClass("selected"),e(this).addClass("selected");
var i=e(this).attr("href").replace("#",".");e(c).hide(),e(i).show()}return t.preventDefault(),t.stopPropagation(),!1}),e(l[n]).click()}o&&e("> nav",r).addClass("hide-tabs")},progressBar:function(t,i){function n(e){o(this.element,e)}function o(t,i){e(".oc-progressbar-indicator",t).css({width:i+"%"})}var s=0;i&&(s=i.startAt||s);var r=e(t);return o(r,s),{element:r,advanceTo:n}},tip:function(t,i){function n(e){e.removeClass("show"),e.remove()}var o="n",s=null,r=!1,a=null,l=null;i&&(o=i.gravity||o,s=i.title||s,r=i.description||r,a=i.width||a,l=i.dismisser||l);var u=_.template('<div class="oc-tip-body-title"><h4><%= title %></h4></div><div class="oc-tip-body-description"><p><%= description %></p></div><button class="action-button mini-action-button">Done</button>'),c=e("<div/>",{"class":"oc-tip show"}),d=e("<div/>",{"class":"oc-tip-body",html:u({title:s,description:r})}),p=e("<div/>",{"class":"floating-menu-spacer "+o});a&&d.width(a);var h,f,m,g=e("body");switch(o){case"n":c.append(p),c.append(d),g.append(c),h=e("body .oc-tip:last"),m=t.offset().left-(h.width()-t.outerWidth())/2,f=t.offset().top+t.outerHeight(),c.css({top:f+10,left:m}),c.animate({top:f,opacity:1},500);break;case"e":c.append(d),c.append(p),g.append(c),h=e("body .oc-tip:last"),c.css({top:t.offset().top,left:t.offset().left-h.width()});break;case"s":c.append(d),c.append(p),g.append(c),h=e("body .oc-tip:last"),m=t.offset().left-(h.width()-t.outerWidth())/2,f=t.offset().top-h.height(),c.css({top:f-10,left:m}),c.animate({top:f,opacity:1},500);break;case"w":c.append(p),c.append(d),g.append(c),c.css({top:t.offset().top,left:t.offset().left+t.outerWidth()})}if(a){appendedTipWidth=e(".oc-tip-body",h).innerWidth();var v=e(".floating-menu-spacer",h);v.width(appendedTipWidth),v.css("background-position",appendedTipWidth/2-8+"px bottom")}e(".action-button",h).click(function(){l(c,n)})},setupIndex:function(){var t=e("#chief-panel-container.home");if(t.length>0){var i=e(window).height()-100;t.height(i),e(".blog-highlight").css({top:i-e(".blog-highlight").outerHeight(!0)}),e.ajax({type:"GET",dataType:"xml",url:"http://blog.opencurriculum.org/feed/rss/",success:function(t){var i=e(t).find("item:first"),n=e(i).find("title").text(),o=e(i).find("link").text();e(".blog-highlight-title").text(n),e(".blog-highlight-title").attr("href",o),e(".blog-highlight").fadeIn("slow")}}),OC.renderIndexAnimation()}},renderIndexAnimation:function(){function t(){clearInterval(n),setTimeout(function(){n=i()},5e3)}function i(){return forward_motion=!1,setInterval(function(){var i=e(".animated-learning-item");i.text().length>0&&!forward_motion?i.text(i.text().substring(0,i.text().length-1)):i.text().length===o[s].length?(forward_motion=!1,t()):(0===i.text().length&&(s===o.length-1?s=0:s++,forward_motion=!0),i.text(o[s].substring(0,i.text().length+1)))},200)}var n,o=["curriculum","lesson plans","activities","worksheets","handouts"],s=0;setTimeout(function(){n=i()},3e3)},renderSelectRedirector:function(){e(OC.config.article.redirectSelector).change(function(){var t=e("option:selected",this).attr("data-url");void 0!==t&&(window.location.href=t)})},renderThermometer:function(){e(OC.config.article.thermometer).each(function(){e(this).parent(OC.config.article.thermometerWrapper).css("width",100-e(this).attr("data-level")+"%"),e(this).addClass("renderDifficulty")})},initCategoryLiveFilter:function(){e(OC.config.catalog.filterInput).fastLiveFilter(OC.config.catalog.filterList).focus()},renderCategoryArticles:function(){Modernizr.cssanimations?(e(OC.config.catalog.categoryPanel.item).each(function(t){var i=Math.ceil((t+1)/5);e(this).attr("style","-webkit-animation-delay:"+300*i+"ms;                             -moz-animation-delay:"+300*i+"ms;                             -o-animation-delay:"+300*i+"ms;                             animation-delay:"+300*i+"ms;"),i===e("ul.category-article-panel li").size()-1&&e("ul.category-article-panel").addClass("play")}),e(OC.config.catalog.categoryPanel.list).attr("data-liffect","slideUp"),e(OC.config.catalog.categoryPanel.list).addClass("play")):e(OC.config.catalog.categoryPanel.item).show()},renderShowMore:function(){function t(e,t){var i,n=e.split(" "),o="";for(i=0;i<n.length;i++)t>=i?o+=n[i]+" ":(i===t+1&&(o+='<span class="more_text hide">'),o+=n[i]+" ",null===n[i+1]&&(o+='</span><a href="#" class="more_link"> Show more...</a>'));return o}e(".summary-text").add('[class^="showmore"]').each(function(){var i=80;e(this).hasClass("showmore-20")?i=20:e(this).hasClass("showmore-40")?i=40:e(this).hasClass("showmore-60")?i=60:e(this).hasClass("showmore-80")?i=80:e(this).hasClass("showmore-100")&&(i=100),e(this).html(e.browser.msie?t(e(this).html(),i):t(e(this).html(),i+5)),e(this).children("span").hide()}).click(function(){var t=e(this).children("span.more_text"),i=e(this).children("a.more_link");return t.hasClass("hide")?(e(this).hasClass("summary-text")?t.show():t.slideDown("slow"),i.html(" &#171; hide"),t.removeClass("hide")):(e(this).hasClass("summary-text")?t.hide():t.slideUp("slow"),i.html(" Show more..."),t.addClass("hide")),!1})},initImageHoverDescriptions:function(){e(".pillar").mouseover(function(){function t(t){e(t).fadeIn("fast")}e(this).hasClass("pillar-community")?t("#pillars-community-description"):e(this).hasClass("pillar-innovation")?t("#pillars-innovation-description"):e(this).hasClass("pillar-freedom")&&t("#pillars-freedom-description")}),e(".pillar").mouseleave(function(){function t(t){e(t).fadeOut("fast")}e(this).hasClass("pillar-community")?t("#pillars-community-description"):e(this).hasClass("pillar-innovation")?t("#pillars-innovation-description"):e(this).hasClass("pillar-freedom")&&t("#pillars-freedom-description")}),e(".license").mouseover(function(){function t(t){e(t).fadeIn("fast")}e(this).hasClass("license-cc")?t("#license-cc-description"):e(this).hasClass("license-by")?t("#license-by-description"):e(this).hasClass("license-sa")&&t("#license-sa-description")}),e(".license").mouseleave(function(){function t(t){e(t).fadeOut("fast")}e(this).hasClass("license-cc")?t("#license-cc-description"):e(this).hasClass("license-by")?t("#license-by-description"):e(this).hasClass("license-sa")&&t("#license-sa-description")})},renderJobsCarousel:function(){e(OC.config.about.jobsCarousel).animate({left:"-1950px"},2e5)},asynchronousLogin:function(t,i){e.get("/user/api/social-availability/"+t+"/"+i+"/",function(t){"false"==t.status&&(OC.signupDialog?(OC.config.user.id=t.id,e('input[name="user"]').val(t.id),OC.config.user.username=t.username,OC.signupDialog.close(),OC.registerationSuccessCallback(),OC.setMessageBoxMessage("You have successfully logged in."),OC.showMessageBox(),OC.pushMessageBoxForward()):window.location.reload())},"json")},expediteGLogin:function(t){OC.asynchronousLogin("plus",t.id);var i,n=t.name.givenName||"",o=t.name.familyName||"";if(t.placesLived){var s=_.where(t.placesLived,{primary:!0})[0];i=s.value||""}else i="";e(OC.config.registration.fields.first_name).attr("value",n),e(OC.config.registration.fields.last_name).attr("value",o),e(OC.config.registration.fields.location).attr("value",i),e("tr.registration-username-password td:first").attr("colspan","2"),e("tr.registration-username-password td:last").remove();var r=t.image.url,a=r.substring(0,r.indexOf("?sz=")+4)+"300";e(OC.config.registration.fields.profilePicture).attr("value",a),e(OC.config.registration.fields.email).attr("value",t.email);try{e(OC.config.registration.fields.username).attr("value",t.email.substring(0,t.email.indexOf("@")))}catch(l){}e(OC.config.registration.fields.socialFlag).attr("value","true"),e(OC.config.registration.fields.socialService).attr("value","plus"),e(OC.config.registration.fields.socialID).attr("value",t.id)},googleSignInCallback:function(t){function i(){l.removeClass("faded"),OC.expediteGLogin(profile),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".login-dialog #fill-panel").remove(),e(".login-dialog #key-panel").addClass("center")}function n(n,u){a.length>0&&l.removeClass("faded"),e(".google-plus-login input[name=google_id]").val(u.id),e.post("/glogin/",e("form.google-plus-login").serialize(),function(n){if("true"===n.status){var o=e(".google-plus-login input[name=redirect_to]").val();"False"!==o&&void 0!==o?window.location.href=o:OC.signupDialog?i():window.location.href="/"}else if(0===a.length&&t["g-oauth-window"]&&r.length>0)OC.customPopup(".new-account-redirect-dialog"),setTimeout(function(){window.location.href="/signup/?expedite=plus"},3e3);else if(a.length>0)return void i()},"json"),(s.length>0||a.length>0)&&(OC.expediteGLogin(u),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".or-wrapper .or-text").removeClass("hidden"),e(".or-wrapper .or-loading").removeClass("visible"),o.removeClass("visible"),e(OC.config.registration.googleAuthResult).html("<p>You have successfully connected to Google. Just need to confirm a few more details below...</p>"),e(OC.config.registration.orWrapper).hide(),a.length>0&&(e(".login-dialog #fill-panel").remove(),e(".login-dialog #key-panel").addClass("center")))}var o=e(".registration-cover"),s=e("#signup-form"),r=e("#sign-in-form"),a=e(".login-dialog"),l=e(".oc-popup-body",a);(t["g-oauth-window"]||o.length>0&&"plus"===o.attr("title"))&&(e(".or-wrapper .or-text").addClass("hidden"),e(".or-wrapper .or-loading").addClass("visible"),OC.googleAuthenticationCallback(t,n),a.length>0&&l.addClass("faded"))},googleAuthenticationCallback:function(t,i){if(t.code){t.state=e("#session-state").attr("data-state");var n;gapi.client.load("oauth2","v2",function(){var e=gapi.client.oauth2.userinfo.get();e.execute(function(e){n=e.email})}),gapi.client.load("plus","v1",function(){var o=gapi.client.plus.people.get({userId:"me"});o.execute(function(o){var s={code:t.code,state:t.state,gplus_id:o.id};o.email=n,e.ajax({type:"POST",url:OC.config.registration.googleAuthURL,dataType:"json",contentType:"application/octet-stream; charset=utf-8",success:function(e){i(e,o)},data:s})})})}else t.error},facebookRegistrationCallback:function(t){var i=e(".registration-cover");("connected"===t.status||i.length>0&&"facebook"===i.attr("title"))&&(e(".or-wrapper .or-text").addClass("hidden"),e(".or-wrapper .or-loading").addClass("visible"),FB.api("/me",function(t){OC.expediteFbLogin(t),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".or-wrapper .or-text").removeClass("hidden"),e(".or-wrapper .or-loading").removeClass("visible"),i.removeClass("visible")}),e(OC.config.registration.googleAuthResult).html("<p>You have successfully connected to your Facebook account.  Just need to confirm a few more details below...</p>"),e(OC.config.registration.orWrapper).hide())},expediteFbLogin:function(t){OC.asynchronousLogin("facebook",t.id);var i,n=t.first_name||"",o=t.last_name||"";i=t.location?t.location.name||"":"",e(OC.config.registration.fields.first_name).attr("value",n),e(OC.config.registration.fields.last_name).attr("value",o),e(OC.config.registration.fields.location).attr("value",i),e("tr.registration-username-password td:first").attr("colspan","2"),e("tr.registration-username-password td:last").remove(),FB.api("/me/picture?width=300",function(t){e(OC.config.registration.fields.profilePicture).attr("value",t.data.url)}),e(OC.config.registration.fields.email).attr("value",t.email),e(OC.config.registration.fields.username).attr("value",t.username),e(OC.config.registration.fields.socialFlag).attr("value","true"),e(OC.config.registration.fields.socialService).attr("value","facebook"),e(OC.config.registration.fields.socialID).attr("value",t.id)},facebookSignInCallback:function(){function t(){s.removeClass("faded"),OC.expediteFbLogin(i),OC.highlightAndReturnErroneousInputs(!1),e('#signup-form input[type="text"]').trigger("change"),e(".login-dialog #fill-panel").remove(),e(".login-dialog #key-panel").addClass("center")}var i,n=(e("#signup-form"),e("#sign-in-form")),o=e(".login-dialog"),s=e(".oc-popup-body",o);o.length>0&&s.addClass("faded"),FB.login(function(s){"connected"===s.status&&FB.api("/me",function(s){i=s,e("form.facebook-login input[name=facebook_id]").val(s.id),e.post("/fblogin/",e("form.facebook-login").serialize(),function(i){if("true"===i.status){var s=e(".facebook-login input[name=redirect_to]").val();"False"!==s&&""!==s?window.location.href=s:OC.signupDialog?t():window.location.href="/"}else 0===o.length&&n.length>0?(OC.customPopup(".new-account-redirect-dialog"),setTimeout(function(){window.location.href="/signup/?expedite=facebook"},2e3)):o.length>0&&t()},"json")})},{scope:"public_profile, email"})},initInviteSignup:function(){e(OC.config.invite.formSelector).submit(function(){var t=e(this),i="#"+t.attr("id");return e(OC.config.invite.formSpinner,t).show(),e(i+"-error").slideUp("fast"),e(OC.config.invite.formError,t).removeClass("form-error-show"),e.ajax({data:e(this).serialize(),type:"POST",url:e(this).attr("action"),success:function(n){e(OC.config.invite.formSpinner,t).hide();var o=n.status,s=n.message,r=!1;o===!1||"false"===o?(["name","organization","email"].forEach(function(i){if(s[i]){var n=e("."+i+"-error",t);n.html(s[i][0]),n.addClass("form-error-show"),e("#id_"+i,t).addClass("form-input-error"),r=!0}}),r||(e(i+"-error").html(s),e(i+"-error").slideDown("fast"))):o&&t.fadeOut("fast",function(){var t='<div class="success-check"></div>';e(i+"-success").html(t+s),e(i+"-success").slideDown("fast")})}}),!1})},initRegistrationForm:function(){e("#signup-form input[title]:not(.form-input-error)").tipsy({trigger:"focus",gravity:"n"}),e("#signup-form input[title].form-input-error").tipsy({trigger:"manual",gravity:"n",fade:!0}),e("#signup-form input.form-input-error").each(function(){error_input=e(this),error_input.change(function(){error_input.removeClass("form-input-error"),error_input.tipsy("hide")}),error_input.tipsy("show")}),e(OC.config.registration.ToS).change(function(){e("#"+OC.config.registration.signUpButtonID).toggleClass("disabled");var t=document.getElementById(OC.config.registration.signUpButtonID);t.disabled=!t.disabled}),e("form#signup-form input[name=social_login]").length>0&&"true"===e("form#signup-form input[name=social_login]").attr("value").toLowerCase()&&(e(".social-login-hide").hide(),e("aside.content-block.google-signin").hide(),e("#new-account-signup-info").hide()),e(".synchronous-signup .facebook-button").click(function(){FB.login(function(e){"connected"===e.status&&OC.facebookRegistrationCallback(e)},{scope:"public_profile, email"})}),-1!==window.location.search.indexOf("expedite=facebook")&&setTimeout(function(){FB.login(function(){},{scope:"public_profile, email"})},1e3),e("#sign-in-form .facebook-button, .login-dialog .facebook-button").click(function(e){return OC.facebookSignInCallback(),e.stopPropagation(),e.preventDefault(),!1}),e(".google-plus-button").click(function(e){return e.stopPropagation(),e.preventDefault(),!1}),e("#session-state").length>0&&""!==e("#session-state").attr("data-state")&&OC.initializeGooglePlusButtons(),e("form#signup-form button.large-action-button").click(function(t){var i=e(this),n=OC.highlightAndReturnErroneousInputs(!0);if(0===n.length&&OC.signupDialog){var o=e("form#signup-form").serialize();i.addClass("loading"),e.post("/user/api/register-asynchronously/",o,function(t){i.removeClass("loading"),OC.signupDialog.close(),OC.registerationSuccessCallback(),OC.config.user.id=t.id,e('input[name="user"]').val(t.id),OC.config.user.username=t.username,OC.setMessageBoxMessage(t.name+", your account has successfully been set up."),OC.showMessageBox(),OC.pushMessageBoxForward()},"json")}else 0===n.length&&(e(".page-form-submission-loader").addClass("show"),i.parents("form#signup-form").submit());return t.stopPropagation(),t.preventDefault(),!1}),OC.liveValidateRegistrationForm()},highlightAndReturnErroneousInputs:function(t){var i=['input[name="first_name"]','input[name="last_name"]','input[name="email"]','input[name="username"]','input[name="dob_date"]','input[name="dob_year"]','select[name="dob_month"]'];t&&i.push('input[name="password"]');var n,o,s=[];for(n=0;n<i.length;n++)o=e("form#signup-form "+i[n]),(""===o.val()||"0"===o.val())&&o.addClass("form-input-error"),o.hasClass("form-input-error")&&s.push(o);return s},liveValidateRegistrationForm:function(){OC.validate.text('#signup-form input[name="first_name"], #signup-form input[name="last_name"]',/[A-Za-z-]{1,16}[\s]?/,"The name must contain only letters and not be more than 16 letters."),OC.validate.text('#signup-form input[name="email"]',/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/,"The email address is invalid"),e('#signup-form input[name="username"]').blur(function(){var t=e(this);""!==t.val()&&(t.addClass("loading"),e.get("/user/api/username-availability/"+t.val()+"/",function(e){t.removeClass("loading"),"false"==e.status?(t.addClass("unavailable"),t.addClass("form-input-error"),t.attr("title","This username is not available"),t.tipsy({trigger:"manual",gravity:"n",fade:!0}),t.tipsy("show")):(t.hasClass("form-input-error")||t.tipsy("hide"),t.removeClass("unavailable"),t.removeClass("form-input-error"),t.addClass("available"))},"json"))}),OC.validate.text('#signup-form input[name="username"]',/^[a-z][a-z0-9_\.]{3,30}$/,"Username should be all lowercase, cannot begin with a number and must only have letters and digits and/or underscores."),OC.validate.text('#signup-form input[name="password"]',/[\w\.\!\@\#\$\%\^\*\&<>]+/,"Password should contain valid characters"),OC.validate.date('#signup-form select[name="dob_month"]','#signup-form input[name="dob_date"]','#signup-form input[name="dob_year"]',{DOB_OUT_OF_RANGE:"The date of birth is out of range",DOB_AFTER_TODAY:"The date of birth cannot be later than today",DOB_LESS_THAN_THIRTEEN:"You need to be above 13 years of age to sign up",DOB_INCORRECT:"The date of birth is incorrect",DOB_NO_MONTH:"You need to select a month of birth"})},validate:{invalidate:function(e,t){e.addClass("form-input-error"),e.attr("title",t),e.tipsy({trigger:"manual",gravity:"n",fade:!0}),e.tipsy("show")},pass:function(e){e.removeClass("form-input-error"),e.tipsy("hide")},text:function(t,i,n){function o(t){r=e(t.target),r.hasClass("form-input-error")&&r.val().match(i)&&r.val().match(i)[0]===r.val()&&OC.validate.pass(r)}function s(t){r=e(t.target),r.val().match(i)?r.val().match(i)[0]!==r.val()&&OC.validate.invalidate(r,n):OC.validate.invalidate(r,n)}var r,a=e(t);a.keyup(o),a.blur(s),a.change(s)},confirm:function(t,i,n){var o,s=e(t),r=e(i);s.blur(function(t){o=e(t.target),o.val()!==r.val()?OC.validate.invalidate(o,n):OC.validate.pass(o)})},date:function(t,i,n,o){var s,r=e(t),a=e(i),l=e(n);r.blur(function(t){s=e(t.target),0===parseInt(s.val(),10)?OC.validate.invalidate(s,o.DOB_NO_MONTH):s.hasClass("form-input-error")&&OC.validate.pass(s)}),a.blur(function(t){s=e(t.target),a.val().match(/[3][0-1]|[0-2]\d|^[1-9]$/)?s.hasClass("form-input-error")&&OC.validate.pass(s):OC.validate.invalidate(s,o.DOB_INCORRECT)}),l.blur(function(t){if(s=e(t.target),s.val().match(/\d{4}/))if(s.val().match(/\d{4}/)==s.val()){var i=parseInt(s.val(),10),n=new Date;1900>i?OC.validate.invalidate(s,o.DOB_OUT_OF_RANGE):i>n.getFullYear()?OC.validate.invalidate(s,o.DOB_AFTER_TODAY):n.getFullYear()-i<=12?OC.validate.invalidate(s,o.DOB_LESS_THAN_THIRTEEN):s.hasClass("form-input-error")&&OC.validate.pass(s)}else OC.validate.invalidate(s,o.DOB_INCORRECT)})}},emailShare:function(t,i,n,o){e("#email-share-success, #email-share-error").hide();var s=e("#share-via-email .form-spinner");s.show(),e.ajax({type:"POST",url:"/api/emailShare/",dataType:"json",contentType:"application/octet-stream; charset=utf-8",data:{email:t,message:i,from_name:n,from_address:o},success:function(t){s.hide();var i=t.status;"true"===i?(e("#email-share-success").html("You have successfully shared this resource over email"),e("#email-share-success").fadeIn("fast")):(e("#email-share-error").html("Your message could not be sent. Kindly check the above fields again"),e("#email-share-error").fadeIn("fast"))}})},commentSubmissionHandler:function(t,i){if("success"===t.status){var n=e("<div/>",{"class":"resource"}),o=e("<div/>",{"class":"resource-thumbnail",style:"background-image:url("+t.message.profile_pic+")"}),s=e("<div/>",{"class":"description"}),r=e("<span/>",{"class":"bold",text:t.message.name});s.append(r),s.append(" on "+t.message.created),s.append(t.message.body),o.appendTo(n),s.appendTo(n),i.text(""),i.val(""),e("#comments").prepend(n)}else e("#comment-fail").dialog({modal:!0,open:!1,width:360,buttons:{Ok:function(){e(this).dialog("close")}}})},scrollBind:function(t,i){e(t).click(function(){e("html, body").animate({scrollTop:e(i).offset().top},1e3)})},commentHandler:function(){e("#revision-comment button").click(function(t){var i=e("#revision-comment .form-spinner");i.show();var n=e("#revision-comment textarea[name=body_markdown]");return e.post("/interactions/comment/",e("#revision-comment").serialize(),function(e){OC.commentSubmissionHandler(e,n),i.hide()},"json"),t.stopPropagation(),t.preventDefault(),!1})},emailShareHandler:function(){e(".share-on-email").click(function(){return e("#email-share-dialog").dialog({modal:!0,open:!1,width:560,buttons:{Send:function(){OC.emailShare(e("#email-share-address").attr("value"),e("#email-share-message").attr("value"),e("#email-from-name").attr("value"),e("#email-from-address").attr("value"))},Close:function(){e("#email-share-success, #email-share-error").hide(),e(this).dialog("close")}}}),!1})},setupUserMenu:function(){OC.setUpMenuPositioning("nav#user-menu","#user-dropdown"),e(window).resize(function(){OC.setUpMenuPositioning("nav#user-menu","#user-dropdown")}),e("#user-buttons > ul > li.user-firstname-wrapper a, nav#user-menu").mouseenter(function(){e("#user-buttons > ul > li.user-firstname-wrapper a .horizontal-caret").addClass("horizontal-caret-hover"),e("#user-buttons > ul > li.user-firstname-wrapper a").addClass("hover"),e("#user-menu").addClass("showMenu")}).mouseleave(function(){e("#user-buttons > ul > li.user-firstname-wrapper a .horizontal-caret").removeClass("horizontal-caret-hover"),e("#user-buttons > ul > li.user-firstname-wrapper a").removeClass("hover"),e("#user-menu").removeClass("showMenu")}),OC.setUpMenuPositioning("nav#share-menu","li.share-action",!0)},setupShareMenu:function(){var t;e("button.share-button").click(function(e){return t=OC.customPopup(".share-dialog"),e.preventDefault(),e.stopPropagation(),!1}),e(".share-on-email").click(function(){t.close()})},setupAddTo:function(){var t=e('form#resource-form input[name="resource_id"]').val(),i=e("form#resource-form input[name=collection_id]").val();e("li.add-action a").click(function(e){OC.addCopyClickHandler("resource",t,i,e)})},addCopyClickHandler:function(t,i,n,o){OC.tabs(".add-resource-browser");var s=OC.customPopup(".add-resource-dialog"),r=e(".add-resource-profile-browser"),a=e(".add-resource-project-browser");r.addClass("loading-browser"),a.addClass("loading-browser"),e(".add-resource-submit-button").click(function(){var o,l=e(".add-resource-dialog .add-resource-tabs li a.selected");if(o=".my-projects"===l.attr("href")?a.find(".selected-destination-collection"):r.find(".selected-destination-collection"),s.close(),o){var u=OC.customPopup(".add-resource-action-dialog");e(".add-resource-action-submit-button").click(function(s){u.close();var r=e("#add-resource-action-form input[name=add-action]:checked"),a=o.attr("id").substring(11);return"copy"===r.val()?"collection"==t?OC.collection.copy(n,i,a,OC.collection.successfullyCopied):OC.resource.copy(n,i,a,OC.resource.successfullyCopied):("collection"==t&&OC.popup("The feature to link folders does not exist at this point. Sorry for the inconvenience","Cannot link folders"),OC.resource.link(n,i,a,OC.resource.successfullyLinked)),s.preventDefault(),s.stopPropagation(),!1})}}),0===r.children().length&&e.get("/resources/tree/collections/user/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,r),r.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json");var l=e('.add-resource-tabs li a[href=".my-projects"]');return l.hasClickEventListener()||l.click(OC.addToProjectsTabClickHandler),o.preventDefault(),o.stopPropagation(),!1},renderBrowser:function(t,i,n){i.html(t),i.find("a#collection-"+n).addClass("current-collection"),i.click(function(){i.find("a.selected-destination-collection").removeClass("selected-destination-collection"),i.find("a.selected-destination-resource").removeClass("selected-destination-resource")}),i.find("a").click(function(t){var n=i.find("a.selected-destination-collection, a.selected-destination-resource");if(!e(t.target).hasClass("current-collection")&&(n.removeClass("selected-destination-collection"),n.removeClass("selected-destination-resource"),n[0]!==t.target)){var o=e(t.target);o.toggleClass(-1!==o.attr("id").indexOf("collection")?"selected-destination-collection":"selected-destination-resource")}return t.stopPropagation(),t.preventDefault(),!1}),e("ul li.parent-collection > .toggle-collection",i).click(OC.parentCollectionClickHandler),e("ul li.parent-category > .toggle-category",i).click(OC.parentCollectionClickHandler)},addToProjectsTabClickHandler:function(){{var t=e(".add-resource-project-browser");e("form#resource-form input[name=collection_id]").val()}0===t.children().length&&e.get("/resources/tree/collections/projects/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,t),t.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json")},initShowMoreBlock:function(){function t(t){var i=200,n=s(),o=[],r=0;for(r;r<t.length;r++)e(t[r]).height()>i&&(e(t[r]).parent().append(n.clone()),e(t[r]).addClass("compressed"),o.push(e(t[r])));return o}function i(t){var i=0;for(i;i<t.length;i++){var o=e(".show-more",t[i].parent());1==o.length&&e(".show-more-text",o).click({block:e(t[i])},n)}}function n(t){t.data.block.removeClass("compressed");var i=e(".show-more",t.data.block.parent());e(".show-more-text",i).off(),r(e(".show-more-text",i),!1),e(".show-more-text",i).click({block:t.data.block},o)}function o(t){t.data.block.addClass("compressed");var i=e(".show-more",t.data.block.parent());e(".show-more-text",i).off(),r(e(".show-more-text",i),!0),e(".show-more-text",i).click({block:t.data.block},n)}function s(){var t=e("<div/>",{"class":"show-more"}),i=e("<span/>",{"class":"show-more-text",text:"SHOW MORE"});return t.append(i),t}function r(e,t){e.text(t?"SHOW MORE":"SHOW LESS")}var a=[".profile-contributions-list",".home-projects-listing"],l=t(a);i(l)},bindEditHeadlineHandler:function(){e(".profile-headline").keypress(function(t){if(13==t.which){t.preventDefault(),e(".profile-headline").blur();var i=e(".profile-headline").text(),n=e(".profile-headline").attr("title"),o=e(".profile-headline").parent("form").children("input[name=user_id]").val();if(n!=i){var s=e(".profile-headline").parent(".profile-headline-wrapper").children(".headline-edit");s.addClass("changing"),e.post("/user/api/headline/"+o+"/edit/",{new_headline:i},function(){s.removeClass("changing")},"json")}}})},initNotificationHandler:function(){OC.setUpMenuPositioning("nav#notifications-menu",".user-notification-count"),e(window).resize(function(){OC.setUpMenuPositioning("nav#notifications-menu",".user-notification-count")}),OC.setupNotificationsMenu()},setupNotificationsMenu:function(){e("nav#user-buttons > ul > li.user-notification-count").click(function(t){e("#notifications-menu").toggleClass("showMenu"),e("li.user-notification-count").toggleClass("menu-open");var i=e("nav#user-buttons > ul > li.user-notification-count");return i.hasClass("unread-notifications")&&(i.removeClass("unread-notifications"),OC.dismissUnreadNotifications(),e("li.user-notification-count").addClass("empty-notifications")),t.stopPropagation(),t.preventDefault(),!1}),OC.closeMenusHandler()},dismissUnreadNotifications:function(){var t,i=e("nav#notifications-menu > ul > li > a.new-notification"),n=[];for(t=0;t<i.length;t++){notification_id=e(i[t]).attr("id");var o="notification-";n.push(notification_id.substring(o.length))}var s=e("#user-info input[name=user_id]").val();e.get("/user/api/notifications/dismiss/"+s+"/?ids="+n.join(","),function(){},"json")},closeMenusHandler:function(){e("body").on("click",function(){var t,i=e(".showMenu");for(t=0;t<i.length;t++)e(i[t]).removeClass("showMenu");var n,o=e(".menu-open");for(n=0;n<o.length;n++)e(o[n]).removeClass("menu-open")})},initArticleCenter:function(){OC.tabs(".introduction-contributor-faqs"),e(".article-labels span").tipsy(),e(".article-objectives-title").click(function(){e(this).parent().toggleClass("show-objectives")})},initAddResource:function(){OC.setUpMenuPositioning("nav#add-resource-menu",".create-new-resource-button a"),e(window).resize(function(){OC.setUpMenuPositioning("nav#add-resource-menu",".create-new-resource-button a")}),OC.setupResourceMenu()},setupResourceMenu:function(){e(".create-new-resource-button a, nav#add-resource-menu").mouseenter(function(){e(".create-new-resource-button a").addClass("hover"),e("#add-resource-menu").addClass("showMenu")}).mouseleave(function(){e(".create-new-resource-button a").removeClass("hover"),e("#add-resource-menu").removeClass("showMenu")})},initCreateCollection:function(){e("nav#add-resource-menu .add-collection a, nav.profile-resources-collections-actions-menu-add .add-collection a").click(function(t){return e(".new-collection-dialog").dialog({modal:!0,open:!1,width:500,buttons:{Ok:function(){var t=e("form#new-collection-form input[name=new_collection_name]");""===t.val()?t.addClass("form-input-error"):(e(this).dialog("close"),e("form#new-collection-form").submit())},Cancel:function(){e(this).dialog("close")}}}),t.stopPropagation(),t.preventDefault(),!1})},initCreateGroup:function(){e("nav#add-resource-menu .add-group a, .new-group-wrapper, a.new-groups-link").click(function(e){OC.customPopup(".new-group-dialog");return e.stopPropagation(),e.preventDefault(),!1})},initUpload:function(){e("nav#add-resource-menu .add-upload a, .profile-resources-collections-actions-menu-add .add-upload a,a.new-upload-suggestion").click(function(e){OC.customPopup(".post-new-upload-dialog");return e.stopPropagation(),e.preventDefault(),!1})},getLicenses:function(t){OC.config.licenses?t(OC.config.licenses):e.get("/license/api/list/",function(e){"true"===e.status?(OC.config.licenses=e.licenses,t(e.licenses)):OC.popup(e.message,e.title)},"json")},initLink:function(){e("nav#add-resource-menu .add-link a, .profile-resources-collections-actions-menu-add .add-link a").click(function(t){OC.getLicenses(function(t){var i,n,o=e('select[name="license"]');for(i=0;i<t.length;i++)n=e("<option/>",{value:t[i].id,text:t[i].title}),o.append(n)});OC.customPopup(".new-link-dialog");return t.stopPropagation(),t.preventDefault(),!1})},bindDeleteResourceHandler:function(){e(".profile-resource-delete, .project-resource-delete").click(function(t){var i=e(this),n=i.attr("id").substring(9),o=e(".resources-collections-added").attr("id").substring(11);return OC.resource.delete(n,o,callback),t.preventDefault(),t.stopPropagation(),!1})},bindDeleteCollectionHandler:function(){e(".profile-collection-delete, .project-collection-delete").click(function(t){function i(t){e(".resource-collection-item#collection-"+t).fadeOut()}var n=e(this),o=n.attr("id").substring(11);return OC.collection.delete(o,i),t.preventDefault(),t.stopPropagation(),!1})},initCollectionsTree:function(){e("nav.collections-navigation ul li.parent-collection > .toggle-collection").click(OC.parentCollectionClickHandler)},initMessageBox:function(){var t=e(".login-messages-wrapper");""!==OC.getMessageBoxMessage()&&OC.showMessageBox(),e(".close-message-box",t).click(OC.dismissMessageBox)},setMessageBoxMessage:function(t){var i=e(".login-messages");i.text(t)},getMessageBoxMessage:function(){var t=e(".login-messages");return t.text()},showMessageBox:function(){var t=e(".login-messages-wrapper");t.addClass("show-messages"),OC.repositionMessageBox()},pushMessageBoxForward:function(){var t=e(".login-messages-wrapper");
t.addClass("push-forward")},dismissMessageBox:function(){var t=e(".login-messages-wrapper");OC.setMessageBoxMessage(""),t.removeClass("show-messages")},repositionMessageBox:function(){var t=e(window).width(),i=e(".login-messages-wrapper"),n=i.width();i.css("left",t/2-n/2)},parentCollectionClickHandler:function(t){var i=e(t.target).closest("li");return i.toggleClass("opened-collection"),e("> ul",i).toggle(),t.preventDefault(),t.stopPropagation(),!1},initForgotAuth:function(){e("#forgot-username-password a").click(function(t){return e(".forgot-username-password-dialog").dialog({modal:!0,open:!1,width:500,buttons:{Submit:function(){e(this).dialog("close"),e("form.forgot-username-password-form").submit()},Cancel:function(){e(this).dialog("close")}}}),t.preventDefault(),t.stopPropagation(),!1})},initChangePassword:function(){e("#change-password").click(function(t){OC.customPopup(".change-password-dialog");return OC.validate.text('.change-password-dialog input[name="new_password"]',/[\w\.\!\@\#\$\%\^\*\&]+/,"Password should contain valid characters"),OC.validate.confirm('.change-password-dialog input[name="confirm_password"]','.change-password-dialog input[name="new_password"]',"Both passwords do not match"),e(".change-password-submit-button").click(function(t){var i=e('.change-password-dialog input[name="confirm_password"]');return i.hasClass("form-input-error")?(t.preventDefault(),t.stopPropagation(),!1):void e("#change-password-form").submit()}),t.preventDefault(),t.stopPropagation(),!1})},initResourceView:function(){if(e(".history-action img").tipsy({gravity:"w"}),e(".toggle-content-title-wrapper").click(OC.togglerClickHandler),e(".oer-meta-support-tag").tipsy({gravity:"s"}),-1!=document.referrer.split("/").indexOf("browse")){setTimeout(function(){e(".need-more-info").animate({top:0},1500)},3e3);var t=e(".need-more-info"),i=e('form#resource-form input[name="resource_id"]').val();if(i){e(".need-more-info-button").click(function(){function n(){e.get("/resources/api/request-for-information/"+i+"/",function(i){"true"===i.status&&t.animate({opacity:0},500,function(){e(this).text("Your request for more information has been sent. You will receive an email once the information is ready for you")}).animate({opacity:1,height:28,"margin-bottom":-40},500,function(){setTimeout(function(){t.animate({top:-56})},6e3)})},"json")}if(OC.config.user.id)n();else{var o="We can send you the info only if you have a free account, so please sign up. It takes only 30 seconds!";OC.launchSignupDialog(o,n)}});var n=e(".resource-comments"),o=e(".request-resource-review");e(window).on("DOMContentLoaded load resize scroll",function(){isElementInViewport(n)&&!n.hasClass("visible")&&(o.animate({top:-56},1500),o.addClass("visible"))});var s=e(".request-resource-review-stars .empty-star");s.hover(function(){s.removeClass("hover");var t,i,n=this;for(t=0;t<s.length&&(i=e(s[t]),i.addClass("hover"),s[t]!==n);t++);e(this).addClass("")}),e(".request-resource-review-stars").mouseleave(function(){s.removeClass("hover")});var r=_.template('<div class="resource-review"><div class="resource-review-user"><div class="resource-review-user-thumbnail" style="background-image: url(\'<%= profile_pic %>\');"></div><div class="resource-review-user-description"><div><a href="<%= user_url %>"><%= name %></a><%= stars %></div><div class="resource-review-user-date"><%= created %></div></div></div><div class="resource-review-body"><%= body %></div></div>');e(".request-resource-review .empty-star").click(function(){var t=OC.customPopup(".review-comment-dialog"),i=this,n=e("form#review-comment-form",t.dialog);e('input[name="stars"]',n).val(s.index(i)+1);var a=e(".review-comment-done-button",t.dialog);a.click(function(){function i(){t.close(),e.post("/interactions/review-resource/",n.serialize(),function(t){if("true"===t.status){o.animate({top:0},500);var i,n=e("<div/>",{"class":"resource-review-user-description-stars"});for(i=0;i<t.review.stars;i++)n.append(e("<span/>",{"class":"full-star"}));t.review.stars=n.get(0).outerHTML;var s=r(t.review),a=e(".resource-review");a.length>0?e(".resource-reviews").append(s):e(".resource-reviews").html(s),OC.setMessageBoxMessage("Successfully posted your review!"),OC.showMessageBox()}else OC.popup(t.message,t.title)},"json")}if(OC.config.user.id)i();else{var s="Please login or create an account (takes 30 seconds!) to complete posting of the review.";OC.launchSignupDialog(s,i)}})})}}},togglerClickHandler:function(){var t=e(this);body=t.parent(".toggle-content").find(".toggle-content-body"),t.hasClass("open")?(t.removeClass("open"),body.slideUp()):(t.addClass("open"),body.slideDown())},initFavoriteResource:function(){function t(e,t){e?(t.addClass("favorited"),t.text("Favorited")):(t.removeClass("favorited"),t.text("Favorite"))}function i(e,t){t&&(o.addClass("favorited"),o.text("Favorited"))}var n=e("form#resource-form input[name=resource_id]").val(),o=(e("form.profile-favorite-form input[name=user_id]").val(),e("button.favorite-button"));n?(OC.getFavoriteState("resource",n,i),o.click(function(){var i=e(this),o=i.hasClass("favorited");t(!o,i),OC.favoriteClickHandler("resource",n,function(e){e||t(o,i)})})):o.click(function(e){return OC.popup("You must be logged in to favorite a resource","Log in to favorite resource"),e.preventDefault(),e.stopPropagation(),!1})},favoriteClickHandler:function(t,i,n,o){function s(){e.get("/interactions/favorite/"+t+"/"+i+"/",function(e){"true"==e.status||"unfavorite success"==e.status?n(!0,o):n(!1,o)},"json")}if(OC.config.user.id)s();else{var r="To favorite this resource to your account, please login or create a free account (takes 30 seconds!).";OC.launchSignupDialog(r,s)}},getFavoriteState:function(t,i,n){e.get("/interactions/favorite/state/"+t+"/"+i+"/",function(e){if("true"==e.status){var t;t="true"==e.favorite.state?!0:!1,n(i,t)}},"json")},getSubscriptionState:function(t,i){var n=t.join();e.get("/user/api/subscribe/state/users/?ids="+n,function(e){"true"==e.status&&i(e.subscription_states)},"json")},initUpvoteDownvoteResource:function(){var t=e("form#resource-form input[name=resource_id]").val(),i=e("form#resource-form input[name=user_id]").val(),n=e("form#resource-form input[name=revision_id]").val(),o=e(".article-community li.thumbs-up-action"),s=e(".article-community li.thumbs-down-action"),r=e(".count",o),a=e(".count",s);if(t){var l;l=n?"/interactions/votes/count/resource/"+t+"/revision/"+n+"/":"/interactions/votes/count/resource/"+t+"/",e.get(l,function(e){"true"==e.status&&(r.text(e.upvote_count),a.text(e.downvote_count),"true"==e.user_upvoted&&s.addClass("user-upvoted"),"true"==e.user_downvoted&&s.addClass("user-downvoted"))},"json")}if(i){var u;e("a",o).click(function(i){return u=n?"/interactions/vote/up/resource/"+t+"/revision/"+n+"/":"/interactions/vote/up/resource/"+t+"/",e.get(u,function(e){"true"==e.status?"unvote"==e.action?(o.removeClass("user-upvoted"),r.text(parseInt(r.text(),10)-1)):(o.addClass("user-upvoted"),r.text(parseInt(r.text(),10)+1)):OC.popup(e.message,e.title)},"json"),i.preventDefault(),i.stopPropagation(),!1}),e("a",s).click(function(i){return u=n?"/interactions/vote/down/resource/"+t+"/revision/"+n+"/":"/interactions/vote/down/resource/"+t+"/",e.get(u,function(e){"true"==e.status?"unvote"==e.action?(s.removeClass("user-downvoted"),a.text(parseInt(a.text(),10)-1)):(s.addClass("user-downvoted"),a.text(parseInt(a.text(),10)+1)):OC.popup(e.message,e.title)},"json"),i.preventDefault(),i.stopPropagation(),!1})}else e("a",o).click(function(e){return OC.popup("You must be logged in to upvote a resource","Log in to upvote resource"),e.preventDefault(),e.stopPropagation(),!1}),e("a",s).click(function(e){return OC.popup("You must be logged in to downvote a resource","Log in to downvote resource"),e.preventDefault(),e.stopPropagation(),!1})},initPrintResource:function(){e(".print-action a").click(function(e){return window.print(),e.preventDefault(),e.stopPropagation(),!1})},initExportResource:function(){e("li.download-as a").click(function(t){return e("#download-menu").addClass("showMenu"),t.preventDefault(),t.stopPropagation(),!1}),e("li.download-as, nav#download-menu").mouseenter(function(){e("#download-menu").addClass("showMenu")}).mouseleave(function(){e("#download-menu").removeClass("showMenu")}),OC.setUpMenuPositioning("nav#download-menu","li.download-as",!1),e(".export-action a").click(function(t){var i=OC.customPopup(".export-document-pdf-dialog"),n=OC.progressBar(".export-document-pdf-progress",{startAt:30}),o=e(".export-document-pdf-status"),s=e("form#resource-form input[name=resource_id]").val();return e.get("/resources/"+s+"/build-export-document/",function(e){if("true"==e.status)if("WebSocket"in window){o.text("Building document..."),n.advanceTo(50);var t=new WebSocket("ws://services.opencurriculum.org:1337/");t.onopen=function(){e.type="pdf",t.send(JSON.stringify(e))},t.onmessage=function(e){if(data=JSON.parse(e.data),data.documentReceived){o.text("Generating PDF..."),n.advanceTo(60);var t=60;setInterval(function(){80>=t&&n.advanceTo(++t)},100)}else data.documentProcessed&&(o.text("Finished! Opening PDF..."),n.advanceTo(100),setTimeout(function(){window.open(data.url,"_blank"),i.close()},500))}}else o.text("Generating PDF..."),n.advanceTo(50);else OC.popup(e.message,e.title)},"json"),t.preventDefault(),t.stopPropagation(),!1}),e(".word-action a").click(function(t){var i=OC.customPopup(".export-document-word-dialog"),n=OC.progressBar(".export-document-word-progress",{startAt:30}),o=e(".export-document-word-status"),s=e("form#resource-form input[name=resource_id]").val();return e.get("/resources/"+s+"/build-export-document/",function(e){if("true"==e.status)if("WebSocket"in window){o.text("Building document..."),n.advanceTo(50);var t=new WebSocket("ws://services.opencurriculum.org:1337/");t.onopen=function(){e.type="word",t.send(JSON.stringify(e))},t.onmessage=function(e){if(data=JSON.parse(e.data),data.documentReceived){o.text("Generating Word file..."),n.advanceTo(60);var t=60;setInterval(function(){80>=t&&n.advanceTo(++t)},100)}else data.documentProcessed&&(o.text("Finished! Opening Word file..."),n.advanceTo(100),setTimeout(function(){window.open(data.url,"_blank"),i.close()},500))}}else o.text("Generating PDF..."),n.advanceTo(50);else OC.popup(e.message,e.title)},"json"),t.preventDefault(),t.stopPropagation(),!1})},initProfileCreateResource:function(){e(".add-unit").click(function(e){return OC.customPopup(".new-unit-dialog"),e.preventDefault(),e.stopPropagation(),!1})},initProfileSubscribers:function(){function t(t){var o,s;for(i=0;i<n.length;i++)o=e(".subscribe-suggestion-form input[name=user_id][value="+n[i]+"]"),s=o.parents("form.subscribe-suggestion-form").find("button.subscribe-button"),t[parseInt(n[i],10)]&&(s.addClass("subscribed"),s.text(" Subscribed"))}var i,n=[];e(".subscribe-suggestion-form").each(function(){e("button.subscribe-button",this).length>0&&n.push(e("input[name=user_id]",this).val())}),n.length>0&&OC.getSubscriptionState(n,t)},initEditResource:function(){e("form.resource-create-edit-form #submission-buttons button[type=submit]").click(function(t){return"save"===action?e("#article-edit-form").submit():e("#log-message").dialog({modal:!0,open:!1,buttons:{Ok:function(){e(this).dialog("close"),e("input[name=log]").attr("value",e("input[name=log_message]").attr("value")),e("#article-edit-form").submit()},Cancel:function(){return e(this).dialog("close"),!1}}}),t.stopPropagation(),t.preventDefault(),!1})},initPictureManipulation:function(){OC.initEditHandlers(),OC.repositionPictures.initRepositionPictures()},initEditHandlers:function(){e(".change-picture").click(function(){e(".picture-upload-dialog").dialog({modal:!0,open:!1,width:OC.config.popup.width,buttons:{Upload:function(){e(".picture-upload-dialog form").submit(),e(this).dialog("close")}}})}),e(".change-picture").tipsy({gravity:"s"})},repositionPictures:{originalRepositionableTop:0,originalRepositionableLeft:0,repositionSetup:!1,userProfile:{selector:".user-picture-cover",positionerSelector:".user-picture-repositioner",container:"user-picture-repositioner-container",wrapperSelector:".user-profile-picture",copy:"user-profile-picture-copy"},projectCover:{selector:"#project-header",positionerSelector:".project-header-repositioner",container:"project-header-repositioner-container",wrapperSelector:".project-header-wrapper",copy:"project-header-picture-copy"},image:null,initRepositionPictures:function(){e(".reposition-picture").tipsy({gravity:"s"}),e("form#profile-picture-reposition-form").length>0&&(OC.repositionPictures.image=OC.repositionPictures.userProfile),e("form#project-cover-reposition-form").length>0&&(OC.repositionPictures.image=OC.repositionPictures.projectCover),OC.repositionPictures.image&&(e(".reposition-picture").click(OC.repositionPictures.repositionClickHandler),backgroundPosition=OC.repositionPictures.getPictureBackgroundPosition(),OC.repositionPictures.originalRepositionableTop=backgroundPosition.top,OC.repositionPictures.originalRepositionableLeft=backgroundPosition.left)},getPictureBackgroundPosition:function(){var t=e(OC.repositionPictures.image.selector),i=e("."+OC.repositionPictures.image.copy);return pictureRawBackgroundPosition=t.css("background-position"),positions=pictureRawBackgroundPosition.split(" "),-1===positions[0].indexOf("%")?(leftPxIndex=positions[0].indexOf("px"),leftPx=parseInt(positions[0].substring(0,leftPxIndex),10),topPxIndex=positions[1].indexOf("px"),topPx=parseInt(positions[1].substring(0,topPxIndex),10),leftPercentage=i.width()===t.width()?0:parseInt(Math.abs(leftPx)/(i.width()-t.width())*100,10),topPercentage=i.height()===t.height()?0:parseInt(Math.abs(topPx)/(i.height()-t.height())*100,10)):(leftPercentageIndex=positions[0].indexOf("%"),leftPercentage=parseInt(positions[0].substring(0,leftPercentageIndex),10),topPercentageIndex=positions[1].indexOf("%"),topPercentage=parseInt(positions[1].substring(0,topPercentageIndex),10)),{left:leftPercentage,top:topPercentage}},repositionClickHandler:function(){OC.repositionPictures.repositionSetup||(OC.repositionPictures.setupReposition(),OC.repositionPictures.repositionSetup=!0),e(".reposition-overlay").addClass("show"),e(".reposition-overlay").animate({opacity:.5},500);var t=e(OC.repositionPictures.image.selector);t.addClass("reposition-mode"),OC.repositionPictures.showRepositioner(),e("."+OC.repositionPictures.image.container).addClass("show"),e(".reposition-floating-actions").addClass("show"),t.tipsy("show")},setupReposition:function(){var t=e(OC.repositionPictures.image.positionerSelector),i=e(OC.repositionPictures.image.selector),n=e(OC.repositionPictures.image.wrapperSelector);pictureBackgroundImage=i.css("background-image");var o=e("<img/>",{src:pictureBackgroundImage.replace(/^url\(["']?/,"").replace(/["']?\)$/,""),"class":OC.repositionPictures.image.copy});n.append(o),t.height(o.height()),t.width(o.width());var s=e("<div/>",{"class":OC.repositionPictures.image.container+" show"});n.append(s),s.height(i.height()+2*(o.height()-i.height())),s.width(i.width()+2*(o.width()-i.width())),s.css("left",i.position().left-(s.width()/2-i.width()/2)),s.css("top",i.position().top-(s.height()/2-i.height()/2)),e(OC.repositionPictures.image.positionerSelector).draggable({containment:"."+OC.repositionPictures.image.container,drag:OC.repositionPictures.movePicture,start:OC.repositionPictures.onDragStart,stop:OC.repositionPictures.onDragComplete}),s.removeClass("show");var r=e("<div/>",{"class":"reposition-overlay"});e("body").append(r);var a=e("<div/>",{"class":"reposition-floating-actions"}),l=e("<button/>",{"class":"action-button mini-action-button",text:"Save"}),u=e("<button/>",{"class":"action-button mini-action-button",text:"Cancel"});OC.repositionPictures.image===OC.repositionPictures.projectCover?a.css("top",i.position().top+i.height()-40):a.css("top",i.position().top+i.height()+10),a.css("left",i.position().left+10),a.append(l),a.append(u),e(OC.repositionPictures.image.wrapperSelector).append(a),i.tipsy({gravity:"s",trigger:"manual",fade:"true"}),u.click(OC.repositionPictures.dismissRepositionMode),l.click(OC.repositionPictures.savePosition)},showRepositioner:function(){e(OC.repositionPictures.image.positionerSelector).addClass("show")},hideRepositioner:function(){e(OC.repositionPictures.image.positionerSelector).removeClass("show")},movePicture:function(t,i){e(OC.repositionPictures.image.selector).css("background-position",i.position.left+"px "+i.position.top+"px")},onDragStart:function(){e(OC.repositionPictures.image.selector).tipsy("hide")},onDragComplete:function(){},dismissRepositionMode:function(){e(".reposition-overlay").animate({opacity:0},500,function(){e(this).removeClass("show");var t=e(OC.repositionPictures.image.selector);t.removeClass("reposition-mode")}),e(".reposition-floating-actions").removeClass("show"),OC.repositionPictures.hideRepositioner(),e("."+OC.repositionPictures.image.container).removeClass("show"),e(OC.repositionPictures.image.selector).tipsy("hide")},savePosition:function(){if(originalBackgroundPosition={left:OC.repositionPictures.originalRepositionableLeft,top:OC.repositionPictures.originalRepositionableTop},newBackgroundPosition=OC.repositionPictures.getPictureBackgroundPosition(),originalBackgroundPosition.left!==newBackgroundPosition.left||originalBackgroundPosition.top!==newBackgroundPosition.top){if(OC.repositionPictures.image===OC.repositionPictures.userProfile){var t=e("#profile-picture-reposition-form input[name=username]").val();e.get("/user/"+t+"/reposition-picture/?left="+newBackgroundPosition.left+"&top="+newBackgroundPosition.top,function(e){"true"==e.status?OC.repositionPictures.dismissRepositionMode():OC.popup(e.message,e.title)},"json")}else if(OC.repositionPictures.image===OC.repositionPictures.projectCover){var i=e("#project-cover-reposition-form input[name=project_id]").val();e.get("/group/"+i+"/reposition-cover/?left="+newBackgroundPosition.left+"&top="+newBackgroundPosition.top,function(e){"true"==e.status?OC.repositionPictures.dismissRepositionMode():OC.popup(e.message,e.title)},"json")}}else OC.repositionPictures.dismissRepositionMode()}},comments:{newCommentTemplate:_.template('<li class="post-comment" id="comment-<%= id %>"><div class="post-comment-user-thumbnail"><div style="background-image: url(\'<%= profile_pic %>\')" class="discussion-response-thumbnail"></div></div><div class="delete-button" title="Delete comment"></div><div class="post-comment-body"><a href="/user/<%= username %>"><%= name %></a> <%= body %><form><input type="hidden" name="user" value="<%= user_id %>" /><input type="hidden" name="parent_type" value="<%= content_type %>" /><input type="hidden" name="parent_id" value="<%= id %>" /></form><div class="comment-actions"><div class="reply-to-comment">Reply</div><div class="upvote-comment">0</div><div class="downvote-comment">0</div></div></div></li>'),initRenderComments:function(){e("form#resource-form").length>0?OC.comments.renderResourceComments(OC.comments.resourceCommentsSuccess):e(".discussion-board").length>0&&OC.comments.resourceCommentsSuccess();var t="textarea[name=body_markdown]";OC.comments.bindCommentsInputClickHandler(t)},bindCommentsInputClickHandler:function(t){e(t).on("focus",OC.comments.focusCommentInput),e(t).on("blur",OC.comments.blurCommentInput)},focusCommentInput:function(t){e(t.target).addClass("expanded")},blurCommentInput:function(t){""===e(t.target).val()&&e(t.target).removeClass("expanded")},resourceCommentsSuccess:function(){OC.comments.bindNewCommentButton(),OC.comments.bindCommentReplyButton(),OC.comments.bindVotingButtons(".comment-thread"),OC.comments.bindCommentDeleteButtons()},renderResourceComments:function(t){var i=e('form#resource-form input[name="resource_id"]').val();e.get("/resources/resource-comments/"+i+"/",function(i){"true"==i.status?(e(".resource-comments").prepend(i.comments),t()):OC.popup(i.message,i.title)},"json")},bindNewCommentButton:function(){e(".post-comment-button-wrapper .post-comment-button").click(OC.comments.postCommentClickHandler)},postCommentClickHandler:function(t){function i(){""!==o?e.post("/interactions/comment/",s,function(e){"success"!==e.status&&(OC.comments.commentDeleteHandler(t.target),OC.popup("Sorry, the comment could not be posted. Please try again later."))},"json"):n.focus()}var n=e(t.target).parents(".post-comments").find("textarea[name=body_markdown]"),o=n.val(),s=e(t.target).parents("form").serialize();if(OC.comments.newCommentSuccessHandler({message:{user_id:OC.config.user.id,name:OC.config.user.full_name,username:OC.config.user.username,profile_pic:OC.config.user.thumbnail,content_type:0,id:0,created:(new Date).toISOString(),body:o}},t.target),OC.config.user.id)i();else{var r="Oops - you aren't logged in! No worries - let us keep your comment safe, while you login or create a free account (takes 30 seconds!)";OC.launchSignupDialog(r,i)}},bindCommentReplyButton:function(){e(".reply-to-comment").click(OC.comments.commentReplyButtonClickHandler)},bindVotingButtons:function(t){e(".upvote-post",t).click(OC.comments.upvotePostClickHandler),e(".downvote-post",t).click(OC.comments.downvotePostClickHandler),e(".upvote-comment",t).click(OC.comments.upvoteCommentClickHandler),e(".downvote-comment",t).click(OC.comments.downvoteCommentClickHandler)},upvotePostClickHandler:function(e){function t(){commentID=OC.projects.getDiscussionID(e.target),OC.comments.newVote(commentID,!0,e.target)}if(OC.config.user.id)t();else{var i="To upvote this post, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},downvotePostClickHandler:function(e){function t(){commentID=OC.comments.getCommentID(e.target),OC.comments.newVote(commentID,!0,e.target)}if(OC.config.user.id)t();else{var i="To downvote this post, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},upvoteCommentClickHandler:function(e){function t(){commentID=OC.comments.getCommentID(e.target),OC.comments.newVote(commentID,!0,e.target)}if(OC.config.user.id)t();else{var i="To upvote this comment, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},downvoteCommentClickHandler:function(e){function t(){commentID=OC.comments.getCommentID(e.target),OC.comments.newVote(commentID,!1,e.target)}if(OC.config.user.id)t();else{var i="To downvote this comment, please login or create a free account instantly.";OC.launchSignupDialog(i,t)}},getCommentID:function(t){return e(t).closest(".post-comment").attr("id").substring(8)},bindCommentDeleteButtons:function(){e(".comment-thread .delete-button").click(OC.comments.commentDeleteButtonClickHandler)},commentDeleteButtonClickHandler:function(t){var i=OC.comments.getCommentID(t.target);e.get("/interactions/comment/"+i+"/delete/",function(e){"true"==e.status?OC.comments.commentDeleteHandler(t.target):OC.popup("Sorry, your comment could not be deleted. Please try again later.")},"json")},commentDeleteHandler:function(t){var i=e(t).closest(".post-comment"),n=i.siblings(".post-comment").length;e(t).tipsy("hide"),0===n?i.closest("ul").remove():i.remove()},newVote:function(t,i,n){endpoint=i?"/interactions/comment/"+t+"/upvote/":"/interactions/comment/"+t+"/downvote/",e.get(endpoint,function(e){"true"==e.status?OC.comments.newVoteHandler(n,i):"unvote success"==e.status?OC.comments.newVoteHandler(n,i,!0):OC.popup("Sorry, your vote could not be posted. Please try again later.")},"json")},newVoteHandler:function(t,i,n){n=n||!1;var o=e(t).text();n?(e(t).text(parseInt(o,10)-1),e(t).removeClass("user-upvoted"),e(t).removeClass("user-downvoted")):(e(t).text(parseInt(o,10)+1),e(t).addClass(i?"user-upvoted":"user-downvoted"))},addDeleteButtonTooltip:function(t){e(".delete-button",t).tipsy({gravity:"n"})},commentReplyButtonClickHandler:function(t){var i=e(t.target).closest(".post-comment"),n=i.find(".post-comment-body:first").clone(),o=n.find("a:first").clone();n.find("a:first").remove(),n.find(".comment-actions").remove(),n.find("ul").remove(),strippedTitle='"'+n.text().substring(0,40),strippedTitle+=n.text().length>40?'..."':'"',e(".new-comment-reply-dialog .new-comment-reply-title").text(strippedTitle),e(".new-comment-reply-dialog .new-comment-original-reply-body").html(n.html());var s=i.find(".discussion-response-thumbnail").css("background-image");e(".new-comment-reply-dialog .new-comment-original-commentor-thumbnail").css("background-image",s),e(".new-comment-reply-dialog .new-comment-original-reply-user-name").html(o),e(".new-comment-reply-body").removeClass("form-input-error"),originalCommentID=i.attr("id").substring(8),e(".new-comment-reply-dialog input[name=parent_id]").val(originalCommentID),newCommentReplyPopup=OC.customPopup(".new-comment-reply-dialog"),e(".new-comment-reply-submit").click(function(t){if(""!==e(".new-comment-reply-body").val()){var n=e(t.target).parents(".new-comment-reply-dialog").find("form#new-comment-reply-form");e.post("/interactions/comment/",n.serialize(),function(e){"success"==e.status?(OC.comments.newCommentReplySuccessHandler(e,i),newCommentReplyPopup.close()):OC.popup("Sorry, the comment reply could not be posted.Please try again later.")},"json")}else e(".new-comment-reply-body").addClass("form-input-error");return t.stopPropagation(),t.preventDefault(),!1})},newCommentSuccessHandler:function(t,i){var n=OC.comments.newCommentTemplate,o=n(t.message),s=e(i).parents(".comment-thread"),r=s.children("ul");0===r.length&&(r=e("<ul/>"),s.prepend(r)),r.append(o);var a=r.find(".post-comment:last"),l=e(i).parents(".comment-thread").find("textarea[name=body_markdown]");l.val(""),l.removeClass("expanded"),l.blur(),OC.comments.attachNewCommentActions(a)},newCommentReplySuccessHandler:function(t,i){var n=OC.comments.newCommentTemplate,o=n(t.message),s=e("> ul",i);0===s.length&&(s=e("<ul/>"),i.append(s)),s.append(o);var r=s.find(".post-comment:last");OC.comments.attachNewCommentActions(r),e(".new-comment-reply-body").val("")},attachNewCommentActions:function(t){OC.comments.addDeleteButtonTooltip(t),e(".delete-button",t).click(OC.comments.commentDeleteButtonClickHandler),e(".reply-to-comment",t).click(OC.comments.commentReplyButtonClickHandler),OC.comments.bindVotingButtons(t)}},renderDocumentComments:function(){var t,i,n=e(".oer-document.document-body");if(n.length>=1){var o=e(".document-element",n);for(t=0;t<o.length;t++){i=e(o[t]);var s=e("form.document-element-form",i),r=e("input[name=document_element_id]",s).val();OC.getDocumentElementComments(i,r)}}OC.closePopoutsHandler()},getDocumentElementComments:function(t,i){e.get("/resources/document-element/"+i+"/comments/",function(e){OC.getDocumentElementCommentsResponseHandler(e,t,i)},"json")},getDocumentElementCommentsResponseHandler:function(t,i,n){var o=t.comments;if(i.hasClass("document-table"))for(tableCells=e("td, th",i),j=0;j<tableCells.length;j++){cellCommentButton=e("<div/>",{"class":"document-cell-comment-button"}),cellCommentsWrapper=e("<div/>",{"class":"document-cell-comments"}),cell=e(tableCells[j]),cell.append(cellCommentButton),cell.append(cellCommentsWrapper),newCommentButton=e(".document-cell-comment-button",cell),newCommentsBox=e(".document-cell-comments",cell);var s=cell.attr("id"),r=s.substring(("item-"+n).length+1).split("-"),a=r[0],l=r[1];cellComments=_.pluck(_.where(o,{reference:"row#"+a+",col#"+l}),"comment"),newCommentsBox.html(OC.cellCommentsView(cellComments,cell)),e("button.document-element-comment-post",newCommentsBox).click(OC.documentElementCommentPostHandler),newCommentButton.css("left",cell.width()-newCommentButton.width()+"px");var u=newCommentButton.position().left,c=u+newCommentsBox.outerWidth();c>e(window).width()-10&&(u-=c-(e(window).width()-10)),newCommentsBox.css({left:u+"px",top:newCommentButton.position().top+"px"}),newCommentButton.click(OC.toggleCellComment)}},toggleCellComment:function(t){var i=e(OC.dismissOpenComment()),n=e(t.target).closest("td, th"),o=n.find(".document-cell-comments");return i.get(0)!==o.get(0)&&(o.addClass("show-popout"),e(t.target).addClass("comments-open"),o.click(function(t){return e(t.target).is("button")?void 0:(t.stopPropagation(),t.preventDefault(),!1)})),t.stopPropagation(),t.preventDefault(),!1},closePopoutsHandler:function(){e("body").on("click",function(){OC.dismissOpenComment()})},dismissOpenComment:function(){var t,i=e(".show-popout");for(t=0;t<i.length;t++)e(i[t]).removeClass("show-popout");var n,o=e(".comments-open");for(n=0;n<i.length;n++)e(o[n]).removeClass("comments-open");return i[0]},documentCommentTemplate:_.template('<div class="document-comment"><div class="document-comment-thumbnail" style="background-image: url(\'<%= profile_pic %>\');"></div><div class="document-comment-body"><a href="/user/<%= username %>" class="document-comment-user"><%= name %></a><%= body %></div></div>'),cellCommentsView:function(t,i){var n,o="",s="",r=_.template('<form class="document-element-comments-form"><input type="hidden" name="document-element-item" value="<%= itemID %>" /><input type="hidden" name="user_id" value="<%= userID %>" />'),a="</form>",l=i.attr("id"),u=e('.document-body-form input[name="user_id"]').val(),c=e(".header-user-picture");c.length>=1&&(n=c.css("background-image").replace('"',"'"));var d;for(d=0;d<t.length;d++)s+=OC.documentCommentTemplate(t[d]);if(n){var p=_.template('<div class="document-comment"><div class="document-comment-thumbnail" style="background-image: <%= profile_pic %>;"></div><div class="document-comment-body"><textarea name="comment-body" placeholder="Add a comment..."></textarea></div></div>'),h=p({profile_pic:n}),f=_.template('<div class="document-element-comment-post-wrapper"><button class="document-element-comment-post action-button mini-action-button">Post</button></div>');o+=r({itemID:l,userID:u})+s+h+f()+a}else o+=r({itemID:l,userID:u})+s+a;return o},documentElementCommentPostHandler:function(t){var i=e(t.target).closest("form.document-element-comments-form"),n=e(t.target).closest(".document-element").find("form.document-element-form"),o=e("form.document-body-form"),s=e("textarea[name=comment-body]",i).val().trim();if(""!==s){var r=e(t.target).closest("td, th").attr("id"),a=r.substring(r.indexOf("-",5)+1),l=parseInt(a.substring(0,a.indexOf("-")),10),u=parseInt(a.substring(a.indexOf("-")+1),10),c={body_markdown:s,owner_id:e("input[name=document_element_id]",n).val(),owner_type:e("input[name=document_element_type]",n).val(),user:e("input[name=user_id]",o).val(),reference:"row#"+l+",col#"+u};e.post("/interactions/comment-reference/",c,function(e){"true"==e.status&&OC.documentElementCommentSubmissionHandler(e,i)},"json")}return t.stopPropagation(),t.preventDefault(),!1},documentElementCommentSubmissionHandler:function(t,i){var n=e(".document-comment",i),o=e(n[n.length-2]);o.after(OC.documentCommentTemplate(t));var s=e("textarea[name=comment-body]",i);s.val("")},articleCenter:{registrationInit:function(){e(window).bind("scroll",function(){i()});var t=e(".animating-panda-wrapper > div"),i=function(){var i=e(window).scrollTop();i>400&&1399>i?(t.removeClass(),t.addClass("eating-panda")):i>1400?(t.removeClass(),t.addClass("sleeping-panda")):t.removeClass()}}},initSubscribe:function(){var t,i=e("form.profile-subscribe-form input[name=user_id]").val();e(".profile-subscribe .page-subscribe-button").click(function(n){return t=e(this),OC.subscribeTo(i,t),n.stopPropagation(),n.preventDefault(),!1}),e(".subscribe-suggestion-form .subscribe-button").click(function(t){return i=e(this).parents(".subscribe-suggestion-form").find("input[name=user_id]").val(),OC.subscribeTo(i,e(this)),t.stopPropagation(),t.preventDefault(),!1})},subscribeTo:function(t,i){function n(){i.hasClass("subscribed")?(i.removeClass("subscribed"),i.text("Subscribe")):(i.addClass("subscribed"),i.text(" Subscribed"))}function o(){e.get("/user/api/subscribe/"+t+"/",function(e){"true"!==e.status&&(n(),OC.popup(e.message,e.title))},"json")}if(n(),OC.config.user.id)o();else{var s="To subscribe and get frequent updates, please login or create a free account instantly.";OC.launchSignupDialog(s,o)
}},initBrowse:function(){e(".content-panel-body-listing-item-favorites").click(function(){e(this).toggleClass("favorited")}),e(".content-panel-body-header-share").click(function(){if(OC.config.user.id)OC.initNewPostDialog();else{var e="To post something into the community, you must login or create a free account (takes 30 seconds!).";OC.launchSignupDialog(e,function(){OC.initNewPostDialog()})}}),e(".filter-sort-option").click(function(){var t=e(this);t.hasClass("selected")||(e(".filter-sort-option").removeClass("selected"),t.addClass("selected"))}),e(".category-choice").tipsy({gravity:"s"})},initNewPostDialog:function(){function t(t,i,n){e(t,i.dialog).click(function(){i.close();var t=OC.customPopup(".post-tag-dialog");e(".post-tag-submit",t.dialog).click(function(){var o=e("select[name=type]",t.dialog).val(),s=e("<input/>",{name:"type",value:o,type:"hidden"}),r=e("form:first",i.dialog),a=e('input[name="standard"]',t.dialog);r.append(a.clone()),r.append(s),n&&r.submit()})})}{var i=OC.customPopup(".browse-post-new-dialog");e(".post-tag-dialog .standards-input").tagit({fieldName:"standard",autocomplete:{minLength:2,source:function(t,i){e.get("/meta/api/standard/search/"+t.term+"/?limit=15",function(t){i(e.map(t,function(e){return{label:e,value:e}}))},"json")}}})}e(".browse-post-new-option.upload-option",i.dialog).click(function(){i.close();var n=OC.customPopup(".post-new-upload-dialog");e('input[name="post"]',n.dialog).val("true"),OC.upload.isPost=!0,t('form.files-upload-rename button[type="submit"]',n,!0)}),e(".browse-post-new-option.file-folder-option",i.dialog).click(function(){i.close();var n=OC.customPopup(".post-new-file-folder-dialog"),o=e(".post-new-file-folder-profile-browser");e.get("/resources/tree/all/user/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,o),o.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json"),t(".post-new-file-folder-submit",n,!0),e(".post-new-file-folder-submit").click(function(t){var i;if(selectedResourceCollection=o.find(".selected-destination-collection, .selected-destination-resource"),selectedResourceCollection.length>0&&(i=e(selectedResourceCollection[0])),i){var n=i.attr("id"),s=-1!=n.indexOf("resource"),r=n.substring(s?9:11);e("#post-new-file-folder-profile-form input[name=is_resource]").val(s),e("#post-new-file-folder-profile-form input[name=resource_collection_ID]").val(r)}return t.stopPropagation(),t.preventDefault(),!1})}),e(".browse-post-new-option.url-option",i.dialog).click(function(){i.close();var e=OC.customPopup(".post-new-url-dialog");t(".post-new-url-submit",e,!0)})},launchSignupDialog:function(t,i){var n=OC.customPopup(".login-dialog"),o=e(".easy-signup-form, #sign-in-form"),s=(e(".easy-signup-form #session-state"),e(".login-dialog-message",n.dialog));OC.signupDialog=n,s.html(t),e.get("/user/api/registeration-context/",function(t){if("true"==t.status){var n;for(n=0;n<o.length;n++)e("#session-state",e(o[n])).attr("data-state",t.state),e("span.g-signin",e(o[n])).attr("data-clientid",t.client_id);OC.initializeGooglePlusButtons(),OC.registerationSuccessCallback=i}},"json")},initializeGooglePlusButtons:function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src="https://plus.google.com/js/client:plusone.js?onload=renderPlus",t.parentNode.insertBefore(e,t)},signupTour:function(){function t(){var t='<p>Wohoo! You are almost set. We sent you an email to confirm your account. When you get a chance, please check your email and confirm the same.</p><p>For now, please enjoy this little tour we put together for you.</p><div class="user-welcome-submit-wrapper oc-popup-submit-wrapper"><button class="action-button user-welcome-submit-button oc-popup-submit-button">Take the mini-tour &#187;</button></div>',i=e("<div/>",{"class":"user-welcome-dialog oc-popup"}),o=e("<div/>",{"class":"oc-popup-title-bar"}),s=e("<div/>",{"class":"oc-popup-title"}),r=e("<h3/>",{text:"Welcome, "+OC.config.user.name}),a=e("<div/>",{"class":"delete-button oc-popup-exit"}),l=e("<div/>",{"class":"oc-popup-body",html:t});s.append(r),o.append(s),o.append(a),i.append(o),i.append(l),e("body").append(i);var p=OC.customPopup(".user-welcome-dialog"),h=e(".user-welcome-submit-button",p.dialog);h.click(function(t){p.close(),e.get("/user/api/onboard/welcome/0.1/",function(){},"json"),u=e("<div/>",{"class":"signup-floaters"}),e("body").append(u),c=e(".signup-floaters"),c.css({height:e(window).height(),width:e(window).width()}),d.addClass("show-popup-background");var i=e("<div/>",{"class":"signup-steps-wrapper"}),o=e("<nav/>",{"class":"signup-steps"}),s=e("<div/>",{"class":"signup-step signup-step-one selected",text:"1"}),r=e("<div/>",{"class":"signup-step signup-step-two",text:"2"}),a=e("<div/>",{"class":"signup-step signup-step-three",text:"3"}),l=e("<div/>",{"class":"signup-steps-flow"});return o.append(s),o.append(r),o.append(a),i.append(o),i.append(l),c.append(i),i.css({top:e(window).height()-i.height()-20}),n(),t.stopPropagation(),t.preventDefault(),!1})}function i(t){steps=["one","two","three","four","five"];var i=e(".signup-steps-step");i.removeClass("selected");var n=e(".signup-step-"+steps[t-1]);n.addClass("selected");var o=e(".signup-step-"+steps[t-2]);0!==o.length&&o.addClass("completed")}function n(){var t=e(".create-new-resource-button a"),i=e("#add-resource-menu");t.css({top:t.position().top,left:t.position().left}),t.addClass("popout"),i.addClass("popout"),i.mouseover(),l=e("<div/>",{"class":"step-one-message step-message"}),messageTitle=e("<div/>",{"class":"step-message-title",text:p.one.title}),messageBody=e("<div/>",{"class":"step-message-body",html:p.one.body}),l.append(messageTitle),l.append(messageBody),c.append(l);var n=e(".step-one-message");n.css({top:t.position().top,left:t.position().left-n.width()-80}),e(".signup-tour-primary-button",n).click(function(){l.addClass("hide"),t.removeClass("popout"),i.removeClass("popout"),o()}),e(".signup-tour-secondary-button",n).click(function(){a()})}function o(){i(2);var t=e("#search-bar");t.css({top:t.position().top,left:t.position().left}),t.addClass("popout"),l=e("<div/>",{"class":"step-two-message step-message"}),messageTitle=e("<div/>",{"class":"step-message-title",text:p.two.title}),messageBody=e("<div/>",{"class":"step-message-body",html:p.two.body}),l.append(messageTitle),l.append(messageBody),c.append(l);var n=e(".step-two-message");n.css({top:t.position().top+20,left:t.position().left+20}),e(".signup-tour-primary-button",n).click(function(e){return l.addClass("hide"),t.removeClass("popout"),s(),e.stopPropagation(),e.preventDefault(),!1}),e(".signup-tour-secondary-button",n).click(function(){a()})}function s(){i(3);var t=e(".user-profile-picture"),n=e(".user-profile-info-body"),o=e(".edit-profile-picture .change-picture");t.css({top:t.position().top,left:t.position().left}),n.css({top:n.position().top,left:n.position().left}),t.addClass("popout"),n.addClass("popout"),o.mouseover(),l=e("<div/>",{"class":"step-three-message step-message"}),messageTitle=e("<div/>",{"class":"step-message-title",text:p.three.title}),messageBody=e("<div/>",{"class":"step-message-body",html:p.three.body}),l.append(messageTitle),l.append(messageBody),c.append(l);var s=e(".step-three-message");s.css({top:t.position().top-20,left:t.position().left+t.width()+20}),e(".signup-tour-primary-button",s).click(function(){l.addClass("hide"),t.removeClass("popout"),n.removeClass("popout"),r()})}function r(){a()}function a(){d.removeClass("show-popup-background"),e(".signup-steps-wrapper").addClass("hide"),e(".signup-floaters").addClass("hide");var t=e("#logo");setTimeout(function(){OC.tip(t,{title:"Confused about where to begin?",gravity:"n",width:220,description:"Begin by exploring our vast library of content by clicking on the site logo, before you decide to come back to your profile to make something.",dismisser:function(e,t){t(e)}})},2500)}var l,u,c,d=e(".popup-background"),p={one:{title:"Create lessons, units and folders of joy",body:'Begin by creating a template-based lesson, or create a standards-aligned unit. Import existing content from Dropbox, Google Drive and other places to build folders for sharing.<div class="signup-tour-buttons"><div class="action-button mini-action-button signup-tour-primary-button">Next &#187;</div><div class="action-button mini-action-button signup-tour-secondary-button">Cancel</div></div>'},two:{title:"Search from what others are creating",body:'Hundreds of teachers and content publishers are creating and sharing lessons, worksheets, videos, student handouts, and activities for you to use. Here is where your quest begins.<div class="signup-tour-buttons"><div class="action-button mini-action-button signup-tour-primary-button">Next &#187;</div><div class="action-button mini-action-button signup-tour-secondary-button">Cancel</div></div>'},three:{title:"Does that look like you?",body:'Begin your journey in OpenCurriculum with a new dashing photo of yours and a headline update. Let all others in the community know you have arrived and are here to stay :)<div class="signup-tour-buttons"><div class="action-button mini-action-button signup-tour-primary-button">Done</div></div>'}},h=""===window.location.search?[]:window.location.search.substring(1).split("&");if(h){var f=_.find(h,function(e){return-1!==e.indexOf("new_user=")});f&&OC.config.user.id&&t()}},validateNewURL:function(){OC.validate.text('.resource-create-edit-form input[name="url"]',/^(?:(?:https?|ftp):\/\/)?(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i,"You seem to have a little error in your URL"),e("form.url-edit-form .action-button").click(function(t){var i,n,o=e(this),s=['input[name="url"]'],r=[];for(i=0;i<s.length;i++)n=e("form.resource-create-edit-form "+s[i]),n.hasClass("form-input-error")&&r.push(n);return 0!==r.length?(t.stopPropagation(),t.preventDefault(),!1):void o.parents("form.resource-create-edit-form").submit()})},collaborators:{currentResourceCollectionVisibility:null,template:_.template('<li class="collaborator-item user" id="user-<%= id %>"><div class="collaborator-info user-info"><div class="collaborator-photo user-photo" style="background-image: url(\'<%= profile_pic %>\')"></div><div class="collaborator-description user-description"><a href="/user/<%= username %>"><%= name %></a></div></div><div class="collaborator-actions user-actions"><span class="delete-member delete-button" title="Remove collaborator"></span></div></li>'),init:function(t,i,n,o,s){var r=OC.customPopup(".resource-collection-visibility-dialog",{closeCallback:o}),a=e("#add-collection-collaborator-form",r.dialog),l=e("input[name=add-collaborator]",a);l.focus(),l.val("");var u=e("ul.collaborators",a);u.children().remove(),e(".resource-collection-visibility-form-tabs li a").unbind("click");var c=e('.resource-collection-visibility-form-tabs li a[href="#profile-access"]'),d=e('.resource-collection-visibility-form-tabs li a[href="#project-access"]'),p=e('.resource-collection-visibility-form-tabs li a[href="#private-access"]');"collection"==t.type?(e("input[name=collection_id]",a).val(t.id),OC.collaborators.add(!0),u.addClass("waiting"),e.get("/resources/collection/"+t.id+"/list-collaborators/",function(e){"true"===e.status?OC.collaborators.listHandler(e):OC.popup(e.message,e.title),u.removeClass("waiting")},"json"),c.click(function(){OC.collaborators.currentResourceCollectionVisibility="public",e.get("/resources/collection/"+t.id+"/visibility/public/")}),d.click(function(){OC.collaborators.currentResourceCollectionVisibility="project",e.get("/resources/collection/"+t.id+"/visibility/project/")}),p.click(function(){OC.collaborators.currentResourceCollectionVisibility="private",e.get("/resources/collection/"+t.id+"/visibility/private/")}),n(t.id,!1)):(e("input[name=resource_id]",a).val(t.id),OC.collaborators.add(!1),u.addClass("waiting"),e.get("/resources/resource/"+t.id+"/list-collaborators/",function(e){"true"===e.status?OC.collaborators.listHandler(e):OC.popup(e.message,e.title),u.removeClass("waiting")},"json"),c.click(function(){OC.collaborators.currentResourceCollectionVisibility="public",e.get("/resources/resource/"+t.id+"/visibility/public/")}),d.click(function(){OC.collaborators.currentResourceCollectionVisibility="project",e.get("/resources/resource/"+t.id+"/visibility/project/")}),p.click(function(){OC.collaborators.currentResourceCollectionVisibility="private",e.get("/resources/resource/"+t.id+"/visibility/private/")}),i(t.id,!1)),OC.tabs(".resource-collection-visibility-form",{tab:"private"==OC.collaborators.currentResourceCollectionVisibility?1:0,showOnly:s?null:1})},add:function(t){var i=e("#add-collection-collaborator-form"),n=e("input[name=add-collaborator]",i),o=e("input[name=collection_id]",i).val(),s=e("input[name=resource_id]",i).val();n.autocomplete({source:function(t,i){e.get("/user/api/list/"+t.term,function(t){i(e.map(t,function(e){return{label:e.name,value:e.username,id:e.id}}))},"json")},minLength:2,select:function(i,r){n.addClass("waiting"),t?e.get("/resources/collection/"+o+"/add/"+r.item.id+"/",function(t){var i=e("#add-collection-collaborator-form ul.collaborators");OC.collaborators.addHandler(t.user,i),n.val(""),n.removeClass("waiting")},"json"):e.get("/resources/resource/"+s+"/add/"+r.item.id+"/",function(i){var o=e("#add-collection-collaborator-form ul.collaborators");OC.collaborators.addHandler(i.user,o,t),n.val(""),n.removeClass("waiting")},"json")}})},listHandler:function(t){var i,n=e("#add-collection-collaborator-form ul.collaborators");for(i=0;i<t.users.length;i++)OC.collaborators.addHandler(t.users[i],n)},addHandler:function(e,t,i){collaborator=OC.collaborators.template(e),t.append(collaborator);var n=t.find("li.collaborator-item:last .delete-button");n.click(function(e){OC.collaborators.removeHandler(e,i)}),n.tipsy({gravity:"n"})},removeHandler:function(t,i){var n=e("#add-collection-collaborator-form"),o=e("input[name=collection_id]",n).val(),s=e("input[name=resource_id]",n).val(),r=e(t.target),a=r.closest("li.collaborator-item").attr("id").substring(5);i?e.get("/resources/collection/"+o+"/remove/"+a+"/",function(e){"true"===e.status?OC.collaborators.remove(r):OC.popup(e.message,e.title)},"json"):e.get("/resources/resource/"+s+"/remove/"+a+"/",function(e){"true"===e.status?OC.remove.remove(r):OC.popup(e.message,e.title)},"json")},remove:function(t){var i=e(t).parents("li.collaborator-item");e(t).tipsy("hide"),i.remove()}},resources:{},resource:{copy:function(t,i,n,o){e.get("/resources/resource/"+i+"/copy/from/"+t+"/to/"+n+"/",function(e){"true"==e.status?o(e.resource,i):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")},link:function(t,i,n,o){e.get("/resources/resource/"+i+"/link/from/"+t+"/to/"+n+"/",function(e){"true"==e.status?o(e.resource,i):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")},successfullyCopied:function(){OC.setMessageBoxMessage("Resource has been copied to your folder successfully."),OC.showMessageBox()},successfullyLinked:function(){OC.setMessageBoxMessage("Resource has been linked in your folder successfully."),OC.showMessageBox()},"delete":function(t,i,n){var o=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",o.dialog).click(function(s){return o.close(),e.post("/resources/delete-resource/"+t+"/from/"+i+"/",function(e){"true"==e.status?n([e.resourceID]):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),s.stopPropagation(),s.preventDefault(),!1})},deleteMultiple:function(t,i,n){var o=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",o.dialog).click(function(s){o.close();var r=t.join();return e.post("/resources/delete-resources/from/"+i+"/?ids="+r,function(e){"true"==e.status?n(e.resourceIDs):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),s.stopPropagation(),s.preventDefault(),!1})},rename:function(t,i,n){e.post("/resources/rename/resource/"+t+"/"+encodeURIComponent(i)+"/",function(e){"true"==e.status?n(e.resourceID,e.title):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")}},collection:{copy:function(t,i,n,o){e.get("/resources/collection/"+i+"/copy/to/"+n+"/",function(e){"true"==e.status?o(e.collection,i):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")},successfullyCopied:function(){OC.setMessageBoxMessage("Folder has been copied into your folder successfully."),OC.showMessageBox()},"delete":function(t,i){var n=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",n.dialog).click(function(o){return n.close(),e.post("/resources/delete-collection/"+t+"/",function(e){"true"==e.status?i([e.collectionID]):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),o.stopPropagation(),o.preventDefault(),!1})},deleteMultiple:function(t,i){var n=OC.customPopup(".delete-resource-collection-dialog");e(".delete-resource-collection-submit-button",n.dialog).click(function(o){n.close();var s=t.join();return e.post("/resources/delete-collections/?ids="+s,function(e){"true"==e.status?i(e.collectionIDs):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json"),o.stopPropagation(),o.preventDefault(),!1})},rename:function(t,i,n){e.post("/resources/rename/collection/"+t+"/"+encodeURIComponent(i)+"/",function(e){"true"==e.status?n(e.collectionID,e.title):(OC.popup(e.message,e.title),OC.dismissMessageBox())},"json")}},setPageHeight:function(){e(".resource-browse, .profile-page").height(e(window).height()-e("header").height()),e(".profile-content").height(e(window).height()-e("header").height()-e(".profile-tabs").outerHeight(!0)-parseInt(e(".profile-content").css("padding-top"),10))},favorites:{},attachCSRFToken:function(t,i){function n(t){var i,n,o,s=null;if(document.cookie&&""!==document.cookie)for(i=document.cookie.split(";"),n=0;n<i.length;n++)if(o=e.trim(i[n]),o.substring(0,t.length+1)===t+"="){s=decodeURIComponent(o.substring(t.length+1));break}return s}function o(e){var t=document.location.host,i=document.location.protocol,n="//"+t,o=i+n;return e===o||e.slice(0,o.length+1)===o+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!/^(\/\/|http:|https:).*/.test(e)}var s=e(this)[0].options.url;o(s)&&i.setRequestHeader("X-CSRFToken",n("csrftoken"))}}),e(document).ready(function(e){OC.setupUserMenu(),e(".chief-panel-container-cover").addClass("play"),OC.setPageHeight(),e(window).resize(OC.setPageHeight),OC.initSearchOptions(),OC.initSearchAutocomplete(),OC.initShowMoreBlock(),OC.bindEditHeadlineHandler(),OC.initNotificationHandler(),OC.initMessageBox(),OC.setupIndex(),OC.initBrowse(),OC.initPictureManipulation(),OC.initSubscribe(),OC.initInviteSignup(),OC.renderSelectRedirector(),OC.renderThermometer(),OC.setupShareMenu(),OC.setupAddTo(),e("#submission-info").animate({top:"0px"},1e3),e(".edit-dropdown").click(function(){e(this).toggleClass("edit-dropdown-opened"),e(this).parent().children(".edit-dropped").toggleClass("show-dropped")}),OC.emailShareHandler(),OC.commentHandler(),OC.initCategoryLiveFilter(),OC.renderCategoryArticles(),OC.initImageHoverDescriptions(),OC.renderJobsCarousel(),e("#philosophy-button").click(function(){e("html, body").animate({scrollTop:e("#our-philosophy").offset().top},1e3)}),OC.initAddResource(),OC.initCreateCollection(),OC.initCreateGroup(),OC.initUpload(),OC.initLink(),OC.bindDeleteResourceHandler(),OC.bindDeleteCollectionHandler(),OC.initCollectionsTree(),OC.initFavoriteResource(),OC.comments.initRenderComments(),OC.initUpvoteDownvoteResource(),OC.initResourceView(),OC.initPrintResource(),OC.initExportResource(),OC.initProfileCreateResource(),OC.initProfileSubscribers(),OC.validateNewURL(),OC.initForgotAuth(),OC.initChangePassword(),OC.renderShowMore(),OC.initArticleCenter(),e(".new-resource-tags").tagit({allowSpaces:!0});try{window.fbAsyncInit=function(){FB.init({appId:t,status:!0,cookie:!0,xfbml:!0}),FB.Event.subscribe("auth.authResponseChange",function(){var t=e(".registration-cover");t.length>0&&"facebook"===t.attr("title")&&OC.facebookRegistrationCallback({status:"false"})})}}catch(i){}!function(e){var t,i="facebook-jssdk",n=e.getElementsByTagName("script")[0];e.getElementById(i)||(t=e.createElement("script"),t.id=i,t.async=!0,t.src="//connect.facebook.net/en_US/all.js",n.parentNode.insertBefore(t,n))}(document),OC.initRegistrationForm(),OC.signupTour()});var t;return e(document).ajaxSend(function(t,i,n){function o(t){var i,n,o,s=null;if(document.cookie&&""!==document.cookie)for(i=document.cookie.split(";"),n=0;n<i.length;n++)if(o=e.trim(i[n]),o.substring(0,t.length+1)===t+"="){s=decodeURIComponent(o.substring(t.length+1));break}return s}function s(e){var t=document.location.host,i=document.location.protocol,n="//"+t,o=i+n;return e===o||e.slice(0,o.length+1)===o+"/"||e===n||e.slice(0,n.length+1)===n+"/"||!/^(\/\/|http:|https:).*/.test(e)}function r(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}!r(n.type)&&s(n.url)&&i.setRequestHeader("X-CSRFToken",o("csrftoken"))}),function(e,t,i,n,o,s,r){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,s=t.createElement(i),r=t.getElementsByTagName(i)[0],s.async=1,s.src=n,r.parentNode.insertBefore(s,r)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-23974225-2","opencurriculum.org"),OC.config.user.id&&(ga("set","&uid",parseInt(OC.config.user.id,10)),ga("set","dimension2",OC.config.user.dob)),ga("send","pageview"),e.fn.shuffleElements=function(){var t,i,n,o=e(this);for(n=o.length;n;t=parseInt(Math.random()*n,10),i=o[--n],o[n]=o[t],o[t]=i);return o},e.fn.selectRange=function(e,t){return this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(e,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select()}})},e.fn.hasClickEventListener=function(t){elementClickEvents=e._data(this[0],"events").click;var i=0;for(i;i<elementClickEvents.length;i++)if(elementClickEvents[i].handler==t)return!0;return!1},getScrollbarWidth=function(){var t=e('<div style="width: 100%; height:200px;"></div>'),i=e('<div style="width:200px;height:150px; position: absolute;top: 0; left: 0; visibility: hidden; overflow:hidden;"></div>').append(t),n=t[0],o=i[0];e("body").append(o);var s=n.offsetWidth;i.css("overflow","scroll");var r=o.clientWidth;return i.remove(),s-r},isElementInViewport=function(t){t instanceof e&&(t=t[0]);var i=t.getBoundingClientRect();return i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)},UserVoice=window.UserVoice||[],function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//widget.uservoice.com/ZAGIW6Tl7C98iiNDKsLe5g.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),UserVoice.push(["set",{accent_color:"#6aba2e",trigger_color:"white",trigger_background_color:"rgba(46, 49, 51, 0.6)"}]),UserVoice.push(["addTrigger",{mode:"contact",trigger_position:"bottom-right"}]),e.fn.animateAuto=function(t,i,n){var o;return this.each(function(s,r){r=e(r),o=r.clone().css({height:"auto",width:"auto"}).appendTo("body");var a=o.css("height"),l=o.css("width");o.remove(),"height"===t?r.animate({height:a},i,n):"width"===t?r.animate({width:l},i,n):"both"===t&&r.animate({width:l,height:a},i,n)})},OC}),define("header",["jquery","underscore","modernizr","tipsy","tagit","core"],function(){});