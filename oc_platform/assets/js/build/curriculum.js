!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("flux",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Flux=e()}}(function(){return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return r(n?n:e)},l,l.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t){t.exports.Dispatcher=e("./lib/Dispatcher")},{"./lib/Dispatcher":2}],2:[function(e,t){function n(){this.$Dispatcher_callbacks={},this.$Dispatcher_isPending={},this.$Dispatcher_isHandled={},this.$Dispatcher_isDispatching=!1,this.$Dispatcher_pendingPayload=null}var i=e("./invariant"),r=1,s="ID_";n.prototype.register=function(e){var t=s+r++;return this.$Dispatcher_callbacks[t]=e,t},n.prototype.unregister=function(e){i(this.$Dispatcher_callbacks[e],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",e),delete this.$Dispatcher_callbacks[e]},n.prototype.waitFor=function(e){i(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var t=0;t<e.length;t++){var n=e[t];this.$Dispatcher_isPending[n]?i(this.$Dispatcher_isHandled[n],"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",n):(i(this.$Dispatcher_callbacks[n],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",n),this.$Dispatcher_invokeCallback(n))}},n.prototype.dispatch=function(e){i(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this.$Dispatcher_startDispatching(e);try{for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]||this.$Dispatcher_invokeCallback(t)}finally{this.$Dispatcher_stopDispatching()}},n.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching},n.prototype.$Dispatcher_invokeCallback=function(e){this.$Dispatcher_isPending[e]=!0,this.$Dispatcher_callbacks[e](this.$Dispatcher_pendingPayload),this.$Dispatcher_isHandled[e]=!0},n.prototype.$Dispatcher_startDispatching=function(e){for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]=!1,this.$Dispatcher_isHandled[t]=!1;this.$Dispatcher_pendingPayload=e,this.$Dispatcher_isDispatching=!0},n.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null,this.$Dispatcher_isDispatching=!1},t.exports=n},{"./invariant":3}],3:[function(e,t){var n=function(e,t,n,i,r,s,o,a){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,r,s,o,a],l=0;u=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[l++]}))}throw u.framesToPop=1,u}};t.exports=n},{}]},{},[1])(1)}),define("curriculumAppDispatcher",["flux"],function(e){var t=e.Dispatcher;return new t}),define("curriculumActions",["curriculumAppDispatcher"],function(e){return{initTextbooks:function(t){e.dispatch({type:"SET_TEXTBOOKS",textbooks:t})},initUnits:function(t){e.dispatch({type:"SET_UNITS",units:t})},initSettings:function(t){e.dispatch({type:"INIT_SETTINGS",settings:t})},setNumWeeks:function(t){e.dispatch({type:"SET_NUM_WEEKS",count:t})},openUnit:function(t){e.dispatch({type:"OPEN_UNIT",unit:t})},buildSections:function(t,n){e.dispatch({type:"BUILD_SECTIONS",unitID:t,sections:n})},updateSettings:function(t){e.dispatch({type:"UPDATE_SETTINGS",settings:t})},saveSettings:function(t){e.dispatch({type:"SAVE_SETTINGS",settings:t})},settingsUpdated:function(){e.dispatch({type:"SETTINGS_UPDATED"})},openOverview:function(){e.dispatch({type:"OPEN_OVERVIEW"})},openSettings:function(){e.dispatch({type:"OPEN_SETTINGS"})},openUnits:function(t){e.dispatch({type:"OPEN_UNITS",mode:t?"add":"view"})},openTextbooks:function(){e.dispatch({type:"OPEN_TEXTBOOKS"})},addUnit:function(t,n,i,r){e.dispatch({type:"ADD_UNIT",name:t,textbook:n,from:i,to:r})},saveUnit:function(t){e.dispatch({type:"SAVE_UNIT",unit:t})},addUnitComplete:function(){e.dispatch({type:"ADD_UNIT_COMPLETE"})},addTextbook:function(t,n){e.dispatch({type:"ADD_TEXTBOOK",title:t,description:n})},saveTextbook:function(t){e.dispatch({type:"SAVE_TEXTBOOK",textbook:t})},addTextbookComplete:function(){e.dispatch({type:"ADD_TEXTBOOK_COMPLETE"})},openItem:function(t){e.dispatch({type:"OPEN_ITEM",item:t})},addItem:function(t){e.dispatch({type:"ADD_ITEM",sectionID:t})},addItemPost:function(t,n,i){e.dispatch({type:"ADD_ITEM_POST",item:t,callback:n,sectionID:i||null})},addItemComplete:function(t,n){e.dispatch({type:"ADD_ITEM_COMPLETE",item:t,id:n})},addToSection:function(t,n){e.dispatch({type:"ADD_ITEM_TO_SECTION",itemID:t,sectionID:n})},itemAddedToSection:function(t,n){e.dispatch({type:"ITEM_ADDED_TO_SECTION",itemID:t,sectionID:n})},addSection:function(t,n,i,r){e.dispatch({type:"ADD_SECTION",name:t,sectionType:n,moduleID:i,isUnit:r})},addSectionPost:function(t,n,i,r){e.dispatch({type:"ADD_SECTION_POST",section:t,moduleID:n,isUnit:i,callback:r})},addSectionComplete:function(t,n){e.dispatch({type:"ADD_SECTION_COMPLETE",section:n,id:t})},deleteSection:function(t){e.dispatch({type:"DELETE_SECTION",id:t})},updateItem:function(t,n){e.dispatch({type:"UPDATE_ITEM",props:t,callback:n})},itemUpdated:function(t){e.dispatch({type:"ITEM_UPDATED",props:t})},deleteItem:function(t){e.dispatch({type:"DELETE_ITEM",id:t})},addField:function(t,n,i,r){e.dispatch({type:"ADD_FIELD",name:t,fieldType:n,position:i,itemID:r})},addFieldPost:function(t,n,i){e.dispatch({type:"ADD_FIELD_POST",item:t,field:n,callback:i})},addFieldComplete:function(t,n){e.dispatch({type:"ADD_FIELD_COMPLETE",itemID:t,fieldID:n})},addResource:function(t,n){e.dispatch({type:"ADD_RESOURCE",resource:t,resourceSetID:n})},removeResource:function(t,n){e.dispatch({type:"REMOVE_RESOURCE",resourceID:resourceID,resourceSetID:n})},deleteMeta:function(t,n){e.dispatch({type:"DELETE_META",id:t,itemID:n})},deleteResourceSet:function(t){e.dispatch({type:"DELETE_RESOURCESET",id:t})},moveSection:function(t,n){e.dispatch({type:"MOVE_SECTION",sectionID:t,beforeSectionID:n})},moveSectionSave:function(t){e.dispatch({type:"MOVE_SECTION_SAVE",toShift:t})},moveSectionComplete:function(){e.dispatch({type:"MOVE_SECTION_COMPLETE"})},moveItem:function(t,n){e.dispatch({type:"MOVE_ITEM",itemID:t,beforeItemID:n})},moveItemSave:function(t){e.dispatch({type:"MOVE_ITEM_SAVE",toShift:t})},moveItemComplete:function(){e.dispatch({type:"MOVE_ITEM_COMPLETE"})},moveField:function(t,n,i,r,s){e.dispatch({type:"MOVE_FIELD",fieldID:t,beforeFieldID:n,itemID:i,toMoveIsMeta:r,beforeIsMeta:s})},moveFieldSave:function(t,n){e.dispatch({type:"MOVE_FIELD_SAVE",id:t,toShift:n})},moveFieldComplete:function(){e.dispatch({type:"MOVE_FIELD_COMPLETE"})},launchPlanner:function(){e.dispatch({type:"LAUNCH_PLANNER"})},selectDate:function(t){e.dispatch({type:"SELECT_DATE",date:t})},selectDateComplete:function(t,n){e.dispatch({type:"SELECT_DATE_COMPLETE",date:t,response:n})},selectPlannerEvent:function(t,n){e.dispatch({type:"SELECT_PLANNER_EVENT",id:t,date:n})},clearEventSelection:function(){e.dispatch({type:"CLEAR_EVENT_SELECTION"})},confirmAddItemToEvent:function(t,n){e.dispatch({type:"ADD_ITEM_TO_EVENT",itemID:t,eventID:n})},itemAddedToEvent:function(){e.dispatch({type:"ITEM_ADDED_TO_EVENT"})},removeItemFromEvent:function(t,n){e.dispatch({type:"REMOVE_ITEM_FROM_EVENT",itemID:t,eventID:n})},dim:function(){e.dispatch({type:"DIM"})},brighten:function(){e.dispatch({type:"BRIGHTEN"})}}}),define("events",[],function(){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function t(e){return"function"==typeof e}function n(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function r(e){return void 0===e}return e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(e){if(!n(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},e.prototype.emit=function(e){var n,s,o,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(n=arguments[1],n instanceof Error)throw n;throw TypeError('Uncaught, unspecified "error" event.')}if(s=this._events[e],r(s))return!1;if(t(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,a=new Array(o-1),u=1;o>u;u++)a[u-1]=arguments[u];s.apply(this,a)}else if(i(s)){for(o=arguments.length,a=new Array(o-1),u=1;o>u;u++)a[u-1]=arguments[u];for(c=s.slice(),o=c.length,u=0;o>u;u++)c[u].apply(this,a)}return!0},e.prototype.addListener=function(n,s){var o;if(!t(s))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,t(s.listener)?s.listener:s),this._events[n]?i(this._events[n])?this._events[n].push(s):this._events[n]=[this._events[n],s]:this._events[n]=s,i(this._events[n])&&!this._events[n].warned&&(o=r(this._maxListeners)?e.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[n].length>o&&(this._events[n].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),"function"==typeof console.trace&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(e,n){function i(){this.removeListener(e,i),r||(r=!0,n.apply(this,arguments))}if(!t(n))throw TypeError("listener must be a function");var r=!1;return i.listener=n,this.on(e,i),this},e.prototype.removeListener=function(e,n){var r,s,o,a;if(!t(n))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,s=-1,r===n||t(r.listener)&&r.listener===n)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,n);else if(i(r)){for(a=o;a-->0;)if(r[a]===n||r[a].listener&&r[a].listener===n){s=a;break}if(0>s)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,n)}return this},e.prototype.removeAllListeners=function(e){var n,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(n in this._events)"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],t(i))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},e.prototype.listeners=function(e){var n;return n=this._events&&this._events[e]?t(this._events[e])?[this._events[e]]:this._events[e].slice():[]},e.listenerCount=function(e,n){var i;return i=e._events&&e._events[n]?t(e._events[n])?1:e._events[n].length:0},e}),define("deep_extend",[],function(){var e=function(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];var t,n,i,r,s=arguments[0],o=Array.prototype.slice.call(arguments,1);return o.forEach(function(o){if("object"==typeof o)for(t in o)t in o&&(i=s[t],n=o[t],n!==s&&("object"==typeof n&&null!==n?n instanceof Date?s[t]=new Date(n.getTime()):n instanceof RegExp?s[t]=new RegExp(n):"object"==typeof i&&null!==i?(r=Array.isArray(n)?Array.isArray(i)?i:[]:Array.isArray(i)?{}:i,s[t]=e(r,n)):(r=Array.isArray(n)?[]:{},s[t]=e(r,n)):s[t]=n))}),s};return e}),define("curriculumSettings",["curriculumAppDispatcher","events","deep_extend"],function(AppDispatcher,Events,extend){var CHANGE_EVENT="change",EventEmitter=Events.EventEmitter,_id=null,_title=null,_description=null,_gradeType=null,_grade=null,_subject=null,_session=null,_start=null,_end=null,_standards=!1,_sync=!0,_syncState="pause",_syncedTo,_isOwner=!1,_newTextbookName=null,_newTextbookDescription=null,_lastPushed=null,_periodTitle=null,_periods=null,_gradeTypes=["Grade","Class","Level","Group","Other"],_unsavedSettings=null,SettingsStore=extend(EventEmitter.prototype,{emitChange:function(){this.emit(CHANGE_EVENT)},addChangeListener:function(e){this.on(CHANGE_EVENT,e)},removeChangeListener:function(e){this.removeListener(CHANGE_EVENT,e)},_saving:function(){OC.utils.status.saving()},_saved:function(){OC.utils.status.saved()},_updateSettings:function(settings){settings.curriculum_id=_id;for(var key in settings)eval("_"+key+" = '"+settings[key]+"'");_unsavedSettings=settings},getGradeTypes:function(){return _gradeTypes},getGeneral:function(){return{title:_title,subject:_subject,session:_session,from:_start,to:_end,grade:_grade?_grade:null,gradeType:_gradeType?_gradeType:null,sync:_sync}},getID:function(){return _id},getPeriods:function(){return{title:_periodTitle,start:_start,end:_end}},getPretitle:function(){return _title+" - "+_grade+" "+_subject},getSyncedTo:function(){return _syncedTo},getCanEdit:function(){return _isOwner},getSyncState:function(){return _syncState},getLastPushed:function(){return _lastPushed},getUnsaved:function(){return _unsavedSettings},dispatchToken:AppDispatcher.register(function(e){switch(e.type){case"ON_LOAD":var t,n,i=general.grade.split(" ");0!==SettingsStore.getGradeTypes().indexOf(i[0])?(t=i[0].toLowerCase(),n=i[1]):(t="other",n=this.props.settings.grade);break;case"UPDATE_SETTINGS":SettingsStore._updateSettings(e.settings),SettingsStore._saving();break;case"ADD_ITEM":case"ADD_FIELD":case"MOVE_SECTION":case"MOVE_ITEM":case"MOVE_FIELD":case"ADD_UNIT":case"ADD_TEXTBOOK":SettingsStore._saving();break;case"ITEM_ADDED_TO_SECTION":case"ADD_FIELD_COMPLETE":case"MOVE_SECTION_COMPLETE":case"MOVE_ITEM_COMPLETE":case"MOVE_FIELD_COMPLETE":case"ADD_UNIT_COMPLETE":case"ADD_TEXTBOOK_COMPLETE":case"SETTINGS_UPDATED":SettingsStore._saved();break;case"PAUSE_CHANGES":_pauseSync=e.mode===!1?!1:!0;break;case"INIT_SETTINGS":_id=e.settings.id,_description=e.settings.description,_grade=e.settings.grade,_subject=e.settings.subject,_title=e.settings.title,_isOwner=e.settings.isOwner,_periodTitle=e.settings.periods.title,_start=e.settings.periods.start,_end=e.settings.periods.end,_session=e.settings.periods.session;break;default:return!0}return SettingsStore.emitChange(),!0})});return SettingsStore}),define("curriculumBootstrap",["atomic","immutable","curriculumActions","curriculumSettings"],function(e,t,n,i){var r={_textbooks:null,_units:null,_standards:null,_numWeeks:null,fetch:function(n){var r=this;e.get("/curriculum/api/curriculum/"+i.getID()+"/").success(function(e){r._textbooks=t.fromJS(e.textbooks),r._units=t.fromJS(e.units),r._standards=t.fromJS(e.standards),n()})},linkUnitsToTextbooks:function(){var e,n,i=this;this._textbooks=this._textbooks.map(function(r){return e=t.List(),r.get("units").forEach(function(t){n=i._units.find(function(e){return e.get("id")===t.get("id")}),n=n.set("textbookID",t.get("textbook_id")),e=e.push(n.get("id"))}),r.set("units",e)})},getTextbookFromUnitID:function(e){return this._textbooks.find(function(t){return t.get("units").find(function(t){return t.id===e})})},setUnitPeriods:function(){var e,t,n=this;if("weekly"==i.getPeriods().title){e=this._units.map(function(e){return textbook=n.getTextbookFromUnitID(e.id),t=e.get("period"),{id:e.get("id"),textbook:textbook?textbook:null,textbookTitle:textbook?textbook.get("title"):null,title:e.get("title"),textbookThumbnail:textbook?textbook.get("thumbnail"):null,begin:t&&t.has("begin")?t.get("begin"):null,end:t&&t.has("end")?t.get("end"):null,from:t&&t.has("from")?t.get("from"):null,to:t&&t.has("to")?t.get("to"):null}}),e=e.filter(function(e){return null!==e.end}).sortBy(function(e){return e.begin});var r=e.max(function(e,t){return e.end>t.end}),s=e.min(function(e,t){return e.begin>t.begin}),o=r?r.end:null,a=s?s.begin:null;return this._numWeeks=null!==o&&null!==a?Math.ceil((o-a)/7):0,e}if("terms"==view.props.settings.periods.title){e=OC.explorer.units.flatMap(function(e){return textbook=view.getTextbookFromUnitID(e.get("id")),t=e.get("period"),{id:e.get("id"),title:e.get("title"),textbook:textbook,textbookTitle:textbook?textbook.get("title"):null,textbookThumbnail:textbook?textbook.get("thumbnail"):null,type:t&&t.has("type")?t.get("type"):null,position:t&&t.has("position")?t.get("position"):null,parent:t&&t.has("parent")?t.get("parent"):null,unit:t&&t.has("unit")?t.get("unit"):null}});var u;return e.forEach(function(e){u=view.props.settings.periods.data[e.parent],u.has("count")?u.count+=1:u.count=1}),e}},init:function(e){function t(e){require(["spin"],function(t){OC.curriculum.hasOwnProperty("spinner")?OC.curriculum.spinner.spin(r):OC.curriculum.spinner=new t(OC.spinner.options).spin(r),e()})}{var i=this,r=OC.curriculum.loadButton;document.querySelector(".ajax-loader-wrapper")}t(function(){OC.curriculum.hasOwnProperty("spinner")&&OC.curriculum.spinner.spin(r),i.fetch(function(){OC.curriculum.spinner.stop(),i.linkUnitsToTextbooks(),n.initTextbooks(i._textbooks),n.initUnits(i.setUnitPeriods()),n.setNumWeeks(i._numWeeks),e()})})}};return r}),define("curriculumItems",["curriculumAppDispatcher","events","deep_extend","immutable","curriculumActions"],function(e,t,n,i){var r=t.EventEmitter,s="change",o=i.List(),a=i.List(),u=i.Map(),c=i.List(),l=i.Map(),d=!1,p=null,h=null,f=!1,m=n(r.prototype,{emitChange:function(){this.emit(s)},addChangeListener:function(e){this.on(s,e)},removeChangeListener:function(e){this.removeListener(s,e)},_setItems:function(e){e.forEach(function(e){items=e.items.map(function(t){return newItem=i.Map(t),newItem=newItem.set("issue",{id:t.issue?t.id:null,host_id:t.issue?t.host_id:null,message:t.issue?t.message:null}),newItem=newItem.set("sectionID",e.id)}),sectionItems=i.List(items),sectionItems=sectionItems.map(function(e){return e.set("resource_sets",e.get("resource_sets").map(function(e){return{id:e.id,title:e.title,position:e.position,resources:i.List(e.resources.map(function(e){return i.Map(e)}))}}))}),o=o.merge(sectionItems)})},selectItem:function(e){var t=o.find(function(e){return e.get("selected")===!0});t&&(o=o.update(o.indexOf(t),function(e){return e.set("selected",!1)})),o=o.update(o.indexOf(e),function(e){return e.set("selected",!0)})},get:function(e){return o.find(function(t){return t.get("id")===e})},getSelected:function(){return o.find(function(e){return e.get("selected")===!0})},getSectionItems:function(e){return o.filter(function(t){return t.get("sectionID")===e})},getUnsavedItem:function(){var e=a.last();return a.pop(),c=c.push(e),e},getUnsavedField:function(e){var t=u.get(e);return u=u.delete(e),l=l.set(e,t),t},getFieldState:function(){return d},getShowPlanner:function(){return f},_update:function(e){var t=o.find(function(t){return t.get("id")===e.id});delete e.id,o=o.update(o.indexOf(t),function(t){return t.withMutations(function(t){for(var n in e)t.set(n,e[n])})})},_add:function(e){var t=o.filter(function(t){return t.get("sectionID")===e}).max(function(e,t){return e.get("position")>t.get("position")}).get("position"),n=i.Map({description:"",resource_sets:[{id:null,resources:i.List()}],meta:[],position:t+1,issue:{id:null,host_id:null,message:null},sectionID:e});o=o.push(n),a=a.push(n)},_setItemID:function(e,t){o=o.update(o.indexOf(e),function(e){return e.set("id",t)})},_setSectionID:function(e,t){var n=o.find(function(t){return t.get("id")===e});o=o.update(o.indexOf(n),function(e){return e.set("sectionID",t)})},_setResourceSetID:function(e,t){var n=o.find(function(t){return t.get("id")==e}),i=u.get(e),r=n.get("resource_sets"),s=r.indexOf(i);r[s].id=t;var a=n.set("resource_sets",r);o=o.set(o.indexOf(n),a)},_addResource:function(e,t){var n,i,r,s=null;n=o.find(function(e,n){return i=n,s=e.get("resource_sets").find(function(e,n){return r=n,e.id===t}),void 0!==s});var a=n.get("resource_sets");a[r].resources=a[r].resources.push(e);var u=n.set("resource_sets",a);o=o.set(i,u)},_removeResource:function(e,t){toUpdateItem=o.find(function(e,n){return index=n,resourceSet=e.get("resource_sets").find(function(e,n){return rsIndex=n,e.id===t}),void 0!==resourceSet});var n=toUpdateItem.get("resource_sets"),i=n[rsIndex].resources.find(function(t){return t.id===e});n[rsIndex].resources=n[rsIndex].resources.splice(n[rsIndex].resources.indexOf(i),1);var r=toUpdateItem.set("resource_sets",n);o=o.set(index,r)},_addField:function(e,t,n,r){var s,a=o.find(function(e){return e.get("id")==r});if("text"===t){var c=OC.utils.slugify(e),l=a.get("meta"),d={slug:c,title:e,body:"",position:n};l.push(d),s=a.set("meta",l),u=u.set(r,{meta:d})}else if("resources"===t){var p={title:e,position:n,resources:[]},h=a.get("resource_sets");h.push(p),s=a.set("resource_sets",h),u=u.set(r,i.Map({resource_set:p}))}o=o.set(o.indexOf(a),s)},_delete:function(e){var t=o.find(function(t){return t.get("id")===e});o=o.delete(o.indexOf(t))},_deleteMeta:function(e,t){var n=o.find(function(e){return e.get("id")===t});o=o.update(o.indexOf(n),function(t){return t.update("meta",function(t){return t.splice(e,1),t})})},_deleteResourceSet:function(e){var t,n,i=o.find(function(i){return t=i.get("resource_sets").find(function(t,i){return n=i,t.id===e}),void 0!==t});o=o.update(o.indexOf(i),function(e){return e.update("resource_sets",function(e){return e.splice(n,1),e})})},_moveItem:function(e,t){var n={},i=o.find(function(t){return t.get("id")===e}),r=o.find(function(e){return e.get("id")===parseInt(t,10)}),s=this.getSectionItems(i.get("sectionID"));i.get("position")<r.get("position")?(itemsToShift=s.filter(function(e){return e.get("position")>i.get("position")&&e.get("position")<=r.get("position")}),o=o.withMutations(function(e){return itemsToShift.forEach(function(t){e=e.update(e.indexOf(t),function(e){return e.set("position",e.get("position")-1)})}),e=e.update(e.indexOf(i),function(e){return e.set("position",r.get("position"))})})):i.get("position")>r.get("position")&&(itemsToShift=s.filter(function(e){return e.get("position")<i.get("position")&&e.get("position")>=r.get("position")}),o=o.withMutations(function(e){return itemsToShift.forEach(function(t){e=e.update(e.indexOf(t),function(e){return e.set("position",e.get("position")+1)})}),e=e.update(e.indexOf(i),function(e){return e.set("position",r.get("position"))})})),itemsToShift.forEach(function(e){n[e.get("id")]=m.get(e.get("id")).get("position")}),n[i.get("id")]=o.find(function(e){return e.get("id")===i.get("id")}).get("position"),p=n},getToShift:function(){return p},getMetaToShift:function(){return h},_moveMeta:function(e,t,n,i,r){function s(e){return o.find(function(e){return e.get("id")===n}).get("resource_sets").find(function(t){return t.id===e})}var a,u,c,l=o.find(function(e){return e.get("id")===n});i&&r?l.get("meta").forEach(function(n,i){e===i&&(a=n),t===i&&(u=n)}):i?(l.get("meta").forEach(function(t,n){e===n&&(a=t)}),u=l.get("resource_sets").find(function(e){return t===e.id})):r?(a=l.get("resource_sets").find(function(t){return e===t.id}),l.get("meta").forEach(function(e,n){t===n&&(u=e)})):(a=l.get("resource_sets").find(function(t){return e===t.id}),u=l.get("resource_sets").find(function(e){return t===e.id}));var d,p,f,m,g={},v=l.get("meta"),y=[];if(c=u.position,a.position<u.position){for(p=l.get("resource_sets").filter(function(e){return e.position>a.position&&e.position<=u.position}),d=0;d<v.length;d++)m=v[d],m.position>a.position&&m.position<=u.position?(y.push(m),m.position=m.position-1):y.push(null);i&&(v[a.position].position=u.position),o=o.update(items.indexOf(l),function(e){return e=e.update("resource_sets",function(e){return p.forEach(function(t){f=e.indexOf(t),-1!==f&&(e=e.update(f,function(e){return e.set("position",e.get("position")-1)}))}),e}),e=e.set("meta",v)})}else if(a.position>u.position){for(p=l.get("resource_sets").filter(function(e){return e.position<a.position&&e.position>=u.position}),d=0;d<v.length;d++)m=v[d],m.position<a.position&&m.position>=u.position?(y.push(m),m.position=m.position+1):y.push(null);i&&(v[a.position].position=c),o=o.update(items.indexOf(l),function(e){return e=e.update("resource_sets",function(e){return p.forEach(function(t){f=e.indexOf(t),-1!==f&&(e=e.update(f,function(e){return e.set("position",e.get("position")+1)}))}),e}),e=e.set("meta",v)})}p&&p.forEach(function(e){g["set-"+e.id]=s[e.id].position}),y&&y.forEach(function(e,t){e&&(g["meta-"+t]=e.position)}),i?g["meta-"+e]=a.position:g["set-"+e]=a.position,h=g},_hidePlanner:function(e){f===!0&&27==e.which&&(f=!1),OC.$.removeClass(document.querySelector(".popup-background"),"show-popup-background"),-1!==e.target.className.indexOf("popup-background")&&(f=!1),m.emitChange()},dispatchToken:e.register(function(e){switch(e.type){case"ADD_ITEM":m._add(e.sectionID);break;case"ADD_ITEM_COMPLETE":m._setItemID(e.item,e.id);break;case"ADD_ITEM_TO_SECTION":m._setSectionID(e.itemID,e.sectionID);break;case"OPEN_ITEM":m.selectItem(e.item);break;case"BUILD_SECTIONS":m._setItems(e.sections);break;case"ITEM_UPDATED":m._update(e.props);break;case"ADD_FIELD":m._addField(e.name,e.fieldType,e.position,e.itemID);break;case"ADD_FIELD_COMPLETE":e.itemID&&m._setResourceSetID(e.itemID,e.fieldID),d=!1;break;case"ADD_RESOURCE":m._addResource(e.resource,e.resourceSetID);break;case"REMOVE_RESOURCE":m._removeResource(e.resourceID,e.resourceSetID);break;case"DELETE_ITEM":m._delete(e.id);break;case"DELETE_META":m._deleteMeta(e.id,e.itemID);break;case"DELETE_RESOURCESET":m._deleteResourceSet(e.id);break;case"MOVE_ITEM":m._moveItem(e.itemID,e.beforeItemID);break;case"MOVE_FIELD":m._moveMeta(e.fieldID,e.beforeFieldID,e.itemID,e.toMoveIsMeta,e.beforeIsMeta);break;case"ADD_ITEM_TO_EVENT":f=!1;break;case"LAUNCH_PLANNER":f=!f;var t=document.querySelector(".popup-background");OC.$.addClass(t,"show-popup-background"),OC.$.addListener(document,"keyup",m._hidePlanner),OC.$.addListener(t,"click",m._hidePlanner);break;default:return!0}return m.emitChange(),!0})});return m}),define("curriculumTextbooks",["curriculumAppDispatcher","events","deep_extend","immutable","curriculumSettings"],function(e,t,n,i,r){var s=t.EventEmitter,o=i.List(),a=null,u=n(s.prototype,{getTextbooks:function(){return o},getUnsavedTextbook:function(){return a},getTitleFromID:function(e){return textbook=o.find(function(t){return t.get("id")===e}),textbook?textbook.title:null},_addTextbook:function(e,t){var n={title:e,description:t};o=o.push(i.Map(n)),n.curriculum_id=r.getID(),a=n}});return e.register(function(e){switch(e.type){case"SET_TEXTBOOKS":o=e.textbooks;break;case"ADD_TEXTBOOK":u._addTextbook(e.title,e.description);break;default:return!0}return u.emitChange(),!0}),u}),define("curriculumUnits",["curriculumAppDispatcher","events","deep_extend","immutable","curriculumTextbooks","curriculumSettings"],function(e,t,n,i,r,s){var o=t.EventEmitter,a=i.List(),u=i.List(),c=null,l=null,d=null,p=null,h=n(o.prototype,{getUnits:function(){return a},getUnit:function(e){return a.find(function(t){return t.get("id")===e})},_addSection:function(e,t,n){var r,s=[];"contextual"===t&&(r=i.Map({description:e,issue:{id:null,host_id:null,message:null},meta:[],resource_sets:i.List(),parent:e,position:0,selected:!1}),s.push(r),c=r);var o=a.find(function(e){return e.id===n});newSection=i.Map({position:o.sections.max(function(e,t){return e.get("position")>t.get("position")}).get("position")+1,title:e,items:i.List(s),type:t}),a=a.update(a.indexOf(o),function(e){return e.sections=e.sections.push(newSection),e}),u=u.push(newSection)},_setSectionID:function(e,t){var n=a.find(function(t){return t.sections.contains(e)});a=a.update(a.indexOf(n),function(n){return n.sections.update(n.sections.indexOf(e),function(e){return e.set("id",t)}),n})},_setItemSectionID:function(e,t){e=e.set("sectionID",t)},_setUnitID:function(){},getUnsavedSection:function(){var e=u.last();return u.pop(),e},peekUnsavedSection:function(){return u.last()},getSectionItem:function(){return c},getToShift:function(){return l},getUnsavedUnit:function(){return d},isView:function(){return p},_deleteSection:function(e){var t,n=a.find(function(n){return n.sections?(t=n.sections.find(function(t){return t.get("id")===e}),void 0!==t):!1});a=a.update(a.indexOf(n),function(e){return e.sections=e.sections.delete(e.sections.indexOf(t)),e})},_moveSection:function(e,t){function n(e,t){return e.sections.find(function(e){return e.get("id")===t})}{var i,r,s,o={},u=a.find(function(t){return t.sections?(i=t.sections.find(function(t){return t.get("id")===e}),void 0!==i):!1});a.find(function(e){return e.sections?(r=e.sections.find(function(e){return e.get("id")===parseInt(t,10)}),void 0!==r):!1})}i.get("position")<r.get("position")?(s=u.sections.filter(function(e){return e.get("position")>i.get("position")&&e.get("position")<=r.get("position")}),a=a.update(a.indexOf(u),function(e){return e.sections=e.sections.withMutations(function(e){return s.forEach(function(t){e=e.update(e.indexOf(t),function(e){return e.set("position",e.get("position")-1)})}),e=e.update(e.indexOf(i),function(e){return e.set("position",r.get("position"))})}),e})):i.get("position")>r.get("position")&&(s=u.sections.filter(function(e){return e.get("position")<i.get("position")&&e.get("position")>=r.get("position")}),a=a.update(a.indexOf(u),function(e){return e.sections=e.sections.withMutations(function(e){return s.forEach(function(t){e=e.update(e.indexOf(t),function(e){return e.set("position",e.get("position")+1)})}),e=e.update(e.indexOf(i),function(e){return e.set("position",r.get("position"))})}),e}));var c,d;unit=a.find(function(e){return e.id===u.id}),s.forEach(function(e){d=unit.sections.indexOf(n(unit,e.get("id"))),-1!==d&&(c=unit.sections.get(d),o[c.get("id")]=c.get("position"))}),o[i.get("id")]=unit.sections.find(function(e){return e.get("id")===i.get("id")}).get("position"),l=o},_addUnit:function(e,t,n,i){{var o,u,c,l=new Date(s.getPeriods().start);new Date(s.getPeriods().end)}"weekly"===s.getPeriods().title?(u=(new Date(n)-l)/1e3/60/60/24,c=(new Date(i)-new Date(n))/1e3/60/60/24,o={type:"generic",begin:Math.round(u),end:Math.round(c+u),unit:"day",from:n,to:i}):o={position:_.max(this.props.units,function(e){return e.position}).position+1,type:"child",parent:this.props.settings.periods.data.indexOf(this.state.newUnitPeriod),unit:"equal"};var p={title:e,textbook:r.getTitleFromID(t),period:o},h={title:e,textbook_id:"number"==typeof t?t:null,period:o,curriculum_id:s.getID()};for(var f in o)h[f]=o[f],p[f]=o[f];delete h.period,delete p.period,a=a.push(p),d=h}});return e.register(function(e){switch(e.type){case"SET_UNITS":units=e.units,a=units;break;case"ADD_SECTION":h._addSection(e.name,e.sectionType,e.moduleID,e.isUnit);break;case"ADD_SECTION_COMPLETE":h._setSectionID(e.section,e.id);break;case"ADD_ITEM_POST":e.item.get("id")||h._setItemSectionID(e.item,e.sectionID);break;case"DELETE_SECTION":h._deleteSection(e.id);break;case"MOVE_SECTION":h._moveSection(e.sectionID,e.beforeSectionID);break;case"OPEN_UNITS":p=!0;break;case"OPEN_TEXTBOOKS":p=!1;break;case"ADD_UNIT":h._addUnit(e.name,e.textbook,e.from,e.to);break;case"ADD_UNIT_COMPLETE":h._setUnitID(e.id);break;default:return!0}return h.emitChange(),!0}),h}),define("curriculumPage",["curriculumAppDispatcher","curriculumItems","curriculumUnits","events","deep_extend","immutable"],function(e,t,n,i,r,s){var o=i.EventEmitter,a="change",u="overview",c=null,l=null,d="view",p=!1,h=!1,f=r(o.prototype,{emitChange:function(){this.emit(a)},addChangeListener:function(e){this.on(a,e)},removeChangeListener:function(e){this.removeListener(a,e)},resetNumWeeks:function(){units=n.getUnits();var e=units.max(function(e,t){return e.end>t.end}),t=units.min(function(e,t){return e.begin>t.begin}),i=e?e.end:null,r=t?t.begin:null;
c=null!==i&&null!==r?Math.ceil((i-r)/7):0},buildSections:function(e,t){unit=n.getUnit(e),unit.sections=s.List();var i,r;t.forEach(function(e){r=e.items.map(function(e){return e.id}),i=s.Map({id:e.id,position:e.position,title:e.title,items:r,type:e.type}),unit.sections=unit.sections.push(i)}),l=unit},getNumWeeks:function(){return c},getView:function(){return u},getUnit:function(){return l},getDrawerView:function(){return p},getAddBlockState:function(){return h},getUnitsMode:function(){return d}});return e.register(function(i){switch(i.type){case"SET_NUM_WEEKS":c=i.count;break;case"ADD_UNIT":e.waitFor([n.dispatchToken]),f.resetNumWeeks();break;case"OPEN_UNIT":l=i.unit,u=i.unit.hasOwnProperty("sections")?"unit":"loading";break;case"OPEN_SETTINGS":u="settings";break;case"OPEN_UNITS":u="units",d=i.mode;break;case"BUILD_SECTIONS":f.buildSections(i.unitID,i.sections),u="unit",e.waitFor([t.dispatchToken]);break;case"ADD_SECTION_POST":h=!1;break;case"OPEN_ITEM":p=!0;break;case"OPEN_OVERVIEW":u="overview",l=null;break;case"DIM":OC.$.addClass(document.querySelector(".popup-background"),"show-popup-background");break;case"BRIGHTEN":OC.$.removeClass(document.querySelector(".popup-background"),"show-popup-background");break;default:return!0}return f.emitChange(),!0}),f}),define("hogan",[],function(){var e={};return function(e){function t(e,t,n){var i;return t&&"object"==typeof t&&(null!=t[e]?i=t[e]:n&&t.get&&"function"==typeof t.get&&(i=t.get(e))),i}function n(e,t,n,i,r,s){function o(){}function a(){}o.prototype=e,a.prototype=e.subs;var u,c=new o;c.subs=new a,c.subsText={},c.buf="",i=i||{},c.stackSubs=i,c.subsText=s;for(u in t)i[u]||(i[u]=t[u]);for(u in i)c.subs[u]=i[u];r=r||{},c.stackPartials=r;for(u in n)r[u]||(r[u]=n[u]);for(u in r)c.partials[u]=r[u];return c}function i(e){return String(null===e||void 0===e?"":e)}function r(e){return e=i(e),l.test(e)?e.replace(s,"&amp;").replace(o,"&lt;").replace(a,"&gt;").replace(u,"&#39;").replace(c,"&quot;"):e}e.Template=function(e,t,n,i){e=e||{},this.r=e.code||this.r,this.c=n,this.options=i||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.buf=""},e.Template.prototype={r:function(){return""},v:r,t:i,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},ep:function(e,t){var i=this.partials[e],r=t[i.name];if(i.instance&&i.base==r)return i.instance;if("string"==typeof r){if(!this.c)throw new Error("No compiler available.");r=this.c.compile(r,this.options)}if(!r)return null;if(this.partials[e].base=r,i.subs){t.stackText||(t.stackText={});for(key in i.subs)t.stackText[key]||(t.stackText[key]=void 0!==this.activeSub&&t.stackText[this.activeSub]?t.stackText[this.activeSub]:this.text);r=n(r,i.subs,i.partials,this.stackSubs,this.stackPartials,t.stackText)}return this.partials[e].instance=r,r},rp:function(e,t,n,i){var r=this.ep(e,n);return r?r.ri(t,n,i):""},rs:function(e,t,n){var i=e[e.length-1];if(!d(i))return void n(e,t,this);for(var r=0;r<i.length;r++)e.push(i[r]),n(e,t,this),e.pop()},s:function(e,t,n,i,r,s,o){var a;return d(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ms(e,t,n,i,r,s,o)),a=!!e,!i&&a&&t&&t.push("object"==typeof e?e:t[t.length-1]),a)},d:function(e,n,i,r){var s,o=e.split("."),a=this.f(o[0],n,i,r),u=this.options.modelGet,c=null;if("."===e&&d(n[n.length-2]))a=n[n.length-1];else for(var l=1;l<o.length;l++)s=t(o[l],a,u),null!=s?(c=a,a=s):a="";return r&&!a?!1:(r||"function"!=typeof a||(n.push(c),a=this.mv(a,n,i),n.pop()),a)},f:function(e,n,i,r){for(var s=!1,o=null,a=!1,u=this.options.modelGet,c=n.length-1;c>=0;c--)if(o=n[c],s=t(e,o,u),null!=s){a=!0;break}return a?(r||"function"!=typeof s||(s=this.mv(s,n,i)),s):r?!1:""},ls:function(e,t,n,r,s){var o=this.options.delimiters;return this.options.delimiters=s,this.b(this.ct(i(e.call(t,r)),t,n)),this.options.delimiters=o,!1},ct:function(e,t,n){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(e,this.options).render(t,n)},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ms:function(e,t,n,i,r,s,o){var a,u=t[t.length-1],c=e.call(u);return"function"==typeof c?i?!0:(a=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(c,u,n,a.substring(r,s),o)):c},mv:function(e,t,n){var r=t[t.length-1],s=e.call(r);return"function"==typeof s?this.ct(i(s.call(r)),r,n):s},sub:function(e,t,n,i){var r=this.subs[e];r&&(this.activeSub=e,r(t,n,this,i),this.activeSub=!1)}};var s=/&/g,o=/</g,a=/>/g,u=/\'/g,c=/\"/g,l=/[&<>\"\']/,d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof exports?exports:e),function(e){function t(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function n(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function i(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var i=1,r=e.length;r>i;i++)if(t.charAt(n+i)!=e.charAt(i))return!1;return!0}function r(t,n,i,a){var u=[],c=null,l=null,d=null;for(l=i[i.length-1];t.length>0;){if(d=t.shift(),l&&"<"==l.tag&&!(d.tag in _))throw new Error("Illegal content in < super tag.");if(e.tags[d.tag]<=e.tags.$||s(d,a))i.push(d),d.nodes=r(t,d.tag,i,a);else{if("/"==d.tag){if(0===i.length)throw new Error("Closing tag without opener: /"+d.n);if(c=i.pop(),d.n!=c.n&&!o(d.n,c.n,a))throw new Error("Nesting error: "+c.n+" vs. "+d.n);return c.end=d.i,u}"\n"==d.tag&&(d.last=0==t.length||"\n"==t[0].tag)}u.push(d)}if(i.length>0)throw new Error("missing closing tag: "+i.pop().n);return u}function s(e,t){for(var n=0,i=t.length;i>n;n++)if(t[n].o==e.n)return e.tag="#",!0}function o(e,t,n){for(var i=0,r=n.length;r>i;i++)if(n[i].c==e&&n[i].o==t)return!0}function a(e){var t=[];for(var n in e)t.push('"'+c(n)+'": function(c,p,t,i) {'+e[n]+"}");return"{ "+t.join(",")+" }"}function u(e){var t=[];for(var n in e.partials)t.push('"'+c(n)+'":{name:"'+c(e.partials[n].name)+'", '+u(e.partials[n])+"}");return"partials: {"+t.join(",")+"}, subs: "+a(e.subs)}function c(e){return e.replace(y,"\\\\").replace(m,'\\"').replace(g,"\\n").replace(v,"\\r")}function l(e){return~e.indexOf(".")?"d":"f"}function d(e,t){var n="<"+(t.prefix||""),i=n+e.n+b++;return t.partials[i]={name:e.n,partials:{}},t.code+='t.b(t.rp("'+c(i)+'",c,p,"'+(e.indent||"")+'"));',i}function p(e,t){t.code+="t.b(t.t(t."+l(e.n)+'("'+c(e.n)+'",c,p,0)));'}function h(e){return"t.b("+e+");"}var f=/\S/,m=/\"/g,g=/\n/g,v=/\r/g,y=/\\/g;e.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},e.scan=function(r,s){function o(){y.length>0&&(_.push({tag:"_t",text:new String(y)}),y="")}function a(){for(var t=!0,n=w;n<_.length;n++)if(t=e.tags[_[n].tag]<e.tags._v||"_t"==_[n].tag&&null===_[n].text.match(f),!t)return!1;return t}function u(e,t){if(o(),e&&a())for(var n,i=w;i<_.length;i++)_[i].text&&((n=_[i+1])&&">"==n.tag&&(n.indent=_[i].text.toString()),_.splice(i,1));else t||_.push({tag:"\n"});b=!1,w=_.length}function c(e,t){var i="="+O,r=e.indexOf(i,t),s=n(e.substring(e.indexOf("=",t)+1,r)).split(" ");return k=s[0],O=s[s.length-1],r+i.length-1}var l=r.length,d=0,p=1,h=2,m=d,g=null,v=null,y="",_=[],b=!1,D=0,w=0,k="{{",O="}}";for(s&&(s=s.split(" "),k=s[0],O=s[1]),D=0;l>D;D++)m==d?i(k,r,D)?(--D,o(),m=p):"\n"==r.charAt(D)?u(b):y+=r.charAt(D):m==p?(D+=k.length-1,v=e.tags[r.charAt(D+1)],g=v?r.charAt(D+1):"_v","="==g?(D=c(r,D),m=d):(v&&D++,m=h),b=D):i(O,r,D)?(_.push({tag:g,n:n(y),otag:k,ctag:O,i:"/"==g?b-k.length:D+O.length}),y="",D+=O.length-1,m=d,"{"==g&&("}}"==O?D++:t(_[_.length-1]))):y+=r.charAt(D);return u(b,!0),_};var _={_t:!0,"\n":!0,$:!0,"/":!0};e.stringify=function(t){return"{code: function (c,p,i) { "+e.wrapMain(t.code)+" },"+u(t)+"}"};var b=0;e.generate=function(t,n,i){b=0;var r={code:"",subs:{},partials:{}};return e.walk(t,r),i.asString?this.stringify(r,n,i):this.makeTemplate(r,n,i)},e.wrapMain=function(e){return'var t=this;t.b(i=i||"");'+e+"return t.fl();"},e.template=e.Template,e.makeTemplate=function(e,t,n){var i=this.makePartials(e);return i.code=new Function("c","p","i",this.wrapMain(e.code)),new this.template(i,t,this,n)},e.makePartials=function(e){var t,n={subs:{},partials:e.partials,name:e.name};for(t in n.partials)n.partials[t]=this.makePartials(n.partials[t]);for(t in e.subs)n.subs[t]=new Function("c","p","t","i",e.subs[t]);return n},e.codegen={"#":function(t,n){n.code+="if(t.s(t."+l(t.n)+'("'+c(t.n)+'",c,p,1),c,p,0,'+t.i+","+t.end+',"'+t.otag+" "+t.ctag+'")){t.rs(c,p,function(c,p,t){',e.walk(t.nodes,n),n.code+="});c.pop();}"},"^":function(t,n){n.code+="if(!t.s(t."+l(t.n)+'("'+c(t.n)+'",c,p,1),c,p,1,0,0,"")){',e.walk(t.nodes,n),n.code+="};"},">":d,"<":function(t,n){var i={partials:{},code:"",subs:{},inPartial:!0};e.walk(t.nodes,i);var r=n.partials[d(t,n)];r.subs=i.subs,r.partials=i.partials},$:function(t,n){var i={subs:{},code:"",partials:n.partials,prefix:t.n};e.walk(t.nodes,i),n.subs[t.n]=i.code,n.inPartial||(n.code+='t.sub("'+c(t.n)+'",c,p,i);')},"\n":function(e,t){t.code+=h('"\\n"'+(e.last?"":" + i"))},_v:function(e,t){t.code+="t.b(t.v(t."+l(e.n)+'("'+c(e.n)+'",c,p,0)));'},_t:function(e,t){t.code+=h('"'+c(e.text)+'"')},"{":p,"&":p},e.walk=function(t,n){for(var i,r=0,s=t.length;s>r;r++)i=e.codegen[t[r].tag],i&&i(t[r],n);return n},e.parse=function(e,t,n){return n=n||{},r(e,"",[],n.sectionTags||[])},e.cache={},e.cacheKey=function(e,t){return[e,!!t.asString,!!t.disableLambda,t.delimiters,!!t.modelGet].join("||")},e.compile=function(t,n){n=n||{};var i=e.cacheKey(t,n),r=this.cache[i];if(r){var s=r.partials;for(var o in s)delete s[o].instance;return r}return r=this.generate(this.parse(this.scan(t,n.delimiters),t,n),t,n),this.cache[i]=r}}("undefined"!=typeof exports?exports:e),e}),define("curriculumUtils",["react","core_light","hogan"],function(e,t,n){var i;return{itemDraggable:function(e,n,i,r,s){var o=document.querySelector("."+i),a=document.querySelector(".movable-clones");a||(a=document.createElement("div"),a.className="movable-clones",document.body.insertBefore(a,document.body.firstChild)),t.$.addListener(e,"mousedown",function(u){function c(n){t.$.addClass(f,"draggable-shadow");var r=document.querySelector(".draggable-shadow");r.style.top=n.pageY+v-m+"px",r.style.left=n.pageX+y-g+20+"px",t.$.removeClass(o,"accepting"),b=t.$.parents(n.target,i),b&&(b.contains(e)||b&&t.$.addClass(b,"accepting"))}function l(){t.$.removeClass(f,"draggable-shadow"),D=document.querySelector("."+i+".accepting"),D&&s(D),f.parentNode.removeChild(f),w.removeEventListener("mousemove",c),w.removeEventListener("mouseup",l),t.$.removeClass(_,"accepting"),t.$.removeClass(o,"accepting")}var d=u.target,p=document.createElement("div");p.innerHTML=r,p.className="movable-clone",a.appendChild(p);var h=document.querySelectorAll(".movable-clones div.movable-clone"),f=h[h.length-1];f.style.top=d.offsetTop+"px",f.style.left=d.offsetLeft+"px",t.$.addClass(f,"float");var m=t.$.outerHeight(u.target),g=t.$.outerHeight(u.target),v=u.target.offsetTop+m-u.pageY,y=u.target.offsetLeft+g-u.pageX,_=t.$.parents(d,n);t.$.addClass(_,"accepting");var b,D,w=t.$.parents(u.target,"content-panel-wrapper");t.$.addListener(t.$.addListener(w,"mousemove",c),"mouseup",l),u.preventDefault()})},clearStatusFocus:function(){$(".light-popup-background").removeClass("show-popup-background")},metaTitles:{methodology:"Methodology",how:"The 'How'",wordwall:"Word Wall Must Haves",prerequisites:"Pre-requisites",ccss:"Common Core State Standards",content:"Standards for Mathematical Content",practices:"Standards for Mathematical Practice","big-idea":"Big Idea","essential-understandings":"Enduring Understandings","language-objectives-supports":"Language Objectives and Supports"},metaOrder:["methodology","how","wordwall","prerequisite"],suggestionTemplate:e.createClass({render:function(){return e.DOM.div({className:"explorer-suggest-resources-listing-item",id:"resource-"+this.props.id},[e.DOM.div({className:"explorer-suggest-resources-listing-item-thumbnail",style:{backgroundImage:"url('"+this.props.thumbnail+"')"}}),e.DOM.div({className:"explorer-suggest-resources-listing-item-content"},[e.DOM.a({className:"explorer-suggest-resources-listing-item-content-title",target:"_blank",href:this.props.url},this.props.title),e.DOM.div({className:"explorer-suggest-resources-listing-item-content"},this.props.description)]),e.DOM.div({className:"explorer-suggest-resources-listing-item-actions"},[e.DOM.button({className:"action-button explorer-suggest-resources-listing-item-action-keep"},"Keep"),e.DOM.button({className:"action-button secondary-button explorer-suggest-resources-listing-item-action-hide"},"Hide")])])}}),cachedResources:[],openResourcePreview:function(e,r,s,o,a){function u(){t.$.removeClass(document.querySelector(".popup-background"),"show-popup-background"),t.$.removeClass(p,"show")}function c(){require(["atomic"],function(n){n.get("/curriculum/api/favorite/"+e+"/").success(function(){t.$.toggleClass(h,"favorited")})})}function l(){h.removeEventListener("click",c),t.$.addListener(h,"click",c)}function d(e){document.querySelector(".explorer-resource-header-title").innerHTML=r,document.querySelector(".explorer-resource-header-thumbnail").style.backgroundImage="url('"+s+"')",document.querySelector(".explorer-resource-actions-open").href=o,f.innerHTML=e,t.$.addClass(f,"show"),t.$.addClass(document.querySelector(".explorer-resource-preview"),"show"),l()}var p=document.querySelector(".explorer-resource-preview-wrapper"),h=document.querySelector(".explorer-resource-actions-favorite"),f=document.querySelector(".explorer-resource-body");if(t.$.addClass(document.querySelector(".popup-background"),"show-popup-background"),t.$.addClass(p,"show"),i)i.spin(p);else{var m={lines:15,length:6,width:3,radius:8,corners:.9,rotate:75,direction:1,color:"#fff",speed:1,trail:79,shadow:!1,hwaccel:!1,className:"spinner",zIndex:12,top:"50%",left:"50%"};require(["spin"],function(e){i=new e(m).spin(p)});var g,v=document.querySelectorAll(".explorer-resource-actions div, a");for(g=0;g<v.length;g++)t.utils.tip(v[g])}f.innerHTML="";var y=n.compile('<div class="reference-preview-wrapper"><div class="reference-preview-thumbnail" style="background-image: url(\'{{thumbnail}}\');"></div><div class="reference-preview-contents"><h2>{{textbook_title}}</h2><h3>Chapter {{chapter}}: {{title}}</h3><h3>Section {{section}}</h3><p>No digital preview available.</p></div></div>'),b=n.compile('<div class="reference-preview-wrapper"><div class="reference-preview-thumbnail" style="background-image: url(\'{{thumbnail}}\');"></div><div class="reference-preview-contents"><h2>{{textbook_title}}</h2><h3>Pages: {{begin}} - {{end}}</h3><p>No digital preview available.</p></div></div>'),D=function(e){return excerpts=_.reduce(e.excerpts,function(e,t){return e?e+", "+t:t}),e._excerpts=excerpts,n.compile('<div class="reference-preview-wrapper"><div class="reference-preview-thumbnail" style="background-image: url(\'{{thumbnail}}\');"></div><div class="reference-preview-contents"><h2>{{textbook_title}}</h2><h3>{{_excerpts}}</h3><p>No digital preview available.</p></div></div>')(e)},w=(n.compile('<div class="reference-preview-wrapper"><div class="reference-preview-thumbnail" style="background-image: url(\'{{thumbnail}}\');"></div><div class="reference-preview-contents"><h2>{{textbook_title}}</h2><h3>{{excerpt}}</h3><p>No digital preview available.</p></div></div>'),document.querySelector(".explorer-resource-contents"));"reference"==a?require(["atomic"],function(n){n.get("/curriculum/api/reference/"+e+"/").success(function(e){i&&i.stop(),"chapter-section"==e.type&&d(y.render(e)),"pages"==e.type&&d(b.render(e)),"excerpts"==e.type&&d(D.render(e)),"excerpt"==e.type&&d(D.render(e)),t.$.removeClass(w,"foreign-resource"),t.$.addClass(w,"reference-resource")})}):require(["atomic"],function(n){n.get("/curriculum/api/resource-view/"+e+"/").success(function(e){i&&i.stop(),"pdf"==a&&(t.config.pdfjs=!0,t.$.addClass(f,"pdf")),t.$.removeClass(w,"reference-resource"),t.$.addClass(w,"foreign-resource"),d(e),"document"==a&&require(["mathjax"],function(e){e.Hub.Queue(["Typeset",e.Hub,"document-body"])})})});var k=document.querySelector(".explorer-resource-actions-close");k.removeEventListener("click",u),t.$.addListener(k,"click",u),t.$.addListener(document,"keyup",function(e){p.hasClass("show")&&27==e.which&&u()})}}}),define("curriculumItemView",["react","curriculumItems","curriculumActions","curriculumSettings","curriculumUtils"],function(e,t,n,i,r){var s=e.createClass({getInitialState:function(){return{selected:!1}},moveItemTo:function(e,i){n.moveItem(e,i),n.moveItemSave(t.getToShift())},componentDidMount:function(){var e=this,t=this.getDOMNode().querySelector(".explorer-resource-section-listing-item-handle");t&&r.itemDraggable(t,"explorer-resource-section-listing-items","explorer-resource-section-listing-item",this.props.model.get("description"),function(t){e.moveItemTo(e.props.model.get("id"),t.id.substring(5),e.props.collection)})},componentWillMount:function(){},toggleStatus:function(e){var t=$(e.target);this.props.model.set("statusPosition",{top:t.offset().top,left:t.offset().left+t.width()/2+7});var n=this.props;return n.model.set("statusShow",!n.model.get("statusShow")),n.model.get("statusShow")&&($("body").unbind("click"),$("body").click(function(e){"textarea"!==e.target.type&&n.model.set("statusShow",!1)})),e.stopPropagation(),!1},openDrawer:function(){n.openItem(this.props.model)},render:function(){return e.DOM.div({className:"explorer-resource-section-listing-item "+OC.config.palette.title+"-item"+(this.props.model.get("selected")?" selected":""),onClick:this.openDrawer,id:"item-"+this.props.model.get("id")},[e.DOM.div({className:"explorer-resource-section-listing-item-handle-wrapper"},i.getCanEdit()?e.DOM.div({className:"explorer-resource-section-listing-item-handle"},null):null),e.DOM.div({className:"explorer-resource-section-listing-item-content",key:1},[o({model:this.props.model,openDrawer:this.openDrawer,edit:this.props.edit})])])}}),o=e.createClass({save:function(e){newDescription=e.target.innerHTML,this.props.model.get("description")!==newDescription&&(OC.utils.status.saving(),item=this.props.model.set("description",newDescription),n.updateItem({id:item.get("id"),description:item.get("description")},function(){OC.utils.status.saved()}))},render:function(){return e.DOM.div({className:"explorer-resource-objective",contentEditable:i.getCanEdit()?!0:!1,title:this.props.model.get("description"),onBlur:this.save},this.props.model.get("description"))}});return s});var Showdown={extensions:{}},forEach=Showdown.forEach=function(e,t){if("function"==typeof e.forEach)e.forEach(t);else{var n,i=e.length;for(n=0;i>n;n++)t(e[n],n,e)}},stdExtName=function(e){return e.replace(/[_-]||\s/g,"").toLowerCase()};Showdown.converter=function(e){var t,n,i,r=0,s=[],o=[];if("undefind"!=typeof module&&"undefined"!=typeof exports&&"undefind"!=typeof require){var a=require("fs");if(a){var u=a.readdirSync((__dirname||".")+"/extensions").filter(function(e){return~e.indexOf(".js")}).map(function(e){return e.replace(/\.js$/,"")});Showdown.forEach(u,function(e){var t=stdExtName(e);Showdown.extensions[t]=require("./extensions/"+e)})}}if(this.makeHtml=function(e){return t={},n={},i=[],e=e.replace(/~/g,"~T"),e=e.replace(/\$/g,"~D"),e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n"),e="\n\n"+e+"\n\n",e=R(e),e=e.replace(/^[ \t]+$/gm,""),Showdown.forEach(s,function(t){e=d(t,e)}),e=S(e),e=h(e),e=p(e),e=m(e),e=F(e),e=e.replace(/~D/g,"$$"),e=e.replace(/~T/g,"~"),Showdown.forEach(o,function(t){e=d(t,e)}),e},e&&e.extensions){var c=this;Showdown.forEach(e.extensions,function(e){if("string"==typeof e&&(e=Showdown.extensions[stdExtName(e)]),"function"!=typeof e)throw"Extension '"+e+"' could not be loaded.  It was either not found or is not a valid extension.";Showdown.forEach(e(c),function(e){e.type?"language"===e.type||"lang"===e.type?s.push(e):("output"===e.type||"html"===e.type)&&o.push(e):o.push(e)})})}var l,d=function(e,t){if(e.regex){var n=new RegExp(e.regex,"g");return t.replace(n,e.replace)}return e.filter?e.filter(t):void 0},p=function(e){return e+="~0",e=e.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|(?=~0))/gm,function(e,i,r,s,o){return i=i.toLowerCase(),t[i]=A(r),s?s+o:(o&&(n[i]=o.replace(/"/g,"&quot;")),"")}),e=e.replace(/~0/,"")},h=function(e){e=e.replace(/\n/g,"\n\n");return e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,f),e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|style|section|header|footer|nav|article|aside)\b[^\r]*?<\/\2>[ \t]*(?=\n+)\n)/gm,f),e=e.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,f),e=e.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,f),e=e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,f),e=e.replace(/\n\n/g,"\n")},f=function(e,t){var n=t;return n=n.replace(/\n\n/g,"\n"),n=n.replace(/^\n/,""),n=n.replace(/\n+$/g,""),n="\n\n~K"+(i.push(n)-1)+"K\n\n"},m=function(e){e=w(e);var t=M("<hr />");return e=e.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,t),e=e.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,t),e=e.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,t),e=k(e),e=O(e),e=x(e),e=h(e),e=N(e)},g=function(e){return e=C(e),e=v(e),e=I(e),e=b(e),e=y(e),e=P(e),e=A(e),e=E(e),e=e.replace(/  +\n/g," <br />\n")},v=function(e){var t=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;return e=e.replace(t,function(e){var t=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return t=q(t,"\\`*_")})},y=function(e){return e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,_),e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?(?:\(.*?\).*?)?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,_),e=e.replace(/(\[([^\[\]]+)\])()()()()()/g,_)},_=function(e,i,r,s,o,a,u,c){void 0==c&&(c="");var l=i,d=r,p=s.toLowerCase(),h=o,f=c;if(""==h)if(""==p&&(p=d.toLowerCase().replace(/ ?\n/g," ")),h="#"+p,void 0!=t[p])h=t[p],void 0!=n[p]&&(f=n[p]);else{if(!(l.search(/\(\s*\)$/m)>-1))return l;h=""}h=q(h,"*_");var m='<a href="'+h+'"';return""!=f&&(f=f.replace(/"/g,"&quot;"),f=q(f,"*_"),m+=' title="'+f+'"'),m+=">"+d+"</a>"},b=function(e){return e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,D),e=e.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,D)},D=function(e,i,r,s,o,a,u,c){var l=i,d=r,p=s.toLowerCase(),h=o,f=c;if(f||(f=""),""==h){if(""==p&&(p=d.toLowerCase().replace(/ ?\n/g," ")),h="#"+p,void 0==t[p])return l;h=t[p],void 0!=n[p]&&(f=n[p])}d=d.replace(/"/g,"&quot;"),h=q(h,"*_");var m='<img src="'+h+'" alt="'+d+'"';return f=f.replace(/"/g,"&quot;"),f=q(f,"*_"),m+=' title="'+f+'"',m+=" />"},w=function(e){function t(e){return e.replace(/[^\w]/g,"").toLowerCase()}return e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,n){return M('<h1 id="'+t(n)+'">'+g(n)+"</h1>")}),e=e.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,n){return M('<h2 id="'+t(n)+'">'+g(n)+"</h2>")}),e=e.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,n,i){var r=n.length;return M("<h"+r+' id="'+t(i)+'">'+g(i)+"</h"+r+">")})},k=function(e){e+="~0";var t=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return r?e=e.replace(t,function(e,t,n){var i=t,r=n.search(/[*+-]/g)>-1?"ul":"ol";i=i.replace(/\n{2,}/g,"\n\n\n");var s=l(i);return s=s.replace(/\s+$/,""),s="<"+r+">"+s+"</"+r+">\n"}):(t=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,e=e.replace(t,function(e,t,n,i){var r=t,s=n,o=i.search(/[*+-]/g)>-1?"ul":"ol",s=s.replace(/\n{2,}/g,"\n\n\n"),a=l(s);return a=r+"<"+o+">\n"+a+"</"+o+">\n"})),e=e.replace(/~0/,"")};l=function(e){return r++,e=e.replace(/\n{2,}$/,"\n"),e+="~0",e=e.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(e,t,n,i,r){var s=r,o=t;return o||s.search(/\n{2,}/)>-1?s=m(U(s)):(s=k(U(s)),s=s.replace(/\n$/,""),s=g(s)),"<li>"+s+"</li>\n"}),e=e.replace(/~0/g,""),r--,e};var O=function(e){return e+="~0",e=e.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(e,t,n){var i=t,r=n;return i=T(U(i)),i=R(i),i=i.replace(/^\n+/g,""),i=i.replace(/\n+$/g,""),i="<pre><code>"+i+"\n</code></pre>",M(i)+r}),e=e.replace(/~0/,"")},S=function(e){return e+="~0",e=e.replace(/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g,function(e,t,n){var i=t,r=n;return r=T(r),r=R(r),r=r.replace(/^\n+/g,""),r=r.replace(/\n+$/g,""),r="<pre><code"+(i?' class="'+i+'"':"")+">"+r+"\n</code></pre>",M(r)}),e=e.replace(/~0/,"")},M=function(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(i.push(e)-1)+"K\n\n"},C=function(e){return e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,t,n,i){var r=i;return r=r.replace(/^([ \t]*)/g,""),r=r.replace(/[ \t]*$/g,""),r=T(r),t+"<code>"+r+"</code>"})},T=function(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=q(e,"*_{}[]\\",!1)},E=function(e){return e=e.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>"),e=e.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>")},x=function(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){var n=t;return n=n.replace(/^[ \t]*>[ \t]?/gm,"~0"),n=n.replace(/~0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=m(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /gm,"~0"),n=n.replace(/~0/g,"")}),M("<blockquote>\n"+n+"\n</blockquote>")})},N=function(e){e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,"");for(var t=e.split(/\n{2,}/g),n=[],r=t.length,s=0;r>s;s++){var o=t[s];o.search(/~K(\d+)K/g)>=0?n.push(o):o.search(/\S/)>=0&&(o=g(o),o=o.replace(/^([ \t]*)/g,"<p>"),o+="</p>",n.push(o))}r=n.length;for(var s=0;r>s;s++)for(;n[s].search(/~K(\d+)K/)>=0;){var a=i[RegExp.$1];a=a.replace(/\$/g,"$$$$"),n[s]=n[s].replace(/~K\d+K/,a)}return n.join("\n\n")},A=function(e){return e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?![a-z\/?\$!])/gi,"&lt;")},I=function(e){return e=e.replace(/\\(\\)/g,z),e=e.replace(/\\([`*_{}\[\]()>#+-.!])/g,z)},P=function(e){return e=e.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>'),e=e.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(e,t){return L(F(t))})},L=function(e){var t=[function(e){return"&#"+e.charCodeAt(0)+";"},function(e){return"&#x"+e.charCodeAt(0).toString(16)+";"},function(e){return e}];return e="mailto:"+e,e=e.replace(/./g,function(e){if("@"==e)e=t[Math.floor(2*Math.random())](e);else if(":"!=e){var n=Math.random();e=n>.9?t[2](e):n>.45?t[1](e):t[0](e)}return e}),e='<a href="'+e+'">'+e+"</a>",e=e.replace(/">.+:/g,'">')},F=function(e){return e=e.replace(/~E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)})},U=function(e){return e=e.replace(/^(\t|[ ]{1,4})/gm,"~0"),e=e.replace(/~0/g,"")},R=function(e){return e=e.replace(/\t(?=\t)/g,"    "),e=e.replace(/\t/g,"~A~B"),e=e.replace(/~B(.+?)~A/g,function(e,t){for(var n=t,i=4-n.length%4,r=0;i>r;r++)n+=" ";return n}),e=e.replace(/~A/g,"    "),e=e.replace(/~B/g,"")},q=function(e,t,n){var i="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(i="\\\\"+i);var r=new RegExp(i,"g");return e=e.replace(r,z)},z=function(e,t){var n=t.charCodeAt(0);return"~E"+n+"E"}},"undefined"!=typeof module&&(module.exports=Showdown),"function"==typeof define&&define.amd&&define("showdown",[],function(){return Showdown}),define("plannerStore",["curriculumAppDispatcher","events","deep_extend","immutable"],function(e,t,n,i){var r=t.EventEmitter,s="change",o=null,a=!1,u=i.Map(),c=null,l=n(r.prototype,{emitChange:function(){this.emit(s)},addChangeListener:function(e){this.on(s,e)},removeChangeListener:function(e){this.removeListener(s,e)},getSelectedDate:function(){return o},getSelectedEvent:function(){return c},getEventsFor:function(e){var t=u.get(e);return t?t:[]},hasPendingLoad:function(){return a===!0},dispatchToken:e.register(function(e){switch(e.type){case"SELECT_DATE":o=e.date,a=!0;break;case"SELECT_DATE_COMPLETE":u=u.set(e.date,e.response),a=!1;break;case"SELECT_PLANNER_EVENT":c=u.get(e.date).find(function(t){return t.id===e.id});break;case"CLEAR_EVENT_SELECTION":c=null;break;case"ITEM_ADDED_TO_EVENT":var t=c;require(["moment"],function(e){var n=e(t.start);OC.utils.messageBox.set("Added to '"+t.title+"' on "+n.format("dddd, MMMM Do YYYY [at] h:mma")),OC.utils.messageBox.show()}),c=null;break;default:return!0}return l.emitChange(),!0})});return l}),function(e){function t(e,t,n){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:n;default:throw new Error("Implement me")}}function n(e,t){return St.call(e,t)}function i(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function r(e){_t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function s(e,t){var n=!0;return p(function(){return n&&(r(e),n=!1),t.apply(this,arguments)},t)}function o(e,t){vn[e]||(r(t),vn[e]=!0)}function a(e,t){return function(n){return m(e.call(this,n),t)}}function u(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function c(){}function l(e,t){t!==!1&&N(e),h(this,e),this._d=new Date(+e._d)}function d(e){var t=O(e),n=t.year||0,i=t.quarter||0,r=t.month||0,s=t.week||0,o=t.day||0,a=t.hour||0,u=t.minute||0,c=t.second||0,l=t.millisecond||0;this._milliseconds=+l+1e3*c+6e4*u+36e5*a,this._days=+o+7*s,this._months=+r+3*i+12*n,this._data={},this._locale=_t.localeData(),this._bubble()}function p(e,t){for(var i in t)n(t,i)&&(e[i]=t[i]);return n(t,"toString")&&(e.toString=t.toString),n(t,"valueOf")&&(e.valueOf=t.valueOf),e}function h(e,t){var n,i,r;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=t._pf),"undefined"!=typeof t._locale&&(e._locale=t._locale),Pt.length>0)for(n in Pt)i=Pt[n],r=t[i],"undefined"!=typeof r&&(e[i]=r);return e}function f(e){return 0>e?Math.ceil(e):Math.floor(e)}function m(e,t,n){for(var i=""+Math.abs(e),r=e>=0;i.length<t;)i="0"+i;return(r?n?"+":"":"-")+i}function g(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function v(e,t){var n;return t=F(t,e),e.isBefore(t)?n=g(e,t):(n=g(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function y(e,t){return function(n,i){var r,s;return null===i||isNaN(+i)||(o(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=n,n=i,i=s),n="string"==typeof n?+n:n,r=_t.duration(n,i),_(this,r,e),this}}function _(e,t,n,i){var r=t._milliseconds,s=t._days,o=t._months;i=null==i?!0:i,r&&e._d.setTime(+e._d+r*n),s&&ht(e,"Date",pt(e,"Date")+s*n),o&&dt(e,pt(e,"Month")+o*n),i&&_t.updateOffset(e,s||o)}function b(e){return"[object Array]"===Object.prototype.toString.call(e)}function D(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function w(e,t,n){var i,r=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(i=0;r>i;i++)(n&&e[i]!==t[i]||!n&&M(e[i])!==M(t[i]))&&o++;return o+s}function k(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=ln[e]||dn[t]||t}return e}function O(e){var t,i,r={};for(i in e)n(e,i)&&(t=k(i),t&&(r[t]=e[i]));return r}function S(t){var n,i;if(0===t.indexOf("week"))n=7,i="day";else{if(0!==t.indexOf("month"))return;n=12,i="month"}_t[t]=function(r,s){var o,a,u=_t._locale[t],c=[];
if("number"==typeof r&&(s=r,r=e),a=function(e){var t=_t().utc().set(i,e);return u.call(_t._locale,t,r||"")},null!=s)return a(s);for(o=0;n>o;o++)c.push(a(o));return c}}function M(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function C(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function T(e,t,n){return at(_t([e,11,31+t-n]),t,n).week}function E(e){return x(e)?366:365}function x(e){return e%4===0&&e%100!==0||e%400===0}function N(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[Ct]<0||e._a[Ct]>11?Ct:e._a[Tt]<1||e._a[Tt]>C(e._a[Mt],e._a[Ct])?Tt:e._a[Et]<0||e._a[Et]>24||24===e._a[Et]&&(0!==e._a[xt]||0!==e._a[Nt]||0!==e._a[At])?Et:e._a[xt]<0||e._a[xt]>59?xt:e._a[Nt]<0||e._a[Nt]>59?Nt:e._a[At]<0||e._a[At]>999?At:-1,e._pf._overflowDayOfYear&&(Mt>t||t>Tt)&&(t=Tt),e._pf.overflow=t)}function A(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length&&t._pf.bigHour===e)),t._isValid}function I(e){return e?e.toLowerCase().replace("_","-"):e}function P(e){for(var t,n,i,r,s=0;s<e.length;){for(r=I(e[s]).split("-"),t=r.length,n=I(e[s+1]),n=n?n.split("-"):null;t>0;){if(i=L(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&w(r,n,!0)>=t-1)break;t--}s++}return null}function L(e){var t=null;if(!It[e]&&Lt)try{t=_t.locale(),require("./locale/"+e),_t.locale(t)}catch(n){}return It[e]}function F(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(_t.isMoment(e)||D(e)?+e:+_t(e))-+n,n._d.setTime(+n._d+i),_t.updateOffset(n,!1),n):_t(e).local()}function U(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function R(e){var t,n,i=e.match(qt);for(t=0,n=i.length;n>t;t++)i[t]=gn[i[t]]?gn[i[t]]:U(i[t]);return function(r){var s="";for(t=0;n>t;t++)s+=i[t]instanceof Function?i[t].call(r,e):i[t];return s}}function q(e,t){return e.isValid()?(t=z(t,e.localeData()),pn[t]||(pn[t]=R(t)),pn[t](e)):e.localeData().invalidDate()}function z(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(zt.lastIndex=0;i>=0&&zt.test(e);)e=e.replace(zt,n),zt.lastIndex=0,i-=1;return e}function Y(e,t){var n,i=t._strict;switch(e){case"Q":return Xt;case"DDDD":return Zt;case"YYYY":case"GGGG":case"gggg":return i?en:Ht;case"Y":case"G":case"g":return nn;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?tn:Wt;case"S":if(i)return Xt;case"SS":if(i)return Jt;case"SSS":if(i)return Zt;case"DDD":return $t;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return jt;case"a":case"A":return t._locale._meridiemParse;case"x":return Kt;case"X":return Qt;case"Z":case"ZZ":return Vt;case"T":return Gt;case"SSSS":return Bt;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?Jt:Yt;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Yt;case"Do":return i?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return n=new RegExp(Q(K(e.replace("\\","")),"i"))}}function $(e){e=e||"";var t=e.match(Vt)||[],n=t[t.length-1]||[],i=(n+"").match(un)||["-",0,0],r=+(60*i[1])+M(i[2]);return"+"===i[0]?-r:r}function H(e,t,n){var i,r=n._a;switch(e){case"Q":null!=t&&(r[Ct]=3*(M(t)-1));break;case"M":case"MM":null!=t&&(r[Ct]=M(t)-1);break;case"MMM":case"MMMM":i=n._locale.monthsParse(t,e,n._strict),null!=i?r[Ct]=i:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(r[Tt]=M(t));break;case"Do":null!=t&&(r[Tt]=M(parseInt(t.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=M(t));break;case"YY":r[Mt]=_t.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":r[Mt]=M(t);break;case"a":case"A":n._isPm=n._locale.isPM(t);break;case"h":case"hh":n._pf.bigHour=!0;case"H":case"HH":r[Et]=M(t);break;case"m":case"mm":r[xt]=M(t);break;case"s":case"ss":r[Nt]=M(t);break;case"S":case"SS":case"SSS":case"SSSS":r[At]=M(1e3*("0."+t));break;case"x":n._d=new Date(M(t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=$(t);break;case"dd":case"ddd":case"dddd":i=n._locale.weekdaysParse(t),null!=i?(n._w=n._w||{},n._w.d=i):n._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=M(t));break;case"gg":case"GG":n._w=n._w||{},n._w[e]=_t.parseTwoDigitYear(t)}}function W(e){var n,i,r,s,o,a,u;n=e._w,null!=n.GG||null!=n.W||null!=n.E?(o=1,a=4,i=t(n.GG,e._a[Mt],at(_t(),1,4).year),r=t(n.W,1),s=t(n.E,1)):(o=e._locale._week.dow,a=e._locale._week.doy,i=t(n.gg,e._a[Mt],at(_t(),o,a).year),r=t(n.w,1),null!=n.d?(s=n.d,o>s&&++r):s=null!=n.e?n.e+o:o),u=ut(i,r,s,a,o),e._a[Mt]=u.year,e._dayOfYear=u.dayOfYear}function B(e){var n,i,r,s,o=[];if(!e._d){for(r=V(e),e._w&&null==e._a[Tt]&&null==e._a[Ct]&&W(e),e._dayOfYear&&(s=t(e._a[Mt],r[Mt]),e._dayOfYear>E(s)&&(e._pf._overflowDayOfYear=!0),i=it(s,0,e._dayOfYear),e._a[Ct]=i.getUTCMonth(),e._a[Tt]=i.getUTCDate()),n=0;3>n&&null==e._a[n];++n)e._a[n]=o[n]=r[n];for(;7>n;n++)e._a[n]=o[n]=null==e._a[n]?2===n?1:0:e._a[n];24===e._a[Et]&&0===e._a[xt]&&0===e._a[Nt]&&0===e._a[At]&&(e._nextDay=!0,e._a[Et]=0),e._d=(e._useUTC?it:nt).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm),e._nextDay&&(e._a[Et]=24)}}function j(e){var t;e._d||(t=O(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],B(e))}function V(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function G(t){if(t._f===_t.ISO_8601)return void J(t);t._a=[],t._pf.empty=!0;var n,i,r,s,o,a=""+t._i,u=a.length,c=0;for(r=z(t._f,t._locale).match(qt)||[],n=0;n<r.length;n++)s=r[n],i=(a.match(Y(s,t))||[])[0],i&&(o=a.substr(0,a.indexOf(i)),o.length>0&&t._pf.unusedInput.push(o),a=a.slice(a.indexOf(i)+i.length),c+=i.length),gn[s]?(i?t._pf.empty=!1:t._pf.unusedTokens.push(s),H(s,i,t)):t._strict&&!i&&t._pf.unusedTokens.push(s);t._pf.charsLeftOver=u-c,a.length>0&&t._pf.unusedInput.push(a),t._pf.bigHour===!0&&t._a[Et]<=12&&(t._pf.bigHour=e),t._isPm&&t._a[Et]<12&&(t._a[Et]+=12),t._isPm===!1&&12===t._a[Et]&&(t._a[Et]=0),B(t),N(t)}function K(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r})}function Q(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function X(e){var t,n,r,s,o;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(s=0;s<e._f.length;s++)o=0,t=h({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._pf=i(),t._f=e._f[s],G(t),A(t)&&(o+=t._pf.charsLeftOver,o+=10*t._pf.unusedTokens.length,t._pf.score=o,(null==r||r>o)&&(r=o,n=t));p(e,n||t)}function J(e){var t,n,i=e._i,r=rn.exec(i);if(r){for(e._pf.iso=!0,t=0,n=on.length;n>t;t++)if(on[t][1].exec(i)){e._f=on[t][0]+(r[6]||" ");break}for(t=0,n=an.length;n>t;t++)if(an[t][1].exec(i)){e._f+=an[t][0];break}i.match(Vt)&&(e._f+="Z"),G(e)}else e._isValid=!1}function Z(e){J(e),e._isValid===!1&&(delete e._isValid,_t.createFromInputFallback(e))}function et(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function tt(t){var n,i=t._i;i===e?t._d=new Date:D(i)?t._d=new Date(+i):null!==(n=Ft.exec(i))?t._d=new Date(+n[1]):"string"==typeof i?Z(t):b(i)?(t._a=et(i.slice(0),function(e){return parseInt(e,10)}),B(t)):"object"==typeof i?j(t):"number"==typeof i?t._d=new Date(i):_t.createFromInputFallback(t)}function nt(e,t,n,i,r,s,o){var a=new Date(e,t,n,i,r,s,o);return 1970>e&&a.setFullYear(e),a}function it(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function rt(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function st(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function ot(e,t,n){var i=_t.duration(e).abs(),r=Ot(i.as("s")),s=Ot(i.as("m")),o=Ot(i.as("h")),a=Ot(i.as("d")),u=Ot(i.as("M")),c=Ot(i.as("y")),l=r<hn.s&&["s",r]||1===s&&["m"]||s<hn.m&&["mm",s]||1===o&&["h"]||o<hn.h&&["hh",o]||1===a&&["d"]||a<hn.d&&["dd",a]||1===u&&["M"]||u<hn.M&&["MM",u]||1===c&&["y"]||["yy",c];return l[2]=t,l[3]=+e>0,l[4]=n,st.apply({},l)}function at(e,t,n){var i,r=n-t,s=n-e.day();return s>r&&(s-=7),r-7>s&&(s+=7),i=_t(e).add(s,"d"),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function ut(e,t,n,i,r){var s,o,a=it(e,0,1).getUTCDay();return a=0===a?7:a,n=null!=n?n:r,s=r-a+(a>i?7:0)-(r>a?7:0),o=7*(t-1)+(n-r)+s+1,{year:o>0?e:e-1,dayOfYear:o>0?o:E(e-1)+o}}function ct(t){var n,i=t._i,r=t._f;return t._locale=t._locale||_t.localeData(t._l),null===i||r===e&&""===i?_t.invalid({nullInput:!0}):("string"==typeof i&&(t._i=i=t._locale.preparse(i)),_t.isMoment(i)?new l(i,!0):(r?b(r)?X(t):G(t):tt(t),n=new l(t),n._nextDay&&(n.add(1,"d"),n._nextDay=e),n))}function lt(e,t){var n,i;if(1===t.length&&b(t[0])&&(t=t[0]),!t.length)return _t();for(n=t[0],i=1;i<t.length;++i)t[i][e](n)&&(n=t[i]);return n}function dt(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),C(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function pt(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function ht(e,t,n){return"Month"===t?dt(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function ft(e,t){return function(n){return null!=n?(ht(this,e,n),_t.updateOffset(this,t),this):pt(this,e)}}function mt(e){return 400*e/146097}function gt(e){return 146097*e/400}function vt(e){_t.duration.fn[e]=function(){return this._data[e]}}function yt(e){"undefined"==typeof ender&&(bt=kt.moment,kt.moment=e?s("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",_t):_t)}for(var _t,bt,Dt,wt="2.8.4",kt="undefined"!=typeof global?global:this,Ot=Math.round,St=Object.prototype.hasOwnProperty,Mt=0,Ct=1,Tt=2,Et=3,xt=4,Nt=5,At=6,It={},Pt=[],Lt="undefined"!=typeof module&&module&&module.exports,Ft=/^\/?Date\((\-?\d+)/i,Ut=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Rt=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,qt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,zt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Yt=/\d\d?/,$t=/\d{1,3}/,Ht=/\d{1,4}/,Wt=/[+\-]?\d{1,6}/,Bt=/\d+/,jt=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Vt=/Z|[\+\-]\d\d:?\d\d/gi,Gt=/T/i,Kt=/[\+\-]?\d+/,Qt=/[\+\-]?\d+(\.\d{1,3})?/,Xt=/\d/,Jt=/\d\d/,Zt=/\d{3}/,en=/\d{4}/,tn=/[+-]?\d{6}/,nn=/[+-]?\d+/,rn=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,sn="YYYY-MM-DDTHH:mm:ssZ",on=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],an=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],un=/([\+\-]|\d\d)/gi,cn=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ln={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},dn={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},pn={},hn={s:45,m:45,h:22,d:26,M:11},fn="DDD w W M D d".split(" "),mn="M D H h m s w W".split(" "),gn={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return m(this.year()%100,2)},YYYY:function(){return m(this.year(),4)},YYYYY:function(){return m(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+m(Math.abs(e),6)},gg:function(){return m(this.weekYear()%100,2)},gggg:function(){return m(this.weekYear(),4)},ggggg:function(){return m(this.weekYear(),5)},GG:function(){return m(this.isoWeekYear()%100,2)},GGGG:function(){return m(this.isoWeekYear(),4)},GGGGG:function(){return m(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return M(this.milliseconds()/100)},SS:function(){return m(M(this.milliseconds()/10),2)},SSS:function(){return m(this.milliseconds(),3)},SSSS:function(){return m(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(M(e/60),2)+":"+m(M(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(M(e/60),2)+m(M(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},vn={},yn=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];fn.length;)Dt=fn.pop(),gn[Dt+"o"]=u(gn[Dt],Dt);for(;mn.length;)Dt=mn.pop(),gn[Dt+Dt]=a(gn[Dt],2);gn.DDDD=a(gn.DDD,3),p(c.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e,t,n){var i,r,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(r=_t.utc([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=_t([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,n){var i=this._calendar[e];return"function"==typeof i?i.apply(t,[n]):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,i):r.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return at(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),_t=function(t,n,r,s){var o;return"boolean"==typeof r&&(s=r,r=e),o={},o._isAMomentObject=!0,o._i=t,o._f=n,o._l=r,o._strict=s,o._isUTC=!1,o._pf=i(),ct(o)},_t.suppressDeprecationWarnings=!1,_t.createFromInputFallback=s("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),_t.min=function(){var e=[].slice.call(arguments,0);return lt("isBefore",e)},_t.max=function(){var e=[].slice.call(arguments,0);return lt("isAfter",e)},_t.utc=function(t,n,r,s){var o;return"boolean"==typeof r&&(s=r,r=e),o={},o._isAMomentObject=!0,o._useUTC=!0,o._isUTC=!0,o._l=r,o._i=t,o._f=n,o._strict=s,o._pf=i(),ct(o).utc()},_t.unix=function(e){return _t(1e3*e)},_t.duration=function(e,t){var i,r,s,o,a=e,u=null;return _t.isDuration(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(a={},t?a[t]=e:a.milliseconds=e):(u=Ut.exec(e))?(i="-"===u[1]?-1:1,a={y:0,d:M(u[Tt])*i,h:M(u[Et])*i,m:M(u[xt])*i,s:M(u[Nt])*i,ms:M(u[At])*i}):(u=Rt.exec(e))?(i="-"===u[1]?-1:1,s=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*i},a={y:s(u[2]),M:s(u[3]),d:s(u[4]),h:s(u[5]),m:s(u[6]),s:s(u[7]),w:s(u[8])}):"object"==typeof a&&("from"in a||"to"in a)&&(o=v(_t(a.from),_t(a.to)),a={},a.ms=o.milliseconds,a.M=o.months),r=new d(a),_t.isDuration(e)&&n(e,"_locale")&&(r._locale=e._locale),r},_t.version=wt,_t.defaultFormat=sn,_t.ISO_8601=function(){},_t.momentProperties=Pt,_t.updateOffset=function(){},_t.relativeTimeThreshold=function(t,n){return hn[t]===e?!1:n===e?hn[t]:(hn[t]=n,!0)},_t.lang=s("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return _t.locale(e,t)}),_t.locale=function(e,t){var n;return e&&(n="undefined"!=typeof t?_t.defineLocale(e,t):_t.localeData(e),n&&(_t.duration._locale=_t._locale=n)),_t._locale._abbr},_t.defineLocale=function(e,t){return null!==t?(t.abbr=e,It[e]||(It[e]=new c),It[e].set(t),_t.locale(e),It[e]):(delete It[e],null)},_t.langData=s("moment.langData is deprecated. Use moment.localeData instead.",function(e){return _t.localeData(e)}),_t.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return _t._locale;if(!b(e)){if(t=L(e))return t;e=[e]}return P(e)},_t.isMoment=function(e){return e instanceof l||null!=e&&n(e,"_isAMomentObject")},_t.isDuration=function(e){return e instanceof d};for(Dt=yn.length-1;Dt>=0;--Dt)S(yn[Dt]);_t.normalizeUnits=function(e){return k(e)},_t.invalid=function(e){var t=_t.utc(0/0);return null!=e?p(t._pf,e):t._pf.userInvalidated=!0,t},_t.parseZone=function(){return _t.apply(null,arguments).parseZone()},_t.parseTwoDigitYear=function(e){return M(e)+(M(e)>68?1900:2e3)},p(_t.fn=l.prototype,{clone:function(){return _t(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=_t(this).utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():q(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):q(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return A(this)},isDSTShifted:function(){return this._a?this.isValid()&&w(this._a,(this._isUTC?_t.utc(this._a):_t(this._a)).toArray())>0:!1},parsingFlags:function(){return p({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._dateTzOffset(),"m")),this},format:function(e){var t=q(this,e||_t.defaultFormat);return this.localeData().postformat(t)},add:y(1,"add"),subtract:y(-1,"subtract"),diff:function(e,t,n){var i,r,s,o=F(e,this),a=6e4*(this.zone()-o.zone());return t=k(t),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),s=this-_t(this).startOf("month")-(o-_t(o).startOf("month")),s-=6e4*(this.zone()-_t(this).startOf("month").zone()-(o.zone()-_t(o).startOf("month").zone())),r+=s/i,"year"===t&&(r/=12)):(i=this-o,r="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-a)/864e5:"week"===t?(i-a)/6048e5:i),n?r:f(r)},from:function(e,t){return _t.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(_t(),e)},calendar:function(e){var t=e||_t(),n=F(t,this).startOf("day"),i=this.diff(n,"days",!0),r=-6>i?"sameElse":-1>i?"lastWeek":0>i?"lastDay":1>i?"sameDay":2>i?"nextDay":7>i?"nextWeek":"sameElse";return this.format(this.localeData().calendar(r,this,_t(t)))},isLeapYear:function(){return x(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=rt(e,this.localeData()),this.add(e-t,"d")):t},month:ft("Month",!0),startOf:function(e){switch(e=k(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(t){return t=k(t),t===e||"millisecond"===t?this:this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")},isAfter:function(e,t){var n;return t=k("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=_t.isMoment(e)?e:_t(e),+this>+e):(n=_t.isMoment(e)?+e:+_t(e),n<+this.clone().startOf(t))},isBefore:function(e,t){var n;return t=k("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=_t.isMoment(e)?e:_t(e),+e>+this):(n=_t.isMoment(e)?+e:+_t(e),+this.clone().endOf(t)<n)},isSame:function(e,t){var n;return t=k(t||"millisecond"),"millisecond"===t?(e=_t.isMoment(e)?e:_t(e),+this===+e):(n=+_t(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))},min:s("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=_t.apply(null,arguments),this>e?this:e}),max:s("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=_t.apply(null,arguments),e>this?this:e}),zone:function(e,t){var n,i=this._offset||0;return null==e?this._isUTC?i:this._dateTzOffset():("string"==typeof e&&(e=$(e)),Math.abs(e)<16&&(e=60*e),!this._isUTC&&t&&(n=this._dateTzOffset()),this._offset=e,this._isUTC=!0,null!=n&&this.subtract(n,"m"),i!==e&&(!t||this._changeInProgress?_(this,_t.duration(i-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,_t.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?_t(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return C(this.year(),this.month())},dayOfYear:function(e){var t=Ot((_t(this).startOf("day")-_t(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=at(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=at(this,1,4).year;return null==e?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},isoWeek:function(e){var t=at(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return T(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return T(this.year(),e.dow,e.doy)},get:function(e){return e=k(e),this[e]()},set:function(e,t){return e=k(e),"function"==typeof this[e]&&this[e](t),this},locale:function(t){var n;return t===e?this._locale._abbr:(n=_t.localeData(t),null!=n&&(this._locale=n),this)},lang:s("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===e?this.localeData():this.locale(t)}),localeData:function(){return this._locale},_dateTzOffset:function(){return 15*Math.round(this._d.getTimezoneOffset()/15)}}),_t.fn.millisecond=_t.fn.milliseconds=ft("Milliseconds",!1),_t.fn.second=_t.fn.seconds=ft("Seconds",!1),_t.fn.minute=_t.fn.minutes=ft("Minutes",!1),_t.fn.hour=_t.fn.hours=ft("Hours",!0),_t.fn.date=ft("Date",!0),_t.fn.dates=s("dates accessor is deprecated. Use date instead.",ft("Date",!0)),_t.fn.year=ft("FullYear",!0),_t.fn.years=s("years accessor is deprecated. Use year instead.",ft("FullYear",!0)),_t.fn.days=_t.fn.day,_t.fn.months=_t.fn.month,_t.fn.weeks=_t.fn.week,_t.fn.isoWeeks=_t.fn.isoWeek,_t.fn.quarters=_t.fn.quarter,_t.fn.toJSON=_t.fn.toISOString,p(_t.duration.fn=d.prototype,{_bubble:function(){var e,t,n,i=this._milliseconds,r=this._days,s=this._months,o=this._data,a=0;o.milliseconds=i%1e3,e=f(i/1e3),o.seconds=e%60,t=f(e/60),o.minutes=t%60,n=f(t/60),o.hours=n%24,r+=f(n/24),a=f(mt(r)),r-=f(gt(a)),s+=f(r/30),r%=30,a+=f(s/12),s%=12,o.days=r,o.months=s,o.years=a},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return f(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*M(this._months/12)},humanize:function(e){var t=ot(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,t){var n=_t.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=_t.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=k(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;if(e=k(e),"month"===e||"year"===e)return t=this._days+this._milliseconds/864e5,n=this._months+12*mt(t),"month"===e?n:n/12;switch(t=this._days+Math.round(gt(this._months/12)),e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return 24*t+this._milliseconds/36e5;case"minute":return 24*t*60+this._milliseconds/6e4;case"second":return 24*t*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*t*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:_t.fn.lang,locale:_t.fn.locale,toIsoString:s("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),i=Math.abs(this.hours()),r=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(i||r||s?"T":"")+(i?i+"H":"")+(r?r+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale}}),_t.duration.fn.toString=_t.duration.fn.toISOString;for(Dt in cn)n(cn,Dt)&&vt(Dt.toLowerCase());_t.duration.fn.asMilliseconds=function(){return this.as("ms")},_t.duration.fn.asSeconds=function(){return this.as("s")},_t.duration.fn.asMinutes=function(){return this.as("m")},_t.duration.fn.asHours=function(){return this.as("h")},_t.duration.fn.asDays=function(){return this.as("d")},_t.duration.fn.asWeeks=function(){return this.as("weeks")},_t.duration.fn.asMonths=function(){return this.as("M")},_t.duration.fn.asYears=function(){return this.as("y")},_t.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===M(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),Lt?module.exports=_t:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(kt.moment=bt),_t}),yt(!0)):yt()}.call(this),define("plannerWidget",["react","plannerStore","moment"],function(e,t,n){var i={},r=function(e,t){return i=t,c(e)},s=function(e,t){return i=t,o(e)},o=e.createClass({componentDidMount:function(){t.on("change",this._onChange)},componentWillUnmount:function(){t.removeListener("change",this._onChange)},_onChange:function(){var e=t.getSelectedDate();this.setState({selectedDate:e,events:t.getEventsFor(e),selectedEvent:t.getSelectedEvent()}),t.hasPendingLoad()?this.load():this.turnOffLoad()},getInitialState:function(){return{day:n(),events:[],selectedDate:t.getSelectedDate(),selectedEvent:t.getSelectedEvent()}},load:function(){function e(e){require(["spin"],function(n){OC.hasOwnProperty("plannerSpinner")?OC.plannerSpinner.spin(t):OC.plannerSpinner=new n(OC.spinner.options).spin(t),e()})}var t=this.getDOMNode().querySelector(".ajax-loader");e(function(){OC.hasOwnProperty("plannerSpinner")&&OC.plannerSpinner.spin(t)})},turnOffLoad:function(){OC.hasOwnProperty("plannerSpinner")&&OC.plannerSpinner.stop()},renderDates:function(){var e,t,i=[],r=n(this.state.day).date(1),s=r.day();for(r.subtract(s,"d"),e=s;e>0;e--)i.push(a({isSibling:!0,date:r.date(),fulldate:r.format(),isSelected:this.state.selectedDate===r.format()})),r.add(1,"d");var o=n(this.state.day).endOf("month"),u=o.date(),c=n(),l=!1;for(o.date(0),t=1;u>=t;t++)l=o.isSame(c,"month")&&c.date()===t?!0:!1,o.add(1,"d"),i.push(a({date:o.date(),isToday:l,fulldate:o.format(),isSelected:this.state.selectedDate===o.format()}));for(lastDayOfMonth=o.day(),k=0;6-lastDayOfMonth>k;k++)o.add(1,"d"),i.push(a({isSibling:!0,date:o.date(),fulldate:o.format(),isSelected:this.state.selectedDate===o.format()}));return i},back:function(){this.setState({day:this.state.day.subtract(1,"M")})},forward:function(){this.setState({day:this.state.day.add(1,"M")})
},cancelEventSelection:function(){i.cancelEventSelect()},confirmEventSelection:function(){i.confirmEventSelect(this.props.itemID,this.state.selectedEvent.id)},renderEvent:function(e){var t={event:e};return this.state.selectedEvent||(t.selected=!1),u(t)},renderDays:function(){return[e.DOM.div({className:"calendar-body-days-day"},"S"),e.DOM.div({className:"calendar-body-days-day"},"M"),e.DOM.div({className:"calendar-body-days-day"},"T"),e.DOM.div({className:"calendar-body-days-day"},"W"),e.DOM.div({className:"calendar-body-days-day"},"T"),e.DOM.div({className:"calendar-body-days-day"},"F"),e.DOM.div({className:"calendar-body-days-day"},"S")]},render:function(){return e.DOM.div({className:"planner-menu-body"},[e.DOM.div({className:"planner-menu-calendar"},[e.DOM.div({className:"calendar-header"},[e.DOM.div({className:"calendar-header-previous",onClick:this.back},e.DOM.span({className:"calendar-header-previous-arrow"})),e.DOM.div({className:"calendar-header-month"},this.state.day.format("MMMM YY")),e.DOM.div({className:"calendar-header-next",onClick:this.forward},e.DOM.span({className:"calendar-header-next-arrow"}))]),e.DOM.div({className:"calendar-body"},[e.DOM.div({className:"calendar-body-days"},this.renderDays()),e.DOM.div({className:"calendar-body-dates"},this.renderDates())])]),e.DOM.div({className:"planner-menu-events"},[this.state.events.length>0?e.DOM.div({className:"planner-menu-events-list"},this.state.events.map(this.renderEvent)):null,this.state.selectedEvent?e.DOM.div({className:"planner-menu-events-actions"},[e.DOM.div({className:"planner-menu-events-actions-buttons  popup-buttons"},[e.DOM.div({className:"planner-menu-events-actions-button popup-button secondary-popup-button",onClick:this.cancelEventSelection},"Cancel"),e.DOM.div({className:"planner-menu-events-actions-button popup-button",style:{color:OC.config.palette.base},onClick:this.confirmEventSelection},"Confirm")])]):null,e.DOM.div({className:"ajax-loader-wrapper"},e.DOM.div({className:"ajax-loader"}))])])}}),a=e.createClass({getInitialProps:function(){return{isSibling:!1,isToday:!1}},getInitialState:function(){return{isSelected:this.props.isSelected}},select:function(){i.dateSelect(this.props.fulldate),this.setState({isSelected:!0})},componentWillReceiveProps:function(e){e.isSelected!==this.state.isSelected&&this.setState({isSelected:e.isSelected})},render:function(){return e.DOM.div({className:"calendar-body-dates-date"+(this.props.isSibling?" sibling-month-date":"")+(this.props.isToday?" today":"")+(this.state.isSelected?" selected":""),onClick:this.select},this.props.date)}}),u=e.createClass({getInitialState:function(){return{selected:!1}},componentWillReceiveProps:function(e){e.hasOwnProperty("selected")&&e.selected!==this.props.selected&&this.setState({selected:e.selected})},select:function(){this.setState({selected:!this.state.selected},function(){this.state.selected?i.eventSelect(this.props.event.id,this.props.event.date):i.cancelEventSelect()})},render:function(){return e.DOM.div({className:"planner-menu-event "+OC.config.palette.title+"-planner-event"+(this.state.selected?" selected":""),onClick:this.select},[e.DOM.div({className:"planner-menu-event-title"},this.props.event.title),e.DOM.div({},[e.DOM.span({className:"planner-menu-event-time"},n(this.props.event.start).format("h:mma")+" - "+n(this.props.event.end).format("h:mma")+" "),e.DOM.a({className:"planner-menu-event-view",href:this.props.event.url},"View event")])])}}),c=e.createClass({render:function(){return e.DOM.nav({className:"oc-menu planner-menu"+(this.props.open?" show-menu":"")},[e.DOM.div({className:"floating-menu-spacer"},null),e.DOM.div({className:"menu-body"},[e.DOM.div({className:"planner-menu-body-wrapper"},o({itemID:this.props.id}))])])}});return{Widget:r,Calendar:s}}),define("curriculumContextView",["react","curriculumActions","curriculumSettings","curriculumUtils","immutable","showdown","curriculumItems","plannerStore","plannerWidget"],function(e,t,n,i,r,s,o,a,u){var c=e.createClass({componentDidMount:function(){function e(){n.style.height=parseInt(OC.$.css(r.getDOMNode(),"height"),10)-parseInt(OC.$.css(t,"height"),10)-2*parseInt(OC.$.css(t,"paddingTop"),10)-parseInt(OC.$.css(i,"height"),10)-parseInt(OC.$.css(n,"paddingTop"),10)-4*parseInt(OC.$.css(document.querySelector(".explorer-resource-module-main"),"marginTop"),10)+"px"}var t=this.getDOMNode().querySelector(".explorer-resource-module-support-title"),n=this.getDOMNode().querySelector(".explorer-resource-module-support-contents"),i=this.getDOMNode().querySelector(".explorer-resource-module-support-pre"),r=this;e(),window.addEventListener("resize",e),o.on("change",this._onChange),OC.utils.tip(this.refs.addToPlanner.getDOMNode()),this.refs.delete&&OC.utils.tip(this.refs.delete.getDOMNode());OC.utils.menu(this.getDOMNode().querySelector("nav.planner-menu"),this.refs.addToPlanner.getDOMNode(),!0)},getInitialState:function(){return{addFieldState:o.getFieldState(),newFieldName:null,newFieldType:"text",item:o.get(this.props.itemID),showPlanner:o.getShowPlanner()}},componentWillUnmount:function(){o.removeListener("change",this._onChange)},_onChange:function(){this.setState({addFieldState:o.getFieldState(),item:o.getSelected(),showPlanner:o.getShowPlanner()})},deleteItem:function(){t.deleteItem(this.props.itemID)},moveMetaTo:function(e,n,i,r,s,a){t.moveField(e,parseInt(n,10),this.state.item.get("id"),s,a?!0:!1),t.moveFieldSave(this.state.item.get("id"),o.getMetaToShift())},makeDraggable:function(e,t,n,r){function s(t,n,i){var s=OC.$.parents(e,"explorer-resource-module-support-section");r?s.id="meta-"+t:s.attr.id="resources-"+t,i.id=-1!==i.id.indexOf("meta")?"meta-"+n:"resources-"+n}var o,a=this;i.itemDraggable(e,"explorer-resource-module-support-body","explorer-resource-module-support-section",t,function(e){-1!==e.id.indexOf("meta")?a.moveMetaTo(n,e.id.substring(5),a.props.item,null,r,!0,s,e):(o=e.id.substring(10),a.moveMetaTo(n,o,a.props.item,null,r,!1,s,e)),a.forceUpdate()})},renderSections:function(){var e=(this.props,this),t=this.state.item.get("meta").length;if(t>0||this.state.item.get("resource_sets").length>0){var n=this.state.item.get("meta").concat(this.state.item.get("resource_sets")).map(function(t,n){return t.hasOwnProperty("slug")?{key:t.slug,index:n,title:t.hasOwnProperty("title")?t.title:"(Unnamed)",body:t.body,item:e.state.item,position:t.position,makeDraggable:e.makeDraggable}:{key:t.id?t.id:0,id:t.id,collection:t.resources,title:t.title,item:e.state.item,parent:e.state.item.get("parent"),position:t.position,makeDraggable:e.makeDraggable}});return n.sort(function(e,t){return e.position-t.position}).map(function(e){return e.hasOwnProperty("index")?l(e):d(e)})}return null},addField:function(){this.setState({addFieldState:!0},function(){this.refs.newFieldInput.getDOMNode().focus()})},cancelAddField:function(){this.setState({addFieldState:!1})},completeAddField:function(){var e=OC.$.max(this.state.item.get("resource_sets").concat(this.state.item.get("meta")),function(e){return e.position}).position,n=this;t.addField(this.state.newFieldName,this.state.newFieldType,e+1,this.state.item.get("id")),t.addFieldPost(o.get(n.state.item.get("id")),o.getUnsavedField(n.state.item.get("id")),function(e,i){"resources"===n.state.newFieldType?t.addFieldComplete(e,i):t.addFieldComplete()})},updateNewFieldTitle:function(e){this.setState({newFieldName:e.target.value})},updateNewFieldType:function(e){this.setState({newFieldType:e.target.value})},togglePlanner:function(){t.launchPlanner()},render:function(){var i=e.DOM.div({className:"explorer-resource-add-field"},[e.DOM.div({className:"explorer-resource-add-field-title",key:0},"New field"),e.DOM.div({className:"explorer-resource-add-field-name-wrapper",key:1},e.DOM.input({className:"explorer-resource-add-field-name",ref:"newFieldInput",type:"text",placeholder:"Name",onBlur:this.updateNewFieldTitle})),e.DOM.select({className:"explorer-resource-add-field-type",key:2,placeholder:"Type",onBlur:this.updateNewFieldType},[e.DOM.option({key:0,value:"text"},"Text"),e.DOM.option({key:1,value:"resources"},"Resources"),e.DOM.option({key:2,value:"standards"},"Standards")]),e.DOM.div({className:"explorer-resource-add-field-actions",key:3},[e.DOM.button({className:"explorer-dull-button explorer-resource-add-section-action-cancel",onClick:this.cancelAddField},"Cancel"),e.DOM.button({className:"explorer-button",onClick:this.completeAddField},"Finish")])]);return e.DOM.div({className:"explorer-resource-module-support-body pseudo-card",style:{height:"100%"}},this.state.item?[e.DOM.div({className:"explorer-resource-module-support-pre card-toolbar",style:{backgroundColor:OC.config.palette.dark}},[e.DOM.div({className:"explorer-resource-module-support-pre-planner "+OC.config.palette.title+"-button",ref:"addToPlanner",title:"Add to Planner",onClick:this.togglePlanner}),u.Widget({open:this.state.showPlanner,id:this.state.item.get("id")},{cancelEventSelect:function(){t.clearEventSelection()},confirmEventSelect:function(e,n){t.confirmAddItemToEvent(e,n),t.brighten()},dateSelect:function(e){t.selectDate(e)},eventSelect:function(e,n){t.selectPlannerEvent(e,n)}}),n.getCanEdit()?e.DOM.div({className:"explorer-resource-module-support-delete "+OC.config.palette.title+"-button",ref:"delete",title:"Delete",onClick:this.deleteItem}):null]),e.DOM.div({className:"explorer-resource-module-support-title",style:{backgroundColor:OC.config.palette.base},key:0},this.state.item.get("description")),e.DOM.div({className:"explorer-resource-module-support-contents"},[e.DOM.div({className:"explorer-resource-module-support-sections",key:1},this.renderSections()),n.getCanEdit()?this.state.addFieldState?i:e.DOM.div({className:"explorer-resource-module-support-new-field",onClick:this.addField,key:3},"+ ADD FIELD"):null])]:null)}}),l=e.createClass({getInitialState:function(){return{body:this.props.body,showMenu:!1}},componentDidMount:function(){function e(){this.textContent?this.setAttribute("data-div-placeholder-content","true"):this.removeAttribute("data-div-placeholder-content")}var t=this,i=["change keydown keypress input"];i.forEach(function(n){OC.$.addListener(t.getDOMNode().querySelector("*[data-placeholder]"),n,e)});var r=this.getDOMNode().querySelector(".explorer-resource-module-support-section-handle");if(r&&this.props.makeDraggable(r,this.props.title,this.props.index,!0),n.getCanEdit()){var s=this.refs.actions.getDOMNode();OC.$.addClass(s,"show");var o=OC.utils.menu(this.getDOMNode().querySelector("nav.field-menu"),s);OC.$.removeClass(s,"show"),this.setState({menuPosition:o})}},componentWillReceiveProps:function(e){this.setState({body:e.body})},componentDidUpdate:function(){},save:function(e){if(newValue=e.target.innerHTML,currentMetas=this.props.item.get("meta"),this.setState({body:newValue}),currentMetas[this.props.key]!==newValue){OC.utils.status.saving();var n;for(n=0;n<currentMetas.length;n++)currentMetas[n].slug===this.props.key&&(currentMetas[n].body=newValue);t.updateItem({id:this.props.item.get("id"),meta:currentMetas},function(){OC.utils.status.saved()})}},toggleMenu:function(){this.state.showMenu||this.state.menuPosition.reset(),this.setState({showMenu:!this.state.showMenu},function(){if(this.state.showMenu){var e=this,t=document.querySelector("body");t.addEventListener("click",function n(i){e.getDOMNode()===i.target||e.getDOMNode().contains(i.target)||(e.setState({showMenu:!1}),t.removeEventListener("click",n))})}})},renderStandard:function(t){return e.DOM.div({className:"explorer-resource-module-support-section-body-field-snippet"},[e.DOM.span({className:"explorer-resource-module-support-section-body-standard"},t.title),e.DOM.span({},": "+t.description)])},render:function(){var t,i=null!==this.state.body&&"object"==typeof this.state.body&&"standards"==this.state.body.type,r=null!==this.state.body&&"object"==typeof this.state.body&&this.state.body.hideTitle;if(i)t=e.DOM.div({className:"explorer-resource-module-support-section-body"},this.state.body.standards.map(this.renderStandard));else{var o=new s.converter,a=r?this.state.body.body:this.state.body;t=e.DOM.div({className:"explorer-resource-module-support-section-body",contentEditable:n.getCanEdit()?!0:!1,onBlur:this.save,"data-placeholder":a&&a.length>0?"":"(add something)",dangerouslySetInnerHTML:{__html:o.makeHtml(a&&a.length>0?o.makeHtml(a):"")},key:1})}return e.DOM.div({className:"explorer-resource-module-support-section explorer-resource-module-support-section-"+this.props.key,id:"meta-"+this.props.index},[e.DOM.div({className:"explorer-resource-module-support-section-handle-wrapper"},n.getCanEdit()?e.DOM.div({className:"explorer-resource-module-support-section-handle"},null):null),r?null:e.DOM.div({className:"explorer-resource-module-support-section-title-wrapper"},e.DOM.div({className:"explorer-resource-module-support-section-title",key:0},this.props.title),t),n.getCanEdit()?e.DOM.div({className:"explorer-resource-module-support-section-actions",onClick:this.toggleMenu,ref:"actions"},null):null,n.getCanEdit()?p({open:this.state.showMenu,id:this.props.index,itemID:this.props.item.get("id"),meta:!0}):null])}}),d=e.createClass({getInitialState:function(){return{showMenu:!1}},_forceUpdate:function(){this.forceUpdate()},componentDidMount:function(){var e=this.getDOMNode().querySelector(".explorer-resource-module-support-section-handle");if(e&&this.props.makeDraggable(e,this.props.title?this.props.title:"Resources",this.props.id,!1),n.getCanEdit()){var t=this.refs.actions.getDOMNode();OC.$.addClass(t,"show");var i=OC.utils.menu(this.getDOMNode().querySelector("nav.field-menu"),t);OC.$.removeClass(t,"show"),this.setState({menuPosition:i})}},componentWillMount:function(){},addResource:function(){var e=this;OC.utils.post({title:"Add a resource",message:"What would you like to add?",postTitle:"Add and finish",urlTitle:"Add a website URL",addMeta:!1,sent:e.resourceSent,callback:e.resourceAdded,urlPostURL:"/curriculum/api/section-item-resources/add-url/",existingPostURL:"/curriculum/api/section-item-resources/add-existing/",uploadPostURL:"/curriculum/api/section-item-resources/add-upload/",toAppendFormData:{section_item_id:this.props.item.get("id"),section_item_resources_id:this.props.id}})},resourceAdded:function(e,t){t.set(e.resource),OC.utils.status.saved()},resourceSent:function(e){OC.utils.status.saving();var n=r.Map(e);return t.addResource(n,this.props.id),n},suggest:function(){var e=this;suggestionsPopup=OC.customPopup(".explorer-suggest-resources-dialog");var t=$(".explorer-suggest-resources-body",suggestionsPopup.dialog),n=$(".explorer-suggest-resources-listing",t);n.removeClass("failure"),t.addClass("loading"),$.get("/curriculum/api/section-item/"+this.props.item.get("id")+"/suggest-resources/",function(i){if(n.html(""),"false"===i.status)n.addClass("failure"),n.html(i.message);else{OC.explorer.cachedResources=_.union(OC.explorer.cachedResources,i.resources);var r;_.each(i.resources,function(e){r=OC.explorer.suggestionTemplate(e),n.append(r)}),appendedResources=$(".explorer-suggest-resources-listing-item",n),$(".explorer-suggest-resources-listing-item-action-keep",appendedResources).click(e.keepResource),$(".explorer-suggest-resources-listing-item-action-hide",appendedResources).click(function(e){$(e.target).parents(".explorer-suggest-resources-listing-item").fadeOut("show")})}t.removeClass("loading")},"json")},keepResource:function(e){var t=$(e.target).parents(".explorer-suggest-resources-listing-item");resourceID=t.attr("id").substring(9);var n=(OC.explorer.cachedResources[resourceID],this),i={objective_id:this.props.id,resource_collection_ID:resourceID};$.post("/curriculum/api/section-item-resources/add-existing/",i,function(e){var t=new OC.explorer.Resource(e.resource);n.props.item.get("resources").push(t)},"json"),t.fadeOut("fast")},renderResource:function(e){return ResourceView({model:e,resourceSetID:this.props.id,key:e.get("id")})},toggleMenu:function(){this.state.showMenu||this.state.menuPosition.reset(),this.setState({showMenu:!this.state.showMenu},function(){if(this.state.showMenu){var e=this,t=document.querySelector("body");t.addEventListener("click",function n(i){e.getDOMNode()===i.target||e.getDOMNode().contains(i.target)||(e.setState({showMenu:!1}),t.removeEventListener("click",n))})}})},render:function(){return e.DOM.div({className:"explorer-resource-module-support-section explorer-resource-module-support-section-resources",id:"resources-"+this.props.id},[e.DOM.div({className:"explorer-resource-module-support-section-handle-wrapper"},n.getCanEdit()?e.DOM.div({className:"explorer-resource-module-support-section-handle"},null):null),e.DOM.div({className:"explorer-resource-module-support-section-title-wrapper"},e.DOM.div({className:"explorer-resource-module-support-section-title",key:0},this.props.title?this.props.title:"Resources")),n.getCanEdit()?e.DOM.div({className:"explorer-resource-module-support-section-actions",onClick:this.toggleMenu,ref:"actions"},null):null,n.getCanEdit()?p({open:this.state.showMenu,id:this.props.id,meta:!1}):null,this.props.collection.size>0?e.DOM.div({className:"explorer-resource-items",key:1},this.props.collection.map(this.renderResource).toJS()):null,this.props.parent?e.DOM.div({className:"explorer-resource-actions-suggest-wrapper"},e.DOM.button({className:"explorer-resource-actions-suggest",onClick:this.suggest,key:2},"SUGGEST MORE RESOURCES")):null,n.getCanEdit()?e.DOM.div({className:"explorer-resource-listing-body-resource-actions",key:3},e.DOM.button({className:"explorer-resource-actions-add explorer-light-button",onClick:this.addResource},"+ Add resource")):null])}});ResourceView=e.createClass({removeResource:function(){OC.utils.status.saving(),t.removeResource(this.props.item.get("id"),this.props.resourceSetID,function(){OC.utils.status.saved()})},openSesame:function(e){return i.openResourcePreview(this.props.model.get("id"),this.props.model.get("title"),this.props.model.get("user_thumbnail"),this.props.model.get("url"),this.props.model.get("type")),e.stopPropagation(),e.preventDefault(),!1},render:function(){return e.DOM.div({className:"explorer-resource-item"},[e.DOM.div({className:"explorer-resource-item-thumbnail-wrapper",key:0},e.DOM.div({className:"explorer-resource-item-thumbnail",style:{backgroundImage:"url('"+this.props.model.get("thumbnail")+"')"}},e.DOM.div({className:"thumbnail-silhouette thumbnail-"+this.props.model.get("type")}))),e.DOM.div({className:"explorer-resource-item-content",key:1},[e.DOM.div({className:"explorer-resource-item-content-body",key:0},[e.DOM.div({className:"explorer-resource-item-content-title",key:0},e.DOM.a({href:this.props.model.get("url"),target:"_blank",onClick:-1!==["pdf","document","reference"].indexOf(this.props.model.get("type"))?this.openSesame:null},this.props.model.get("title"))),e.DOM.div({className:"explorer-resource-item-content-caption",key:1},"")]),n.getCanEdit()?e.DOM.div({className:"explorer-resource-item-content-actions",key:1},e.DOM.div({className:"explorer-resource-item-content-action-delete",onClick:this.removeResource,title:"Remove resource"})):null])])}});var p=e.createClass({deleteField:function(){this.props.meta===!0?t.deleteMeta(this.props.id,this.props.itemID):t.deleteResourceSet(this.props.id)},render:function(){return e.DOM.nav({className:"oc-menu field-menu"+(this.props.open?" show-menu":"")},[e.DOM.div({className:"floating-menu-spacer"},null),e.DOM.ul({},e.DOM.li({},e.DOM.a({onClick:this.deleteField},"Delete field")))])}});return c}),define("curriculumModuleView",["react","curriculumItemView","curriculumPage","curriculumItems","curriculumActions","curriculumSettings","curriculumUtils","curriculumContextView","curriculumUnits"],function(e,t,n,i,r,s,o,a,u){var c=e.createClass({getInitialState:function(){return{drawerItem:null,addBlockState:!1,newSectionName:null,newSectionType:"collection",drawerOpen:n.getDrawerView(),sections:u.getUnit(this.props.id).sections}},componentDidMount:function(){n.on("change",this._onChange),u.on("change",this._onChange),OC.$.addClass(document.querySelector(".content-panel-body"),"abridged")},componentWillUnmount:function(){n.removeListener("change",this._onChange),u.removeListener("change",this._onChange),OC.$.removeClass(document.querySelector(".content-panel-body"),"abridged")},_onChange:function(){this.setState({addBlockState:n.getAddBlockState(),drawerOpen:n.getDrawerView(),sections:n.getUnit().sections})},componentWillMount:function(){OC.curriculum.spinner.stop()},renderDrawer:function(){function e(e){return i.getSectionItems(e.get("id")).find(function(e){return e.get("selected")===!0})}var t=this.props,n=t.sections.find(function(t){return e(t)});return n?a({itemID:e(n).get("id"),section:n}):this.props.drawerView?a():void 0},addSection:function(){this.setState({addBlockState:!0},function(){this.refs.newSectionInput.getDOMNode().focus()})},cancelAddSection:function(){this.setState({addBlockState:!1})},completeAddSection:function(){r.addSection(this.state.newSectionName,this.state.newSectionType,this.props.id,this.props.isUnit);var e=this.state.newSectionType;r.addSectionPost(u.getUnsavedSection(),this.props.id,this.props.isUnit,function(t){"contextual"===e&&r.addItemPost(u.getSectionItem(),function(e){r.addToSection(e,t)},t)})},updateNewSectionTitle:function(e){this.setState({newSectionName:e.target.value})},updateNewSectionType:function(e){this.setState({newSectionType:e.target.value})},render:function(){var t=e.DOM.div({className:"explorer-resource-add-section"},[e.DOM.div({className:"explorer-resource-add-section-title",key:0},"New block"),e.DOM.div({className:"explorer-resource-add-section-name-wrapper",key:1},e.DOM.input({className:"explorer-resource-add-section-name",ref:"newSectionInput",type:"text",placeholder:"Name",onBlur:this.updateNewSectionTitle})),e.DOM.select({className:"explorer-resource-add-section-type",key:2,placeholder:"Type",onBlur:this.updateNewSectionType},[e.DOM.option({key:0,value:"collection"},"List"),e.DOM.option({key:1,value:"contextual"},"Section")]),e.DOM.div({className:"explorer-resource-add-section-actions",key:3},[e.DOM.button({className:"explorer-dull-button explorer-resource-add-section-action-cancel",onClick:this.cancelAddSection},"Cancel"),e.DOM.button({className:"explorer-button",onClick:this.completeAddSection},"Finish")])]);return e.DOM.div({className:"curriculum-module"},[e.DOM.div({className:"explorer-resource-module-main"+(this.props.drawerView?" compress":""),key:0},[e.DOM.div({className:"explorer-resource-sections-wrapper",key:1},l({sections:this.state.sections,openDrawer:this.openDrawer,drawerOpen:this.state.drawerOpen,moveItemTo:this.props.moveItemTo})),s.getCanEdit()?this.state.addBlockState?t:e.DOM.div({className:"curriculum-module-new-section"+(this.props.drawerView?" compress":""),onClick:this.addSection,key:2},"+ ADD BLOCK"):null]),e.DOM.div({className:"explorer-resource-module-support"+(this.props.drawerView?" show":""),key:1},this.renderDrawer())])}}),l=e.createClass({sortedRender:function(){this.forceUpdate()},renderSection:function(t){return e.DOM.div({className:"explorer-resource-section card",id:"section-"+t.get("id")},d({key:t.get("id"),id:t.get("id"),sections:this.props.sections,title:t.get("title"),type:t.get("type"),drawerOpen:this.props.drawerOpen}))},render:function(){return e.DOM.div({className:"explorer-resource-sections"},this.props.sections.sortBy(function(e){return e.get("position")}).map(this.renderSection).toJS())}}),d=e.createClass({moveSectionTo:function(e,t){r.moveSection(e,t),r.moveSectionSave(u.getToShift())},getInitialState:function(){return{showMenu:!1,items:this.getItems(this.props.id)}},getItems:function(){var e=i.getSectionItems(this.props.id);return this.props.hasOwnProperty("id")||i.peekUnsavedSection()===section&&(e=section.get("items")),e},componentDidMount:function(){var e,t=this,n=this.getDOMNode().querySelectorAll(".explorer-resource-section-listing-collection-handle, .explorer-resource-section-listing-contextual-handle");for(e=0;e<n.length;e++)o.itemDraggable(n[e],"explorer-resource-sections","explorer-resource-section-body",this.props.title,function(e){t.moveSectionTo(t.props.id,OC.$.parents(e,"explorer-resource-section").id.substring(8),t.props.sections)});var r=this.getDOMNode().querySelector("nav.block-menu");if(r){var s=OC.utils.menu(r,this.getDOMNode().querySelector(".block-menu-button"));this.setState({menuPosition:s})}i.on("change",this._onChange)},componentWillUnmount:function(){i.removeListener("change",this._onChange)},componentWillReceiveProps:function(e){this.props.drawerOpen!==e.drawerOpen&&this.state.menuPosition&&this.state.menuPosition.reset()},_onChange:function(){this.setState({addBlockState:n.getAddBlockState(),items:this.getItems(this.props.id)})},addItem:function(){var e=this.props.id;r.addItem(e),r.addItemPost(i.getUnsavedItem(),function(t){r.addToSection(t,e)})},open:function(){this.props.openDrawer(this.props.collection.get(0))},toggleMenu:function(){this.setState({showMenu:!this.state.showMenu},function(){if(this.state.showMenu){var e=this,t=document.querySelector("body");t.addEventListener("click",function n(i){return e.getDOMNode()===i.target||e.getDOMNode().contains(i.target)?void 0:(e.setState({showMenu:!1}),t.removeEventListener("click",n),i.preventDefault(),i.stopPropagation(),!1)})}})},renderItem:function(e){return t({key:e.id,title:e.get("title"),model:e,collection:this.props.collection,openDrawer:this.props.openDrawer,drawerOpen:this.props.drawerOpen,moveItemTo:this.props.moveItemTo})},render:function(){var t,i=n.getDrawerView();if("collection"===this.props.type){var r;return t={className:"curriculum-module-section-listing-collection"},t.style=i?{}:{backgroundColor:OC.config.palette.dark},r=e.DOM.div(t,e.DOM.div({className:"explorer-resource-section-listing-collection-handle-wrapper",key:0},s.getCanEdit()?e.DOM.div({className:"explorer-resource-section-listing-collection-handle"},""):null),e.DOM.div({className:"curriculum-module-section-listing-collection-title-wrapper",key:1},e.DOM.div({className:"curriculum-module-section-listing-collection-title"},this.props.title)),s.getCanEdit()?(e.DOM.div({className:"curriculum-module-section-listing-collection-menu block-menu-button "+(i?"light":OC.config.palette.title)+"-button",onClick:this.toggleMenu,key:2}),p({open:this.state.showMenu,id:this.props.id})):null),e.DOM.div({className:"explorer-resource-section-body"},[r,e.DOM.div({className:"explorer-resource-section-listing-items",key:1},this.state.items.sortBy(function(e){return e.get("position")}).map(this.renderItem).toJS()),s.getCanEdit()?e.DOM.div({className:"explorer-resource-listing-actions",key:2},e.DOM.button({id:"new-item",className:"explorer-dull-button",onClick:this.addItem},"+ Add new")):null])}return"contextual"===this.props.type?(t={className:"curriculum-module-section-listing-contextual"+(this.props.collection.get(0).get("selected")?" selected":""),onClick:this.open},t.style=i?{}:{backgroundColor:OC.config.palette.dark},e.DOM.div({className:"explorer-resource-section-body"},e.DOM.div(t,e.DOM.div({className:"curriculum-module-section-listing-contextual-handle-wrapper",key:0},s.getCanEdit()?e.DOM.div({className:"curriculum-module-section-listing-contextual-handle"},""):null),e.DOM.div({className:"curriculum-module-section-listing-contextual-title-wrapper",key:1},e.DOM.div({className:"curriculum-module-section-listing-contextual-title"},this.props.title)),e.DOM.div({className:"curriculum-module-section-listing-contextual-menu block-menu-button "+(i?"light":OC.config.palette.title)+"-button",onClick:this.toggleMenu,key:2}),p({open:this.state.showMenu,id:this.props.id})))):void 0}}),p=e.createClass({deleteSection:function(){r.deleteSection(this.props.id)},render:function(){return e.DOM.nav({className:"oc-menu block-menu"+(this.props.open?" show-menu":"")},[e.DOM.div({className:"floating-menu-spacer"},null),e.DOM.ul({},e.DOM.li({},e.DOM.a({onClick:this.deleteSection},"Delete block")))])}});return c}),define("reactRouter",["react"],function(e){var t=function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){t.DefaultRoute=n(1),t.Link=n(2),t.NotFoundRoute=n(3),t.Redirect=n(4),t.Route=n(5),t.RouteHandler=n(6),t.HashLocation=n(7),t.HistoryLocation=n(8),t.RefreshLocation=n(9),t.ImitateBrowserBehavior=n(10),t.ScrollToTopBehavior=n(11),t.Navigation=n(12),t.State=n(13),t.create=n(14),t.run=n(15),t.History=n(16)},function(e,t,n){var i=n(17),r=n(18),s=n(19),o=i.createClass({displayName:"DefaultRoute",mixins:[r],propTypes:{name:i.PropTypes.string,path:s.falsy,handler:i.PropTypes.func.isRequired}});e.exports=o},function(e,t,n){function i(e){return 0===e.button}function r(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var s=n(17),o=n(32),a=n(33),u=n(12),c=n(13),l=s.createClass({displayName:"Link",mixins:[u,c],propTypes:{activeClassName:s.PropTypes.string.isRequired,to:s.PropTypes.string.isRequired,params:s.PropTypes.object,query:s.PropTypes.object,onClick:s.PropTypes.func},getDefaultProps:function(){return{activeClassName:"active"}},handleClick:function(e){var t,n=!0;this.props.onClick&&(t=this.props.onClick(e)),!r(e)&&i(e)&&((t===!1||e.defaultPrevented===!0)&&(n=!1),e.preventDefault(),n&&this.transitionTo(this.props.to,this.props.params,this.props.query))},getHref:function(){return this.makeHref(this.props.to,this.props.params,this.props.query)},getClassName:function(){var e={};return this.props.className&&(e[this.props.className]=!0),this.isActive(this.props.to,this.props.params,this.props.query)&&(e[this.props.activeClassName]=!0),o(e)},render:function(){var e=a({},this.props,{href:this.getHref(),className:this.getClassName(),onClick:this.handleClick});return s.DOM.a(e,this.props.children)}});e.exports=l},function(e,t,n){var i=n(17),r=n(18),s=n(19),o=i.createClass({displayName:"NotFoundRoute",mixins:[r],propTypes:{name:i.PropTypes.string,path:s.falsy,handler:i.PropTypes.func.isRequired}});e.exports=o},function(e,t,n){var i=n(17),r=n(18),s=n(19),o=i.createClass({displayName:"Redirect",mixins:[r],propTypes:{path:i.PropTypes.string,from:i.PropTypes.string,to:i.PropTypes.string,handler:s.falsy}});e.exports=o},function(e,t,n){var i=n(17),r=n(18),s=i.createClass({displayName:"Route",mixins:[r],propTypes:{name:i.PropTypes.string,path:i.PropTypes.string,handler:i.PropTypes.func.isRequired,ignoreScrollBehavior:i.PropTypes.bool}});e.exports=s},function(e,t,n){var i=n(17),r=n(20),s=i.createClass({displayName:"RouteHandler",mixins:[r],getDefaultProps:function(){return{ref:"__routeHandler__"}},render:function(){return this.getRouteHandler()}});e.exports=s},function(e,t,n){function i(){return l.decode(window.location.href.split("#")[1]||"")}function r(){var e=i();return"/"===e.charAt(0)?!0:(h.replace("/"+e),!1)}function s(e){e===u.PUSH&&(c.length+=1);var t={path:i(),type:e};d.forEach(function(e){e(t)})}function o(){r()&&(s(a||u.POP),a=null)}var a,u=n(30),c=n(16),l=n(21),d=[],p=!1,h={addChangeListener:function(e){d.push(e),r(),p||(window.addEventListener?window.addEventListener("hashchange",o,!1):window.attachEvent("onhashchange",o),p=!0)},removeChangeListener:function(e){d=d.filter(function(t){return t!==e}),0===d.length&&(window.removeEventListener?window.removeEventListener("hashchange",o,!1):window.removeEvent("onhashchange",o),p=!1)},push:function(e){a=u.PUSH,window.location.hash=l.encode(e)},replace:function(e){a=u.REPLACE,window.location.replace(window.location.pathname+window.location.search+"#"+l.encode(e))},pop:function(){a=u.POP,c.back()},getCurrentPath:i,toString:function(){return"<HashLocation>"}};e.exports=h},function(e,t,n){function i(){return u.decode(window.location.pathname+window.location.search)}function r(e){var t={path:i(),type:e};c.forEach(function(e){e(t)})}function s(){r(o.POP)}var o=n(30),a=n(16),u=n(21),c=[],l=!1,d={addChangeListener:function(e){c.push(e),l||(window.addEventListener?window.addEventListener("popstate",s,!1):window.attachEvent("popstate",s),l=!0)
},removeChangeListener:function(e){c=c.filter(function(t){return t!==e}),0===c.length&&(window.addEventListener?window.removeEventListener("popstate",s):window.removeEvent("popstate",s),l=!1)},push:function(e){window.history.pushState({path:e},"",u.encode(e)),a.length+=1,r(o.PUSH)},replace:function(e){window.history.replaceState({path:e},"",u.encode(e)),r(o.REPLACE)},pop:a.back,getCurrentPath:i,toString:function(){return"<HistoryLocation>"}};e.exports=d},function(e,t,n){var i=n(8),r=n(16),s=n(21),o={push:function(e){window.location=s.encode(e)},replace:function(e){window.location.replace(s.encode(e))},pop:r.back,getCurrentPath:i.getCurrentPath,toString:function(){return"<RefreshLocation>"}};e.exports=o},function(e,t,n){var i=n(30),r={updateScrollPosition:function(e,t){switch(t){case i.PUSH:case i.REPLACE:window.scrollTo(0,0);break;case i.POP:e?window.scrollTo(e.x,e.y):window.scrollTo(0,0)}}};e.exports=r},function(e){var t={updateScrollPosition:function(){window.scrollTo(0,0)}};e.exports=t},function(e,t,n){var i=n(17),r={contextTypes:{makePath:i.PropTypes.func.isRequired,makeHref:i.PropTypes.func.isRequired,transitionTo:i.PropTypes.func.isRequired,replaceWith:i.PropTypes.func.isRequired,goBack:i.PropTypes.func.isRequired},makePath:function(e,t,n){return this.context.makePath(e,t,n)},makeHref:function(e,t,n){return this.context.makeHref(e,t,n)},transitionTo:function(e,t,n){this.context.transitionTo(e,t,n)},replaceWith:function(e,t,n){this.context.replaceWith(e,t,n)},goBack:function(){this.context.goBack()}};e.exports=r},function(e,t,n){var i=n(17),r={contextTypes:{getCurrentPath:i.PropTypes.func.isRequired,getCurrentRoutes:i.PropTypes.func.isRequired,getCurrentPathname:i.PropTypes.func.isRequired,getCurrentParams:i.PropTypes.func.isRequired,getCurrentQuery:i.PropTypes.func.isRequired,isActive:i.PropTypes.func.isRequired},getPath:function(){return this.context.getCurrentPath()},getRoutes:function(){return this.context.getCurrentRoutes()},getPathname:function(){return this.context.getCurrentPathname()},getParams:function(){return this.context.getCurrentParams()},getQuery:function(){return this.context.getCurrentQuery()},isActive:function(e,t,n){return this.context.isActive(e,t,n)}};e.exports=r},function(e,t,n){function i(e){throw e}function r(e,t){if("string"==typeof t)throw new Error("Unhandled aborted transition! Reason: "+e);e instanceof E||(e instanceof C?t.replace(this.makePath(e.to,e.params,e.query)):t.pop())}function s(e,t,n,i){for(var r,a,u,c=0,l=t.length;l>c;++c){if(a=t[c],r=s(e,a.childRoutes,a.defaultRoute,a.notFoundRoute),null!=r)return r.routes.unshift(a),r;if(u=x.extractParams(a.path,e))return o(a,u)}return n&&(u=x.extractParams(n.path,e))?o(n,u):i&&(u=x.extractParams(i.path,e))?o(i,u):r}function o(e,t){return{routes:[e],params:t}}function a(e,t){for(var n in t)if(t.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0}function u(e,t,n,i,r,s){return e.some(function(e){if(e!==t)return!1;for(var o,u=t.paramNames,c=0,l=u.length;l>c;++c)if(o=u[c],i[o]!==n[o])return!1;return a(r,s)&&a(s,r)})}function c(e){function t(){U&&(U.abort(new E),U=null)}function n(){L=F,F={}}e=e||{},"function"==typeof e?e={routes:e}:Array.isArray(e)&&(e={routes:e});var o=[],a={},c=[],f=e.location||N,C=e.scrollBehavior||A,I=e.onError||i,P=e.onAbort||r,L={},F={},U=null,R=null;"string"==typeof f?d(!h||!1,"You should not use a static location in a DOM environment because the router will not be kept in sync with the current URL"):p(h,"You cannot use %s without a DOM",f),f!==y||O()||(f=_);var q=l.createClass({displayName:"Router",mixins:[b,D,w],statics:{defaultRoute:null,notFoundRoute:null,isRunning:!1,addRoutes:function(e){o.push.apply(o,k(e,this,a))},makePath:function(e,t,n){var i;if(x.isAbsolute(e))i=x.normalize(e);else{var r=a[e];p(r,'Unable to find <Route name="%s">',e),i=r.path}return x.withQuery(x.injectParams(i,t),n)},makeHref:function(e,t,n){var i=this.makePath(e,t,n);return f===v?"#"+i:i},transitionTo:function(e,t,n){p("string"!=typeof f,"You cannot use transitionTo with a static location");var i=this.makePath(e,t,n);U?f.replace(i):f.push(i)},replaceWith:function(e,t,n){p("string"!=typeof f,"You cannot use replaceWith with a static location"),f.replace(this.makePath(e,t,n))},goBack:function(){return p("string"!=typeof f,"You cannot use goBack with a static location"),T.length>1||f===_?(f.pop(),!0):(d(!1,"goBack() was ignored because there is no router history"),!1)},match:function(e){return s(e,o,this.defaultRoute,this.notFoundRoute)||null},dispatch:function(e,n,i){t();var r=L.path;if(r!==e){r&&n!==g.REPLACE&&this.recordScrollPosition(r);var s=x.withoutQuery(e),o=this.match(s);d(null!=o,'No route matches path "%s". Make sure you have <Route path="%s"> somewhere in your routes',e,e),null==o&&(o={});var a,l,p=L.routes||[],h=L.params||{},f=L.query||{},m=o.routes||[],v=o.params||{},y=x.extractQuery(e)||{};p.length?(a=p.filter(function(e){return!u(m,e,h,v,f,y)}),l=m.filter(function(e){return!u(p,e,h,v,f,y)})):(a=[],l=m);var _=new S(e,this.replaceWith.bind(this,e));U=_;var b=c.slice(p.length-a.length);_.from(a,b,function(t){return t||_.isAborted?i.call(q,t,_):void _.to(l,v,y,function(t){return t||_.isAborted?i.call(q,t,_):(F.path=e,F.action=n,F.pathname=s,F.routes=m,F.params=v,F.query=y,void i.call(q,null,_))})})}},run:function(e){p(!this.isRunning,"Router is already running");var t=function(t,n){U=null,t?I.call(q,t):n.isAborted?P.call(q,n.abortReason,f):e.call(q,q,F)};"string"==typeof f?q.dispatch(f,null,t):(R=function(e){q.dispatch(e.path,e.type,t)},f.addChangeListener&&f.addChangeListener(R),q.dispatch(f.getCurrentPath(),null,t),this.isRunning=!0)},stop:function(){t(),f.removeChangeListener&&R&&(f.removeChangeListener(R),R=null),this.isRunning=!1}},propTypes:{children:M.falsy},getLocation:function(){return f},getScrollBehavior:function(){return C},getRouteAtDepth:function(e){var t=this.state.routes;return t&&t[e]},getRouteComponents:function(){return c},getInitialState:function(){return n(),L},componentWillReceiveProps:function(){n(),this.setState(L)},componentWillUnmount:function(){q.stop()},render:function(){return this.getRouteAtDepth(0)?l.createElement(m,this.props):null},childContextTypes:{getRouteAtDepth:l.PropTypes.func.isRequired,getRouteComponents:l.PropTypes.func.isRequired,routeHandlers:l.PropTypes.array.isRequired},getChildContext:function(){return{getRouteComponents:this.getRouteComponents,getRouteAtDepth:this.getRouteAtDepth,routeHandlers:[this]}}});return e.routes&&q.addRoutes(e.routes),q}var l=n(17),d=n(34),p=n(35),h=n(36).canUseDOM,f=n(10),m=n(6),g=n(30),v=n(7),y=n(8),_=n(9),b=n(22),D=n(23),w=n(24),k=n(25),O=n(26),S=n(27),M=n(19),C=n(28),T=n(16),E=n(29),x=n(21),N=h?v:"/",A=h?f:null;e.exports=c},function(e,t,n){function i(e,t,n){"function"==typeof t&&(n=t,t=null);var i=r({routes:e,location:t});return i.run(n),i}var r=n(14);e.exports=i},function(e,t,n){var i=n(35),r=n(36).canUseDOM,s={back:function(){i(r,"Cannot use History.back without a DOM"),s.length-=1,window.history.back()},length:1};e.exports=s},function(t){t.exports=e},function(e,t,n){var i=n(35),r={render:function(){i(!1,"%s elements should not be rendered",this.constructor.displayName)}};e.exports=r},function(e){var t={falsy:function(e,t,n){return e[t]?new Error("<"+n+'> may not have a "'+t+'" prop'):void 0}};e.exports=t},function(e,t,n){var i=n(17);e.exports={contextTypes:{getRouteAtDepth:i.PropTypes.func.isRequired,getRouteComponents:i.PropTypes.func.isRequired,routeHandlers:i.PropTypes.array.isRequired},childContextTypes:{routeHandlers:i.PropTypes.array.isRequired},getChildContext:function(){return{routeHandlers:this.context.routeHandlers.concat([this])}},getRouteDepth:function(){return this.context.routeHandlers.length-1},componentDidMount:function(){this._updateRouteComponent()},componentDidUpdate:function(){this._updateRouteComponent()},_updateRouteComponent:function(){var e=this.getRouteDepth(),t=this.context.getRouteComponents();t[e]=this.refs[this.props.ref||"__routeHandler__"]},getRouteHandler:function(e){var t=this.context.getRouteAtDepth(this.getRouteDepth());return t?i.createElement(t.handler,e||this.props):null}}},function(e,t,n){function i(e){if(!(e in d)){var t=[],n=e.replace(a,function(e,n){return n?(t.push(n),"([^/?#]+)"):"*"===e?(t.push("splat"),"(.*?)"):"\\"+e});d[e]={matcher:new RegExp("^"+n+"$","i"),paramNames:t}}return d[e]}var r=n(35),s=n(38).merge,o=n(37),a=/:([a-zA-Z_$][a-zA-Z0-9_$]*)|[*.()\[\]\\+|{}^$]/g,u=/:([a-zA-Z_$][a-zA-Z0-9_$?]*[?]?)|[*]/g,c=/\/\/\?|\/\?/g,l=/\?(.+)/,d={},p={decode:function(e){return decodeURI(e.replace(/\+/g," "))},encode:function(e){return encodeURI(e).replace(/%20/g,"+")},extractParamNames:function(e){return i(e).paramNames},extractParams:function(e,t){var n=i(e),r=t.match(n.matcher);if(!r)return null;var s={};return n.paramNames.forEach(function(e,t){s[e]=r[t+1]}),s},injectParams:function(e,t){t=t||{};var n=0;return e.replace(u,function(i,s){if(s=s||"splat","?"!==s.slice(-1))r(null!=t[s],'Missing "'+s+'" parameter for path "'+e+'"');else if(s=s.slice(0,-1),null==t[s])return"";var o;return"splat"===s&&Array.isArray(t[s])?(o=t[s][n++],r(null!=o,"Missing splat # "+n+' for path "'+e+'"')):o=t[s],o}).replace(c,"/")},extractQuery:function(e){var t=e.match(l);return t&&o.parse(t[1])},withoutQuery:function(e){return e.replace(l,"")},withQuery:function(e,t){var n=p.extractQuery(e);n&&(t=t?s(n,t):n);var i=t&&o.stringify(t);return i?p.withoutQuery(e)+"?"+i:e},isAbsolute:function(e){return"/"===e.charAt(0)},normalize:function(e){return e.replace(/^\/*/,"/")},join:function(e,t){return e.replace(/\/*$/,"/")+t}};e.exports=p},function(e,t,n){var i=n(17),r={childContextTypes:{makePath:i.PropTypes.func.isRequired,makeHref:i.PropTypes.func.isRequired,transitionTo:i.PropTypes.func.isRequired,replaceWith:i.PropTypes.func.isRequired,goBack:i.PropTypes.func.isRequired},getChildContext:function(){return{makePath:this.constructor.makePath,makeHref:this.constructor.makeHref,transitionTo:this.constructor.transitionTo,replaceWith:this.constructor.replaceWith,goBack:this.constructor.goBack}}};e.exports=r},function(e,t,n){function i(e,t){return e.some(function(e){return e.name===t})}function r(e,t){for(var n in t)if(String(e[n])!==String(t[n]))return!1;return!0}function s(e,t){for(var n in t)if(String(e[n])!==String(t[n]))return!1;return!0}var o=n(17),a=n(33),u=n(21),c={getCurrentPath:function(){return this.state.path},getCurrentRoutes:function(){return this.state.routes.slice(0)},getCurrentPathname:function(){return this.state.pathname},getCurrentParams:function(){return a({},this.state.params)},getCurrentQuery:function(){return a({},this.state.query)},isActive:function(e,t,n){return u.isAbsolute(e)?e===this.state.path:i(this.state.routes,e)&&r(this.state.params,t)&&(null==n||s(this.state.query,n))},childContextTypes:{getCurrentPath:o.PropTypes.func.isRequired,getCurrentRoutes:o.PropTypes.func.isRequired,getCurrentPathname:o.PropTypes.func.isRequired,getCurrentParams:o.PropTypes.func.isRequired,getCurrentQuery:o.PropTypes.func.isRequired,isActive:o.PropTypes.func.isRequired},getChildContext:function(){return{getCurrentPath:this.getCurrentPath,getCurrentRoutes:this.getCurrentRoutes,getCurrentPathname:this.getCurrentPathname,getCurrentParams:this.getCurrentParams,getCurrentQuery:this.getCurrentQuery,isActive:this.isActive}}};e.exports=c},function(e,t,n){function i(e,t){if(!t)return!0;if(e.pathname===t.pathname)return!1;var n=e.routes,i=t.routes,r=n.filter(function(e){return-1!==i.indexOf(e)});return!r.some(function(e){return e.ignoreScrollBehavior})}var r=n(35),s=n(36).canUseDOM,o=n(31),a={statics:{recordScrollPosition:function(e){this.scrollHistory||(this.scrollHistory={}),this.scrollHistory[e]=o()},getScrollPosition:function(e){return this.scrollHistory||(this.scrollHistory={}),this.scrollHistory[e]||null}},componentWillMount:function(){r(null==this.getScrollBehavior()||s,"Cannot use scroll behavior without a DOM")},componentDidMount:function(){this._updateScroll()},componentDidUpdate:function(e,t){this._updateScroll(t)},_updateScroll:function(e){if(i(this.state,e)){var t=this.getScrollBehavior();t&&t.updateScrollPosition(this.constructor.getScrollPosition(this.state.path),this.state.action)}}};e.exports=a},function(e,t,n){function i(e,t,n){return a.createClass({statics:{willTransitionTo:function(i,r,s){i.redirect(e,t||r,n||s)}},render:function(){return null}})}function r(e,t,n){for(var i in t)if(t.hasOwnProperty(i)){var r=t[i](n,i,e);r instanceof Error&&u(!1,r.message)}}function s(e,t,n){var s=e.type,a=e.props,u=s&&s.displayName||"UnknownComponent";c(-1!==m.indexOf(s),'Unrecognized route configuration element "<%s>"',u),s.propTypes&&r(u,s.propTypes,a);var h={name:a.name};a.ignoreScrollBehavior&&(h.ignoreScrollBehavior=!0),s===p.type?(h.handler=i(a.to,a.params,a.query),a.path=a.path||a.from||"*"):h.handler=a.handler;var g=t&&t.path||"/";if((a.path||a.name)&&s!==l.type&&s!==d.type){var v=a.path||a.name;f.isAbsolute(v)||(v=f.join(g,v)),h.path=f.normalize(v)}else h.path=g,s===d.type&&(h.path+="*");return h.paramNames=f.extractParamNames(h.path),t&&Array.isArray(t.paramNames)&&t.paramNames.forEach(function(e){c(-1!==h.paramNames.indexOf(e),'The nested route path "%s" is missing the "%s" parameter of its parent path "%s"',h.path,e,t.path)}),a.name&&(c(null==n[a.name],'You cannot use the name "%s" for more than one route',a.name),n[a.name]=h),s===d.type?(c(t,"<NotFoundRoute> must have a parent <Route>"),c(null==t.notFoundRoute,"You may not have more than one <NotFoundRoute> per <Route>"),t.notFoundRoute=h,null):s===l.type?(c(t,"<DefaultRoute> must have a parent <Route>"),c(null==t.defaultRoute,"You may not have more than one <DefaultRoute> per <Route>"),t.defaultRoute=h,null):(h.childRoutes=o(a.children,h,n),h)}function o(e,t,n){var i=[];return a.Children.forEach(e,function(e){(e=s(e,t,n))&&i.push(e)}),i}var a=n(17),u=n(34),c=n(35),l=n(1),d=n(3),p=n(4),h=n(5),f=n(21),m=[l.type,d.type,p.type,h.type];e.exports=o},function(e){function t(){var e=navigator.userAgent;return-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone")?window.history&&"pushState"in window.history:!1}e.exports=t},function(e,t,n){function i(e,t,n,i){var r=t.reduce(function(t,i,r){return function(s){if(s||e.isAborted)t(s);else if(i.handler.willTransitionFrom)try{i.handler.willTransitionFrom(e,n[r],t),i.handler.willTransitionFrom.length<3&&t()}catch(o){t(o)}else t()}},i);r()}function r(e,t,n,i,r){var s=t.reduceRight(function(t,r){return function(s){if(s||e.isAborted)t(s);else if(r.handler.willTransitionTo)try{r.handler.willTransitionTo(e,n,i,t),r.handler.willTransitionTo.length<4&&t()}catch(o){t(o)}else t()}},r);s()}function s(e,t){this.path=e,this.abortReason=null,this.isAborted=!1,this.retry=t.bind(this)}var o=n(33),a=n(28);o(s.prototype,{abort:function(e){this.isAborted||(this.abortReason=e,this.isAborted=!0)},redirect:function(e,t,n){this.abort(new a(e,t,n))},from:function(e,t,n){return i(this,e,t,n)},to:function(e,t,n,i){return r(this,e,t,n,i)}}),e.exports=s},function(e){function t(e,t,n){this.to=e,this.params=t,this.query=n}e.exports=t},function(e){function t(){}e.exports=t},function(e){var t={PUSH:"push",REPLACE:"replace",POP:"pop"};e.exports=t},function(e,t,n){function i(){return r(s,"Cannot get current scroll position without a DOM"),{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}}var r=n(35),s=n(36).canUseDOM;e.exports=i},function(e){function t(e){return"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}).join(" "):Array.prototype.join.call(arguments," ")}e.exports=t},function(e){function t(e){if(null==e)throw new TypeError("Object.assign target cannot be null or undefined");for(var t=Object(e),n=Object.prototype.hasOwnProperty,i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r){var s=Object(r);for(var o in s)n.call(s,o)&&(t[o]=s[o])}}return t}e.exports=t},function(e,t,n){var i=n(39),r=i;e.exports=r},function(e){var t=function(e,t,n,i,r,s,o,a){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,r,s,o,a],l=0;u=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[l++]}))}throw u.framesToPop=1,u}};e.exports=t},function(e){var t=!("undefined"==typeof window||!window.document||!window.document.createElement),n={canUseDOM:t,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:t&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:t&&!!window.screen,isInWorker:!t};e.exports=n},function(e,t,n){e.exports=n(40)},function(e,t){t.arrayToObject=function(e){for(var t={},n=0,i=e.length;i>n;++n)"undefined"!=typeof e[n]&&(t[n]=e[n]);return t},t.merge=function(e,n){if(!n)return e;if("object"!=typeof n)return Array.isArray(e)?e.push(n):e[n]=!0,e;if("object"!=typeof e)return e=[e].concat(n);Array.isArray(e)&&!Array.isArray(n)&&(e=t.arrayToObject(e));for(var i=Object.keys(n),r=0,s=i.length;s>r;++r){var o=i[r],a=n[o];e[o]=e[o]?t.merge(e[o],a):a}return e},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.compact=function(e,n){if("object"!=typeof e||null===e)return e;n=n||[];var i=n.indexOf(e);if(-1!==i)return n[i];if(n.push(e),Array.isArray(e)){for(var r=[],s=0,o=e.length;o>s;++s)"undefined"!=typeof e[s]&&r.push(e[s]);return r}var a=Object.keys(e);for(s=0,o=a.length;o>s;++s){var u=a[s];e[u]=t.compact(e[u],n)}return e},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null===e||"undefined"==typeof e?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e){function t(e){return function(){return e}}function n(){}n.thatReturns=t,n.thatReturnsFalse=t(!1),n.thatReturnsTrue=t(!0),n.thatReturnsNull=t(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,n){var i=n(41),r=n(42);e.exports={stringify:i,parse:r}},function(e,t,n){var i=n(38),r={delimiter:"&",indices:!0};r.stringify=function(e,t,n){if(i.isBuffer(e)?e=e.toString():e instanceof Date?e=e.toISOString():null===e&&(e=""),"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return[encodeURIComponent(t)+"="+encodeURIComponent(e)];var s=[];if("undefined"==typeof e)return s;for(var o=Object.keys(e),a=0,u=o.length;u>a;++a){var c=o[a];s=s.concat(!n.indices&&Array.isArray(e)?r.stringify(e[c],t,n):r.stringify(e[c],t+"["+c+"]",n))}return s},e.exports=function(e,t){t=t||{};var n="undefined"==typeof t.delimiter?r.delimiter:t.delimiter;t.indices="boolean"==typeof t.indices?t.indices:r.indices;var i=[];if("object"!=typeof e||null===e)return"";for(var s=Object.keys(e),o=0,a=s.length;a>o;++o){var u=s[o];i=i.concat(r.stringify(e[u],u,t))}return i.join(n)}},function(e,t,n){var i=n(38),r={delimiter:"&",depth:5,arrayLimit:20,parameterLimit:1e3};r.parseValues=function(e,t){for(var n={},r=e.split(t.delimiter,1/0===t.parameterLimit?void 0:t.parameterLimit),s=0,o=r.length;o>s;++s){var a=r[s],u=-1===a.indexOf("]=")?a.indexOf("="):a.indexOf("]=")+1;if(-1===u)n[i.decode(a)]="";else{var c=i.decode(a.slice(0,u)),l=i.decode(a.slice(u+1));n[c]=n.hasOwnProperty(c)?[].concat(n[c]).concat(l):l}}return n},r.parseObject=function(e,t,n){if(!e.length)return t;var i=e.shift(),s={};if("[]"===i)s=[],s=s.concat(r.parseObject(e,t,n));else{var o="["===i[0]&&"]"===i[i.length-1]?i.slice(1,i.length-1):i,a=parseInt(o,10),u=""+a;!isNaN(a)&&i!==o&&u===o&&a>=0&&a<=n.arrayLimit?(s=[],s[a]=r.parseObject(e,t,n)):s[o]=r.parseObject(e,t,n)}return s},r.parseKeys=function(e,t,n){if(e){var i=/^([^\[\]]*)/,s=/(\[[^\[\]]*\])/g,o=i.exec(e);if(!Object.prototype.hasOwnProperty(o[1])){var a=[];o[1]&&a.push(o[1]);for(var u=0;null!==(o=s.exec(e))&&u<n.depth;)++u,Object.prototype.hasOwnProperty(o[1].replace(/\[|\]/g,""))||a.push(o[1]);return o&&a.push("["+e.slice(o.index)+"]"),r.parseObject(a,t,n)}}},e.exports=function(e,t){if(""===e||null===e||"undefined"==typeof e)return{};t=t||{},t.delimiter="string"==typeof t.delimiter||i.isRegExp(t.delimiter)?t.delimiter:r.delimiter,t.depth="number"==typeof t.depth?t.depth:r.depth,t.arrayLimit="number"==typeof t.arrayLimit?t.arrayLimit:r.arrayLimit,t.parameterLimit="number"==typeof t.parameterLimit?t.parameterLimit:r.parameterLimit;for(var n="string"==typeof e?r.parseValues(e,t):e,s={},o=Object.keys(n),a=0,u=o.length;u>a;++a){var c=o[a],l=r.parseKeys(c,n[c],t);s=i.merge(s,l)}return i.compact(s)}}]);return t}),define("curriculumPageView",["react","curriculumPage","curriculumActions","curriculumSettings","curriculumUnits","curriculumTextbooks","curriculumModuleView","reactRouter"],function(e,t,n,i,r,s,o,a){function u(){var n=t.getUnit();n?e.renderComponent(p({unit:n}),document.querySelector(".header-wrapper")):e.renderComponent(OC.views.Header(),document.querySelector(".header-wrapper"),function(){OC.curriculum.resized||(OC.resize(),window.addEventListener("resize",OC.resize))})}var c=a.Link,l=e.createClass({getInitialState:function(){return this.getStateFromStore()},getStateFromStore:function(){return{units:r.getUnits(),view:t.getView(),drawerView:t.getDrawerView()}},componentDidMount:function(){t.on("change",this._onChange),i.on("change",this._onChange)},componentWillUnmount:function(){t.removeListener("change",this._onChange),i.removeListener("change",this._onChange)},_onChange:function(){this.setState(this.getStateFromStore())},renderPeriods:function(){var n,r=this;if("weekly"==i.getPeriods().title){var s=[];for(n=0;n<t.getNumWeeks();n++)s.push(e.DOM.div({className:"curriculum-calendar-canvas-period"},e.DOM.div({className:"curriculum-calendar-canvas-period-title"},"Week "+(n+1))));return s}return"terms"==this.props.settings.periods.title?_.map(r.props.settings.periods.data,function(t){return t.count&&t.count>0?e.DOM.div({key:t.title,className:"explorer-timetable-period",style:{height:7*t.count*11+40*t.count+1*t.count-29+"px"}},[e.DOM.div({className:"explorer-timetable-period-title",key:0},t.title),e.DOM.div({className:"explorer-timetable-period-caption",key:1},t.caption)]):null}):void 0},openSettings:function(){n.openSettings()},openUnits:function(){n.openUnits()},createUnits:function(){n.openUnits(!0)},renderPeriodUnits:function(){var e=this;return r.getUnits().toJS().map(function(t){return d({unit:t,click:e.renderUnit,key:t.id})})},render:function(){function n(){switch(d.state.view){case"overview":return r;case"settings":return s;case"units":return u;case"loading":return l;default:return a}}var r,s,a,u,l=e.DOM.div(),d=this;return r=e.DOM.div({className:"curriculum-menu-wrapper card-wrapper"},e.DOM.div({className:"curriculum-menu card"},[e.DOM.div({className:"curriculum-pretitle-wrapper card-toolbar",style:{backgroundColor:OC.config.palette.dark}},[e.DOM.a({className:"card-toolbar-back back-button "+OC.config.palette.title+"-button",href:OC.curriculum.home},"Back"),i.getCanEdit()?e.DOM.div({className:"card-toolbar-secondary"},[e.DOM.a({className:"card-toolbar-units "+OC.config.palette.title+"-button",onClick:this.openUnits},"Units"),c({className:"card-toolbar-settings "+OC.config.palette.title+"-button",to:"settings"},"Settings")]):null]),e.DOM.div({className:"curriculum-title-wrapper card-title-wrapper card-title-wrapper-small",style:{backgroundColor:OC.config.palette.base}},e.DOM.div({className:"curriculum-title card-title"},i.getPretitle())),e.DOM.div({className:"curriculum-calendar",style:{height:60*this.state.numWeeks+"px"}},[e.DOM.div({className:"curriculum-calendar-canvas"},this.renderPeriods()),e.DOM.div({className:"curriculum-units",style:{marginTop:"-"+60*t.getNumWeeks()+"px"}},this.renderPeriodUnits())]),0===t.getNumWeeks()?e.DOM.div({className:"curriculum-empty-state empty-state-title empty-state-title-independent"},[e.DOM.span({},"Get started by "),e.DOM.a({onClick:this.createUnits,className:"curriculum-action "+OC.config.palette.title+"-action"},"creating a unit")]):null])),u=h({mode:t.getUnitsMode()}),("unit"===this.state.view||"standard"===this.state.view)&&(a=e.DOM.div({className:"curriculum-module-wrapper"+(t.getDrawerView()?"":" card-wrapper")},o({title:"unit"===this.state.view?t.getUnit().title.toUpperCase():this.props.standard.title.toUpperCase(),textbookTitle:this.props.textbook?this.props.textbook.get("title").toUpperCase():null,thumbnail:this.props.textbook?this.props.textbook.thumbnail:null,sections:"unit"===this.state.view?t.getUnit().sections:this.props.standard.sections,id:"unit"===this.state.view?t.getUnit().id:this.props.standard.id,drawerView:this.state.drawerView,setDrawerOpen:this.openDrawer,edit:this.state.edit,addSection:this.addSection,addField:this.addField,isUnit:"unit"===this.state.view?!0:!1,moveItemTo:this.moveItemTo,moveSectionTo:this.moveSectionTo,moveMetaTo:this.moveMetaTo,moveResourceSetTo:this.moveResourceSetTo}))),n()}}),d=e.createClass({openUnit:function(){OC.curriculum.spinner.spin(OC.curriculum.loadButton),n.openUnit(this.props.unit)},render:function(){return e.DOM.div({className:"curriculum-units-unit-wrapper color-"+OC.config.palette.title,id:"textbook-unit-"+this.props.unit.id,style:{height:7.428*(this.props.unit.end-this.props.unit.begin+1)+"px"},onClick:this.openUnit},e.DOM.div({className:"curriculum-units-unit"},[e.DOM.div({className:"curriculum-units-unit-thumbnail",style:{backgroundImage:"url('"+this.props.unit.textbookThumbnail+"')"}}),e.DOM.div({className:"curriculum-units-unit-body"},e.DOM.div({className:"curriculum-units-unit-body-title"},this.props.unit.title),e.DOM.div({className:"curriculum-units-unit-body-textbook"},this.props.unit.textbookTitle)),e.DOM.div({className:"curriculum-units-unit-actions"})]))}}),p=e.createClass({componentDidMount:function(){OC.utils.tip(this.refs.back.getDOMNode(),{gravity:"s"})},"return":function(){n.openOverview()},render:function(){return e.DOM.header({className:"unit-header",style:{backgroundImage:"url('"+this.props.unit.textbookThumbnail+"')"}},[e.DOM.div({className:"unit-header-mask"}),e.DOM.div({className:"unit-header-body"},e.DOM.div({className:"unit-header-body-back",onClick:this.return,ref:"back",title:"Back to sequence"}),e.DOM.div({className:"unit-header-body-description"},[e.DOM.div({className:"unit-header-body-description-thumbnail",style:{backgroundImage:"url('"+this.props.unit.textbookThumbnail+"')"}}),e.DOM.div({className:"unit-header-body-description-titles"},[e.DOM.div({className:"unit-header-body-description-titles-unit"},this.props.unit.title),e.DOM.div({className:"unit-header-body-description-titles-textbook"},this.props.unit.textbookTitle)])]),OC.config.user.id?e.DOM.div({className:"unit-header-body-user content-panel-header-user"},e.DOM.nav({className:"content-panel-header-user-buttons"},OC.views.UserHeader())):null)])}}),h=e.createClass({getInitialState:function(){return{mode:this.props.mode,view:r.isView()?"units":"textbooks"}},componentDidMount:function(){r.on("change",this._onChange),s.on("change",this._onChange),"add"===this.state.mode&&this.initDateSelectors()},componentWillUnmount:function(){r.removeListener("change",this._onChange),s.removeListener("change",this._onChange)},componentDidUpdate:function(){"add"===this.state.mode&&this.initDateSelectors()},initDateSelectors:function(){var e,t;"units"===this.state.view&&(e=this.getDOMNode().querySelector(".explorer-settings-units-new-body-duration-from"),t=this.getDOMNode().querySelector(".explorer-settings-units-new-body-duration-to"),require(["pikaday"],function(n){new n({field:e,onSelect:function(t){e.title=t.toISOString()}}),new n({field:t,onSelect:function(e){t.title=e.toISOString()}})}))},_onChange:function(){this.setState({view:r.isView()?"units":"textbooks"})},renderUnit:function(e){return f({unit:e,settings:this.props.settings})},cancelAddUnit:function(){this.setState({mode:"view"})},renderTextbookOptions:function(){var t=s.getTextbooks().map(function(t){return e.DOM.option({value:t.get("id")},"Textbook: "+t.get("title"))});return t=t.push(e.DOM.option({value:"none"},"Textbook: (none)"))},completeAddUnit:function(){n.addUnit(this.refs.newUnitInput.getDOMNode().value,this.refs.newUnitTextbook.getDOMNode().value,this.refs.newUnitFrom.getDOMNode().value,this.refs.newUnitTo.getDOMNode().value),n.saveUnit(r.getUnsavedUnit()),this.setState({mode:"view"})},openUnits:function(){this.setState({mode:"view"}),n.openUnits()},openTextbooks:function(){this.setState({mode:"view"}),n.openTextbooks()},goBack:function(){n.openOverview()},add:function(){this.setState({mode:"add"})},completeAddTextbook:function(){n.addTextbook(this.refs.newTextbookInput.getDOMNode().value,this.refs.newTextbookDescription.getDOMNode().value),n.saveTextbook(s.getUnsavedTextbook()),this.setState({mode:"view"})},cancelAddTextbook:function(){this.setState({mode:"view"})},renderTextbook:function(t){return e.DOM.div({className:"curriculum-textbooks-item"},e.DOM.div({className:"curriculum-textbooks-item-thumbnail",style:{backgroundImage:"url('"+t.get("thumbnail")+"');"}}),e.DOM.div({className:"curriculum-textbooks-item-body"},e.DOM.div({className:"curriculum-textbooks-item-body-title",type:"text"},t.get("title")),e.DOM.div({className:"curriculum-textbooks-item-body-description"},t.get("description"))),e.DOM.div({className:"curriculum-textbooks-item-actions"},e.DOM.a({className:"curriculum-textbooks-item-actions-action circle-action "+OC.config.palette.title+"-circle-action",onClick:this.edit,title:"Edit",ref:"edit"},null)))},render:function(){var t;return"add"===this.state.mode&&(t="units"===this.state.view?e.DOM.div({className:"explorer-settings-units-new"},e.DOM.div({className:"explorer-settings-units-new-body"},e.DOM.div({className:"explorer-settings-units-new-thumbnail"}),e.DOM.input({className:"explorer-settings-units-new-body-title",type:"text",placeholder:"Name of unit",ref:"newUnitInput",onBlur:this.updateNewUnitName},null),e.DOM.select({className:"explorer-settings-units-new-textbook",ref:"newUnitTextbook",onBlur:this.updateNewUnitTextbook},this.renderTextbookOptions()),"weekly"===i.getPeriods().title?e.DOM.div({},e.DOM.input({className:"explorer-settings-units-new-body-duration-from",type:"text",ref:"newUnitFrom",placeholder:"From",onBlur:this.updateNewUnitFrom},null),e.DOM.input({className:"explorer-settings-units-new-body-duration-to",type:"text",ref:"newUnitTo",placeholder:"To",onBlur:this.updateNewUnitTo},null)):e.DOM.select({className:"explorer-settings-units-new-period",onBlur:this.updateNewUnitPeriod},this.props.settings.periods.data.map(this.renderPeriodOptions))),e.DOM.div({className:"explorer-resource-add-units-actions",key:3},[e.DOM.button({className:"explorer-dull-button explorer-resource-add-unit-action-cancel",onClick:this.cancelAddUnit},"Cancel"),e.DOM.button({className:"explorer-button",onClick:this.completeAddUnit},"Finish")])):e.DOM.div({className:"explorer-settings-textbooks-new"},e.DOM.div({className:"explorer-settings-textbooks-new-thumbnail"}),e.DOM.div({className:"explorer-settings-textbooks-new-body"},e.DOM.input({className:"explorer-settings-textbooks-new-body-title",type:"text",placeholder:"Name of textbook",ref:"newTextbookInput",onBlur:this.updateNewTextbookName},null),e.DOM.textarea({className:"explorer-settings-textbooks-new-description",placeholder:"Description of textbook",ref:"newTextbookDescription",onBlur:this.updateNewTextbookDescription},null)),e.DOM.div({className:"explorer-resource-add-textbooks-actions",key:3},[e.DOM.button({className:"explorer-dull-button explorer-resource-add-textbook-action-cancel",onClick:this.cancelAddTextbook},"Cancel"),e.DOM.button({className:"explorer-button",onClick:this.completeAddTextbook},"Finish")]))),e.DOM.div({className:"curriculum-units-wrapper card-wrapper"},e.DOM.div({className:"curriculum-units card"},[e.DOM.div({className:"card-toolbar",style:{backgroundColor:OC.config.palette.dark}},[e.DOM.a({className:"card-toolbar-back back-button "+OC.config.palette.title+"-button",onClick:this.goBack},"Back"),e.DOM.div({className:"card-toolbar-secondary"},["view"===this.state.mode?e.DOM.a({className:"card-toolbar-add add-button",onClick:this.add},"units"===this.state.view?"Add unit":"Add textbook"):null])]),e.DOM.ul({className:"card-tabs "+OC.config.palette.title+"-card-tabs",style:{backgroundColor:OC.config.palette.base}},[e.DOM.li({className:"card-tab "+("units"===this.state.view?"selected":""),onClick:this.openUnits},"Units"),e.DOM.li({className:"card-tab "+("textbooks"===this.state.view?"selected":""),onClick:this.openTextbooks},"Textbooks")]),"units"===this.state.view?e.DOM.div({className:"explorer-settings-units"},[r.getUnits().map(this.renderUnit).toJS(),t]):e.DOM.div({className:"explorer-settings-textbooks"},[s.getTextbooks().map(this.renderTextbook).toJS(),t])]))
}}),f=e.createClass({getInitialState:function(){return{mode:"view"}},componentDidMount:function(){OC.utils.tip(this.refs.edit.getDOMNode(),{gravity:"s"})},edit:function(){this.setState({mode:"edit"})},cancelEditUnit:function(){this.setState({mode:"view"})},completeEditUnit:function(){this.setState({mode:"view"})},render:function(){return"edit"===this.state.mode?OC.explorer.EditableSettingsUnit({unit:this.props.unit,textbooks:this.props.textbooks,settings:this.props.settings,cancelEditUnit:this.cancelEditUnit,completeEditUnit:this.completeEditUnit}):e.DOM.div({className:"curriculum-units-item"},e.DOM.div({className:"curriculum-units-item-thumbnail",style:{backgroundImage:"url('"+this.props.unit.textbookThumbnail+"');"}}),e.DOM.div({className:"curriculum-units-item-body"},e.DOM.div({className:"curriculum-units-item-body-title",type:"text"},this.props.unit.title),e.DOM.div({className:"curriculum-units-item-body-textbook"},this.props.unit.textbook?this.props.unit.textbook.title:null),e.DOM.div({className:"curriculum-units-item-body-duration"},"From Day "+this.props.unit.begin+" to Day "+this.props.unit.end)),e.DOM.div({className:"curriculum-units-item-actions"},e.DOM.a({className:"curriculum-units-item-actions-action circle-action "+OC.config.palette.title+"-circle-action",onClick:this.edit,title:"Edit",ref:"edit"},null)))}});return u(),t.on("change",u),l}),define("plannerAPI",["atomic","curriculumAppDispatcher","curriculumActions"],function(e,t,n){OC.hasOwnProperty("api")||(OC.api={}),OC.api.planner={get:function(t){require(["jstz"],function(i){e.get("/planner/daily/"+t+"/zone/"+encodeURIComponent(i.determine().name())+"/").success(function(e){n.selectDateComplete(t,e)})})},addItem:function(t,i){e.post("/planner/event/add-item/",{item_id:t,event_id:i}).success(function(){n.itemAddedToEvent()})},removeItem:function(t,n){e.post("/planner/event/remove-item/",{item_id:t,event_id:n}).success(function(){})}},t.register(function(e){switch(e.type){case"SELECT_DATE":OC.api.planner.get(e.date);break;case"ADD_ITEM_TO_EVENT":OC.api.planner.addItem(e.itemID,e.eventID);break;case"REMOVE_ITEM_FROM_EVENT":OC.api.planner.removeItem(e.itemID,e.eventID);break;default:return!0}})}),define("curriculumWebAPI",["atomic","curriculumAppDispatcher","curriculumActions","curriculumSettings","plannerAPI"],function(e,t,n,i){OC.api.curriculum={sectionItem:{update:function(t,i){e.post("/curriculum/api/section-item/update/",t).success(function(e){t.hasOwnProperty("meta")||n.itemUpdated(t),i(e)})},create:function(t,r){var s={description:t.get("description"),section_id:t.get("sectionID"),curriculum_id:i.getID(),position:t.get("position")};e.post("/curriculum/api/section-item/create/",s).success(function(e){n.addItemComplete(t,e.id),r(e.id)})},"delete":function(t){e.delete("/curriculum/api/section-item/"+t+"/delete/").success(function(){})},createResourceSet:function(t,n){e.post("/curriculum/api/section-item/create-resource-set/",t).success(function(e){n(t.id,e.id)})},deleteMeta:function(t,n){e.delete("/curriculum/api/section-item/"+t+"/delete-meta/"+n+"/").success(function(){})},reposition:function(t){e.post("/curriculum/api/section-items/reposition/",t).success(function(e){n.moveItemComplete(e)})},repositionMeta:function(t,i){e.post("/curriculum/api/meta/"+t+"/reposition/",i).success(function(e){n.moveFieldComplete(e)})}},section:{get:function(t){e.get("/curriculum/api/sections/"+t+"/").success(function(e){n.buildSections(t,e)})},addItem:function(t,i){e.post("/curriculum/api/section-item/add-item-to-section/",{id:i,item_id:t}).success(function(){n.itemAddedToSection(t)})},create:function(t,i,r,s){var o={title:t.get("title"),section_type:t.get("type"),position:t.get("position"),parent_id:i,is_unit:r};e.post("/curriculum/api/section/create/",o).success(function(e){n.addSectionComplete(t,e.id),s(e.id)})},"delete":function(t){e.delete("/curriculum/api/section/"+t+"/delete/").success(function(){})},reposition:function(t){e.post("/curriculum/api/sections/reposition/",t).success(function(e){n.moveSectionComplete(e)})}},issues:{update:function(t,n){e.post("/curriculum/api/issue/create-update/",JSON.stringify(t)).success(function(e){n(e)})}},resources:{"delete":function(t,n){e.post("/curriculum/api/section-item/remove-resource/",t).success(function(e){n(e)})}},resourceSet:{"delete":function(t){e.delete("/curriculum/api/section-item-resources/"+t+"/delete/").success(function(){})}},textbook:{create:function(t){e.post("/curriculum/api/textbook/create/",t).success(function(e){n.addTextbookComplete(e.id)})}},unit:{create:function(t){e.post("/curriculum/api/unit/create/",t).success(function(e){n.addUnitComplete(e.id)})}},settings:{update:function(t){e.post("/curriculum/api/settings/update/",t).success(function(e){n.settingsUpdated(e)})},pushChanges:function(t,n){e.get("/curriculum/api/curriculum/"+t+"/push/").success(function(e){n(e)})},pauseChanges:function(t,n){e.get("/curriculum/api/curriculum/"+t+"/pause/").success(function(e){n(e)})}}},t.register(function(e){switch(e.type){case"SAVE_SETTINGS":OC.api.curriculum.settings.update(e.settings,function(){});break;case"OPEN_UNIT":e.unit.hasOwnProperty("sections")||OC.api.curriculum.section.get(e.unit.id);break;case"SAVE_UNIT":OC.api.curriculum.unit.create(e.unit);break;case"SAVE_TEXTBOOK":OC.api.curriculum.textbook.create(e.textbook);break;case"ADD_ITEM_POST":OC.api.curriculum.sectionItem.create(e.item,e.callback);break;case"ADD_ITEM_TO_SECTION":OC.api.curriculum.section.addItem(e.itemID,e.sectionID);break;case"DELETE_ITEM":OC.api.curriculum.sectionItem.delete(e.id);break;case"ADD_SECTION_POST":OC.api.curriculum.section.create(e.section,e.moduleID,e.isUnit,e.callback);break;case"DELETE_SECTION":OC.api.curriculum.section.delete(e.id);break;case"UPDATE_ITEM":OC.api.curriculum.sectionItem.update(e.props,e.callback);break;case"ADD_FIELD_POST":var t=e.item,n=e.field;n.hasOwnProperty("meta")?(serializedItem={meta:[n.meta],id:t.get("id")},OC.api.curriculum.sectionItem.update(serializedItem,e.callback)):OC.api.curriculum.sectionItem.createResourceSet({id:t.get("id"),title:n.get("resource_set").title,position:n.get("resource_set").position},e.callback);break;case"DELETE_META":OC.api.curriculum.sectionItem.deleteMeta(e.itemID,e.id);break;case"DELETE_RESOURCESET":OC.api.curriculum.resourceSet.delete(e.id);break;case"MOVE_SECTION_SAVE":OC.api.curriculum.section.reposition(e.toShift);break;case"MOVE_ITEM_SAVE":OC.api.curriculum.sectionItem.reposition(e.toShift);break;case"MOVE_FIELD_SAVE":OC.api.curriculum.sectionItem.repositionMeta(e.id,e.toShift);break;case"REMOVE_RESOURCE":OC.api.curriculum.resources.delete({resource_id:e.resourceID,resource_set_id:e.resourceSetID},e.callback);break;default:return!0}})}),function(e,t){var n;if("object"==typeof exports){try{n=require("moment")}catch(i){}module.exports=t(n)}else"function"==typeof define&&define.amd?define("pikaday",["require"],function(e){var i="moment";return n=e.defined&&e.defined(i)?e(i):void 0,t(n)}):e.Pikaday=t(e.moment)}(this,function(e){var t="function"==typeof e,n=!!window.addEventListener,i=window.document,r=window.setTimeout,s=function(e,t,i,r){n?e.addEventListener(t,i,!!r):e.attachEvent("on"+t,i)},o=function(e,t,i,r){n?e.removeEventListener(t,i,!!r):e.detachEvent("on"+t,i)},a=function(e,t,n){var r;i.createEvent?(r=i.createEvent("HTMLEvents"),r.initEvent(t,!0,!1),r=y(r,n),e.dispatchEvent(r)):i.createEventObject&&(r=i.createEventObject(),r=y(r,n),e.fireEvent("on"+t,r))},u=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},c=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},l=function(e,t){c(e,t)||(e.className=""===e.className?t:e.className+" "+t)},d=function(e,t){e.className=u((" "+e.className+" ").replace(" "+t+" "," "))},p=function(e){return/Array/.test(Object.prototype.toString.call(e))},h=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},f=function(e){return e%4===0&&e%100!==0||e%400===0},m=function(e,t){return[31,f(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},g=function(e){h(e)&&e.setHours(0,0,0,0)},v=function(e,t){return e.getTime()===t.getTime()},y=function(e,t,n){var i,r;for(i in t)r=void 0!==e[i],r&&"object"==typeof t[i]&&void 0===t[i].nodeName?h(t[i])?n&&(e[i]=new Date(t[i].getTime())):p(t[i])?n&&(e[i]=t[i].slice(0)):e[i]=y({},t[i],n):(n||!r)&&(e[i]=t[i]);return e},_=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},b={field:null,bound:void 0,position:"bottom left",format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null,onDraw:null},D=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},w=function(e,t,n,i,r,s,o){if(o)return'<td class="is-empty"></td>';var a=[];return s&&a.push("is-disabled"),r&&a.push("is-today"),i&&a.push("is-selected"),'<td data-day="'+e+'" class="'+a.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n+'" data-pika-month="'+t+'" data-pika-day="'+e+'">'+e+"</button></td>"},k=function(e,t,n){var i=new Date(n,0,1),r=Math.ceil(((new Date(n,t,e)-i)/864e5+i.getDay()+1)/7);return'<td class="pika-week">'+r+"</td>"},O=function(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},S=function(e){return"<tbody>"+e.join("")+"</tbody>"},M=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;7>t;t++)n.push('<th scope="col"><abbr title="'+D(e,t)+'">'+D(e,t,!0)+"</abbr></th>");return"<thead>"+(e.isRTL?n.reverse():n).join("")+"</thead>"},C=function(e,t,n,i,r){var s,o,a,u,c,l=e._o,d=n===l.minYear,h=n===l.maxYear,f='<div class="pika-title">',m=!0,g=!0;for(a=[],s=0;12>s;s++)a.push('<option value="'+(n===r?s-t:12+s-t)+'"'+(s===i?" selected":"")+(d&&s<l.minMonth||h&&s>l.maxMonth?"disabled":"")+">"+l.i18n.months[s]+"</option>");for(u='<div class="pika-label">'+l.i18n.months[i]+'<select class="pika-select pika-select-month">'+a.join("")+"</select></div>",p(l.yearRange)?(s=l.yearRange[0],o=l.yearRange[1]+1):(s=n-l.yearRange,o=1+n+l.yearRange),a=[];o>s&&s<=l.maxYear;s++)s>=l.minYear&&a.push('<option value="'+s+'"'+(s===n?" selected":"")+">"+s+"</option>");return c='<div class="pika-label">'+n+l.yearSuffix+'<select class="pika-select pika-select-year">'+a.join("")+"</select></div>",f+=l.showMonthAfterYear?c+u:u+c,d&&(0===i||l.minMonth>=i)&&(m=!1),h&&(11===i||l.maxMonth<=i)&&(g=!1),0===t&&(f+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+l.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(f+='<button class="pika-next'+(g?"":" is-disabled")+'" type="button">'+l.i18n.nextMonth+"</button>"),f+="</div>"},T=function(e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+M(e)+S(t)+"</table>"},E=function(o){var a=this,u=a.config(o);a._onMouseDown=function(e){if(a._v){e=e||window.event;var t=e.target||e.srcElement;if(t){if(!c(t,"is-disabled")){if(c(t,"pika-button")&&!c(t,"is-empty"))return a.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),void(u.bound&&r(function(){a.hide(),u.field&&u.field.blur()},100));c(t,"pika-prev")?a.prevMonth():c(t,"pika-next")&&a.nextMonth()}if(c(t,"pika-select"))a._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}}},a._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;t&&(c(t,"pika-select-month")?a.gotoMonth(t.value):c(t,"pika-select-year")&&a.gotoYear(t.value))},a._onInputChange=function(n){var i;n.firedBy!==a&&(t?(i=e(u.field.value,u.format),i=i&&i.isValid()?i.toDate():null):i=new Date(Date.parse(u.field.value)),a.setDate(h(i)?i:null),a._v||a.show())},a._onInputFocus=function(){a.show()},a._onInputClick=function(){a.show()},a._onInputBlur=function(){a._c||(a._b=r(function(){a.hide()},50)),a._c=!1},a._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,i=t;if(t){!n&&c(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),s(t,"change",a._onChange)));do if(c(i,"pika-single"))return;while(i=i.parentNode);a._v&&t!==u.trigger&&a.hide()}},a.el=i.createElement("div"),a.el.className="pika-single"+(u.isRTL?" is-rtl":""),s(a.el,"mousedown",a._onMouseDown,!0),s(a.el,"change",a._onChange),u.field&&(u.container?u.container.appendChild(a.el):u.bound?i.body.appendChild(a.el):u.field.parentNode.insertBefore(a.el,u.field.nextSibling),s(u.field,"change",a._onInputChange),u.defaultDate||(u.defaultDate=t&&u.field.value?e(u.field.value,u.format).toDate():new Date(Date.parse(u.field.value)),u.setDefaultDate=!0));var l=u.defaultDate;h(l)?u.setDefaultDate?a.setDate(l,!0):a.gotoDate(l):a.gotoDate(new Date),u.bound?(this.hide(),a.el.className+=" is-bound",s(u.trigger,"click",a._onInputClick),s(u.trigger,"focus",a._onInputFocus),s(u.trigger,"blur",a._onInputBlur)):this.show()};return E.prototype={config:function(e){this._o||(this._o=y({},b,!0));var t=y(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,h(t.minDate)||(t.minDate=!1),h(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&(g(t.minDate),t.minYear=t.minDate.getFullYear(),t.minMonth=t.minDate.getMonth()),t.maxDate&&(g(t.maxDate),t.maxYear=t.maxDate.getFullYear(),t.maxMonth=t.maxDate.getMonth()),p(t.yearRange)){var i=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||i,t.yearRange[1]=parseInt(t.yearRange[1],10)||i}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||b.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return h(this._d)?t?e(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,i){t&&e.isMoment(n)&&this.setDate(n.toDate(),i)},getDate:function(){return h(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",a(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),h(e)){var n=this._o.minDate,i=this._o.maxDate;h(n)&&n>e?e=n:h(i)&&e>i&&(e=i),this._d=new Date(e.getTime()),g(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),a(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(h(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=e.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),t=r<n.getTime()||i.getTime()<r}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=_(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=_({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){this._o.minDate=e},setMaxDate:function(e){this._o.maxDate=e},draw:function(e){if(this._v||e){var t=this._o,n=t.minYear,i=t.maxYear,s=t.minMonth,o=t.maxMonth,a="";this._y<=n&&(this._y=n,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(var u=0;u<t.numberOfMonths;u++)a+='<div class="pika-lendar">'+C(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year)+this.render(this.calendars[u].year,this.calendars[u].month)+"</div>";if(this.el.innerHTML=a,t.bound&&"hidden"!==t.field.type&&r(function(){t.trigger.focus()},1),"function"==typeof this._o.onDraw){var c=this;r(function(){c._o.onDraw.call(c)},0)}}},adjustPosition:function(){if(!this._o.container){var e,t,n,r=this._o.trigger,s=r,o=this.el.offsetWidth,a=this.el.offsetHeight,u=window.innerWidth||i.documentElement.clientWidth,c=window.innerHeight||i.documentElement.clientHeight,l=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop;if("function"==typeof r.getBoundingClientRect)n=r.getBoundingClientRect(),e=n.left+window.pageXOffset,t=n.bottom+window.pageYOffset;else for(e=s.offsetLeft,t=s.offsetTop+s.offsetHeight;s=s.offsetParent;)e+=s.offsetLeft,t+=s.offsetTop;(e+o>u||this._o.position.indexOf("right")>-1&&e-o+r.offsetWidth>0)&&(e=e-o+r.offsetWidth),(t+a>c+l||this._o.position.indexOf("top")>-1&&t-a-r.offsetHeight>0)&&(t=t-a-r.offsetHeight),this.el.style.cssText=["position: absolute","left: "+e+"px","top: "+t+"px"].join(";")}},render:function(e,t){var n=this._o,i=new Date,r=m(e,t),s=new Date(e,t,1).getDay(),o=[],a=[];g(i),n.firstDay>0&&(s-=n.firstDay,0>s&&(s+=7));for(var u=r+s,c=u;c>7;)c-=7;u+=7-c;for(var l=0,d=0;u>l;l++){var p=new Date(e,t,1+(l-s)),f=n.minDate&&p<n.minDate||n.maxDate&&p>n.maxDate,y=h(this._d)?v(p,this._d):!1,_=v(p,i),b=s>l||l>=r+s;a.push(w(1+(l-s),t,e,y,_,f,b)),7===++d&&(n.showWeekNumber&&a.unshift(k(l-s,t,e)),o.push(O(a,n.isRTL)),a=[],d=0)}return T(n,o)},isVisible:function(){return this._v},show:function(){this._v||(d(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(s(i,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;e!==!1&&(this._o.bound&&o(i,"click",this._onClick),this.el.style.cssText="",l(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),o(this.el,"mousedown",this._onMouseDown,!0),o(this.el,"change",this._onChange),this._o.field&&(o(this._o.field,"change",this._onInputChange),this._o.bound&&(o(this._o.trigger,"click",this._onInputClick),o(this._o.trigger,"focus",this._onInputFocus),o(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},E}),define("curriculumSettingsView",["react","curriculumSettings","curriculumActions","pikaday","reactRouter"],function(e,t,n,i,r){var s=r.Link,o=e.createClass({getInitialState:function(){return{view:"general",addTextbookMode:!1,addUnitMode:!1,pauseSync:!1,pushingSync:!1}},componentWillMount:function(){this.setState({general:t.getGeneral(),pauseSync:"pause"===t.getSyncState(),lastPushed:t.getLastPushed()})},componentDidMount:function(){this.updateSyncTime()},componentDidUpdate:function(){this.updateSyncTime()},_onChange:function(){this.setState({pauseSync:PageStore.getPauseSync(),pushingSync:PageStore.getPushingSync()})},updateSyncTime:function(){require(["timeago"],function(){$(".explorer-settings-general-sync-push-status-time",this.getDOMNode).timeago("updateFromDOM")})},openGeneral:function(e){return this.setState({view:"general"}),e.stopPropagation(),e.preventDefault(),!1},hideTip:function(e){("blur"===e.type||"change"===e.type||"click"===e.type)&&this.updateSettings(e)},updateSettings:function(e){var i=!1;switch(e.target.name){case"title":case"gradeType":case"grade":case"subject":case"session":case"durationRelevance":case"standards":case"sync":""!==e.target.value&&this.state.general[e.target.name]!==e.target.value&&(this.state.general[e.target.name]=e.target.value,this.setState({general:this.state.general}),i=!0);break;case"from":case"to":""!==e.target.value!==null&&this.state.general[e.target.name]!==e.target.title&&(this.state.general[e.target.name]=e.target.title,this.setState({general:this.state.general}),i=!0)}i&&(serializedSettings={},serializedSettings[e.target.name]=this.state.general[e.target.name],n.updateSettings(serializedSettings),n.saveSettings(t.getUnsaved()))},pauseChanges:function(){("pausing"!==this.state.pauseSync||"resuming"!==this.state.pauseSync)&&(this.state.pauseSync?(this.setState({pauseSync:"resuming"}),n.pauseChanges(this.props.id,!1)):(this.setState({pauseSync:"pausing"}),n.pauseChanges(this.props.id,!0)))},pushChanges:function(){console.log("tried pausing changes")},goBack:function(){n.openOverview()},generalView:function(){return e.DOM.div({className:"card-wrapper"},e.DOM.div({className:"card"},[e.DOM.div({className:"card-toolbar",style:{backgroundColor:OC.config.palette.dark}},[s({className:"card-toolbar-back back-button "+OC.config.palette.title+"-button",to:"page"},"Back")]),e.DOM.div({className:"card-title-wrapper card-title-wrapper-edit card-title-wrapper-small"},[e.DOM.input({className:"card-title "+OC.config.palette.title+"-card-title",defaultValue:this.state.general.title,placeholder:"Name",ref:"curriculumNameInput",onBlur:this.hideTip,name:"title"})]),e.DOM.div({className:"card-input-wrapper card-dual-input-wrapper"},[e.DOM.input({className:"card-input "+OC.config.palette.title+"-card-input",defaultValue:(this.state.general.gradeType?this.state.general.gradeType+" ":"")+this.state.general.grade,placeholder:"Grade (eg. Grade 5)",ref:"curriculumGradeInput",onBlur:this.hideTip,name:"grade"}),e.DOM.input({className:"card-input "+OC.config.palette.title+"-card-input",defaultValue:this.state.general.subject,placeholder:"Subject",ref:"curriculumSubjectInput",onBlur:this.hideTip,name:"subject"})]),e.DOM.div({className:"card-input-wrapper"},[e.DOM.select({className:"card-input "+OC.config.palette.title+"-card-input",defaultValue:this.state.general.session,placeholder:"Academic session",ref:"curriculumGradeInput",name:"session",onBlur:this.hideTip},[e.DOM.option({value:"semester"},"Semester"),e.DOM.option({value:"trimester"},"Trimester"),e.DOM.option({value:"term"},"Term"),e.DOM.option({value:"instructional-block"},"Instructional Block"),e.DOM.option({value:"session"},"Session"),e.DOM.option({value:"other"},"Other")])]),a({from:this.state.general.from,to:this.state.general.to,updateSettings:this.updateSettings}),e.DOM.div({className:"card-section-title-wrapper"},e.DOM.div({className:"card-section-title",style:{color:OC.config.palette.base}},"Advanced")),e.DOM.div({className:"card-input-wrapper explorer-settings-general-sync"},[e.DOM.div({className:""},"Sync"),e.DOM.div({className:""},e.DOM.div({className:"explorer-settings-general-sync-labels-wrapper",onMouseOver:this.showTip,onMouseLeave:this.hideTip},[e.DOM.label({className:"",type:"label",key:0},[e.DOM.input({className:"",type:"radio",name:"sync",value:!0,onClick:this.hideTip,defaultChecked:"true"===this.state.general.sync}),e.DOM.span({className:""},"Yes")]),e.DOM.label({className:"",type:"label",key:1},[e.DOM.input({className:"",type:"radio",name:"sync",value:!1,onClick:this.hideTip,defaultChecked:"true"!==this.state.general.sync}),e.DOM.span({className:""},"No")])]),"true"===this.state.general.sync?e.DOM.div({className:"explorer-settings-general-sync-pause"},e.DOM.button({onClick:this.pauseChanges,className:"explorer-dull-button"},this.state.pauseSync&&"resuming"!==this.state.pauseSync?"pausing"===this.state.pauseSync?"Pausing...":" Resume change updates":"resuming"===this.state.pauseSync?"Resuming...":"Pause outgoing change updates")):null,"true"===this.state.general.sync?e.DOM.div({className:"explorer-settings-general-sync-push"},[e.DOM.button({onClick:this.pushChanges,className:"explorer-button"},this.state.pushingSync?"Pushing...":"Force push changes' updates now"),e.DOM.div({className:"explorer-settings-general-sync-push-status"},[e.DOM.span({className:"explorer-settings-general-sync-push-status-message"},"Last pushed updates "),e.DOM.span({className:"explorer-settings-general-sync-push-status-time",title:this.state.lastPushed},"")])]):null)])]))},openUnits:function(e){return this.setState({view:"units"}),e.stopPropagation(),e.preventDefault(),!1},openTextbooks:function(e){return this.setState({view:"textbooks"}),e.stopPropagation(),e.preventDefault(),!1},render:function(){var e;switch(this.state.view){case"general":e=this.generalView;break;case"textbooks":e=Textbooks;break;case"units":e=Units}return e()}}),a=e.createClass({getInitialState:function(){return{from:null,to:null,initialized:!1,durationRelevance:!1}},componentWillMount:function(){this.setState({from:this.props.from,to:this.props.to,durationRelevance:this.props.durationRelevance})},componentDidMount:function(){var e=this,t=this.refs.from.getDOMNode(),n=this.refs.to.getDOMNode(),r=new i({field:t,onSelect:function(t){e.state.initialized&&e.props.updateSettings({target:{name:"from",value:t,title:t.toISOString()}})}}),s=new i({field:n,onSelect:function(t){e.state.initialized&&e.props.updateSettings({target:{name:"to",value:t,title:t.toISOString()}})}});r.setDate(e.state.from),s.setDate(e.state.to),e.setState({initialized:!0})},render:function(){return e.DOM.div({className:"card-input-wrapper card-dual-input-wrapper"},[e.DOM.input({className:"card-input "+OC.config.palette.title+"-card-input",name:"From",placeholder:"From",ref:"from"}),e.DOM.input({className:"card-input "+OC.config.palette.title+"-card-input",name:"To",placeholder:"To",ref:"to"})])}});return o}),define("curriculum",["react","curriculumBootstrap","curriculumActions","curriculumPageView","curriculumWebAPI","curriculumSettingsView","reactRouter"],function(e,t,n,i,r,s,o){n.initSettings(OC.curriculum.settings),OC.curriculum.loadButton=document.querySelector(".ajax-loader");var a=o.Route,u=o.DefaultRoute,c=o.RouteHandler,l=e.createClass({render:function(){return c()}}),d=a({name:"page",path:"/",handler:l},[a({name:"settings",path:"/settings",handler:s}),u({handler:i})]);t.init(function(){o.run(d,function(t){e.renderComponent(t(),document.querySelector(".curriculum"))})})}),!function(e){"function"==typeof define&&define.amd?define("dropzone",["jquery"],e):e(jQuery)}(function(e){function t(e){return e?n(e):void 0}function n(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}var i={exports:{}};return i.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){i.off(e,n),t.apply(this,arguments)}var i=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===t||i.fn===t){n.splice(r,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var i=0,r=n.length;r>i;++i)n[i].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length},function(){var n,r,s,o,a,u,c,l,d={}.hasOwnProperty,p=function(e,t){function n(){this.constructor=e}for(var i in t)d.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},h=[].slice;r="undefined"!=typeof t&&null!==t?t:require("emitter"),c=function(){},n=function(e){function t(e,i){var r,s,o;if(this.element=e,this.version=t.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(t.instances.push(this),this.element.dropzone=this,r=null!=(o=t.optionsForElement(this.element))?o:{},this.options=n({},this.defaultOptions,r,null!=i?i:{}),this.options.forceFallback||!t.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(s=this.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?t.getElement(this.options.previewsContainer,"previewsContainer"):this.element),this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:t.getElements(this.options.clickable,"clickable")),this.init()}var n;return p(t,e),t.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],t.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return c},forceFallback:!1,fallback:function(){var e,n,i,r,s,o;for(this.element.className=""+this.element.className+" dz-browser-not-supported",o=this.element.getElementsByTagName("div"),r=0,s=o.length;s>r;r++)e=o[r],/(^| )dz-message($| )/.test(e.className)&&(n=e,e.className="dz-message");return n||(n=t.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(n)),i=n.getElementsByTagName("span")[0],i&&(i.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,n,i;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},n=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=n*t.optHeight:null==t.optHeight&&(t.optHeight=1/n*t.optWidth),i=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):n>i?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*i):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/i),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t
},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:c,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:c,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var n,i,r,s,o,a,u,c,l,d,p,h,f;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=t.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),d=e.previewElement.querySelectorAll("[data-dz-name]"),s=0,u=d.length;u>s;s++)n=d[s],n.textContent=e.name;for(p=e.previewElement.querySelectorAll("[data-dz-size]"),o=0,c=p.length;c>o;o++)n=p[o],n.innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=t.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),i=function(n){return function(i){return i.preventDefault(),i.stopPropagation(),e.status===t.UPLOADING?t.confirm(n.options.dictCancelUploadConfirmation,function(){return n.removeFile(e)}):n.options.dictRemoveFileConfirmation?t.confirm(n.options.dictRemoveFileConfirmation,function(){return n.removeFile(e)}):n.removeFile(e)}}(this),h=e.previewElement.querySelectorAll("[data-dz-remove]"),f=[],a=0,l=h.length;l>a;a++)r=h[a],f.push(r.addEventListener("click",i));return f}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var n,i,r,s,o;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),e.previewElement.classList.add("dz-image-preview"),s=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),o=[],i=0,r=s.length;r>i;i++)n=s[i],n.alt=e.name,o.push(n.src=t);return o}},error:function(e,t){var n,i,r,s,o;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),s=e.previewElement.querySelectorAll("[data-dz-errormessage]"),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(n.textContent=t);return o}},errormultiple:c,processing:function(e){return e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink)?e._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:c,uploadprogress:function(e,t){var n,i,r,s,o;if(e.previewElement){for(s=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(n.style.width=""+t+"%");return o}},totaluploadprogress:c,sending:c,sendingmultiple:c,success:function(e){return e.previewElement?e.previewElement.classList.add("dz-success"):void 0},successmultiple:c,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:c,complete:function(e){return e._removeLink?e._removeLink.textContent=this.options.dictRemoveFile:void 0},completemultiple:c,maxfilesexceeded:c,maxfilesreached:c,previewTemplate:'<div class="dz-preview dz-file-preview">\n <div class="dz-details">\n <div class="dz-filename"><span data-dz-name></span></div>\n <div class="dz-size" data-dz-size></div>\n <img data-dz-thumbnail />\n </div>\n <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n <div class="dz-success-mark"><span></span></div>\n <div class="dz-error-mark"><span></span></div>\n <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},n=function(){var e,t,n,i,r,s,o;for(i=arguments[0],n=2<=arguments.length?h.call(arguments,1):[],s=0,o=n.length;o>s;s++){t=n[s];for(e in t)r=t[e],i[e]=r}return i},t.prototype.getAcceptedFiles=function(){var e,t,n,i,r;for(i=this.files,r=[],t=0,n=i.length;n>t;t++)e=i[t],e.accepted&&r.push(e);return r},t.prototype.getRejectedFiles=function(){var e,t,n,i,r;for(i=this.files,r=[],t=0,n=i.length;n>t;t++)e=i[t],e.accepted||r.push(e);return r},t.prototype.getFilesWithStatus=function(e){var t,n,i,r,s;for(r=this.files,s=[],n=0,i=r.length;i>n;n++)t=r[n],t.status===e&&s.push(t);return s},t.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(t.QUEUED)},t.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(t.UPLOADING)},t.prototype.getActiveFiles=function(){var e,n,i,r,s;for(r=this.files,s=[],n=0,i=r.length;i>n;n++)e=r[n],(e.status===t.UPLOADING||e.status===t.QUEUED)&&s.push(e);return s},t.prototype.init=function(){var e,n,i,r,s,o,a;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(t.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(i=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null==e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!=e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,n,r,s;if(n=e.hiddenFileInput.files,n.length)for(r=0,s=n.length;s>r;r++)t=n[r],e.addFile(t);return i()})}}(this))(),this.URL=null!=(o=window.URL)?o:window.webkitURL,a=this.events,r=0,s=a.length;s>r;r++)e=a[r],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),n=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(t){return n(t),e.emit("dragenter",t)}}(this),dragover:function(e){return function(t){var i;try{i=t.dataTransfer.effectAllowed}catch(r){}return t.dataTransfer.dropEffect="move"===i||"linkMove"===i?"move":"copy",n(t),e.emit("dragover",t)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(t){return n(t),e.drop(t)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(n){return e.listeners.push({element:n,events:{click:function(i){return n!==e.element||i.target===e.element||t.elementInside(i.target,e.element.querySelector(".dz-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},t.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,t.instances.splice(t.instances.indexOf(this),1)},t.prototype.updateTotalUploadProgress=function(){var e,t,n,i,r,s,o,a;if(i=0,n=0,e=this.getActiveFiles(),e.length){for(a=this.getActiveFiles(),s=0,o=a.length;o>s;s++)t=a[s],i+=t.upload.bytesSent,n+=t.upload.total;r=100*i/n}else r=100;return this.emit("totaluploadprogress",r,n,i)},t.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},t.prototype.getFallbackForm=function(){var e,n,i,r;return(e=this.getExistingFallback())?e:(i='<div class="dz-fallback">',this.options.dictFallbackText&&(i+="<p>"+this.options.dictFallbackText+"</p>"),i+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',n=t.createElement(i),"FORM"!==this.element.tagName?(r=t.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),r.appendChild(n)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=r?r:n)},t.prototype.getExistingFallback=function(){var e,t,n,i,r,s;for(t=function(e){var t,n,i;for(n=0,i=e.length;i>n;n++)if(t=e[n],/(^| )fallback($| )/.test(t.className))return t},s=["div","form"],i=0,r=s.length;r>i;i++)if(n=s[i],e=t(this.element.getElementsByTagName(n)))return e},t.prototype.setupEventListeners=function(){var e,t,n,i,r,s,o;for(s=this.listeners,o=[],i=0,r=s.length;r>i;i++)e=s[i],o.push(function(){var i,r;i=e.events,r=[];for(t in i)n=i[t],r.push(e.element.addEventListener(t,n,!1));return r}());return o},t.prototype.removeEventListeners=function(){var e,t,n,i,r,s,o;for(s=this.listeners,o=[],i=0,r=s.length;r>i;i++)e=s[i],o.push(function(){var i,r;i=e.events,r=[];for(t in i)n=i[t],r.push(e.element.removeEventListener(t,n,!1));return r}());return o},t.prototype.disable=function(){var e,t,n,i,r;for(this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),i=this.files,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(this.cancelUpload(e));return r},t.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},t.prototype.filesize=function(e){var t;return e>=109951162777.6?(e/=109951162777.6,t="TiB"):e>=107374182.4?(e/=107374182.4,t="GiB"):e>=104857.6?(e/=104857.6,t="MiB"):e>=102.4?(e/=102.4,t="KiB"):(e=10*e,t="b"),"<strong>"+Math.round(e)/10+"</strong> "+t},t.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},t.prototype.drop=function(e){var t,n;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(n=e.dataTransfer.items,n&&n.length&&null!=n[0].webkitGetAsEntry?this._addFilesFromItems(n):this.handleFiles(t)))},t.prototype.paste=function(e){var t,n;return null!=(null!=e&&null!=(n=e.clipboardData)?n.items:void 0)?(this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0):void 0},t.prototype.handleFiles=function(e){var t,n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(this.addFile(t));return r},t.prototype._addFilesFromItems=function(e){var t,n,i,r,s;for(s=[],i=0,r=e.length;r>i;i++)n=e[i],s.push(null!=n.webkitGetAsEntry&&(t=n.webkitGetAsEntry())?t.isFile?this.addFile(n.getAsFile()):t.isDirectory?this._addFilesFromDirectory(t,t.name):void 0:null!=n.getAsFile&&(null==n.kind||"file"===n.kind)?this.addFile(n.getAsFile()):void 0);return s},t.prototype._addFilesFromDirectory=function(e,t){var n,i;return n=e.createReader(),i=function(e){return function(n){var i,r,s;for(r=0,s=n.length;s>r;r++)i=n[r],i.isFile?i.file(function(n){return e.options.ignoreHiddenFiles&&"."===n.name.substring(0,1)?void 0:(n.fullPath=""+t+"/"+n.name,e.addFile(n))}):i.isDirectory&&e._addFilesFromDirectory(i,""+t+"/"+i.name)}}(this),n.readEntries(i,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},t.prototype.accept=function(e,n){return e.size>1024*this.options.maxFilesize*1024?n(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):t.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(n(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,n):n(this.options.dictInvalidFileType)},t.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=t.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(n){return n?(e.accepted=!1,t._errorProcessing([e],n)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}}(this))},t.prototype.enqueueFiles=function(e){var t,n,i;for(n=0,i=e.length;i>n;n++)t=e[n],this.enqueueFile(t);return null},t.prototype.enqueueFile=function(e){if(e.status!==t.ADDED||e.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return e.status=t.QUEUED,this.options.autoProcessQueue?setTimeout(function(e){return function(){return e.processQueue()}}(this),0):void 0},t.prototype._thumbnailQueue=[],t.prototype._processingThumbnail=!1,t.prototype._enqueueThumbnail=function(e){return this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},t.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},t.prototype.removeFile=function(e){return e.status===t.UPLOADING&&this.cancelUpload(e),this.files=l(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},t.prototype.removeAllFiles=function(e){var n,i,r,s;for(null==e&&(e=!1),s=this.files.slice(),i=0,r=s.length;r>i;i++)n=s[i],(n.status!==t.UPLOADING||e)&&this.removeFile(n);return null},t.prototype.createThumbnail=function(e,t){var n;return n=new FileReader,n.onload=function(i){return function(){var r;return r=document.createElement("img"),r.onload=function(){var n,s,o,a,c,l,d,p;return e.width=r.width,e.height=r.height,o=i.options.resize.call(i,e),null==o.trgWidth&&(o.trgWidth=o.optWidth),null==o.trgHeight&&(o.trgHeight=o.optHeight),n=document.createElement("canvas"),s=n.getContext("2d"),n.width=o.trgWidth,n.height=o.trgHeight,u(s,r,null!=(c=o.srcX)?c:0,null!=(l=o.srcY)?l:0,o.srcWidth,o.srcHeight,null!=(d=o.trgX)?d:0,null!=(p=o.trgY)?p:0,o.trgWidth,o.trgHeight),a=n.toDataURL("image/png"),i.emit("thumbnail",e,a),null!=t?t():void 0},r.src=n.result}}(this),n.readAsDataURL(e)},t.prototype.processQueue=function(){var e,t,n,i;if(t=this.options.parallelUploads,n=this.getUploadingFiles().length,e=n,!(n>=t)&&(i=this.getQueuedFiles(),i.length>0)){if(this.options.uploadMultiple)return this.processFiles(i.slice(0,t-n));for(;t>e;){if(!i.length)return;this.processFile(i.shift()),e++}}},t.prototype.processFile=function(e){return this.processFiles([e])},t.prototype.processFiles=function(e){var n,i,r;for(i=0,r=e.length;r>i;i++)n=e[i],n.processing=!0,n.status=t.UPLOADING,this.emit("processing",n);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},t.prototype._getFilesWithXhr=function(e){var t,n;return n=function(){var n,i,r,s;for(r=this.files,s=[],n=0,i=r.length;i>n;n++)t=r[n],t.xhr===e&&s.push(t);return s}.call(this)},t.prototype.cancelUpload=function(e){var n,i,r,s,o,a,u;if(e.status===t.UPLOADING){for(i=this._getFilesWithXhr(e.xhr),r=0,o=i.length;o>r;r++)n=i[r],n.status=t.CANCELED;for(e.xhr.abort(),s=0,a=i.length;a>s;s++)n=i[s],this.emit("canceled",n);this.options.uploadMultiple&&this.emit("canceledmultiple",i)}else((u=e.status)===t.ADDED||u===t.QUEUED)&&(e.status=t.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));return this.options.autoProcessQueue?this.processQueue():void 0},t.prototype.uploadFile=function(e){return this.uploadFiles([e])},t.prototype.uploadFiles=function(e){var i,r,s,o,a,u,c,l,d,p,h,f,m,g,v,y,_,b,D,w,k,O,S,M,C,T,E,x,N,A,I,P;for(_=new XMLHttpRequest,b=0,O=e.length;O>b;b++)i=e[b],i.xhr=_;_.open(this.options.method,this.options.url,!0),_.withCredentials=!!this.options.withCredentials,g=null,s=function(t){return function(){var n,r,s;for(s=[],n=0,r=e.length;r>n;n++)i=e[n],s.push(t._errorProcessing(e,g||t.options.dictResponseError.replace("{{statusCode}}",_.status),_));return s}}(this),v=function(t){return function(n){var r,s,o,a,u,c,l,d,p;if(null!=n)for(s=100*n.loaded/n.total,o=0,c=e.length;c>o;o++)i=e[o],i.upload={progress:s,total:n.total,bytesSent:n.loaded};else{for(r=!0,s=100,a=0,l=e.length;l>a;a++)i=e[a],(100!==i.upload.progress||i.upload.bytesSent!==i.upload.total)&&(r=!1),i.upload.progress=s,i.upload.bytesSent=i.upload.total;if(r)return}for(p=[],u=0,d=e.length;d>u;u++)i=e[u],p.push(t.emit("uploadprogress",i,s,i.upload.bytesSent));return p}}(this),_.onload=function(n){return function(i){var r;if(e[0].status!==t.CANCELED&&4===_.readyState){if(g=_.responseText,_.getResponseHeader("content-type")&&~_.getResponseHeader("content-type").indexOf("application/json"))try{g=JSON.parse(g)}catch(o){i=o,g="Invalid JSON response from server."}return v(),200<=(r=_.status)&&300>r?n._finished(e,g,i):s()}}}(this),_.onerror=function(){return function(){return e[0].status!==t.CANCELED?s():void 0}}(this),m=null!=(E=_.upload)?E:_,m.onprogress=v,u={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&n(u,this.options.headers);for(o in u)a=u[o],_.setRequestHeader(o,a);if(r=new FormData,this.options.params){x=this.options.params;for(h in x)y=x[h],r.append(h,y)}for(D=0,S=e.length;S>D;D++)i=e[D],this.emit("sending",i,_,r);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,_,r),"FORM"===this.element.tagName)for(N=this.element.querySelectorAll("input, textarea, select, button"),w=0,M=N.length;M>w;w++)if(l=N[w],d=l.getAttribute("name"),p=l.getAttribute("type"),"SELECT"===l.tagName&&l.hasAttribute("multiple"))for(A=l.options,k=0,C=A.length;C>k;k++)f=A[k],f.selected&&r.append(d,f.value);else(!p||"checkbox"!==(I=p.toLowerCase())&&"radio"!==I||l.checked)&&r.append(d,l.value);for(c=T=0,P=e.length-1;P>=0?P>=T:T>=P;c=P>=0?++T:--T)r.append(this._getParamName(c),e[c],e[c].name);return _.send(r)},t.prototype._finished=function(e,n,i){var r,s,o;for(s=0,o=e.length;o>s;s++)r=e[s],r.status=t.SUCCESS,this.emit("success",r,n,i),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("successmultiple",e,n,i),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t.prototype._errorProcessing=function(e,n,i){var r,s,o;for(s=0,o=e.length;o>s;s++)r=e[s],r.status=t.ERROR,this.emit("error",r,n,i),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("errormultiple",e,n,i),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},t}(r),n.version="3.10.2",n.options={},n.optionsForElement=function(e){return e.getAttribute("id")?n.options[s(e.getAttribute("id"))]:void 0},n.instances=[],n.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},n.autoDiscover=!0,n.discover=function(){var e,t,i,r,s,o;for(document.querySelectorAll?i=document.querySelectorAll(".dropzone"):(i=[],e=function(e){var t,n,r,s;for(s=[],n=0,r=e.length;r>n;n++)t=e[n],s.push(/(^| )dropzone($| )/.test(t.className)?i.push(t):void 0);return s},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),o=[],r=0,s=i.length;s>r;r++)t=i[r],o.push(n.optionsForElement(t)!==!1?new n(t):void 0);return o},n.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],n.isBrowserSupported=function(){var e,t,i,r,s;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(s=n.blacklistedBrowsers,i=0,r=s.length;r>i;i++)t=s[i],t.test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},l=function(e,t){var n,i,r,s;for(s=[],i=0,r=e.length;r>i;i++)n=e[i],n!==t&&s.push(n);return s},s=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},n.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},n.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},n.getElement=function(e,t){var n;if("string"==typeof e?n=document.querySelector(e):null!=e.nodeType&&(n=e),null==n)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return n},n.getElements=function(e,t){var n,i,r,s,o,a,u,c;if(e instanceof Array){r=[];try{for(s=0,a=e.length;a>s;s++)i=e[s],r.push(this.getElement(i,t))}catch(l){n=l,r=null}}else if("string"==typeof e)for(r=[],c=document.querySelectorAll(e),o=0,u=c.length;u>o;o++)i=c[o],r.push(i);else null!=e.nodeType&&(r=[e]);if(null==r||!r.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return r},n.confirm=function(e,t,n){return window.confirm(e)?t():null!=n?n():void 0},n.isValidFile=function(e,t){var n,i,r,s,o;if(!t)return!0;for(t=t.split(","),i=e.type,n=i.replace(/\/.*$/,""),s=0,o=t.length;o>s;s++)if(r=t[s],r=r.trim(),"."===r.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(r.toLowerCase(),e.name.length-r.length))return!0}else if(/\/\*$/.test(r)){if(n===r.replace(/\/.*$/,""))return!0}else if(i===r)return!0;return!1},"undefined"!=typeof e&&null!==e&&(e.fn.dropzone=function(e){return this.each(function(){return new n(this,e)})}),"undefined"!=typeof i&&null!==i?i.exports=n:window.Dropzone=n,n.ADDED="added",n.QUEUED="queued",n.ACCEPTED=n.QUEUED,n.UPLOADING="uploading",n.PROCESSING=n.UPLOADING,n.CANCELED="canceled",n.ERROR="error",n.SUCCESS="success",a=function(e){var t,n,i,r,s,o,a,u,c,l;for(a=e.naturalWidth,o=e.naturalHeight,n=document.createElement("canvas"),n.width=1,n.height=o,i=n.getContext("2d"),i.drawImage(e,0,0),r=i.getImageData(0,0,1,o).data,l=0,s=o,u=o;u>l;)t=r[4*(u-1)+3],0===t?s=u:l=u,u=s+l>>1;return c=u/o,0===c?1:c},u=function(e,t,n,i,r,s,o,u,c,l){var d;return d=a(t),e.drawImage(t,n,i,r,s,o,u,c,l/d)},o=function(e,t){var n,i,r,s,o,a,u,c,l;if(r=!1,l=!0,i=e.document,c=i.documentElement,n=i.addEventListener?"addEventListener":"attachEvent",u=i.addEventListener?"removeEventListener":"detachEvent",a=i.addEventListener?"":"on",s=function(n){return"readystatechange"!==n.type||"complete"===i.readyState?(("load"===n.type?e:i)[u](a+n.type,s,!1),!r&&(r=!0)?t.call(e,n.type||n):void 0):void 0},o=function(){var e;try{c.doScroll("left")}catch(t){return e=t,void setTimeout(o,50)}return s("poll")},"complete"!==i.readyState){if(i.createEventObject&&c.doScroll){try{l=!e.frameElement}catch(d){}l&&o()}return i[n](a+"DOMContentLoaded",s,!1),i[n](a+"readystatechange",s,!1),e[n](a+"load",s,!1)}},n._autoDiscoverFunction=function(){return n.autoDiscover?n.discover():void 0},o(window,n._autoDiscoverFunction)}.call(this),i.exports}),define("uploadNew",["filepicker","dropzone","hogan"],function(e,t,n){var i={filepickerKey:"AGuSaWwXNQFi60wveigBHz",fp_uploaded_files:{},dropzone_uploaded_files:{},manual_to_upload_files:[],isPost:!1,launchFilepickerDialog:function(e,t){return filepicker.pickAndStore({multiple:!0,openTo:t},{location:"S3",path:"/resources/",access:"public"},this.fpPost,this.fpError),e.preventDefault(),e.stopPropagation(),!1},uploadCallback:function(e){var t,n,i,r=this;t=e,require(["deep_extend"],function(t){t(r.fp_uploaded_files,e)});for(n in t)"failures"===n?(i=document.createElement("div"),i.innerHTML="The following files failed to upload: ",i.innerHTML+=JSON.stringify(t.failures),document.querySelector(".uploadfiles").appendChild(i)):(this.addToUploadList(n,t[n],"","filepicker-item"),this.newFileUploadListener())},fpPost:function(e){var t,n,i,r,s,o=this;for(i=e.length,t={},n=0;i>n;n++)r=e[n].key,s=e[n].filename,t[r]=s;t.user=OC.config.user.id;var a=document.querySelector("form input[name=collection]");a&&(t.collection=a.value),atomic.post("/api/filepicker-upload/",t).success(function(e){o.uploadCallback(e)})},fpError:function(e){151===e&&alert("Sorry, something went wrong")},dzTemplate:n.compile('<div class="dz-preview dz-file-preview {{process}}"><div class="dz-details"><div class="dz-filename"><span data-dz-name contenteditable="true" class="{{key}}">{{filename}}</span></div><div class="dz-size" data-dz-size>{{filesize}}</div><img data-dz-thumbnail /></div><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><div class="dz-success-mark"><span></span></div><div class="dz-error-mark"><span></span></div><div class="dz-error-message"><span data-dz-errormessage></span></div></div>'),singleFileTemplate:n.compile('<div class="single-upload {{process}}"><input type="hidden" name="key" value="{{key}}" /><input type="text" name="filename" value="{{filename}}" /><input type="hidden" name="upload_service" value="{{process}}" /><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><!--<select name="type"><option value="lesson">Lesson</option><option value="project">Project</option><option value="worksheet">Worksheet</option><option value="handout">Handout</option><option value="activity">Activity</option><option value="assessment">Test / assessment</option><option value="lecture">Lecture</option></select>--><div class="alternative-upload"><a>Upload something else instead...</a></div></div>'),newFileUploadListener:function(){var e=document.querySelector("form.files-upload-rename button[type=submit]"),t=document.querySelector('form.files-upload-rename button[name="select-file"]');OC.$.hasClass(e,"hidden")&&(OC.$.isEmpty(this.fp_uploaded_files)&&OC.$.isEmpty(this.dropzone_uploaded_files)&&!this.manual_to_upload_files.length||(OC.$.removeClass(e,"hidden"),this.isPost&&OC.$.addClass(t,"hidden")))},updateSingleItemKey:function(e){document.querySelector(".upload-dialog .upload-drag-drop-replace input[name=key]").value=e},addToUploadList:function(e,n,i,r){var s={key:e,filename:n,filesize:i,process:r};if(this.isPost){var o=document.querySelectorAll(".upload-dialog .upload-drag-drop,.upload-dialog .upload-drag-drop-message");OC.$.addClass(o,"hidden");var a=this.singleFileTemplate.render(s),u=document.querySelector(".upload-dialog .upload-drag-drop-replace");u.innerHTML=a,OC.$.removeClass(u,"hidden"),u.querySelector('input[name="filename"]').focus(),OC.$.addListener(u.querySelector(".alternative-upload a"),"click",function(){OC.$.addClass(u,"hidden"),OC.$.removeClass(o,"hidden");var e=document.querySelectorAll('input[class="manual-upload"]');e[e.length-2].parent.removeChild(e[e.length-2]),this.manual_to_upload_files=[],this.dropzone_uploaded_files={},t.forElement(".upload-dialog .upload-drag-drop").removeAllFiles(),this.fp_uploaded_files={};var n=$("form.files-upload-rename button[type=submit]"),i=$('form.files-upload-rename button[name="select-file"]');OC.$.removeClass(i,"hidden"),OC.$.addClass(n,"hidden")})}else{var c=this.dzTemplate.render(s);document.querySelector(".upload-dialog .upload-drag-drop").appendChild(c)}},onFileInputChange:function(){var e,t=this.files[0].size;if(e=t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t+" B",t>5242880){var n=OC.utils.popup(".upload-filepicker-suggest-dialog");OC.$.addListener(n.dialog.querySelector(".filepicker-suggest"),"click",function(e){return n.close(),e.preventDefault(),e.stopPropagation(),!1})}else{var i=this.files[0].name;addToUploadList(i,i,e,"manual-item"),manual_to_upload_files.push(i),newFileUploadListener();{document.querySelectorAll("form.files-upload-rename input.manual-upload").length,document.createElement("input")}newFileInput.className="manual-upload",newFileInput.type="file",OC.$.addListener(newFileInput,"change",onFileInputChange),document.querySelector("form.files-upload-rename").appendChild(newFileInput)}},preSubmissionHandler:function(){var e;if(this.isPost){var t=document.querySelector(".upload-drag-drop-replace"),n=t.querySelector('input[name="key"]').value,i=t.querySelector('input[name="filename"]').value,r=t.querySelector('input[name="upload_service"]').value;if("filepicker-item"===r||"dropzone-item"===r)e=document.createElement("input"),e.type="hidden",e.name=n,e.value=i,document.querySelector(".files-upload-rename").appendChild(e);else{var s=document.querySelectorAll(".files-upload-rename input[class=manual-upload]");s[s.length-2].name=i}}else{var o,a,u,c,l,d,p,h=document.querySelectorAll(".upload-dialog .upload-drag-drop .dz-preview"),f=document.querySelectorAll(".files-upload-rename input[type=file]");for(u=0;u<h.length;u++)if(l=h[u],d=l.querySelector(".dz-filename span:first").className,p=l.querySelector(".dz-filename span:first").innerHTML.trim(),OC.$.hasClass(l,"filepicker-item"))fp_uploaded_files[d]!=p&&(fp_uploaded_files[d]=p);else if(OC.$.hasClass(l,"manual-item"))for(c=0;c<f.length;c++)f[c].value!==d&&(f[c].name=p);else dropzone_uploaded_files[d]!=p&&(dropzone_uploaded_files[d]=p);for(o in OC.upload.fp_uploaded_files)e=document.createElement("input"),e.type="hidden",e.name=o,e.value=fp_uploaded_files[o],document.querySelector(".files-upload-rename").appendChild(e);for(a in OC.upload.dropzone_uploaded_files)e=document.createElement("input"),e.type="hidden",e.name=a,e.value=dropzone_uploaded_files[a],document.querySelector(".files-upload-rename").appendChild(e)}},sending:function(e,t,n){var r=function(e){var t,n,i,r=null;if(document.cookie&&""!==document.cookie)for(t=document.cookie.split(";"),n=0;n<t.length;n++)if(i=t[n].trim(),i.substring(0,e.length+1)===e+"="){r=decodeURIComponent(i.substring(e.length+1));break}return r},s=function(e){var t=document.location.host,n=document.location.protocol,i="//"+t,r=n+i;return e===r||e.slice(0,r.length+1)===r+"/"||e===i||e.slice(0,i.length+1)===i+"/"||!/^(\/\/|http:|https:).*/.test(e)},o=this.options.url;s(o)&&t.setRequestHeader("X-CSRFToken",r("csrftoken")),n.append("user",OC.config.user.id);var a=document.querySelector(".upload-dialog form input[name=collection]");a&&n.append("collection",a.value),i.isPost&&i.addToUploadList(null,e.name,0,"dropzone-item")},uploadprogress:function(e,t){i.isPost&&$(".single-upload .dz-progress .dz-upload").css("width",t+"%")},success:function(e,t){function n(e,t){var n,i;for(n=0;n<e.length;n++)if(i=e[n],-1!==i.innerHTML.indexOf(t))return i;return null}var r,s=JSON.parse(t);for(r in s)i.dropzone_uploaded_files[r]=s[r].title;OC.$.addClass(n(document.querySelectorAll(".dz-preview .dz-filename > span"),i.dropzone_uploaded_files[r]),r),e.previewElement.querySelector(".dz-filename span").setAttribute("contenteditable",!0),i.newFileUploadListener(),i.isPost&&i.updateSingleItemKey(r)}};filepicker.setKey(i.filepickerKey),i.isPost="true"===document.querySelector('form.files-upload-rename input[name="post"]').value,OC.$.addListener(document.querySelector("form.files-upload-rename"),"keypress",function(e){13===e.keyCode&&e.preventDefault()
});var r={".uploadfiles":"COMPUTER",".gdrive-upload":"GOOGLE_DRIVE",".skydrive-upload":"SKYDRIVE",".dropbox-upload":"DROPBOX",".gmail-upload":"GMAIL",".box-upload":"BOX",".picasa-upload":"PICASA",".ftp-upload":"FTP",".webdav-upload":"WEBDAV",".facebook-upload":"FACEBOOK"};for(var s in r)OC.$.addListener(document.querySelector(s),"click",function(e){i.launchFilepickerDialog(e,r[s])});OC.$.addListener(document.querySelector("form.files-upload-rename button[type=submit]"),"click",function(e){return i.preSubmissionHandler(e),i.isPost?!1:!0}),OC.$.addListener(document.querySelector("button[name=select-file]"),"click",function(e){return i.isPost?document.querySelector(".upload-drag-drop").click():document.querySelector("input[class=manual-upload]:last").click(),e.preventDefault(),e.stopPropagation(),!1});var o=document.querySelector(".upload-drag-drop");if(o){new t(".upload-dialog .upload-drag-drop",{url:"/api/file-upload/",maxFilesize:5,createImageThumbnails:!1,init:function(){this.on("sending",i.sending),this.on("uploadprogress",i.uploadprogress),this.on("success",i.success)}})}return OC.$.addListener(document.querySelector("input[type=file]"),"change",i.onFileInputChange),i}),define("post",["core_light","uploadNew"],function(e,t){var n={_options:{},_postDialog:null,_prePostDialog:null,_submit:null,_prepFormCallback:null,_postURL:null,_postTitle:"Post",init:function(e){_options=e;var t=document.querySelector(".browse-post-new-dialog .popup-title"),n=document.querySelector(".browse-post-new-message"),i=document.querySelector(".post-new-url-dialog .popup-title"),r=document.querySelectorAll(".post-new-url-submit, .post-new-file-folder-submit, .projects-progress-button");if(t.innerHTML=e.title,n.innerHTML=e.message,i.innerHTML=e.urlTitle,!e.addMeta){var s;for(s=0;s<r.length;s++)r[s].innerHTML=_options.postTitle||_postTitle}this.launch()},launch:function(){_postDialog=e.utils.popup(".browse-post-new-dialog"),this.choices()},choices:function(){function n(){e.$.addListener(o,"click",function(){function n(){var e=document.querySelector('form.files-upload-rename input[name="filename"]').value,t=document.createElement("input");t.name="title",t.title=e,document.querySelector("form.files-upload-rename").appendChild(t)}_postDialog.close();var i=e.utils.popup(".upload-dialog");i.dialog.querySelector('input[name="post"]').value="true",t.isPost=!0,s('form.files-upload-rename button[type="submit"]',i,!0,_options.uploadPostURL,n)})}function i(){e.$.addListener(a,"click",function(){function t(){var e=i.querySelector(".selected-destination-collection, .selected-destination-resource");if(e){var t=e.id,n=-1!=t.indexOf("resource"),r=t.substring(n?9:11);document.querySelector("#post-new-file-folder-profile-form input[name=is_resource]").value=n,document.querySelector("#post-new-file-folder-profile-form input[name=resource_collection_ID]").value=r,document.querySelector("#post-new-file-folder-profile-form input[name=title]").value=e.innerHTML}}_postDialog.close();var n=e.utils.popup(".post-new-file-folder-dialog"),i=document.querySelector(".post-new-file-folder-profile-browser");require(["atomic"],function(t){t.get("/resources/tree/all/user/").success(function(t){"true"==t.status&&(e.utils.browser(t.tree,i),e.$.removeClass(i,"loading-browser"),n.reposition(n))})}),s(".post-new-file-folder-submit",n,!0,_options.existingPostURL,t)})}function r(){e.$.addListener(u,"click",function(){_postDialog.close();var t=e.utils.popup(".post-new-url-dialog");s(".post-new-url-submit",t,!0,_options.urlPostURL)})}var s=this.bindPost,o=_postDialog.dialog.querySelector(".browse-post-new-option.upload-option"),a=_postDialog.dialog.querySelector(".browse-post-new-option.file-folder-option"),u=_postDialog.dialog.querySelector(".browse-post-new-option.url-option");o.removeEventListener("click",n),a.removeEventListener("click",i),u.removeEventListener("click",r),n(),i(),r()},post:function(t){if(_prePostDialog.close(),_options.addMeta){var i=e.utils.popup(".post-tag-dialog");e.$.addListener(i.dialog.querySelector(".post-tag-submit"),"click",function(){var e=i.dialog.querySelector("select[name=type]").value,t=document.createElement("input");t.name="type",t.value=e,t.type=hidden;var n=_prePostDialog.dialog.querySelector("form:first"),r=i.dialog.querySelector('input[name="standard"]');n.appendChild(r.clone()),n.appendChild(t),_submit&&n.submit()})}else{_prepFormCallback&&_prepFormCallback();var r=_prePostDialog.dialog.querySelector("form"),s=e.$.serialize(r);for(var o in _options.toAppendFormData)s[o]=_options.toAppendFormData[o];var a=_prePostDialog.dialog.querySelector('input[name="title"]');a&&(s.title=a.value),n.complete(s,_postURL)}return t.stopPropagation(),t.preventDefault(),!1},bindPost:function(t,i,r,s,o){i.dialog.querySelector(t).removeEventListener("click",n.post),e.$.addListener(i.dialog.querySelector(t),"click",n.post),_prePostDialog=i,_submit=r,_postURL=s,_prepFormCallback=o},complete:function(e,t){var n=null;_options.sent&&(n=_options.sent({title:e.title})),require(["atomic"],function(i){i.post(t,e).success(function(e){_options.callback(e,n)})})}};return n}),define("jstz",[],function(){return function(e){var t=function(){var e="s",n={DAY:864e5,HOUR:36e5,MINUTE:6e4,SECOND:1e3,BASELINE_YEAR:2014,MAX_SCORE:864e6,AMBIGUITIES:{"America/Denver":["America/Mazatlan"],"America/Chicago":["America/Mexico_City"],"America/Santiago":["America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Sao_Paulo"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Europe/Helsinki","Asia/Damascus","Africa/Cairo","Asia/Gaza","Europe/Minsk"],"Pacific/Auckland":["Pacific/Fiji"],"America/Los_Angeles":["America/Santa_Isabel"],"America/New_York":["America/Havana"],"America/Halifax":["America/Goose_Bay"],"America/Godthab":["America/Miquelon"],"Asia/Dubai":["Asia/Yerevan"],"Asia/Jakarta":["Asia/Krasnoyarsk"],"Asia/Shanghai":["Asia/Irkutsk","Australia/Perth"],"Australia/Sydney":["Australia/Lord_Howe"],"Asia/Tokyo":["Asia/Yakutsk"],"Asia/Dhaka":["Asia/Omsk"],"Asia/Baku":["Asia/Yerevan"],"Australia/Brisbane":["Asia/Vladivostok"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Majuro":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk","Europe/Moscow"],"Asia/Karachi":["Asia/Yekaterinburg"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]}},i=function(e){var t=-e.getTimezoneOffset();return null!==t?t:0},r=function(){var t=i(new Date(n.BASELINE_YEAR,0,2)),r=i(new Date(n.BASELINE_YEAR,5,2)),s=t-r;return 0>s?t+",1":s>0?r+",1,"+e:t+",0"},s=function(){if("undefined"!=typeof Intl&&"undefined"!=typeof Intl.DateTimeFormat){var e=Intl.DateTimeFormat();if("undefined"!=typeof e&&"undefined"!=typeof e.resolvedOptions)return e.resolvedOptions().timeZone}},o=function(e){for(var t=new Date(e,0,1,0,0,1,0).getTime(),n=new Date(e,12,31,23,59,59).getTime(),i=t,r=new Date(i).getTimezoneOffset(),s=null,o=null;n-864e5>i;){var u=new Date(i),c=u.getTimezoneOffset();c!==r&&(r>c&&(s=u),c>r&&(o=u),r=c),i+=864e5}return s&&o?{s:a(s).getTime(),e:a(o).getTime()}:!1},a=function p(e,t,i){"undefined"==typeof t&&(t=n.DAY,i=n.HOUR);for(var r=new Date(e.getTime()-t).getTime(),s=e.getTime()+t,o=new Date(r).getTimezoneOffset(),a=r,u=null;s-i>a;){var c=new Date(a),l=c.getTimezoneOffset();if(l!==o){u=c;break}a+=i}return t===n.DAY?p(u,n.HOUR,n.MINUTE):t===n.HOUR?p(u,n.MINUTE,n.SECOND):u},u=function(e,t,n,i){if("N/A"!==n)return n;if("Asia/Beirut"===t){if("Africa/Cairo"===i.name&&13983768e5===e[6].s&&14116788e5===e[6].e)return 0;if("Asia/Jerusalem"===i.name&&13959648e5===e[6].s&&14118588e5===e[6].e)return 0}else if("America/Santiago"===t){if("America/Asuncion"===i.name&&14124816e5===e[6].s&&1397358e6===e[6].e)return 0;if("America/Campo_Grande"===i.name&&14136912e5===e[6].s&&13925196e5===e[6].e)return 0}else if("America/Montevideo"===t){if("America/Sao_Paulo"===i.name&&14136876e5===e[6].s&&1392516e6===e[6].e)return 0}else if("Pacific/Auckland"===t&&"Pacific/Fiji"===i.name&&14142456e5===e[6].s&&13961016e5===e[6].e)return 0;return n},c=function(e,i){for(var r=function(t){for(var r=0,s=0;s<e.length;s++)if(t.rules[s]&&e[s]){if(!(e[s].s>=t.rules[s].s&&e[s].e<=t.rules[s].e)){r="N/A";break}if(r=0,r+=Math.abs(e[s].s-t.rules[s].s),r+=Math.abs(t.rules[s].e-e[s].e),r>n.MAX_SCORE){r="N/A";break}}return r=u(e,i,r,t)},s={},o=t.olson.dst_rules.zones,a=o.length,c=n.AMBIGUITIES[i],l=0;a>l;l++){var d=o[l],p=r(o[l]);"N/A"!==p&&(s[d.name]=p)}for(var h in s)if(s.hasOwnProperty(h)&&-1!=c.indexOf(h))return h;return i},l=function(e){var n=function(){for(var e=[],n=0;n<t.olson.dst_rules.years.length;n++){var i=o(t.olson.dst_rules.years[n]);e.push(i)}return e},i=function(e){for(var t=0;t<e.length;t++)if(e[t]!==!1)return!0;return!1},r=n(),s=i(r);return s?c(r,e):e},d=function(){var e=s();return e||(e=t.olson.timezones[r()],"undefined"!=typeof n.AMBIGUITIES[e]&&(e=l(e))),{name:function(){return e}}};return{determine:d}}();t.olson=t.olson||{},t.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-660,1,s":"Pacific/Apia","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Majuro","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},t.olson.dst_rules={years:[2008,2009,2010,2011,2012,2013,2014],zones:[{name:"Africa/Cairo",rules:[{e:12199572e5,s:12090744e5},{e:1250802e6,s:1240524e6},{e:12858804e5,s:12840696e5},!1,!1,!1,{e:14116788e5,s:1406844e6}]},{name:"America/Asuncion",rules:[{e:12050316e5,s:12243888e5},{e:12364812e5,s:12558384e5},{e:12709548e5,s:12860784e5},{e:13024044e5,s:1317528e6},{e:1333854e6,s:13495824e5},{e:1364094e6,s:1381032e6},{e:13955436e5,s:14124816e5}]},{name:"America/Campo_Grande",rules:[{e:12032172e5,s:12243888e5},{e:12346668e5,s:12558384e5},{e:12667212e5,s:1287288e6},{e:12981708e5,s:13187376e5},{e:13302252e5,s:1350792e6},{e:136107e7,s:13822416e5},{e:13925196e5,s:14136912e5}]},{name:"America/Goose_Bay",rules:[{e:122559486e4,s:120503526e4},{e:125704446e4,s:123648486e4},{e:128909886e4,s:126853926e4},{e:13205556e5,s:129998886e4},{e:13520052e5,s:13314456e5},{e:13834548e5,s:13628952e5},{e:14149044e5,s:13943448e5}]},{name:"America/Havana",rules:[{e:12249972e5,s:12056436e5},{e:12564468e5,s:12364884e5},{e:12885012e5,s:12685428e5},{e:13211604e5,s:13005972e5},{e:13520052e5,s:13332564e5},{e:13834548e5,s:13628916e5},{e:14149044e5,s:13943412e5}]},{name:"America/Mazatlan",rules:[{e:1225008e6,s:12074724e5},{e:12564576e5,s:1238922e6},{e:1288512e6,s:12703716e5},{e:13199616e5,s:13018212e5},{e:13514112e5,s:13332708e5},{e:13828608e5,s:13653252e5},{e:14143104e5,s:13967748e5}]},{name:"America/Mexico_City",rules:[{e:12250044e5,s:12074688e5},{e:1256454e6,s:12389184e5},{e:12885084e5,s:1270368e6},{e:1319958e6,s:13018176e5},{e:13514076e5,s:13332672e5},{e:13828572e5,s:13653216e5},{e:14143068e5,s:13967712e5}]},{name:"America/Miquelon",rules:[{e:12255984e5,s:12050388e5},{e:1257048e6,s:12364884e5},{e:12891024e5,s:12685428e5},{e:1320552e6,s:12999924e5},{e:13520016e5,s:1331442e6},{e:13834512e5,s:13628916e5},{e:14149008e5,s:13943412e5}]},{name:"America/Santa_Isabel",rules:[{e:12250116e5,s:1207476e6},{e:12564612e5,s:12389256e5},{e:12885156e5,s:12703752e5},{e:13199652e5,s:13018248e5},{e:13514148e5,s:13332744e5},{e:13828644e5,s:13653288e5},{e:1414314e6,s:13967784e5}]},{name:"America/Sao_Paulo",rules:[{e:12032136e5,s:12243852e5},{e:12346632e5,s:12558348e5},{e:12667176e5,s:12872844e5},{e:12981672e5,s:1318734e6},{e:13302216e5,s:13507884e5},{e:13610664e5,s:1382238e6},{e:1392516e6,s:14136876e5}]},{name:"Asia/Amman",rules:[{e:1225404e6,s:12066552e5},{e:12568536e5,s:12381048e5},{e:12883032e5,s:12695544e5},{e:13197528e5,s:13016088e5},!1,!1,{e:14147064e5,s:13959576e5}]},{name:"Asia/Damascus",rules:[{e:12254868e5,s:120726e7},{e:125685e7,s:12381048e5},{e:12882996e5,s:12701592e5},{e:13197492e5,s:13016088e5},{e:13511988e5,s:13330584e5},{e:13826484e5,s:1364508e6},{e:14147028e5,s:13959576e5}]},{name:"Asia/Dubai",rules:[!1,!1,!1,!1,!1,!1,!1]},{name:"Asia/Gaza",rules:[{e:12199572e5,s:12066552e5},{e:12520152e5,s:12381048e5},{e:1281474e6,s:126964086e4},{e:1312146e6,s:130160886e4},{e:13481784e5,s:13330584e5},{e:13802292e5,s:1364508e6},{e:14116788e5,s:13959576e5}]},{name:"Asia/Irkutsk",rules:[{e:12249576e5,s:12068136e5},{e:12564072e5,s:12382632e5},{e:12884616e5,s:12697128e5},!1,!1,!1,!1]},{name:"Asia/Jerusalem",rules:[{e:12231612e5,s:12066624e5},{e:1254006e6,s:1238112e6},{e:1284246e6,s:12695616e5},{e:131751e7,s:1301616e6},{e:13483548e5,s:13330656e5},{e:13828284e5,s:13645152e5},{e:1414278e6,s:13959648e5}]},{name:"Asia/Kamchatka",rules:[{e:12249432e5,s:12067992e5},{e:12563928e5,s:12382488e5},{e:12884508e5,s:12696984e5},!1,!1,!1,!1]},{name:"Asia/Krasnoyarsk",rules:[{e:12249612e5,s:12068172e5},{e:12564108e5,s:12382668e5},{e:12884652e5,s:12697164e5},!1,!1,!1,!1]},{name:"Asia/Omsk",rules:[{e:12249648e5,s:12068208e5},{e:12564144e5,s:12382704e5},{e:12884688e5,s:126972e7},!1,!1,!1,!1]},{name:"Asia/Vladivostok",rules:[{e:12249504e5,s:12068064e5},{e:12564e8,s:1238256e6},{e:12884544e5,s:12697056e5},!1,!1,!1,!1]},{name:"Asia/Yakutsk",rules:[{e:1224954e6,s:120681e7},{e:12564036e5,s:12382596e5},{e:1288458e6,s:12697092e5},!1,!1,!1,!1]},{name:"Asia/Yekaterinburg",rules:[{e:12249684e5,s:12068244e5},{e:1256418e6,s:1238274e6},{e:12884724e5,s:12697236e5},!1,!1,!1,!1]},{name:"Asia/Yerevan",rules:[{e:1224972e6,s:1206828e6},{e:12564216e5,s:12382776e5},{e:1288476e6,s:12697272e5},{e:13199256e5,s:13011768e5},!1,!1,!1]},{name:"Australia/Lord_Howe",rules:[{e:12074076e5,s:12231342e5},{e:12388572e5,s:12545838e5},{e:12703068e5,s:12860334e5},{e:13017564e5,s:1317483e6},{e:1333206e6,s:13495374e5},{e:13652604e5,s:1380987e6},{e:139671e7,s:14124366e5}]},{name:"Australia/Perth",rules:[{e:12068136e5,s:12249576e5},!1,!1,!1,!1,!1,!1]},{name:"Europe/Helsinki",rules:[{e:12249828e5,s:12068388e5},{e:12564324e5,s:12382884e5},{e:12884868e5,s:1269738e6},{e:13199364e5,s:13011876e5},{e:1351386e6,s:13326372e5},{e:13828356e5,s:13646916e5},{e:14142852e5,s:13961412e5}]},{name:"Europe/Minsk",rules:[{e:12249792e5,s:12068352e5},{e:12564288e5,s:12382848e5},{e:12884832e5,s:12697344e5},!1,!1,!1,!1]},{name:"Europe/Moscow",rules:[{e:12249756e5,s:12068316e5},{e:12564252e5,s:12382812e5},{e:12884796e5,s:12697308e5},!1,!1,!1,!1]},{name:"Pacific/Apia",rules:[!1,!1,!1,{e:13017528e5,s:13168728e5},{e:13332024e5,s:13489272e5},{e:13652568e5,s:13803768e5},{e:13967064e5,s:14118264e5}]},{name:"Pacific/Fiji",rules:[!1,!1,{e:12696984e5,s:12878424e5},{e:13271544e5,s:1319292e6},{e:1358604e6,s:13507416e5},{e:139005e7,s:1382796e6},{e:14215032e5,s:14148504e5}]}]},"undefined"!=typeof exports?exports.jstz=t:e.jstz=t}(this),jstz});