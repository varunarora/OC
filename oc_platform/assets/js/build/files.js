!function(e){"function"==typeof define&&define.amd?define("timeago",["jquery"],e):e(jQuery)}(function(e){function t(){var t=o(this),n=l.settings;return isNaN(t.datetime)||(0==n.cutoff||Math.abs(i(t.datetime))<n.cutoff)&&e(this).text(s(t.datetime)),this}function o(t){if(t=e(t),!t.data("timeago")){t.data("timeago",{datetime:l.datetime(t)});var o=e.trim(t.text());l.settings.localeTitle?t.attr("title",t.data("timeago").datetime.toLocaleString()):!(o.length>0)||l.isTime(t)&&t.attr("title")||t.attr("title",o)}return t.data("timeago")}function s(e){return l.inWords(i(e))}function i(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return s(t instanceof Date?t:"string"==typeof t?e.timeago.parse(t):"number"==typeof t?new Date(t):e.timeago.datetime(t))};var l=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowPast:!0,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",inPast:"any moment now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(t){function o(o,i){var l=e.isFunction(o)?o(i,t):o,n=s.numbers&&s.numbers[i]||i;return l.replace(/%d/i,n)}if(!this.settings.allowPast&&!this.settings.allowFuture)throw"timeago allowPast and allowFuture settings can not both be set to false.";var s=this.settings.strings,i=s.prefixAgo,l=s.suffixAgo;if(this.settings.allowFuture&&0>t&&(i=s.prefixFromNow,l=s.suffixFromNow),!this.settings.allowPast&&t>=0)return this.settings.strings.inPast;var n=Math.abs(t)/1e3,c=n/60,r=c/60,a=r/24,u=a/365,d=45>n&&o(s.seconds,Math.round(n))||90>n&&o(s.minute,1)||45>c&&o(s.minutes,Math.round(c))||90>c&&o(s.hour,1)||24>r&&o(s.hours,Math.round(r))||42>r&&o(s.day,1)||30>a&&o(s.days,Math.round(a))||45>a&&o(s.month,1)||365>a&&o(s.months,Math.round(a/30))||1.5>u&&o(s.year,1)||o(s.years,Math.round(u)),p=s.wordSeparator||"";return void 0===s.wordSeparator&&(p=" "),e.trim([i,d,l].join(p))},parse:function(t){var o=e.trim(t);return o=o.replace(/\.\d+/,""),o=o.replace(/-/,"/").replace(/-/,"/"),o=o.replace(/T/," ").replace(/Z/," UTC"),o=o.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),o=o.replace(/([\+\-]\d\d)$/," $100"),new Date(o)},datetime:function(t){var o=e(t).attr(l.isTime(t)?"datetime":"title");return l.parse(o)},isTime:function(t){return"time"===e(t).get(0).tagName.toLowerCase()}});var n={init:function(){var o=e.proxy(t,this);o();var s=l.settings;s.refreshMillis>0&&(this._timeagoInterval=setInterval(o,s.refreshMillis))},update:function(o){var s=l.parse(o);e(this).data("timeago",{datetime:s}),l.settings.localeTitle&&e(this).attr("title",s.toLocaleString()),t.apply(this)},updateFromDOM:function(){e(this).data("timeago",{datetime:l.parse(e(this).attr(l.isTime(this)?"datetime":"title"))}),t.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};e.fn.timeago=function(e,t){var o=e?n[e]:n.init;if(!o)throw new Error("Unknown function name '"+e+"' for timeago");return this.each(function(){o.call(this,t)}),this},document.createElement("abbr"),document.createElement("time")}),function(e){"function"==typeof define&&define.amd?define("droppable",["jquery","ui_core","widget","mouse","draggable"],e):e(jQuery)}(function(e){return e.widget("ui.droppable",{version:"@VERSION",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,o=this.options,s=o.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(o.scope),o.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,o){if("accept"===t)this.accept=e.isFunction(o)?o:function(e){return e.is(o)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(o)}this._super(t,o)},_activate:function(t){var o=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),o&&this._trigger("activate",t,this.ui(o))},_deactivate:function(t){var o=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),o&&this._trigger("deactivate",t,this.ui(o))},_over:function(t){var o=e.ui.ddmanager.current;o&&(o.currentItem||o.element)[0]!==this.element[0]&&this.accept.call(this.element[0],o.currentItem||o.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(o)))},_out:function(t){var o=e.ui.ddmanager.current;o&&(o.currentItem||o.element)[0]!==this.element[0]&&this.accept.call(this.element[0],o.currentItem||o.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(o)))},_drop:function(t,o){var s=o||e.ui.ddmanager.current,i=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var o=e(this).droppable("instance");return o.options.greedy&&!o.options.disabled&&o.options.scope===s.options.scope&&o.accept.call(o.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(o,{offset:o.element.offset()}),o.options.tolerance,t)?(i=!0,!1):void 0}),i?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,o){return e>=t&&t+o>e}return function(t,o,s,i){if(!o.offset)return!1;var l=(t.positionAbs||t.position.absolute).left+t.margins.left,n=(t.positionAbs||t.position.absolute).top+t.margins.top,c=l+t.helperProportions.width,r=n+t.helperProportions.height,a=o.offset.left,u=o.offset.top,d=a+o.proportions().width,p=u+o.proportions().height;switch(s){case"fit":return l>=a&&d>=c&&n>=u&&p>=r;case"intersect":return a<l+t.helperProportions.width/2&&c-t.helperProportions.width/2<d&&u<n+t.helperProportions.height/2&&r-t.helperProportions.height/2<p;case"pointer":return e(i.pageY,u,o.proportions().height)&&e(i.pageX,a,o.proportions().width);case"touch":return(n>=u&&p>=n||r>=u&&p>=r||u>n&&r>p)&&(l>=a&&d>=l||c>=a&&d>=c||a>l&&c>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,o){var s,i,l=e.ui.ddmanager.droppables[t.options.scope]||[],n=o?o.type:null,c=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;s<l.length;s++)if(!(l[s].options.disabled||t&&!l[s].accept.call(l[s].element[0],t.currentItem||t.element))){for(i=0;i<c.length;i++)if(c[i]===l[s].element[0]){l[s].proportions().height=0;continue e}l[s].visible="none"!==l[s].element.css("display"),l[s].visible&&("mousedown"===n&&l[s]._activate.call(l[s],o),l[s].offset=l[s].element.offset(),l[s].proportions({width:l[s].element[0].offsetWidth,height:l[s].element[0].offsetHeight}))}},drop:function(t,o){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,o)&&(s=this._drop.call(this,o)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,o)))}),s},dragStart:function(t,o){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,o)})},drag:function(t,o){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,o),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,i,l,n=e.ui.intersect(t,this,this.options.tolerance,o),c=!n&&this.isover?"isout":n&&!this.isover?"isover":null;c&&(this.options.greedy&&(i=this.options.scope,l=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===i}),l.length&&(s=e(l[0]).droppable("instance"),s.greedyChild="isover"===c)),s&&"isover"===c&&(s.isover=!1,s.isout=!0,s._out.call(s,o)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,o),s&&"isout"===c&&(s.isout=!1,s.isover=!0,s._over.call(s,o)))}})},dragStop:function(t,o){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,o)}},e.ui.droppable}),define("resourcesCollections",["jquery","underscore","core","timeago","draggable","droppable"],function(e,t){t.extend(OC.resourcesCollections,{resourceItemTemplate:t.template('<div class="<%= host %>-browse-item resource-collection-item resource <%= type %>-resource" id="resource-<%= id %>"><input type="checkbox" name="resource_id" value="<%= id %>"/><a href="<%= url %>"><%= title %> <span class="<%= host %>-browse-item-date"><%= created %></span><div class="resource-collection-actions <%= resource_type %> <%= is_collaborator %> is-owner"><span class="<%= host %>-browse-item-visibility browse-item-visibility visibility-<%= visibility %>" title=" Who has access: <%= access %>"></span><div class="<%= host %>-resource-delete resource-collection-delete" id="resource-<%= id %>" title="Delete"></div></div></a></div>'),resourceCollectionItemTemplate:t.template('<div class="resource-collection-item <%= category %>" id="<%= category %>-<%= id %>"><% if (owner){ %> <div class="resource-item-selector"><input type="checkbox" name="resource_collection_id" value="<%= id %>"/></div><% } %><a href="<%= url %>"<% if (open_url){ %> target="_blank"<% } %> class="resource-item-thumbnail" style="background-image: url(\'<%= thumbnail %>\');"><div class="resource-item-thumbnail-selector"></div><div class="resource-item-thumbnail-<%= type %>"></div></a><div class="resource-item-description"><div class="resource-item-description-title"><a href="<%= url %>"<% if (open_url){ %> target="_blank"<% } %>><%= title %></a></div><div class="resource-item-description-modified" title="<%= modified %>"><%= modified %></div><div class="resource-item-description-actions"><div class="resource-item-description-actions-visibility"><span class=" <%= host %>-browse-item-visibility browse-item-visibility visibility-<%= visibility %> <%= visibility_classes %>"><span class="visibility-icon"></span><%= visibility_title %></span></div></div></div></div>'),collectionItemTemplate:t.template('<div class="<%= host %>-browse-item resource-collection-item directory " id="collection-<%= id %>"><input type="checkbox" name="collection_id" value="<%= id %>"/><a href="<%= url %>"><%= title %> <span class="<%= host %>-browse-item-date"><%= created %></span><div class="resource-collection-actions <%= collection_type %> <%= is_collaborator %> is-owner"><span class="<%= host %>-browse-item-visibility browse-item-visibility visibility-<%= visibility %>" title=" Who has access: <%= access %>"></span><div class="<%= host %>-collection-delete resource-collection-delete" id="collection-<%= id %>" title="Delete"></div></div></a></div>'),currentResourceCollectionVisibility:"",initResourcesCollections:function(){e(".resource-collection-item").length>=1&&(OC.resourcesCollections.initFavoriteStates(),OC.resourcesCollections.initCopyAction(),OC.resourcesCollections.ownerView&&OC.resourcesCollections.bindItemSelect(),OC.resourcesCollections.infiniteScroll()),e(".resources-collections-added").length>=1&&(e(".project-browse-item-visibility, .profile-browse-item-visibility").tipsy({gravity:"n"}),e(".resource-collection-delete").tipsy({gravity:"n"}),OC.resourcesCollections.bindItemVisibilityButton(),OC.resourcesCollectionsActions.initResourcesCollectionsActions())},initFavoriteStates:function(){function t(t,s){o=e(".resource-collection-item#resource-"+t);var i=e(".resource-favorite",o),l=e(".resource-favorite-wrapper",o);s&&(l.addClass("favorited"),i.text("Favorited")),i.click(function(o){var s=e(this),i=s.parent(".resource-favorite-wrapper");return OC.favoriteClickHandler("resource",t,function(){i.addClass("favorited"),s.text("Favorited")},function(){i.removeClass("favorited"),s.text("Favorite")}),o.stopPropagation(),o.preventDefault(),!1})}var o,s,i,l=e(".resource-collection-item");for(s=0;s<l.length;s++)i=e(l[s]).attr("id").substring(9),OC.getFavoriteState("resource",i,t)},infiniteScroll:function(){if(OC.resourcesCollections.resourceCount>20){var t,o,s=e(".lazy-load-button");e(".profile-content").on("DOMContentLoaded load resize scroll",function(){t=e(".resources-collections-added").attr("id").substring(11),e.contains(document,s[0])&&isElementInViewport(s)&&!s.hasClass("loading")&&(s.addClass("loading"),e.get("/resources/api/load-resources/"+t+"/from/"+OC.resourcesCollections.currentCount+"/",function(t){if("true"==t.status){var i=Object.keys(t.resources);if(0!==i.length){var l,n;for(o=0;o<i.length;o++){n=t.resources[i[o]],n.owner=OC.resourcesCollections.ownerView,e(".resources-collections-added").append(OC.resourcesCollections.resourceCollectionItemTemplate(n));var c=".resources-collections-added .resource-collection-item:last";l=e(c),OC.resourcesCollections.bindItemSelect(c),OC.resourcesCollectionsActions.bindResourceCollectionSelectors(c),e(".resource-item-description-modified",l).timeago()}OC.resourcesCollections.currentCount+=i.length}else s.remove()}else OC.popup(t.message,t.title);s.removeClass("loading")},"json"))})}},initCopyAction:function(){var t,o=e(".resource-collection-item"),s=e(".resources-collections-added");s.length>=1&&(t=s.attr("id").substring(11));var i;for(i=0;i<o.length;i++){var l,n;resourceCollectionItem=e(o[i]),resourceCollectionCopyButton=e(".resource-copy",resourceCollectionItem),resourceCollectionItem.hasClass("collection")?n=resourceCollectionItem.attr("id").substring(11):(l=resourceCollectionItem.attr("id").substring(9),n=void 0),t?n?OC.resourcesCollections.bindResourceCollectionCopyButton("collection",n,t):OC.resourcesCollections.bindResourceCollectionCopyButton("resource",l,t):n?OC.resourcesCollections.fetchParentCollectionAndBindCopyButton("collection",n,OC.resourcesCollections.bindResourceCollectionCopyButton):OC.resourcesCollections.fetchParentCollectionAndBindCopyButton("resource",l,OC.resourcesCollections.bindResourceCollectionCopyButton)}},synchronizeSelectors:function(){var t,o,s,i=e(".resource-item-thumbnail-selector"),l=0;for(l=0;l<i.length;l++)t=e(i[l]),s=t.parents(".resource-collection-item"),o=s.find("input[name=resource_collection_id]")[0],o.checked?s.addClass("selected"):s.removeClass("selected")},bindItemSelect:function(t){var o=t||".resource-collection-item";e(o).click(OC.resourcesCollections.itemSelectClickHandlers.itemClick),e(o+" input[name=resource_collection_id]").click(OC.resourcesCollections.itemSelectClickHandlers.inputClick),OC.resourcesCollections.itemSelectClickHandlers.preventPropagationOnItemClick(o)},itemSelectClickHandlers:{itemClick:function(){var t=e(this),o=e("input[name=resource_collection_id]",t),s=o[0];s.checked?o.prop("checked",!1):o.prop("checked",!0),t.toggleClass("selected"),o.trigger("itemSelected")},inputClick:function(t){var o=e(t.target).parents(".resource-collection-item");o.toggleClass("selected"),e(t.target).trigger("itemSelected")},preventPropagationOnItemClick:function(t){e(t+" input[name=resource_collection_id], "+t+" a.resource-item-thumbnail, "+t+" .resource-item-description-title a").click(function(e){e.stopPropagation()})}},bindResourceCollectionCopyButton:function(e,t,o){resourceCollectionCopyButton.click(function(s){OC.addCopyClickHandler(e,t,o,s)})},fetchParentCollectionAndBindCopyButton:function(t,o,s){"collection"===t?e.get("/resources/parent-collection-from-collection/"+o+"/",function(e){"true"==e.status?s("collection",collectionID,e.collectionID):OC.popup(e.message,e.title)},"json"):e.get("/resources/collection-from-resource/"+o+"/",function(e){"true"==e.status?s("resource",resourceID,e.collectionID):OC.popup(e.message,e.title)},"json")},bindItemVisibilityButton:function(){e(".browse-item-visibility").click(OC.resourcesCollections.itemVisibilityButtonClickHandler)},itemVisibilityButtonClickHandler:function(t){var o=e(t.target);if(o.hasClass("is-owner")||o.hasClass("is-collaborator")){var s=o.hasClass("project-browse-item-visibility"),i=e(t.target).closest(".resource-collection-item");i.type=i.hasClass("collection")?"collection":"resource",i.id=i.attr("id").substring("collection"===i.type?11:9),OC.collaborators.currentResourceCollectionVisibility=OC.resourcesCollections.getResourceCollectionVisibility(o,s),OC.collaborators.init(i,OC.resourcesCollections.resourceVisibility.setupToggler,OC.resourcesCollections.collectionVisibility.setupToggler,OC.resourcesCollections.closeCollaboratorPopupCallback,o.hasClass("is-owner"))}return t.stopPropagation(),t.preventDefault(),!1},getResourceCollectionVisibility:function(e,t){return e.hasClass("visibility-private")?"private":t?"project":"public"},collectionVisibility:{setupToggler:function(t,o){var s=e(".resources-collections-added #collection-"+t+" .browse-item-visibility");if(o){var i=e('.resource-collection-visibility-form-tabs li a[href="#project-access"]');i.click(function(){OC.resourcesCollections.collectionVisibility.setProjectVisibility(s,t)})}else{var l=e('.resource-collection-visibility-form-tabs li a[href="#profile-access"]');l.click(function(){OC.resourcesCollections.collectionVisibility.setPublicVisibility(s,t)})}var n=e('.resource-collection-visibility-form-tabs li a[href="#private-access"]');n.click(function(){OC.resourcesCollections.collectionVisibility.setPrivateVisibility(s,t)})},setProjectVisibility:function(e){e.removeClass("visibility-private"),e.addClass("visibility-project"),e.html('<span class="group-shared-icon"></span>Shared with group')},setPrivateVisibility:function(e){e.removeClass("visibility-project"),e.removeClass("visibility-public"),e.addClass("visibility-private"),e.html('<span class="private-shared-icon"></span>Shared')},setPublicVisibility:function(e){e.removeClass("visibility-private"),e.addClass("visibility-public"),e.html('<span class="publicly-shared-icon"></span>Public')}},resourceVisibility:{setupToggler:function(t,o){var s=e(".resources-collections-added #resource-"+t+" .browse-item-visibility");if(o){var i=e('.resource-collection-visibility-form-tabs li a[href="#project-access"]');i.click(function(){OC.resourcesCollections.resourceVisibility.setProjectVisibility(s,t)})}else{var l=e('.resource-collection-visibility-form-tabs li a[href="#profile-access"]');l.click(function(){OC.resourcesCollections.resourceVisibility.setPublicVisibility(s,t)})}var n=e('.resource-collection-visibility-form-tabs li a[href="#private-access"]');n.click(function(){OC.resourcesCollections.resourceVisibility.setPrivateVisibility(s,t)})},setProjectVisibility:function(e){e.removeClass("visibility-private"),e.addClass("visibility-project"),e.html('<span class="group-shared-icon"></span>Shared with group')},setPrivateVisibility:function(e){e.removeClass("visibility-project"),e.removeClass("visibility-public"),e.addClass("visibility-private"),e.html('<span class="private-shared-icon"></span>Shared')},setPublicVisibility:function(e){e.removeClass("visibility-private"),e.addClass("visibility-public"),e.html('<span class="publicly-shared-icon"></span>Public')}},closeCollaboratorPopupCallback:function(){var t=e("form#add-collection-collaborator-form input[name=collection_id]").val(),o=e("form#add-collection-collaborator-form input[name=resource_id]").val(),s=""===t?"resource-"+o:"collection-"+t,i=e(".resources-collections-added").hasClass("project-resources-collections"),l=e(".resources-collections-added #"+s+" .browse-item-visibility"),n=OC.resourcesCollections.getResourceCollectionVisibility(l,i);n!==OC.resourcesCollections.currentResourceCollectionVisibility&&""!==t&&(OC.setMessageBoxMessage("Changing access control of resources and folders inside..."),OC.showMessageBox(),OC.resourcesCollections.collectionVisibilityChangePropagation(t))},collectionVisibilityChangePropagation:function(t){e.get("/resources/collection/"+t+"/visibility/propagate-changes/",function(e){"true"===e.status?OC.resourcesCollections.collectionVisibilityPropagationSuccess():OC.popup(e.message,e.title)},"json")},collectionVisibilityPropagationSuccess:function(){OC.dismissMessageBox()}}),OC.resourcesCollectionsActions={pendingActions:{copyResources:[],copyCollections:[],deleteResources:[],deleteCollections:[],renameResources:[],renameCollections:[]},actionsCompleted:{copyResources:[],copyCollections:[],deleteResources:[],deleteCollections:[],renameResources:[],renameCollections:[]},actionCompletionCallback:"",actionCompleted:function(){var e,t=!0;for(e in OC.resourcesCollectionsActions.pendingActions)if(OC.resourcesCollectionsActions.pendingActions[e].length>=1){t=!1;break}t&&OC.resourcesCollectionsActions.actionCompletionCallback()},initResourcesCollectionsActions:function(){var t=e(".resources-collections-added");t.length>0&&(OC.resourcesCollectionsActions.initBrowseNavigation(),OC.resourcesCollectionsActions.initMoveResourcesCollections(),OC.resourcesCollectionsActions.initResourceCollectionActions())},initMoveResourcesCollections:function(){OC.resourcesCollectionsActions.initResourceCollectionsDraggability(e(".resource-collection-item")),OC.resourcesCollectionsActions.initResourceCollectionsDroppability(e(".resource-collection-item.directory"))},initResourceCollectionsDraggability:function(e){e.draggable({revert:"invalid"})},initResourceCollectionsDroppability:function(t){t.droppable({hoverClass:"droppable",accept:".directory, .resource",drop:function(t,o){o.draggable.hasClass("directory")?(OC.resourcesCollectionsActions.moveCollectionIntoCollection(o.draggable.attr("id").substring(11),e(t.target).attr("id").substring(11)),OC.resourcesCollectionsActions.movedIntoCollection([],[o.draggable])):(OC.resourcesCollectionsActions.moveResourceIntoCollection(o.draggable.attr("id").substring(9),e(t.target).attr("id").substring(11)),OC.resourcesCollectionsActions.movedIntoCollection([o.draggable],[]))}})},moveResourceIntoCollection:function(t,o){var s=e(".resources-collections-added").attr("id").substring(11);e.get("/resources/move/resource/"+t+"/from/"+s+"/to/"+o+"/",function(e){"true"==e.status?OC.resourcesCollectionsActions.resourceCollectionMovedSuccess(".resource-collection-item#resource-"+t):OC.popup(e.message,e.title)},"json")},moveCollectionIntoCollection:function(t,o){var s=e(".resources-collections-added").attr("id").substring(11);e.get("/resources/move/collection/"+t+"/from/"+s+"/to/"+o+"/",function(e){"true"==e.status?OC.resourcesCollectionsActions.resourceCollectionMovedSuccess(".resource-collection-item#collection-"+t):OC.popup(e.message,e.title)},"json")},resourceCollectionMovedSuccess:function(t){e(t).fadeOut("fast")},movedIntoCollection:function(e,t){var o=e||[],s=t||[];o.length>=1&&s.length>=1?OC.setMessageBoxMessage("Moved resources and folders successfully"):o.length>=1?OC.setMessageBoxMessage("Moved resource(s) into the folder successfully"):s.length>=1&&OC.setMessageBoxMessage("Moved folder(s) successfully"),OC.showMessageBox()},resourceCopiedSuccessfully:function(t,o){var s="project"===t.host?"":"profile-resource",i="collection"===t.visibility?"Private (collection)":t.visibility.charAt(0).toUpperCase();t.resource_type=s,t.access=i;var l=OC.resourcesCollections.resourceCollectionItemTemplate(t);e("."+t.host+"-resources-added-list").append(l);var n=e("."+t.host+"-resources-added-list .resource-collection-item:last"),c=e("input[type=checkbox]",n),r=e(".browse-item-visibility",n);c.click(OC.resourcesCollectionsActions.resourceCollectionCheckboxHandler),r.click(OC.resourcesCollections.itemVisibilityButtonClickHandler),OC.resourcesCollectionsActions.initResourceCollectionsDraggability(n),e(".resource-item-description-modified",n).timeago(),OC.resourcesCollectionsActions.pendingActions.copyResources.splice(o),OC.resourcesCollectionsActions.actionsCompleted.copyResources.push(o),OC.resourcesCollectionsActions.actionCompleted()},collectionCopiedSuccessfully:function(t,o){var s="project"===t.host?"":"profile-collection",i="collection"===t.visibility?"Private (collection)":t.visibility.charAt(0).toUpperCase();t.collection_type=s,t.access=i;var l=OC.resourcesCollections.collectionItemTemplate(t);e("."+t.host+"-collections-added-list").append(l);var n=e("."+t.host+"-collections-added-list .resource-collection-item:last"),c=e("input[type=checkbox]",n),r=e(".browse-item-visibility",n);c.click(OC.resourcesCollectionsActions.resourceCollectionCheckboxHandler),r.click(OC.resourcesCollections.itemVisibilityButtonClickHandler),OC.resourcesCollectionsActions.initResourceCollectionsDraggability(n),OC.resourcesCollectionsActions.initResourceCollectionsDroppability(n),e(".resource-item-description-modified",n).timeago(),OC.resourcesCollectionsActions.pendingActions.copyCollections.splice(o),OC.resourcesCollectionsActions.actionsCompleted.copyCollections.push(o),OC.resourcesCollectionsActions.actionCompleted()},resourceRenamedSuccessfully:function(t,o){var s=e(".resource-collection-item#resource-"+t),i=e(".resource-item-description-title a",s);i.text(o),s.trigger("click"),OC.resourcesCollectionsActions.pendingActions.renameResources.splice(t),OC.resourcesCollectionsActions.actionsCompleted.renameResources.push(t),OC.resourcesCollectionsActions.actionCompleted()},collectionRenamedSuccessfully:function(t,o){var s=e(".resource-collection-item#collection-"+t),i=e(".resource-item-description-title a",s);i.text(o),s.trigger("click"),OC.resourcesCollectionsActions.pendingActions.renameCollections.splice(t),OC.resourcesCollectionsActions.actionsCompleted.renameCollections.push(t),OC.resourcesCollectionsActions.actionCompleted()},copying:function(){OC.setMessageBoxMessage("Copying..."),OC.showMessageBox()},copied:function(){var e=OC.resourcesCollectionsActions.actionsCompleted.copyResources,t=OC.resourcesCollectionsActions.actionsCompleted.copyCollections;e.length>=1&&t.length>=1?OC.setMessageBoxMessage("Copied resources and folders successfully"):e.length>=1?OC.setMessageBoxMessage("Copied resource(s) successfully"):t.length>=1&&OC.setMessageBoxMessage("Copied folder(s) successfully"),OC.showMessageBox()},renaming:function(){OC.setMessageBoxMessage("Renaming..."),OC.showMessageBox()},renamed:function(){var e=OC.resourcesCollectionsActions.actionsCompleted.renameResources,t=OC.resourcesCollectionsActions.actionsCompleted.renameCollections;1===e.length?OC.setMessageBoxMessage("Renamed resource successfully"):1===t.length&&OC.setMessageBoxMessage("Renamed folder successfully"),OC.showMessageBox()},collectionsDeletedSuccessfully:function(t){var o;for(o=0;o<t.length;o++)OC.resourcesCollectionsActions.pendingActions.deleteCollections.splice(t[o]),OC.resourcesCollectionsActions.actionsCompleted.deleteCollections.push(t[o]),e(".resource-collection-item#collection-"+t[o]).fadeOut();OC.resourcesCollectionsActions.actionCompleted()},resourcesDeletedSuccessfully:function(t){var o;for(o=0;o<t.length;o++)OC.resourcesCollectionsActions.pendingActions.deleteResources.splice(t[o]),OC.resourcesCollectionsActions.actionsCompleted.deleteResources.push(t[o]),e(".resource-collection-item#resource-"+t[o]).fadeOut();OC.resourcesCollectionsActions.actionCompleted()},deleting:function(){OC.setMessageBoxMessage("Deleting..."),OC.showMessageBox()},deleted:function(){var e=OC.resourcesCollectionsActions.actionsCompleted.deleteResources,t=OC.resourcesCollectionsActions.actionsCompleted.deleteCollections;e.length>=1&&t.length>=1?OC.setMessageBoxMessage("Deleted resources and folders successfully"):e.length>=1?OC.setMessageBoxMessage("Deleted resource(s) successfully"):t.length>=1&&OC.setMessageBoxMessage("Deleted folder(s) successfully"),OC.showMessageBox()},initResourceCollectionActions:function(){function t(){var t=e(".profile-resources-collections-wrapper"),o=e(".profile-resources-collections-actions-menu");return isElementInViewport(t)?o.height()>t.height()?o.height():t.height():e(window).height()-t.offset().top}function o(){i.height(a)}var s=e(".profile-resources-collections-actions"),i=e(".profile-resources-collections-actions-shadow"),l=e(".profile-resources-collections-wrapper"),n=e(".profile-tabs"),c=n.position().top+n.outerHeight(!0),r=s.position().left;s.css({top:c,left:r});var a=t();e(".profile-content").on("scroll",function(){isElementInViewport(s)&&!s.hasClass("floating")?s.position().top<c&&(s.addClass("floating"),i.height(e(window).height()-c)):s.hasClass("floating")&&l.position().top>c&&(s.removeClass("floating"),i.height(a))}),o(),e(window).resize(function(){a=t(),o()}),OC.resourcesCollectionsActions.bindResourceCollectionSelectors(),OC.resourcesCollectionsActions.actionButtonsClickHandler();var u=e(".resource-collection-item input[type=checkbox]:checked");if(u.length>=1){var d;for(d=0;d<u.length;d++)OC.resourcesCollectionsActions.selectedResourcesCollections.push(u[d])}else OC.resourcesCollectionsActions.selectedResourcesCollectionsChangeListener()},actionButtonsClickHandler:function(){var t=e(".collection-actions .move-button");t.click(OC.resourcesCollectionsActions.moveButtonClickHandler);var o=e(".collection-actions .copy-button");o.click(OC.resourcesCollectionsActions.copyButtonClickHandler);var s=e(".collection-actions .rename-button");s.click(OC.resourcesCollectionsActions.renameButtonClickHandler);var i=e(".collection-actions .del-button");i.click(OC.resourcesCollectionsActions.deleteButtonClickHandler)},moveButtonClickHandler:function(t){var o=OC.customPopup(".move-resource-collection-dialog"),s=e(".move-resource-collection-browser"),i=e(".resources-collections-added").attr("id").substring(11);s.children().remove(),s.addClass("loading-browser"),e(".move-resource-collection-submit-button").click(function(){var t=s.find(".selected-destination-collection");if(o.close(),t){var i,l=t.attr("id").substring(11),n=[],c=[];for(i=0;i<OC.resourcesCollectionsActions.selectedResourcesCollections.length;i++){var r=e(OC.resourcesCollectionsActions.selectedResourcesCollections[i]).closest(".resource-collection-item");r.hasClass("collection")?(OC.resourcesCollectionsActions.moveCollectionIntoCollection(r.attr("id").substring(11),l),c.push(OC.resourcesCollectionsActions.selectedResourcesCollections[i])):(OC.resourcesCollectionsActions.moveResourceIntoCollection(r.attr("id").substring(9),l),n.push(OC.resourcesCollectionsActions.selectedResourcesCollections[i]))}OC.resourcesCollectionsActions.movedIntoCollection(n,c)}});var l=e(".resources-collections-added").hasClass("project-resources-collections");return l?e.get("/resources/collection/"+i+"/tree/collections/project/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,s,i),s.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json"):e.get("/resources/tree/collections/user/",function(e){"true"==e.status?(OC.renderBrowser(e.tree,s,i),s.removeClass("loading-browser")):OC.popup(e.message,e.title)},"json"),t.stopPropagation(),t.preventDefault(),!1},copyButtonClickHandler:function(t){var o=e(".resources-collections-added").attr("id").substring(11);OC.resourcesCollectionsActions.copying();
var s,i=[],l=[];for(s=0;s<OC.resourcesCollectionsActions.selectedResourcesCollections.length;s++){var n=e(OC.resourcesCollectionsActions.selectedResourcesCollections[s]).closest(".resource-collection-item");if(n.hasClass("collection")){var c=n.attr("id").substring(11);OC.collection.copy(c,o,OC.resourcesCollectionsActions.collectionCopiedSuccessfully),l.push(c)}else{var r=n.attr("id").substring(9);OC.resource.copy(o,r,o,OC.resourcesCollectionsActions.resourceCopiedSuccessfully),i.push(r)}}return OC.resourcesCollectionsActions.pendingActions.copyResources.concat(i),OC.resourcesCollectionsActions.pendingActions.copyCollections.concat(l),OC.resourcesCollectionsActions.actionCompletionCallback=OC.resourcesCollectionsActions.copied,t.stopPropagation(),t.preventDefault(),!1},renameButtonClickHandler:function(t){OC.resourcesCollectionsActions.renaming();var o=e(OC.resourcesCollectionsActions.selectedResourcesCollections[0]).closest(".resource-collection-item"),s=OC.customPopup(".rename-file-folder-dialog"),i=e('input[name="new_name"]',s.dialog),l=e(".resource-item-description-title a",o).text();return i.val(l),e(".rename-file-folder-submit-button",s.dialog).click(function(t){s.close();var n=i.val();if(n!==l){var c=[],r=[];if(o.hasClass("collection")){var a=o.attr("id").substring(11);OC.collection.rename(a,n,OC.resourcesCollectionsActions.collectionRenamedSuccessfully),r.push(a)}else{var u=o.attr("id").substring(9);OC.resource.rename(u,n,OC.resourcesCollectionsActions.resourceRenamedSuccessfully),c.push(u)}OC.resourcesCollectionsActions.pendingActions.renameResources.concat(c),OC.resourcesCollectionsActions.pendingActions.renameCollections.concat(r),OC.resourcesCollectionsActions.actionCompletionCallback=OC.resourcesCollectionsActions.renamed}return i.val(""),e(this).unbind("click"),t.stopPropagation(),t.preventDefault(),!1}),t.stopPropagation(),t.preventDefault(),!1},setDialogMessage:function(t,o,s){e(t+"-message").text(o),e(t+"-title").text(s)},getSelectedResourcesCollections:function(){var t,o=[],s=[];for(t=0;t<OC.resourcesCollectionsActions.selectedResourcesCollections.length;t++){var i=e(OC.resourcesCollectionsActions.selectedResourcesCollections[t]).closest(".resource-collection-item");i.hasClass("collection")?s.push(OC.resourcesCollectionsActions.selectedResourcesCollections[t]):o.push(OC.resourcesCollectionsActions.selectedResourcesCollections[t])}return[o,s]},deleteButtonClickHandler:function(t){var o=e(".resources-collections-added").attr("id").substring(11);OC.resourcesCollectionsActions.deleting();var s,i=[],l=[],n=[],c=[];for(s=0;s<OC.resourcesCollectionsActions.selectedResourcesCollections.length;s++){var r=e(OC.resourcesCollectionsActions.selectedResourcesCollections[s]).closest(".resource-collection-item");r.hasClass("collection")?(l.push(r.attr("id").substring(11)),c.push(OC.resourcesCollectionsActions.selectedResourcesCollections[s])):(i.push(r.attr("id").substring(9)),n.push(OC.resourcesCollectionsActions.selectedResourcesCollections[s]))}return resourceCollections=OC.resourcesCollectionsActions.getSelectedResourcesCollections(),resourceCollections[0].length>1&&resourceCollections[1].length>1?(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete these files and folders? This will also delete all the files and folders within these folders.","Delete files and folders"),OC.resource.deleteMultiple(i,o,OC.resourcesCollectionsActions.resourcesDeletedSuccessfully),OC.collection.deleteMultiple(l,OC.resourcesCollectionsActions.collectionsDeletedSuccessfully)):resourceCollections[0].length>1&&1===resourceCollections[1].length?(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete these files and the selected folder? This will also delete all the files and folders within the folder.","Delete files and folder"),OC.resource.deleteMultiple(i,o,OC.resourcesCollectionsActions.resourcesDeletedSuccessfully),OC.collection.delete(l[0],OC.resourcesCollectionsActions.collectionsDeletedSuccessfully)):1===resourceCollections[0].length&&resourceCollections[1].length>1?(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete these folders and the selected file? This will also delete all the files and folders within these folders.","Delete folders and file"),OC.resource.delete(i[0],o,OC.resourcesCollectionsActions.resourcesDeletedSuccessfully),OC.collection.deleteMultiple(l,OC.resourcesCollectionsActions.collectionsDeletedSuccessfully)):1===resourceCollections[0].length&&1===resourceCollections[1].length?(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete this folder and this file? This will also delete all the files and folders within the folder.","Delete folder and file"),OC.resource.delete(i[0],o,OC.resourcesCollectionsActions.resourcesDeletedSuccessfully),OC.collection.delete(l[0],OC.resourcesCollectionsActions.collectionsDeletedSuccessfully)):resourceCollections[0].length>1?(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete these resources?","Delete resources"),OC.resource.deleteMultiple(i,o,OC.resourcesCollectionsActions.resourcesDeletedSuccessfully)):resourceCollections[1].length>1?(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete these folders? This will also delete all the files and folders within these folders.","Delete folders"),OC.collection.deleteMultiple(l,OC.resourcesCollectionsActions.resourcesDeletedSuccessfully)):1===resourceCollections[0].length?(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete this resource?","Delete resource"),OC.resource.delete(i[0],o,OC.resourcesCollectionsActions.resourcesDeletedSuccessfully)):1===resourceCollections[1].length&&(OC.resourcesCollectionsActions.setDialogMessage(".delete-resource-collection-dialog","Are you sure you want to delete this folder? This will also delete all the files and folders within the folder.","Delete folder"),OC.collection.delete(l[0],OC.resourcesCollectionsActions.collectionsDeletedSuccessfully)),OC.resourcesCollectionsActions.pendingActions.deleteResources.concat(n),OC.resourcesCollectionsActions.pendingActions.deleteCollections.concat(c),OC.resourcesCollectionsActions.actionCompletionCallback=OC.resourcesCollectionsActions.deleted,t.stopPropagation(),t.preventDefault(),!1},bindResourceCollectionSelectors:function(t){var o=t||".resource-collection-item";e(o+" input[type=checkbox]").on("itemSelected",OC.resourcesCollectionsActions.resourceCollectionCheckboxHandler)},selectedResourcesCollections:[],resourceCollectionCheckboxHandler:function(t){var o=e(t.target).closest(".resource-collection-item");if(t.target.checked===!1){var s=OC.resourcesCollectionsActions.selectedResourcesCollections.indexOf(o);OC.resourcesCollectionsActions.selectedResourcesCollections.splice(s,1)}else OC.resourcesCollectionsActions.selectedResourcesCollections.push(o);OC.resourcesCollectionsActions.selectedResourcesCollectionsChangeListener()},selectedResourcesCollectionsChangeListener:function(){var t=e(".collection-actions .move-button"),o=e(".collection-actions .copy-button"),s=e(".collection-actions .del-button"),i=e(".collection-actions .rename-button"),l=e(".collection-actions .share-button"),n=e(".profile-resources-collections-actions-menu-edit"),c=e(".profile-resources-collections-actions-menu-add");OC.resourcesCollectionsActions.selectedResourcesCollections.length>=1?(n.hasClass("show")||(n.addClass("show"),c.addClass("fade-out")),1==OC.resourcesCollectionsActions.selectedResourcesCollections.length?(OC.resourcesCollectionsActions.enableActionButton(l),OC.resourcesCollectionsActions.enableActionButton(i)):(OC.resourcesCollectionsActions.disableActionButton(l),OC.resourcesCollectionsActions.disableActionButton(i)),OC.resourcesCollectionsActions.enableActionButton(t),OC.resourcesCollectionsActions.enableActionButton(o),OC.resourcesCollectionsActions.enableActionButton(s),OC.resourcesCollectionsActions.actionButtonsClickHandler()):(OC.resourcesCollectionsActions.disableActionButton(t),OC.resourcesCollectionsActions.disableActionButton(o),OC.resourcesCollectionsActions.disableActionButton(s),OC.resourcesCollectionsActions.disableActionButton(i),OC.resourcesCollectionsActions.disableActionButton(l),n.removeClass("show"),c.removeClass("fade-out"))},enableActionButton:function(e){e.removeClass("disabled-collection-button"),e.disabled=!1,e.unbind("click")},disableActionButton:function(e){e.addClass("disabled-collection-button"),e.disabled=!0,e.unbind("click"),e.click(function(e){return e.stopPropagation(),e.preventDefault(),!1})},initBrowseNavigation:function(){var t=e(".resources-collections-added").attr("id").substring(11),o=e("nav.collections-navigation").find("a#collection-"+t);o.addClass("current-navigation-collection"),o.parents(".parent-collection").each(function(){e(this).find(".toggle-collection:first").click()})}},e(document).ready(function(e){OC.resourcesCollections.initResourcesCollections(),OC.resourcesCollections.ownerView&&OC.resourcesCollections.synchronizeSelectors(),e(".resource-item-description-modified").timeago()})}),define("nanoscroller",["jquery"],function(e){!function(t,o){var s,i,l,n,c,r,a,u,d,p,h,C,g,f,m,v,b,y,O,A,w,S,x,R,M,k,T,B,D;w={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},v="scrollbar",m="scroll",u="mousedown",d="mousemove",h="mousewheel",p="mouseup",f="resize",c="drag",y="up",g="panedown",l="DOMMouseScroll",n="down",O="wheel",r="keydown",a="keyup",b="touchmove",s="Microsoft Internet Explorer"===t.navigator.appName&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject,i=null,M=t.requestAnimationFrame,A=t.cancelAnimationFrame,T=o.createElement("div").style,D=function(){var e,t,o,s,i,l;for(s=["t","webkitT","MozT","msT","OT"],e=i=0,l=s.length;l>i;e=++i)if(o=s[e],t=s[e]+"ransform",t in T)return s[e].substr(0,s[e].length-1);return!1}(),B=function(e){return D===!1?!1:""===D?e:D+e.charAt(0).toUpperCase()+e.substr(1)},k=B("transform"),x=k!==!1,S=function(){var e,t,s;return e=o.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=m,t.top="-9999px",o.body.appendChild(e),s=e.offsetWidth-e.clientWidth,o.body.removeChild(e),s},R=function(){var e,o,s;return o=t.navigator.userAgent,(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(o))?(s=/Firefox\/\d{2}\./.exec(o),s&&(s=s[0].replace(/\D+/g,"")),e&&+s>23):!1},C=function(){function r(s,l){this.el=s,this.options=l,i||(i=S()),this.$el=e(this.el),this.doc=e(this.options.documentContext||o),this.win=e(this.options.windowContext||t),this.$content=this.$el.children("."+l.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return r.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===l)(t===n&&e.originalEvent.detail>0||t===y&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===h){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===n&&e.originalEvent.wheelDelta<0||t===y&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},r.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},r.prototype.updateScrollValues=function(){var e,t;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==t&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},r.prototype.setOnScrollStyles=function(){var e;x?(e={},e[k]="translate(0, "+this.sliderTop+"px)"):e={top:this.sliderTop},M?this.scrollRAF||(this.scrollRAF=M(function(t){return function(){t.scrollRAF=null,t.slider.css(e)}}(this))):this.slider.css(e)},r.prototype.createEvents=function(){this.events={down:function(e){return function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.pane.addClass("active"),e.doc.bind(d,e.events[c]).bind(p,e.events[y]),!1}}(this),drag:function(e){return function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.offsetY,e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.trigger("scrolltop"),!1}}(this),up:function(e){return function(){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind(d,e.events[c]).unbind(p,e.events[y]),!1}}(this),resize:function(e){return function(){e.reset()}}(this),panedown:function(e){return function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1}}(this),scroll:function(e){return function(t){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,n),e.prevScrollTop!==e.maxScrollTop&&e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,y),0!==e.prevScrollTop&&e.$el.trigger("scrolltop"))))}}(this),wheel:function(e){return function(t){var o;return null!=t?(o=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail,o&&(e.sliderY+=-o/3),e.scroll(),!1):void 0}}(this)}},r.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(f,e[f]),this.iOSNativeScrolling||(this.slider.bind(u,e[n]),this.pane.bind(u,e[g]).bind(""+h+" "+l,e[O])),this.$content.bind(""+m+" "+h+" "+l+" "+b,e[m])},r.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(f,e[f]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+m+" "+h+" "+l+" "+b,e[m])},r.prototype.generate=function(){var e,o,s,l,n,c;return l=this.options,n=l.paneClass,c=l.sliderClass,e=l.contentClass,this.$el.find("."+n).length||this.$el.find("."+c).length||this.$el.append('<div class="'+n+'"><div class="'+c+'" /></div>'),this.pane=this.$el.children("."+n),this.slider=this.pane.find("."+c),0===i&&R()?(s=t.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/\D+/g,""),o={right:-14,paddingRight:+s+14}):i&&(o={right:-i},this.$el.addClass("has-scrollbar")),null!=o&&this.$content.css(o),this},r.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},r.prototype.reset=function(){var e,t,o,l,n,c,r,a,u,d,p,h;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content,l=e.style,n=l.overflowY,s&&this.$content.css({height:this.$content.height()}),t=e.scrollHeight+i,d=parseInt(this.$el.css("max-height"),10),d>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>d?d:e.scrollHeight)),r=this.pane.outerHeight(!1),u=parseInt(this.pane.css("top"),10),c=parseInt(this.pane.css("bottom"),10),a=r+u+c,h=Math.round(a/t*a),h<this.options.sliderMinHeight?h=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&h>this.options.sliderMaxHeight&&(h=this.options.sliderMaxHeight),n===m&&l.overflowX!==m&&(h+=i),this.maxSliderTop=a-h,this.contentHeight=t,this.paneHeight=r,this.paneOuterHeight=a,this.sliderHeight=h,this.slider.height(h),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&n!==m?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&n===m?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),o=this.$content.css("position"),("static"===o||"relative"===o)&&(p=parseInt(this.$content.css("right"),10),p&&this.$content.css({right:"",marginRight:p})),this)},r.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop((this.paneHeight-this.contentHeight+i)*this.sliderY/this.maxSliderTop*-1),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},r.prototype.scrollBottom=function(e){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger(h),this.stop().restore(),this):void 0},r.prototype.scrollTop=function(e){return this.isActive?(this.$content.scrollTop(+e).trigger(h),this.stop().restore(),this):void 0},r.prototype.scrollTo=function(e){return this.isActive?(this.scrollTop(this.$el.find(e).get(0).offsetTop),this):void 0},r.prototype.stop=function(){return A&&this.scrollRAF&&(A(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},r.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),s&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},r.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass("flashed"),setTimeout(function(e){return function(){e.pane.removeClass("flashed")}}(this),this.options.flashDelay),this):void 0},r}(),e.fn.nanoScroller=function(t){return this.each(function(){var o,s;if((s=this.nanoscroller)||(o=e.extend({},w,t),this.nanoscroller=s=new C(this,o)),t&&"object"==typeof t){if(e.extend(s.options,t),null!=t.scrollBottom)return s.scrollBottom(t.scrollBottom);if(null!=t.scrollTop)return s.scrollTop(t.scrollTop);if(t.scrollTo)return s.scrollTo(t.scrollTo);if("bottom"===t.scroll)return s.scrollBottom(0);if("top"===t.scroll)return s.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return s.scrollTo(t.scroll);if(t.stop)return s.stop();if(t.destroy)return s.destroy();if(t.flash)return s.flash()}return s.reset()})},e.fn.nanoScroller.Constructor=C}(window,document)}),define("files",["jquery","core","resourcesCollections","nanoscroller"],function(e){e(document).ready(function(e){function t(){e("nav.collections-navigation").height(e(".category-panel").height()-e(".user-profile-info").outerHeight(!0)-20)}t(),e(window).resize(t),e("nav.collections-navigation > ul").addClass("scroll-content"),e("nav.collections-navigation").nanoScroller({paneClass:"scroll-pane",sliderClass:"scroll-slider",contentClass:"scroll-content",flash:!0})})});