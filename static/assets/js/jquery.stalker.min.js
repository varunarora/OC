(function(e,t,n){function u(t,n){this.element=t;this.options=e.extend({},s,n);this._defaults=s;this._name=r;this.init()}var r="stalker",i=t.document,s={direction:"down",offset:0,stalkerStyle:{},delay:0,startCallback:null,stopCallback:null},o=50;u.prototype.init=function(){function r(t){n.stalking=true;var r={position:"fixed"},i=e.extend({},r);r[t]=-n.jElement.outerHeight()+"px";i[t]=parseInt(n.options.offset)+"px";var s=function(){var t={width:n._baseWidth+"px",left:n._baseOffset.left+"px","z-index":o};if(typeof n.options.stalkerStyle=="object"){n.jElement.css(e.extend(t,n.options.stalkerStyle))}else{n.jElement.css(t).addClass(n.options.stalkerStyle)}n.jElement.before(n.placeholder).css(i)};if(n.options.delay){setTimeout(s,n.options.delay)}else{s()}}function s(){n.jElement.detach();var e=n.jElement.contents();n._jElementClone.empty().append(e);n.placeholder.replaceWith(n._jElementClone);n.jElement=n._jElementClone;n.stalking=false;if(n.options.stopCallback){n.options.stopCallback.call(n.jElement[0])}}function u(){var o=e(i).scrollTop();var u=e(t).height();var a=o+u;if(n.options.direction=="down"){if(n._baseOffset.top<o){if(!n.stalking){n._jElementClone=n.styleClone(n.jElement);r("top");if(n.options.startCallback){n.options.startCallback.call(n.jElement[0])}}}else if(n.stalking){s()}}else{if(n._baseOffset.top+n.jElement.outerHeight()>a){if(!n.stalking){n._jElementClone=n.styleClone(n.jElement);r("bottom");if(n.options.startCallback){n.options.startCallback.call(n.jElement[0])}}}else if(n.stalking){s()}}}function a(){if(n.stalking){if(n.options.stalkerStyle&&n.options.stalkerStyle.width){n._baseWidth=n.options.stalkerStyle.width}else{n._baseWidth=n.placeholder.width()}n._baseOffset=n.placeholder.offset();n.jElement.width(n._baseWidth).css("left",n._baseOffset.left+"px")}else{n._baseWidth=n.jElement.width();n._baseOffset=n.jElement.offset()}u()}this.jElement=e(this.element);this._baseOffset=this.jElement.offset();this._baseWidth=this.jElement.width();this.placeholder=this.styleClone(this.jElement).css("height",this.jElement.height());this.stalking=false;var n=this;e(t).on("scroll.stalker",a).on("resize.stalker",a);u()};u.prototype.styleClone=function(t){var n="nodeName"in t?t:t[0];var r=i.createElement(n.nodeName);var s,o,u;for(s=0,o=n.attributes.length;s<o;s++){u=n.attributes[s];r.setAttribute(u.name||u.nodeName,u.value||u.nodeValue)}if(r.clearAttributes){r.clearAttributes()}if(r.mergeAttributes){r.mergeAttributes(n)}return e(r)};e.fn[r]=function(t){return this.each(function(){if(!e.data(this,"plugin_"+r)){e.data(this,"plugin_"+r,new u(this,t))}})}})(jQuery,window)