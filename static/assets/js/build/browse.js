!function(e,t){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(i,s,n){e.Backbone=t(e,n,i,s)});else if("undefined"!=typeof exports){var i=require("underscore");t(e,exports,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,i,s){{var n=e.Backbone,o=[],r=(o.push,o.slice);o.splice}t.VERSION="1.1.2",t.$=s,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,i){if(!c(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var s=this._events[e]||(this._events[e]=[]);return s.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,s){if(!c(this,"once",e,[t,s])||!t)return this;var n=this,o=i.once(function(){n.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,s)},off:function(e,t,s){var n,o,r,a,l,u,h,d;if(!this._events||!c(this,"off",e,[t,s]))return this;if(!e&&!t&&!s)return this._events=void 0,this;for(a=e?[e]:i.keys(this._events),l=0,u=a.length;u>l;l++)if(e=a[l],r=this._events[e]){if(this._events[e]=n=[],t||s)for(h=0,d=r.length;d>h;h++)o=r[h],(t&&t!==o.callback&&t!==o.callback._callback||s&&s!==o.context)&&n.push(o);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],s=this._events.all;return i&&u(i,t),s&&u(s,arguments),this},stopListening:function(e,t,s){var n=this._listeningTo;if(!n)return this;var o=!t&&!s;s||"object"!=typeof t||(s=this),e&&((n={})[e._listenId]=e);for(var r in n)e=n[r],e.off(t,s,this),(o||i.isEmpty(e._events))&&delete this._listeningTo[r];return this}},l=/\s+/,c=function(e,t,i,s){if(!i)return!0;if("object"==typeof i){for(var n in i)e[t].apply(e,[n,i[n]].concat(s));return!1}if(l.test(i)){for(var o=i.split(l),r=0,a=o.length;a>r;r++)e[t].apply(e,[o[r]].concat(s));return!1}return!0},u=function(e,t){var i,s=-1,n=e.length,o=t[0],r=t[1],a=t[2];switch(t.length){case 0:for(;++s<n;)(i=e[s]).callback.call(i.ctx);return;case 1:for(;++s<n;)(i=e[s]).callback.call(i.ctx,o);return;case 2:for(;++s<n;)(i=e[s]).callback.call(i.ctx,o,r);return;case 3:for(;++s<n;)(i=e[s]).callback.call(i.ctx,o,r,a);return;default:for(;++s<n;)(i=e[s]).callback.apply(i.ctx,t);return}},h={listenTo:"on",listenToOnce:"once"};i.each(h,function(e,t){a[t]=function(t,s,n){var o=this._listeningTo||(this._listeningTo={}),r=t._listenId||(t._listenId=i.uniqueId("l"));return o[r]=t,n||"object"!=typeof s||(n=this),t[e](s,n,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(t,a);var d=t.Model=function(e,t){var s=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(s=this.parse(s,t)||{}),s=i.defaults({},s,i.result(this,"defaults")),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(d.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,s){var n,o,r,a,l,c,u,h;if(null==e)return this;if("object"==typeof e?(o=e,s=t):(o={})[e]=t,s||(s={}),!this._validate(o,s))return!1;r=s.unset,l=s.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(n in o)t=o[n],i.isEqual(h[n],t)||a.push(n),i.isEqual(u[n],t)?delete this.changed[n]:this.changed[n]=t,r?delete h[n]:h[n]=t;if(!l){a.length&&(this._pending=s);for(var d=0,g=a.length;g>d;d++)this.trigger("change:"+a[d],this,h[a[d]],s)}if(c)return this;if(!l)for(;this._pending;)s=this._pending,this._pending=!1,this.trigger("change",this,s);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var s in this.attributes)t[s]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,s=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in e)i.isEqual(n[o],t=e[o])||((s||(s={}))[o]=t);return s},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,s=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(s&&s(t,i,e),void t.trigger("sync",t,i,e)):!1},I(this,e),this.sync("read",this,e)},save:function(e,t,s){var n,o,r,a=this.attributes;if(null==e||"object"==typeof e?(n=e,s=t):(n={})[e]=t,s=i.extend({validate:!0},s),n&&!s.wait){if(!this.set(n,s))return!1}else if(!this._validate(n,s))return!1;n&&s.wait&&(this.attributes=i.extend({},a,n)),void 0===s.parse&&(s.parse=!0);var l=this,c=s.success;return s.success=function(e){l.attributes=a;var t=l.parse(e,s);return s.wait&&(t=i.extend(n||{},t)),i.isObject(t)&&!l.set(t,s)?!1:(c&&c(l,e,s),void l.trigger("sync",l,e,s))},I(this,s),o=this.isNew()?"create":s.patch?"patch":"update","patch"===o&&(s.attrs=n),r=this.sync(o,this,s),n&&s.wait&&(this.attributes=a),r},destroy:function(e){e=e?i.clone(e):{};var t=this,s=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&n(),s&&s(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;I(this,e);var o=this.sync("delete",this,e);return e.wait||n(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||A();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var s=this.validationError=this.validate(e,t)||null;return s?(this.trigger("invalid",this,s,i.extend(t,{validationError:s})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];i.each(g,function(e){d.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var p=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},f={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};i.extend(p.prototype,a,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,m))},remove:function(e,t){var s=!i.isArray(e);e=s?[e]:i.clone(e),t||(t={});var n,o,r,a;for(n=0,o=e.length;o>n;n++)a=e[n]=this.get(e[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],r=this.indexOf(a),this.models.splice(r,1),this.length--,t.silent||(t.index=r,a.trigger("remove",a,this,t)),this._removeReference(a,t));return s?e[0]:e},set:function(e,t){t=i.defaults({},t,f),t.parse&&(e=this.parse(e,t));var s=!i.isArray(e);e=s?e?[e]:[]:i.clone(e);var n,o,r,a,l,c,u,h=t.at,g=this.model,p=this.comparator&&null==h&&t.sort!==!1,m=i.isString(this.comparator)?this.comparator:null,y=[],v=[],b={},w=t.add,C=t.merge,R=t.remove,O=!p&&w&&R?[]:!1;for(n=0,o=e.length;o>n;n++){if(l=e[n]||{},r=l instanceof d?a=l:l[g.prototype.idAttribute||"id"],c=this.get(r))R&&(b[c.cid]=!0),C&&(l=l===a?a.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),p&&!u&&c.hasChanged(m)&&(u=!0)),e[n]=c;else if(w){if(a=e[n]=this._prepareModel(l,t),!a)continue;y.push(a),this._addReference(a,t)}a=c||a,!O||!a.isNew()&&b[a.id]||O.push(a),b[a.id]=!0}if(R){for(n=0,o=this.length;o>n;++n)b[(a=this.models[n]).cid]||v.push(a);v.length&&this.remove(v,t)}if(y.length||O&&O.length)if(p&&(u=!0),this.length+=y.length,null!=h)for(n=0,o=y.length;o>n;n++)this.models.splice(h+n,0,y[n]);else{O&&(this.models.length=0);var S=O||y;for(n=0,o=S.length;o>n;n++)this.models.push(S[n])}if(u&&this.sort({silent:!0}),!t.silent){for(n=0,o=y.length;o>n;n++)(a=y[n]).trigger("add",a,this,t);(u||O&&O.length)&&this.trigger("sort",this,t)}return s?e[0]:e},reset:function(e,t){t||(t={});for(var s=0,n=this.models.length;n>s;s++)this._removeReference(this.models[s],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return r.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,s=this;return e.success=function(i){var n=e.reset?"reset":"set";s[n](i,e),t&&t(s,i,e),s.trigger("sync",s,i,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var s=this,n=t.success;return t.success=function(e,i){t.wait&&s.add(e,t),n&&n(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?i.clone(t):{},t.collection=this;var s=new this.model(e,t);return s.validationError?(this.trigger("invalid",this,s.validationError,t),!1):s},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,s){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,s),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(y,function(e){p.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var v=["groupBy","countBy","sortBy","indexBy"];i.each(v,function(e){p.prototype[e]=function(t,s){var n=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,n,s)}});var b=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,C)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];i.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var s=e[t];if(i.isFunction(s)||(s=this[e[t]]),s){var n=t.match(w),o=n[1],r=n[2];s=i.bind(s,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,s):this.$el.on(o,r,s)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var s=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(s,!1)}}}),t.sync=function(e,s,n){var o=O[e];i.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:o,dataType:"json"};if(n.url||(r.url=i.result(s,"url")||A()),null!=n.data||!s||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||s.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",n.emulateJSON&&(r.data._method=o);var a=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===r.type||n.emulateJSON||(r.processData=!1),"PATCH"===r.type&&R&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=t.ajax(i.extend(r,n));return s.trigger("request",s,l,n),l};var R=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),O={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},x=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,_=/\*\w+/g,$=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(S.prototype,a,{initialize:function(){},route:function(e,s,n){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(s)&&(n=s,s=""),n||(n=this[s]);var o=this;return t.history.route(e,function(i){var r=o._extractParameters(e,i);o.execute(n,r),o.trigger.apply(o,["route:"+s].concat(r)),o.trigger("route",s,r),t.history.trigger("route",o,s,r)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace($,"\\$&").replace(x,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/?]+)"}).replace(_,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var s=e.exec(t).slice(1);return i.map(s,function(e,t){return t===s.length-1?e||null:e?decodeURIComponent(e):null})}});var k=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,V=/^\/+|\/+$/g,H=/msie [\w.]+/,E=/\/$/,N=/#.*$/;k.started=!1,i.extend(k.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(E,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(k.started)throw new Error("Backbone.history has already been started");k.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var s=this.getFragment(),n=document.documentMode,o=H.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);if(this.root=("/"+this.root+"/").replace(V,"/"),o&&this._wantsHashChange){var r=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=r.hide().appendTo("body")[0].contentWindow,this.navigate(s)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=s;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),k.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!k.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(N,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var s=e.href.replace(/(javascript:|#).*$/,"");e.replace(s+"#"+t)}else e.hash="#"+t}}),t.history=new k;var q=function(e,t){var s,n=this;s=e&&i.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},i.extend(s,n,t);var o=function(){this.constructor=s};return o.prototype=n.prototype,s.prototype=new o,e&&i.extend(s.prototype,e),s.__super__=n.prototype,s};d.extend=p.extend=S.extend=b.extend=k.extend=q;var A=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var i=t.error;t.error=function(s){i&&i(e,s,t),e.trigger("error",e,s,t)}};return t}),define("nanoscroller",["jquery"],function(e){!function(t,i){var s,n,o,r,a,l,c,u,h,d,g,p,f,m,y,v,b,w,C,R,O,S,x,T,_,$,k,M,V;O={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},v="scrollbar",y="scroll",u="mousedown",h="mousemove",g="mousewheel",d="mouseup",m="resize",a="drag",w="up",f="panedown",o="DOMMouseScroll",r="down",C="wheel",l="keydown",c="keyup",b="touchmove",s="Microsoft Internet Explorer"===t.navigator.appName&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject,n=null,_=t.requestAnimationFrame,R=t.cancelAnimationFrame,k=i.createElement("div").style,V=function(){var e,t,i,s,n,o;for(s=["t","webkitT","MozT","msT","OT"],e=n=0,o=s.length;o>n;e=++n)if(i=s[e],t=s[e]+"ransform",t in k)return s[e].substr(0,s[e].length-1);return!1}(),M=function(e){return V===!1?!1:""===V?e:V+e.charAt(0).toUpperCase()+e.substr(1)},$=M("transform"),x=$!==!1,S=function(){var e,t,s;return e=i.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=y,t.top="-9999px",i.body.appendChild(e),s=e.offsetWidth-e.clientWidth,i.body.removeChild(e),s},T=function(){var e,i,s;return i=t.navigator.userAgent,(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(i))?(s=/Firefox\/\d{2}\./.exec(i),s&&(s=s[0].replace(/\D+/g,"")),e&&+s>23):!1},p=function(){function l(s,o){this.el=s,this.options=o,n||(n=S()),this.$el=e(this.el),this.doc=e(this.options.documentContext||i),this.win=e(this.options.windowContext||t),this.$content=this.$el.children("."+o.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return l.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===o)(t===r&&e.originalEvent.detail>0||t===w&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===g){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===r&&e.originalEvent.wheelDelta<0||t===w&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},l.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},l.prototype.updateScrollValues=function(){var e,t;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==t&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},l.prototype.setOnScrollStyles=function(){var e;x?(e={},e[$]="translate(0, "+this.sliderTop+"px)"):e={top:this.sliderTop},_?this.scrollRAF||(this.scrollRAF=_(function(t){return function(){t.scrollRAF=null,t.slider.css(e)}}(this))):this.slider.css(e)},l.prototype.createEvents=function(){this.events={down:function(e){return function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.pane.addClass("active"),e.doc.bind(h,e.events[a]).bind(d,e.events[w]),!1}}(this),drag:function(e){return function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.offsetY,e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.trigger("scrolltop"),!1}}(this),up:function(e){return function(){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind(h,e.events[a]).unbind(d,e.events[w]),!1}}(this),resize:function(e){return function(){e.reset()}}(this),panedown:function(e){return function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1}}(this),scroll:function(e){return function(t){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,r),e.prevScrollTop!==e.maxScrollTop&&e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,w),0!==e.prevScrollTop&&e.$el.trigger("scrolltop"))))}}(this),wheel:function(e){return function(t){var i;return null!=t?(i=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail,i&&(e.sliderY+=-i/3),e.scroll(),!1):void 0}}(this)}},l.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(m,e[m]),this.iOSNativeScrolling||(this.slider.bind(u,e[r]),this.pane.bind(u,e[f]).bind(""+g+" "+o,e[C])),this.$content.bind(""+y+" "+g+" "+o+" "+b,e[y])},l.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(m,e[m]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+y+" "+g+" "+o+" "+b,e[y])},l.prototype.generate=function(){var e,i,s,o,r,a;return o=this.options,r=o.paneClass,a=o.sliderClass,e=o.contentClass,this.$el.find("."+r).length||this.$el.find("."+a).length||this.$el.append('<div class="'+r+'"><div class="'+a+'" /></div>'),this.pane=this.$el.children("."+r),this.slider=this.pane.find("."+a),0===n&&T()?(s=t.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/\D+/g,""),i={right:-14,paddingRight:+s+14}):n&&(i={right:-n},this.$el.addClass("has-scrollbar")),null!=i&&this.$content.css(i),this},l.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},l.prototype.reset=function(){var e,t,i,o,r,a,l,c,u,h,d,g;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content,o=e.style,r=o.overflowY,s&&this.$content.css({height:this.$content.height()}),t=e.scrollHeight+n,h=parseInt(this.$el.css("max-height"),10),h>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>h?h:e.scrollHeight)),l=this.pane.outerHeight(!1),u=parseInt(this.pane.css("top"),10),a=parseInt(this.pane.css("bottom"),10),c=l+u+a,g=Math.round(c/t*c),g<this.options.sliderMinHeight?g=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&g>this.options.sliderMaxHeight&&(g=this.options.sliderMaxHeight),r===y&&o.overflowX!==y&&(g+=n),this.maxSliderTop=c-g,this.contentHeight=t,this.paneHeight=l,this.paneOuterHeight=c,this.sliderHeight=g,this.slider.height(g),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&r!==y?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&r===y?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),i=this.$content.css("position"),("static"===i||"relative"===i)&&(d=parseInt(this.$content.css("right"),10),d&&this.$content.css({right:"",marginRight:d})),this)},l.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop((this.paneHeight-this.contentHeight+n)*this.sliderY/this.maxSliderTop*-1),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},l.prototype.scrollBottom=function(e){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger(g),this.stop().restore(),this):void 0},l.prototype.scrollTop=function(e){return this.isActive?(this.$content.scrollTop(+e).trigger(g),this.stop().restore(),this):void 0},l.prototype.scrollTo=function(e){return this.isActive?(this.scrollTop(this.$el.find(e).get(0).offsetTop),this):void 0},l.prototype.stop=function(){return R&&this.scrollRAF&&(R(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},l.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),s&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},l.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass("flashed"),setTimeout(function(e){return function(){e.pane.removeClass("flashed")}}(this),this.options.flashDelay),this):void 0},l}(),e.fn.nanoScroller=function(t){return this.each(function(){var i,s;if((s=this.nanoscroller)||(i=e.extend({},O,t),this.nanoscroller=s=new p(this,i)),t&&"object"==typeof t){if(e.extend(s.options,t),null!=t.scrollBottom)return s.scrollBottom(t.scrollBottom);if(null!=t.scrollTop)return s.scrollTop(t.scrollTop);if(t.scrollTo)return s.scrollTo(t.scrollTo);if("bottom"===t.scroll)return s.scrollBottom(0);if("top"===t.scroll)return s.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return s.scrollTo(t.scroll);if(t.stop)return s.stop();if(t.destroy)return s.destroy();if(t.flash)return s.flash()}return s.reset()})},e.fn.nanoScroller.Constructor=p}(window,document)}),function(e){"function"==typeof define&&define.amd?define("timeago",["jquery"],e):e(jQuery)}(function(e){function t(){var t=i(this),r=o.settings;return isNaN(t.datetime)||(0==r.cutoff||Math.abs(n(t.datetime))<r.cutoff)&&e(this).text(s(t.datetime)),this}function i(t){if(t=e(t),!t.data("timeago")){t.data("timeago",{datetime:o.datetime(t)});var i=e.trim(t.text());o.settings.localeTitle?t.attr("title",t.data("timeago").datetime.toLocaleString()):!(i.length>0)||o.isTime(t)&&t.attr("title")||t.attr("title",i)}return t.data("timeago")}function s(e){return o.inWords(n(e))}function n(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return s(t instanceof Date?t:"string"==typeof t?e.timeago.parse(t):"number"==typeof t?new Date(t):e.timeago.datetime(t))};var o=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowPast:!0,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",inPast:"any moment now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(t){function i(i,n){var o=e.isFunction(i)?i(n,t):i,r=s.numbers&&s.numbers[n]||n;return o.replace(/%d/i,r)}if(!this.settings.allowPast&&!this.settings.allowFuture)throw"timeago allowPast and allowFuture settings can not both be set to false.";var s=this.settings.strings,n=s.prefixAgo,o=s.suffixAgo;if(this.settings.allowFuture&&0>t&&(n=s.prefixFromNow,o=s.suffixFromNow),!this.settings.allowPast&&t>=0)return this.settings.strings.inPast;var r=Math.abs(t)/1e3,a=r/60,l=a/60,c=l/24,u=c/365,h=45>r&&i(s.seconds,Math.round(r))||90>r&&i(s.minute,1)||45>a&&i(s.minutes,Math.round(a))||90>a&&i(s.hour,1)||24>l&&i(s.hours,Math.round(l))||42>l&&i(s.day,1)||30>c&&i(s.days,Math.round(c))||45>c&&i(s.month,1)||365>c&&i(s.months,Math.round(c/30))||1.5>u&&i(s.year,1)||i(s.years,Math.round(u)),d=s.wordSeparator||"";return void 0===s.wordSeparator&&(d=" "),e.trim([n,h,o].join(d))},parse:function(t){var i=e.trim(t);return i=i.replace(/\.\d+/,""),i=i.replace(/-/,"/").replace(/-/,"/"),i=i.replace(/T/," ").replace(/Z/," UTC"),i=i.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),i=i.replace(/([\+\-]\d\d)$/," $100"),new Date(i)},datetime:function(t){var i=e(t).attr(o.isTime(t)?"datetime":"title");return o.parse(i)},isTime:function(t){return"time"===e(t).get(0).tagName.toLowerCase()}});var r={init:function(){var i=e.proxy(t,this);i();var s=o.settings;s.refreshMillis>0&&(this._timeagoInterval=setInterval(i,s.refreshMillis))},update:function(i){var s=o.parse(i);e(this).data("timeago",{datetime:s}),o.settings.localeTitle&&e(this).attr("title",s.toLocaleString()),t.apply(this)},updateFromDOM:function(){e(this).data("timeago",{datetime:o.parse(e(this).attr(o.isTime(this)?"datetime":"title"))}),t.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};e.fn.timeago=function(e,t){var i=e?r[e]:r.init;if(!i)throw new Error("Unknown function name '"+e+"' for timeago");
return this.each(function(){i.call(this,t)}),this},document.createElement("abbr"),document.createElement("time")}),define("categoryResources",["jquery","core","underscore","backbone","nanoscroller","timeago"],function(e,t,s,n){function o(t,i){var n=e(t).attr("name"),o=e(t).attr("value"),a=e(t).attr("type");"undefined"!=typeof a&&"checkbox"===e(t).attr("type")&&(t.checked?S[n].splice(s.indexOf(S[n],o),1):S[n].push(o)),filteredCollection=x?x:OC.categoryResources.resourceSet;var l=r(filteredCollection);OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog?OC.categoryResources.reset(l):i.render(l)}function r(e){return new h(e.reject(function(e){return s.some(S,function(t,i){return"tags"==i?0===e.get(i).length?!1:s.every(e.get(i),function(e){return-1!==s.indexOf(t,e)}):"category"==i?-1!==s.indexOf(t,e.get(i)):-1!==s.indexOf(t,e.get(i).toLowerCase())})}))}function a(t){var i,n,o=s.union(s.flatten(s.map(t,function(e){return e.get("tags")}))),r=e('.category-panel-listing-categories-body-filters input[name="tags"]'),a=s.map(r,function(t){return e(t).val()}),c={};for(n=0;n<r.length;n++)c[e(r[n]).val()]=r[n].checked;for(s.each(o,function(e){-1===a.indexOf(e)&&a.push(e)}),a.sort(),e(".category-panel-listing-categories-body-filters").html(""),i=0;i<a.length;i++){var u=e("<label/>",{text:a[i]}),h=e("<input/>",{type:"checkbox",name:"tags",checked:s.has(c,a[i])?c[a[i]]:"true",value:a[i]}),d=e("<span/>",{"class":"category-panel-listing-categories-body-filters-description",text:"?",title:""});u.prepend(h),u.append(d),e(".category-panel-listing-categories-body-filters").append(u),e(".category-panel-listing-categories-body-filters label:last").click(l)}}function l(t){t.stopPropagation();var i;i=e("input:checkbox",t.target)[0],i?(i.checked=i.checked===!1?!0:!1,t.preventDefault()):i=t.target,o(i,OC.categoryResources.resourceCollectionView)}function c(e){var t,i=s.groupBy(e.models,function(e){return e.get("category")}),n=new f;return s.each(i,function(e,i){t=s.find(OC.categoryResources.childCategories,function(e){return e.get("title")===i}),t.set("resources",new h(e)),n.add(t)}),n}var u=n.Model.extend({id:"",url:"",title:"",user:"",user_id:"",user_thumbnail:"",user_url:"",favorites:"",tags:"",type:"",thumbnail:"",favorited:"",created:"",stars:"",review_count:"",remote:""}),h=n.Collection.extend({model:u,sortByPopularity:function(){this.comparator=this.popularityComparator,this.sort()},sortByNewest:function(){this.comparator=this.newestComparator,this.sort()},newestComparator:function(e){return-e.get("created")},popularityComparator:function(e){return-e.get("favorites")}}),d=n.Model.extend({url:"",body:"",user:"",user_thumbnail:""}),g=n.Collection.extend({model:d}),p=n.Model.extend({id:"",title:"",resources:"",url:"",position:"",truncated:!0}),f=n.Collection.extend({model:p,comparator:"position"});OC.categoryResources&&(OC.categoryResources.childCategories=[],OC.categoryResources.resourceSet=new h,OC.categoryResources.requestSet=new g,s.each(OC.categoryResources.rawChildCategories,function(e){OC.categoryResources.childCategories.push(new p(e))}),s.each(OC.categoryResources.rawResources,function(e){OC.categoryResources.resourceSet.add(new u(e))}),s.each(OC.categoryResources.rawRequests,function(e){OC.categoryResources.requestSet.add(new d(e))}));var m=n.View.extend({truncatedResourceLimit:0,initialize:function(){this.truncatedResourceLimit=OC.categoryResources.visibleResourceCount;var t=this;e(window).resize(function(){OC.categoryResources.setVisibleResourceCount(),t.truncatedResourceLimit=OC.categoryResources.visibleResourceCount,t.render()})},render:function(e){this.clearView();var t=e||this.collection;this.collection=t,0===t.length?this.showNullView():s.each(t.models,function(e){new y({model:e}).render()})},clearView:function(){e(".content-panel-body-listing-items").html("")},showNullView:function(){e(".content-panel-body-listing-items").html('<p class="no-results-message">Couldn\'t find a thing! Have you tried requesting for something?</p>'),OC.categoryResources.filterAsyncSearchOn&&e(".no-results-message").addClass("hide")},hideShowMores:function(){e(".content-panel-body-listing-items .content-panel-body-listing-category-show").addClass("hide")},showShowMores:function(){e(".content-panel-body-listing-items .content-panel-body-listing-category-show").removeClass("hide")},truncateAll:function(){s.each(this.collection.models,function(e){e.set("truncated",!1)})},resetTruncate:function(){s.each(this.collection.models,function(e){e.set("truncated",!0)})}}),y=n.View.extend({tagName:"div",className:"content-panel-body-listing-category",events:function(){return OC.categoryResources.isCatalog?{}:{"click .content-panel-body-listing-category-show":"showMore"}},template:s.template('<div class="content-panel-body-listing-category-title"><h3><%= title %></h3></div><div class="content-panel-body-listing-category-resources"></div>'),showMore:function(){var t=this.$(".content-panel-body-listing-category-show");t.addClass("loading");var n=this;return e.get("/resources/api/load-category-resources/"+this.model.get("id")+"/from/"+this.model.get("resources").models.length+"/",function(e){if("true"===e.status){n.model.set("loaded",!0),n.clearResources(),n.renderResources();var o=Object.keys(e.resources),r=[];for(i=0;i<o.length;i++)resource=e.resources[o[i]],resourceModel=new u(resource),n.model.get("resources").add(resourceModel),s.some(S,function(e,t){return"tags"==t?-1!==s.indexOf(e,resourceModel.get(t)):-1!==s.indexOf(e,resourceModel.get(t).toLowerCase())})||OC.categoryResources.resourceSet.find(function(e){return e.get("id")==resourceModel.get("id")})||n.lateRender(resourceModel),OC.categoryResources.resourceSet.add(resourceModel),r.push(resourceModel);a(r),t.remove()}else OC.popup(e.message,e.title)},"json"),!1},renderResources:function(){if(existingResources=this.model.get("truncated")===!1||this.model.get("loaded")?this.model.get("resources").models:this.model.get("resources").models.slice(0,categoryView.truncatedResourceLimit),existingResources=s.sortBy(existingResources,function(e){return"activity"===e.get("type").toLowerCase()||"lesson"===e.get("type").toLowerCase()?0:1})){for(i=0;i<existingResources.length;i++)this.$(".content-panel-body-listing-category-resources").append(new R({model:existingResources[i]}).silentRender());this.model.get("count")-categoryView.truncatedResourceLimit>0&&this.$(".content-panel-body-listing-category-resources").append('<a href="'+this.model.get("url")+'" class="content-panel-body-listing-item-show"><div class="content-panel-body-listing-item-show-count">'+(this.model.get("count")-categoryView.truncatedResourceLimit)+"</div> more</div>")}},render:function(){return modelJSON=this.model.toJSON(),this.$el.html(this.template(modelJSON)),e(".content-panel-body-listing-items").append(this.$el),this.renderResources(),(this.model.get("truncated")===!1||this.model.get("loaded"))&&this.$(".content-panel-body-listing-item-show").remove(),this},lateRender:function(e){this.$(".content-panel-body-listing-category-resources").append(new R({model:e}).silentRender())},clearResources:function(){this.$(".content-panel-body-listing-category-resources").html("")}}),v=n.Model.extend({tag:""}),b=n.View.extend({tagName:"span",className:"content-panel-body-listing-item-contents-label label",template:s.template("<%= tag %>"),render:function(){return this.$el.html(this.template(this.model.toJSON())),this.el}}),w=n.View.extend({tagName:"a",className:"content-panel-body-listing-request",attributes:function(){return{href:this.model.get("url")}},template:s.template('<div style="background-image: url(\'<%= user_thumbnail %>\')" class="content-panel-body-listing-request-thumbnail"></div><div class="content-panel-body-listing-request-body"><span class="bold content-panel-body-listing-request-body-user"><%= user %></span><%= body %></div>'),render:function(){return this.$el.html(this.template(this.model.toJSON())),e(".content-panel-body-listing-requests").append(this.$el),this}}),C=n.View.extend({requestURL:"",initialize:function(e){this.options=e},render:function(e){this.clearView();var t=e||this.collection;this.collection=t,0===t.length?this.showNullView():(this.showNonNullView(),s.each(t.models,function(e){new w({model:e}).render()}))},clearView:function(){e(".content-panel-body-listing-requests").html("")},showNullView:function(){e(".content-panel-body-listing-requests").html('Can\'t find what you are looking for? <span class="no-request-found-message"><span class="no-request-found-teacher-count">'+this.randomUserCount()+'</span> teachers are currently online waiting to help you for free!</span> <a href="'+this.options.requestURL+'" class="no-request-found">Ask for help right now</a>')},randomUserCount:function(){return String(s.random(6,14))},showNonNullView:function(){e(".content-panel-body-listing-requests").html('<div class="content-panel-body-listing-requests-title"><h3>Top requests</h3><a href="'+this.options.requestURL+'" class="action-button mini-action-button content-panel-body-listing-requests-new-request">New request</a></div>')}}),R=n.View.extend({tagName:"div",className:function(){return OC.categoryResources&&(OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog)?"content-panel-body-listing-thumbnail-item":"content-panel-body-listing-banner-item"},truncatedDescriptionLength:null,descriptionTruncated:!0,itemHeight:null,thumbnailTemplate:s.template('<a href="<%= user_url %>" class="content-panel-body-listing-item-user-picture" style="background-image: url(\'<%= user_thumbnail %>\')"></a><a href="<%= url %>" class="content-panel-body-listing-item-anchor"<% if (remote) { %> target="_blank"<% } %>><div class="content-panel-body-listing-item-label-fold"></div><div class="content-panel-body-listing-item-label"><%= type %></div><div class="content-panel-body-listing-item-favorites<% if (favorited){ %> favorited<% } %>"><%= favorites %></div><div class="content-panel-body-listing-item-thumbnail"style="background-image: url(\'<%= thumbnail %>\')"></div><div class="content-panel-body-listing-item-thumbnail-shadow"></div><div class="content-panel-body-listing-item-contents"><div class="content-panel-body-listing-item-contents-caption"><%= title %></div><% if (views){ %><div class="content-panel-body-listing-item-contents-meta"><%= views %> views</div><% } %><%= tags %><div class="content-panel-body-listing-item-contents-description"><%= description %></div><% if (review_count !== 0) { %><div class="content-panel-body-listing-item-contents-reviews"><div class="content-panel-body-listing-item-contents-review-count">(<span class="content-panel-body-listing-item-contents-review-count-value"><%= review_count %></span>)</div></div><% } %></div></a>'),bannerTemplate:s.template('<a href="<%= user_url %>" class="content-panel-body-listing-item-user-picture" style="background-image: url(\'<%= user_thumbnail %>\')"></a><div class="content-panel-body-listing-item-label-fold"></div><div class="content-panel-body-listing-item-label <%= typeClass %>"><%= type %></div><a href="<%= url %>" class="content-panel-body-listing-item-anchor"<% if (remote) { %> target="_blank"<% } %>><div class="content-panel-body-listing-item-thumbnail-wrapper"><div class="content-panel-body-listing-item-favorites<% if (favorited){ %> favorited<% } %>"><%= favorites %></div><div class="content-panel-body-listing-item-thumbnail" style="background-image: url(\'<%= thumbnail %>\')"></div><div class="content-panel-body-listing-item-thumbnail-shadow"></div></div><div class="content-panel-body-listing-item-contents"><div class="content-panel-body-listing-item-contents-meta"><% if (review_count !== 0) { %><div class="content-panel-body-listing-item-contents-reviews"><div class="content-panel-body-listing-item-contents-review-count">(<span class="content-panel-body-listing-item-contents-review-count-value"><%= review_count %></span>)</div></div><% } %><% if (views){ %><div class="content-panel-body-listing-item-contents-views"><%= views %> views</div><% } %><div class="content-panel-body-listing-item-contents-creator">Shared by <span href="<%= user_url %>" target="_blank"><%= username %></span> <span title="<%= created_iso %>" class="resource-time-ago"></span></div></div><div class="content-panel-body-listing-item-contents-caption"><%= title %></div><!--<%= tags %>--><div class="content-panel-body-listing-item-contents-description"><%= description %></div></div></a>'),events:{"click .content-panel-body-listing-item-favorites":"favorite","mouseenter .content-panel-body-listing-item-user-picture":"showUserTip","mouseleave .content-panel-body-listing-item-user-picture":"hideUserTip","click .content-panel-body-listing-item-description-more":"expand","click .content-panel-body-listing-item-description-less":"collapse"},expand:function(e){return this.descriptionTruncated=!1,this.silentRender(),this.$el.addClass("expanded"),e.stopPropagation(),e.preventDefault(),!1},collapse:function(e){return this.descriptionTruncated=!0,this.silentRender(),this.$el.removeClass("expanded"),e.stopPropagation(),e.preventDefault(),!1},getTrucatedTitle:function(){this.model.get("title").length;return this.model.get("title")},getTrucatedDescription:function(){var t=this.model.get("description").length;return t>this.truncatedDescriptionLength?this.descriptionTruncated?e(this.model.get("description")).text().substring(0,this.truncatedDescriptionLength).trim()+'&hellip;<span href="" class="content-panel-body-listing-item-description-more">more &#x27a4;</span>':e(this.model.get("description")).text().substring(0,3*this.truncatedDescriptionLength)+(t>this.truncatedDescriptionLength?"&hellip;":"")+'<span href="" class="content-panel-body-listing-item-description-less">&#x2770; less</span>':0===t?"No description found.":e(this.model.get("description")).text()},initialize:function(){var t,i=e("<div/>",{"class":"content-panel-body-listing-item-contents-labels"});for(existingTags=this.model.get("tags"),t=0;t<existingTags.length;t++)i.append(new b({model:new v({tag:existingTags[t]})}).render());this.$tagsView=i;var s,n,o=e("<div/>",{"class":"content-panel-body-listing-item-contents-reviews-stars"}),r=this.model.get("stars"),a=!1;for(parseInt(r/.5,10)%2!==0&&(a=!0),n=0;n<parseInt(r,10);n++)s=e("<span/>",{"class":"content-panel-body-listing-item-contents-review-star"}),o.append(s);a&&o.append(e("<span/>",{"class":"content-panel-body-listing-item-contents-review-halfstar"})),this.$starsView=o,this.typeClass=this.model.get("type").toLowerCase()+"-label",this.template=OC.categoryResources&&(OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog)?this.thumbnailTemplate:this.bannerTemplate,this.truncatedDescriptionLength=OC.categoryResources&&(OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog)?100:450},render:function(){return e(".content-panel-body-listing-items").append(this.silentRender()),this},silentRender:function(){return modelJSON=this.model.toJSON(),OC.categoryResources&&(OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog)&&(modelJSON.title=this.getTrucatedTitle()),modelJSON.description=this.getTrucatedDescription(),modelJSON.typeClass=this.typeClass,this.$el.html(this.template(modelJSON)),this.$(".content-panel-body-listing-item-contents-reviews").prepend(this.$starsView),this.el},favorite:function(){var e=this.$el.find(".content-panel-body-listing-item-favorites"),t=e.hasClass("favorited");return favoriteCallback=this.favoriteCallback,favoriteCallback(!t,e),OC.favoriteClickHandler("resource",this.model.get("id"),function(i){i||favoriteCallback(t,e)}),!1},favoriteCallback:function(e,t){e?(t.text(parseInt(t.text(),10)+1),t.addClass("favorited")):(t.text(parseInt(t.text(),10)-1),t.removeClass("favorited"))},showUserTip:function(){function t(t){t.css({top:n.offset().top-t.outerHeight(!0)-5,left:n.offset().left+n.width()/2-t.width()/2}),t.addClass("show"),t.undelegate("mouseleave"),t.undelegate("mouseenter"),t.mouseleave(function(){e(this).removeClass("show"),e(this).removeClass("hovered")}),t.mouseenter(function(){t.addClass("show"),t.addClass("hovered")})}var i=e(".user-tooltips #user-"+this.model.get("user_id")),n=this.$el.find(".content-panel-body-listing-item-user-picture");if(0!==i.length)t(i);else{tooltipTemplate=s.template('<div class="user-tooltip-wrapper" id="user-<%= id %>"><div class="floating-tooltip-spacer"></div><div class="user-tooltip"><div class="user-tooltip-thumbnail" style="background-image: url(\'<%= thumbnail %>\');"></div><div class="user-tooltip-description"><div class="user-tooltip-description-name"><a href="<%= url %>"><%= name %></a></div><div class="user-tooltip-description-subscribe"><button class="btn dull-button subscribe-button">Subscribe</button></div></div></div></div>');var o=this.model.get("user_id"),r=tooltipTemplate({id:o,thumbnail:this.model.get("user_thumbnail"),url:this.model.get("user_url"),name:this.model.get("user")});e(".user-tooltips").append(r);var a=e(".user-tooltips #user-"+o),l=e("button.subscribe-button",a);o===OC.config.user.id&&l.addClass("hide"),OC.getSubscriptionState([o],function(e){e[parseInt(o,10)]&&(l.addClass("subscribed"),l.text("✔ Subscribed"))}),l.click(function(){OC.subscribeTo(o,e(this))}),t(a)}},hideUserTip:function(){var t=e(".user-tooltips .user-tooltip-wrapper.show");t.hasClass("hovered")||t.removeClass("show")}}),O=n.View.extend({isCatalog:!1,render:function(t){this.clearView(),this.prepareView();var i=t||this.collection;if(this.collection=i,0===i.length)this.showNullView();else{var n=s.sortBy(i.models,function(e){return"activity"===e.get("type").toLowerCase()||"lesson"===e.get("type").toLowerCase()?0:1});s.each(n,function(e){new R({model:e}).render()}),e(".resource-time-ago").timeago()}this.revealView()},initialize:function(){this.listenTo(this.collection,"add",this.lateRender),this.isCatalog=OC.categoryResources.isCatalog},clearView:function(){e(".content-panel-body-listing-items").html("")},prepareView:function(){e(".content-panel-body-listing-items").addClass("spinner-background")},revealView:function(){e(".content-panel-body-listing-items").removeClass("spinner-background"),e(".content-panel-body-listing-items").css("display","none"),e(".content-panel-body-listing-items").fadeIn("fast")},showNullView:function(){e(".content-panel-body-listing-items").html('<p class="no-results-message">Couldn\'t find a thing! Have you tried requesting for something?</p>'),OC.categoryResources.filterAsyncSearchOn&&e(".no-results-message").addClass("hide")},lateRender:function(e){new R({model:e}).render()}}),S={type:[],tags:[],category:[]},x=(new f,null);return OC.categoryResources&&s.extend(OC.categoryResources,{resourceCollectionView:t,requestCollectionView:t,lastInputTimestamp:null,searchFilterTimeout:null,filterAsyncSearchOn:!1,visibleResourceCount:null,suggestionMode:!1,qnaFlashed:!1,currentView:"items",commonCoreEasyMap:{Kindergarten:"Kindergarten","Elementary / Primary School":{"Grade 1":"Grade 1","Grade 2":"Grade 2","Grade 3":"Grade 3","Grade 4":"Grade 4","Grade 5":"Grade 5"},"Middle School":{"Grade 6":"Grade 6","Grade 7":"Grade 7","Grade 8":"Grade 8"},"High School":{"High School: Number &amp; Quantity":"Number &amp; Quantity","High School: Algebra":"Algebra","High School: Functions":"Functions","High School: Geometry":"Geometry","High School: Statistics &amp; Probability":"Statistics &amp; Probability"}},commonCoreEasyEnglishMap:{Kindergarten:"Kindergarten","Elementary / Primary School":{"Grade 1":"Grade 1","Grade 2":"Grade 2","Grade 3":"Grade 3","Grade 4":"Grade 4","Grade 5":"Grade 5"},"Middle School":{"Grade 6":"Grade 6","Grade 7":"Grade 7","Grade 8":"Grade 8","Grade 6-8":"Grade 6-8"},"High School":{"Grade 9-10":"Grade 9-10","Grade 11-12":"Grade 11-12"}},initBrowseView:function(){function t(){var t=e(window).height()-e("body > header").height()-e(".resource-browse-header").height()-parseInt(e(".resource-browse-subject .wide-center-stage").css("padding-top"),10);e(".grades-topics-list").height(t)}getScrollbarWidth();if(e(OC.config.search.input).val(""),!OC.categoryResources.suggestionMode){OC.setUpMenuPositioning(".sort-by-type-menu",".sort-by-type"),e(".category-panel-listing-categories-body").addClass("scroll-content"),e(".category-panel-listing-categories").height(e(".resource-browse").height()-100),e(".category-panel-listing-categories").nanoScroller({paneClass:"scroll-pane",sliderClass:"scroll-slider",contentClass:"scroll-content",flash:!0});var i=e(".sort-by-type-menu");e(".content-panel").on("scroll click",function(){i.hasClass("show")&&e(".sort-by-type-menu").removeClass("show")}),e(".sort-by-type").click(function(t){return e(".sort-by-type-menu").toggleClass("show"),t.stopPropagation(),t.preventDefault(),!1}),e(".category-panel-listing-categories-body-filters-description").tipsy({gravity:"s"}),OC.categoryResources.setupGradeListing(),e("ul.grades li a.grade").click(OC.categoryResources.gradeClickHandler),setTimeout(function(){e(".grades-topics-list-empty").animate({left:0,opacity:1},1e3)},500),e(".resource-browse-subject").length>0&&(t(),e(window).resize(t))}},gradeClickHandler:function(t){var i=e(this),s=parseInt(e(this).attr("id").substring(9),10);return e("ul.grades li a").removeClass("current"),i.addClass("current"),OC.categoryResources.setGradeTopicList(OC.categoryResources.gradeCategoryMap[s]),t.stopPropagation(),t.preventDefault(),!1},initSuggestionsView:function(){function t(t,i,s){e(t).click(function(t){var n=OC.customPopup(".moderate-suggestion-dialog"),o=e("form.moderate-suggestion-form",n.dialog),r=e(this).parents(".content-panel-body-listing-banner-item");return e('textarea[name="message"]',n.dialog).val(""),e(".moderate-suggestion-submit",o).click(function(t){n.close();var a=r.attr("id").substring(11);return e.post("/resources/api/"+i+"/"+a+"/",o.serialize(),function(e){"true"==e.status?(OC.setMessageBoxMessage(s),OC.showMessageBox(),r.fadeOut("slow")):OC.popup(e.message,e.title)},"json"),t.stopPropagation(),t.preventDefault(),!1}),t.stopPropagation(),t.preventDefault(),!1})}t(".approve-button","approve-suggestion","Suggestion successfully approved!"),t(".reject-button","reject-suggestion","Suggestion successfully rejected!")},setGradeTopicList:function(t){e(".grades-topics-list-empty").addClass("hidden");var i=e(".grades-topics-list-filled");i.html("");var s,n,o,r,a;for(s=0;s<t.length;s++)n=e("<li/>",{"class":"grade-topic"}),o=e("<a/>",{href:t[s].url}),r=e("<div/>",{"class":"grade-topic-thumbnail",style:"background-image: url('"+staticURL+"images/categories/"+t[s].slug+".png');"}),a=e("<div/>",{html:t[s].title,"class":"grade-topic-content"}),o.append(r),o.append(a),n.append(o),i.append(n)},setupGradeListing:function(){function t(e){var t;for(t in u)if(u.hasOwnProperty(t)&&s.has(u[t],e))return t}function i(e){for(r=0;r<d.length;r++)if(s.isObject(d[r])&&s.keys(d[r])[0]===e)return s.values(d[r])[0];return sectionMap={},sectionMap[section]=[],d.push(sectionMap),sectionMap[section]}function n(t,i,s){m=e("<li/>"),f=e("<a/>",{href:s,html:i,id:"category-"+t,"class":"grade"}),m.append(f),v.append(m)}var o,r,a,l,c,u={},h=s.keys(OC.categoryResources.commonCoreEasyMap),d=[];for(l in OC.categoryResources.commonCoreEasyMap)OC.categoryResources.commonCoreEasyMap.hasOwnProperty(l)&&s.isObject(OC.categoryResources.commonCoreEasyMap[l])&&(u[l]=OC.categoryResources.commonCoreEasyMap[l]);for(o=0;o<OC.categoryResources.rawChildCategories.length;o++)c=-1!==h.indexOf(OC.categoryResources.rawChildCategories[o].title),c?d.push({title:OC.categoryResources.commonCoreEasyMap[OC.categoryResources.rawChildCategories[o].title],id:OC.categoryResources.rawChildCategories[o].id,url:OC.categoryResources.rawChildCategories[o].url}):(section=t(OC.categoryResources.rawChildCategories[o].title),section&&(a=u[section][OC.categoryResources.rawChildCategories[o].title],i(section).push({title:a,id:OC.categoryResources.rawChildCategories[o].id,url:OC.categoryResources.rawChildCategories[o].url})));var g,p,f,m,y,v=e(".grades-topics ul.grades");for(g=0;g<d.length;g++)if(y=s.values(d[g]),1===y.length)for(m=e("<li/>"),f=e("<a/>",{text:s.keys(d[g])[0],"class":"grade-section"}),m.append(f),v.append(m),sectionCategories=s.values(d[g])[0],p=0;p<sectionCategories.length;p++)n(sectionCategories[p].id,sectionCategories[p].title,sectionCategories[p].url);else n(d[g].id,d[g].title,d[g].url)},initInfiniteScroll:function(){if(OC.categoryResources.currentCategoryID){var t,i,s,n=e(".lazy-load-button");e(".content-panel").on("DOMContentLoaded load resize scroll",function(){t=e(".content-panel-body").attr("id").substring(9),e.contains(document,n[0])&&n.hasClass("enabled")&&isElementInViewport(n)&&!n.hasClass("loading")&&(n.addClass("loading"),e.get("/resources/api/load-browse-resources/"+t+"/from/"+OC.categoryResources.currentCategoryID+"/",function(e){if("true"===e.status){var t=Object.keys(e.resources);if(e.current_category_id){for(i=0;i<t.length;i++)s=e.resources[t[i]],resourceModel=new u(s),resourceCollectionView.collection.add(resourceModel);OC.categoryResources.currentCategoryID=e.current_category_id}else n.remove()}else OC.popup(e.message,e.title);n.removeClass("loading")},"json"))})}},setVisibleResourceCount:function(){function t(){var t=e(".content-panel-body-listing").width()/e(".content-panel-body-listing-thumbnail-item").outerWidth(!0);OC.categoryResources.visibleResourceCount=Math.floor(t)-1}var i=e("<div>",{"class":"content-panel-body-listing-thumbnail-item"});e("body").append(i),t(),e(window).resize(function(){t()})},filterInitialResources:function(t){var i,s,n,o=e(".sort-by-type-menu input:checkbox, .category-panel-listing-categories-body-filters input:checkbox, .category-panel-body-listing-filters-filter-subtopic input:checkbox");for(i=0;i<o.length;i++)n=e(o[i]).val(),s=e(o[i]).attr("name"),o[i].checked||S[s].push(n);return r(t)},initMVC:function(){var t=e(".sort-by-type-menu label, .category-panel-listing-categories-body-filters label, .category-panel-body-listing-filters-filter-subtopic label");e(t).click(l),e(".filter-sort-option").click(function(t){unfilteredCollection=x?x:OC.categoryResources.resourceSet,filteredCollection=r(unfilteredCollection),e(t.target).hasClass("filter-sort-option-newest")?filteredCollection.sortByNewest():filteredCollection.sortByPopularity(),OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog?OC.categoryResources.reset(filteredCollection):OC.categoryResources.resourceCollectionView.render(filteredCollection)});var i=e(".category-panel-body-listing-types");i.length>0&&e(".category-panel-body-listing-types ul li a").click(function(t){var i=e(t.target),n=i.parents("li").attr("name");if(e(".category-panel-body-listing-types ul li a").removeClass("current"),i.addClass("current"),"all"===n)S.type=[];else{var o=s.map(e(".category-panel-body-listing-types ul li"),function(t){return e(t).attr("name")});o.splice(o.indexOf("all"),1),o.splice(o.indexOf(n),1),S.type=o}var a=x?x:r(OC.categoryResources.resourceSet);return OC.categoryResources.resourceCollectionView.render(a),t.stopPropagation(),t.preventDefault(),!1});var n=e(".content-panel-body-listing-items, .content-panel-body-listing-requests");if(!OC.categoryResources.isSubjectHome){e(OC.config.search.input).keyup(function(){var t=e(this).val(),i=e(".lazy-load-button"),o=new h(OC.categoryResources.resourceSet.filter(function(e){return-1!==e.get("title").toLowerCase().indexOf(t.toLowerCase())||-1!==e.get("description").toLowerCase().indexOf(t.toLowerCase())||0!==s.filter(e.get("tags"),function(e){return-1!==e.toLowerCase().indexOf(t.toLowerCase())}).length||0!==s.filter(e.get("objectives"),function(e){return-1!==e.toLowerCase().indexOf(t.toLowerCase())}).length})),a=e(".filter-search-placeholder");if(t.length>0)i.length>0&&(i.addClass("hide"),i.removeClass("enabled")),n.addClass("show"),(OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog)&&categoryView.truncateAll(),a.addClass("show"),currentTime=(new Date).getTime(),OC.categoryResources.lastInputTimestamp&&(delta=(currentTime-OC.categoryResources.lastInputTimestamp)/1e3,1>delta&&(clearTimeout(OC.categoryResources.searchFilterTimeout),OC.categoryResources.filterAsyncSearchOn=!1),OC.categoryResources.searchFilterTimeout=setTimeout(function(){var i,s,n=e(".content-panel-body").attr("id").substring(9);e.get("/resources/api/search-category/"+n+"/query/"+t+"/",function(t){if(a.removeClass("show"),OC.categoryResources.filterAsyncSearchOn=!1,"true"==t.status){var n=Object.keys(t.resources);for(OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog?0===o.length&&0===n.length?categoryView.showNullView():0===o.length&&categoryView.clearView():0===OC.categoryResources.resourceCollectionView.collection.length&&0===n.length?OC.categoryResources.resourceCollectionView.showNullView():0===resourceCollectionView.collection.length&&OC.categoryResources.resourceCollectionView.clearView(),i=0;i<n.length;i++)s=t.resources[n[i]],resourceModel=new u(s),OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog?o.add(resourceModel):OC.categoryResources.resourceCollectionView.collection.add(resourceModel),OC.categoryResources.resourceSet.add(resourceModel);(OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog)&&(OC.categoryResources.reset(r(o)),categoryView.truncateAll()),x=o}else OC.popup(t.message,t.title);e(".no-results-message").removeClass("hide")},"json")},1500),OC.categoryResources.filterAsyncSearchOn=!0),OC.categoryResources.lastInputTimestamp=currentTime;else{clearTimeout(OC.categoryResources.searchFilterTimeout),i.length>0&&(i.removeClass("hide"),i.addClass("enabled")),OC.categoryResources.filterAsyncSearchOn=!1,a.removeClass("show");var l="items"==OC.categoryResources.currentView?"requests":"items";e(".content-panel-body-listing-"+l).removeClass("show");try{categoryView.resetTruncate(),categoryView.showShowMores()}catch(c){}x=null}OC.categoryResources.isSubjectHome||OC.categoryResources.isCatalog?OC.categoryResources.reset(r(o)):(OC.categoryResources.resourceCollectionView.render(r(o)),OC.categoryResources.resourceCollectionView.initialize()),x=o;var d=new g(OC.categoryResources.requestSet.filter(function(e){return-1!==e.get("body").toLowerCase().indexOf(t.toLowerCase())}));OC.categoryResources.requestCollectionView.render(d)}),e(".category-panel-body-listing-filters-filter-standards .category-panel-body-listing-filters-filter-title").click(function(){e(this).parent().find(".category-panel-body-listing-filters-filter-body").toggleClass("hidden")});var o,a={};OC.categoryResources.resourceSet.each(function(e){o=e.get("type"),s.has(a,o)?a[o]+=1:a[o]=1});var c;s.each(e(".category-panel-body-listing-types ul li"),function(t){c=e(t),$a=c.find("a"),$a.text(s.has(a,c.attr("name").toUpperCase())?$a.text()+" ("+a[c.attr("name").toUpperCase()]+")":"all"===c.attr("name")?$a.text()+" ("+OC.categoryResources.resourceSet.length+")":$a.text()+" (0)")});var d=e(".resource-browse-header-qna");d.tipsy({gravity:"se",delayIn:1e3,trigger:"manual",fade:!0}),e(".content-panel-body-listing").scroll(function(){OC.categoryResources.qnaFlashed||(d.attr("title",String(s.random(6,14))+" teachers waiting online to help for free"),setTimeout(function(){d.tipsy("show"),setTimeout(function(){d.tipsy("hide")},5e3)},1500),OC.categoryResources.qnaFlashed=!0)})}},reset:function(e){categoryView=new m({collection:c(e)}),categoryView.render()},initModeToggler:function(){e(".content-panel-body-listing-questions-toggler a").click(function(t){e(".content-panel-body-listing-questions-toggler a").removeClass("selected");var i=e(t.target);return i.addClass("selected"),i.hasClass("content-panel-body-listing-questions-toggler-listing")?(e(".content-panel-body-listing-items").addClass("show"),e(".content-panel-body-listing-requests").removeClass("show"),OC.categoryResources.currentView="items"):i.hasClass("content-panel-body-listing-questions-toggler-questions")&&(e(".content-panel-body-listing-requests").addClass("show"),e(".content-panel-body-listing-items").removeClass("show"),OC.categoryResources.currentView="requests"),t.stopPropagation(),t.preventDefault(),!1
})}}),{Category:p,Resource:u,ResourceView:R,Request:d,RequestCollectionView:C,ResourceCollectionView:O}}),define("browse",["jquery","core","categoryResources"],function(e,t,i){var s=i.ResourceCollectionView,n=i.RequestCollectionView;e(document).ready(function(e){t.categoryResources.suggestionMode?t.categoryResources.initSuggestionsView():t.categoryResources.isSubjectHome||(t.categoryResources.setVisibleResourceCount(),t.categoryResources.isCatalog?t.categoryResources.reset(t.categoryResources.filterInitialResources(t.categoryResources.resourceSet)):(t.categoryResources.resourceCollectionView=new s({collection:t.categoryResources.resourceSet}),t.categoryResources.resourceCollectionView.render()),t.categoryResources.requestCollectionView=new n({collection:t.categoryResources.requestSet,requestURL:t.categoryResources.requestURL}),t.categoryResources.requestCollectionView.render(),e(t.config.search.input).autocomplete("disable"),t.categoryResources.initMVC(),t.categoryResources.initModeToggler(),t.categoryResources.initInfiniteScroll()),t.categoryResources.initBrowseView()})});