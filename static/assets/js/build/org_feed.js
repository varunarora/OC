define("org_feed",["react","core_light"],function(e,t){var r={items:[],fetching:!1,feeds:e.createClass({componentDidUpdate:function(){var e,r=this.getDOMNode().querySelectorAll(".feed-item-date");for(e=0;e<r.length;e++)t.utils.timeago(r[e])},componentWillMount:function(){function e(){require(["spin"],function(e){r.hasOwnProperty("spinner")?r.spinner.spin(s):r.spinner=new e(t.spinner.options).spin(s)})}function i(){document!==s&&document.contains(s)&&a.offsetTop-(n.offsetTop+parseInt(n.style.height,10))<n.scrollTop&&!t.$.hasClass(s,"loading")&&(t.$.addClass(s,"loading"),r.hasOwnProperty("spinner")&&r.spinner.spin(s),r.fetching===!1&&(r.fetching=!0,require(["atomic"],function(e){e.get("/user/api/load-feed/"+t.feed.context+"/"+t.config.profile.id+"/from/"+t.feed.currentCount+"/").success(function(e){"true"==e.status&&(o.setProps({items:o.props.items.concat(e.feeds)},function(){r.fetching=!1}),t.feed.currentCount+=e.feeds.length),t.$.removeClass(s,"loading"),r.spinner.stop()})})))}{var s=document.querySelector(".ajax-loader"),a=document.querySelector(".ajax-loader-wrapper"),o=this,n=document.querySelector(".content-panel-body-wrapper");document.querySelector(".content-panel")}t.feed.feedCount>0&&(e(),i(),t.$.addListener(n,"scroll",i))},renderItem:function(e){return r.item({item:e})},render:function(){var i,s=e.DOM.div({},[e.DOM.div({className:"empty-state-title empty-state-title-independent empty-state-title-independent-large"},"Subscribe to someone for the latest and greatest"),r.subscribeSuggestions({suggestions:t.feed.suggestions})]);return i=t.config.profile.id===t.config.user.id?e.DOM.div({className:"empty-state-title empty-state-title-independent"},"You have no activity to show"):e.DOM.div({className:"empty-feed empty-external-feed"},e.DOM.div({className:"empty-state-title"},"Looks like "+(t.config.profile.name+" hasn't done much on the site lately"))),e.DOM.div({className:"feed-list"},t.feed.feedCount>0?this.props.items.map(this.renderItem):"profile"===t.feed.context?i:s)}}),item:e.createClass({getInitialState:function(){return{videoLoaded:!1}},loadAndPlay:function(){this.setState({videoLoaded:!0})},date:function(t){return e.DOM.span({className:"feed-item-date",title:t},null)},url:function(t,r){return e.DOM.a({href:t},r)},urlItem:function(t,r,i,s){return e.DOM.a({className:"feed-link",href:i,target:"_blank"},[e.DOM.div({className:"feed-link-thumbnail",style:{backgroundImage:"url('"+t+"')"}}),e.DOM.div({className:"feed-link-link-wrapper"},[e.DOM.div({className:"feed-link-link"},r),e.DOM.div({className:"feed-link-url"},s)])])},videoItem:function(t,r,i,s,a,o){return e.DOM.div({className:"feed-video"},[this.state.videoLoaded?e.DOM.iframe("youtube"===this.props.item.target_provider?{height:282,width:502,frameBorder:0,allowFullScreen:!0,src:"http://www.youtube.com/embed/"+(this.props.item.target_video_tag+"?wmode=opaque&autoplay=1")}:{height:282,width:502,frameBorder:0,allowFullScreen:!0,src:"http://player.vimeo.com/video/"+this.props.item.target_video_tag+"?title=0&amp;byline=0&amp;portrait=0&amp;badge=0&amp;color=ffffff"}):e.DOM.div({className:"video-placeholder youtube-video-placeholder feed-link-thumbnail",style:{backgroundImage:"url('"+r+"')"}},e.DOM.div({className:"video-placeholder-cover",onClick:this.loadAndPlay})),e.DOM.a({className:"feed-link-link-wrapper",href:a,target:"_blank"},[e.DOM.div({className:"feed-link-link"},s),e.DOM.div({className:"feed-link-url"},o)])])},uploadItem:function(t,r,i,s,a){return e.DOM.div({className:"feed-upload"},[e.DOM.div({className:"feed-upload-thumbnail",style:{backgroundImage:"url('"+t+"')"}}),e.DOM.div({className:"feed-upload-description"},[e.DOM.a({href:i,className:"feed-upload-description-title"},r),e.DOM.div({className:"feed-upload-description-download"},[e.DOM.a({href:s,target:"_blank"},"Download"),e.DOM.span({href:i}," · "+a)])])])},commentItem:function(t){return e.DOM.div({className:"feed-comment"},e.DOM.blockquote({dangerouslySetInnerHTML:{__html:t}}))},newPost:function(t){return e.DOM.a({href:t},"new post")},post:function(t){return e.DOM.a({href:t},"discussion post")},group:function(t,r){return e.DOM.a({href:t},r)},membership:function(t,r){return e.DOM.a({href:t},r)},groupItem:function(t,r,i,s,a){return e.DOM.a({className:"feed-group",href:t},[e.DOM.div({className:"feed-group-thumbnail",style:{backgroundImage:"url('"+r+"')",backgroundPosition:i[0]+"% "+i[1]+"%"}}),e.DOM.div({className:"feed-group-link-wrapper"},[e.DOM.div({className:"feed-group-link"},s),e.DOM.div({className:"feed-group-count"},a+" members")])])},folderItem:function(t,r){return e.DOM.a({className:"feed-folder",href:r},[e.DOM.div({className:"feed-folder-thumbnail"}),e.DOM.div({className:"feed-folder-description"},[e.DOM.div({className:"feed-folder-description-title"},t)])])},discussionItem:function(t,r,i,s,a){return e.DOM.div({className:"feed-comment feed-comment-discussion-response"},[e.DOM.div({className:"feed-comment-user-photo",style:{backgroundImage:"url('"+t+"')"}},null),e.DOM.div({className:"feed-comment-user-description"},e.DOM.a({href:r},i),e.DOM.span({dangerouslySetInnerHTML:{__html:s}}),e.DOM.blockquote({dangerouslySetInnerHTML:{__html:a}}))])},render:function(){var r,i=this.props.item,s=parseInt(t.config.user.id,10)===parseInt(i.actor_id,10)?e.DOM.span({},"You"):e.DOM.a({href:i.actor_url},i.actor_name);if("resource"===i.action_type)"url"==i.target_type?r=e.DOM.div({className:"feed-item-description-url"},[s,e.DOM.span({}," created a new link."),this.date(i.target_created),this.urlItem(i.target_thumbnail,i.target,i.target_direct_url,i.target_direct_url_host)]):"document"==i.target_type?r=e.DOM.div({className:"feed-item-description-document"},[s,e.DOM.span({}," created a new document "),e.DOM.a({href:i.target_direct_url},i.target),this.date(i.target_created)]):"video"==i.target_type?r=e.DOM.div({className:"feed-item-description-video"},[s,e.DOM.span({}," added a video."),this.date(i.target_created),this.videoItem(i.target_video_tag,i.target_thumbnail,i.target_provider,i.target,i.target_direct_url,i.target_direct_url_host)]):"attachment"==i.target_type&&(r=e.DOM.div({className:"feed-item-description-upload"},[s,e.DOM.span({}," uploaded a new file."),this.date(i.target_created),this.uploadItem(i.target_thumbnail,i.target,i.target_url,i.target_download_url,i.target_size)]));else if("comment"===i.action_type)"resource"===i.target_type?r=e.DOM.div({className:"feed-item-description-comment"},[s,e.DOM.span({}," commented on the resource "),this.url(i.target_url,i.target),e.DOM.span({},"."),this.date(i.action_created),this.commentItem(i.action)]):"comment"===i.target_type&&(r=i.action_id===i.target_id?e.DOM.div({className:"feed-item-description-comment"},[s,e.DOM.span({}," wrote a "),this.newPost(i.target_url),e.DOM.span({}," in "),this.group(i.context_url,i.context),e.DOM.span({},"."),this.date(i.action_created),this.commentItem(i.action)]):e.DOM.div({className:"feed-item-description-comment"},[s,e.DOM.span({}," commented on a "),this.post(i.target_url),e.DOM.span({}," in "),this.group(i.context_url,i.context),e.DOM.span({},"."),this.date(i.action_created),this.discussionItem(i.target_user_thumbnail,i.target_user_url,i.target_user,i.target,i.action)]));else if("membership"===i.action_type)r=e.DOM.div({className:"feed-item-description-membership"},[s,e.DOM.span({}," just joined the group "),this.membership(i.target_url,i.target),this.date(i.action_joined),this.groupItem(i.target_url,i.target_thumbnail,i.target_thumbnail_position,i.target,i.target_member_count)]);else if("project"===i.action_type)r=e.DOM.div({className:"feed-item-description-group"},[s,e.DOM.span({}," created the group "),this.membership(i.target_url,i.target),this.date(i.target_created),this.groupItem(i.action_url,i.action_thumbnail,i.action_thumbnail_position,i.action,i.action_member_count)]);else if("favorite"===i.action_type){var a;switch(i.target_type){case"url":a=this.urlItem(i.target_thumbnail,i.target,i.target_direct_url,i.target_direct_url_host);break;case"video":a=this.videoItem(i.target_video_tag,i.target_thumbnail,i.target_provider,i.target,i.target_direct_url,i.target_direct_url_host);break;case"attachment":a=this.uploadItem(i.target_thumbnail,i.target,i.target_url,i.target_download_url,i.target_size)}r=e.DOM.div({className:"feed-item-description-group"},[s,e.DOM.span({}," favorited "),this.url(i.target_user_url,i.target_user),e.DOM.span({},"'s resource "),this.url(i.target_url,i.target),this.date(i.action_created),a])}else"collection"===i.action_type&&(r=e.DOM.div({className:"feed-item-description-folder"},[s,e.DOM.span({}," created a new folder."),this.date(i.target_created),this.folderItem(i.target,i.target_url)]));return e.DOM.div({className:"feed-item"},[e.DOM.a({href:i.actor_url,className:"feed-item-user-thumbnail",style:{backgroundImage:"url('"+i.actor_thumbnail+"')"},title:i.actor_name}),e.DOM.div({className:"feed-item-description"},r)])}}),subscribe:e.createClass({getInitialState:function(){return{subscribed:this.props.subscribed}},subscribe:function(){var e=this;this.setState({subscribed:!this.state.subscribed},function(){require(["atomic"],function(r){r.get("/user/api/subscribe/"+(e.props.id?e.props.id:t.config.profile.id)+"/").success(function(t){"true"!==t.status&&e.setState({subscribed:!e.state.subscribed})})})})},render:function(){return e.DOM.button({className:"oc-button feed-subscribe"+(this.state.subscribed?" feed-unsubscribe":""),onClick:this.subscribe},this.state.subscribed?"★ Following":"Follow")}}),subscribeSuggestion:e.createClass({getInitialState:function(){return{subscribed:!1}},render:function(){return e.DOM.div({className:"home-profile-suggestion"},[e.DOM.a({className:"home-profile-suggestion-thumbnail",href:this.props.url,style:{borderColor:t.config.palette.base,backgroundImage:"url('"+this.props.thumbnail+"')"}}),e.DOM.a({className:"home-profile-suggestion-cover",href:this.props.url,style:{backgroundColor:t.config.palette.dark}},this.props.name),e.DOM.div({className:"home-profile-suggestion-wrapper-subscribe feed-subscribe-wrapper"},r.subscribe({subscribed:this.state.subscribed,id:this.props.id}))])}}),subscribeSuggestions:e.createClass({renderSuggestion:function(e){return r.subscribeSuggestion(e)},render:function(){return e.DOM.div({className:"suggestion-list"},this.props.suggestions.map(this.renderSuggestion))}})};return t.config.user.id!==t.config.profile.id&&e.renderComponent(r.subscribe({subscribed:t.feed.subscribed}),document.querySelector(".profile-box-feed-subscribe-wrapper")),e.renderComponent(r.feeds({items:r.items}),document.querySelector(".feed-list-wrapper")),r}),define("follow",["react","core_light"],function(e,t){var r={follows:e.createClass({componentDidMount:function(){function e(e){require(["spin"],function(i){r.hasOwnProperty("spinner")?r.spinner.spin(s):r.spinner=new i(t.spinner.options).spin(s),e()})}var i,s=document.querySelector(".ajax-loader"),a=document.querySelector(".ajax-loader-wrapper"),o=this;e(function(){require(["jquery"],function(){r.hasOwnProperty("spinner")&&r.spinner.spin(s),i="followers"==t.follow.context?"/user/api/followers/":"/user/api/following/",require(["atomic"],function(e){e.get(i+t.config.profile.id+"/").success(function(e){o.setProps({follows:o.props.follows.concat(e.follows)}),t.$.removeClass(s,"loading"),t.$.addClass(a,"hide"),r.spinner.stop()})})})})},renderUser:function(e){return r.follow(e)},render:function(){return t.follow.followerCount>0?e.DOM.div({},this.props.follows.map(this.renderUser)):e.DOM.div({className:"empty-state-title empty-state-title-independent"},"No followers.")}}),follow:e.createClass({getInitialState:function(){return{following:this.props.following}},follow:function(){var e=this;this.setState({following:!this.state.following},function(){require(["atomic"],function(r){r.get("/user/api/subscribe/"+(e.props.id?e.props.id:t.config.profile.id)+"/").success(function(t){"true"!==t.status&&e.setState({following:!e.state.following})})})})},render:function(){return e.DOM.div({className:"profile-box-social-user"},[e.DOM.div({className:"profile-box-social-user-info"},[e.DOM.div({className:"profile-box-social-user-thumbnail box-user-thumbnail",style:{backgroundImage:"url('"+this.props.thumbnail+"')"}},null),e.DOM.div({className:"profile-box-social-user-description box-user-description"},[e.DOM.a({href:this.props.url},this.props.name),e.DOM.div({className:"profile-box-social-user-description-headline box-user-description-headline"},this.props.headline)])]),e.DOM.div({className:"profile-box-social-user-actions"},e.DOM.button({className:"oc-button"+(this.state.following?" oc-dull-button":""),onClick:this.follow},this.state.following?"Unfollow":"Follow"))])}})};e.renderComponent(r.follows({follows:[]}),document.querySelector(".profile-box-social-users"))});